{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>475</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>頂点に <var>1</var> から <var>N</var> の番号が、辺に <var>1</var> から <var>M</var> の番号がついた <var>N</var> 頂点 <var>M</var> 辺の重み付き単純連結無向グラフと正整数 <var>K</var> が与えられます。<br>\n辺 <var>i\\ (1\\leq i\\leq M)</var> は頂点 <var>u _ i</var>​ と頂点 <var>v _ i</var> を結んでおり、重みは <var>w _ i</var> です。</p>\n<p>このグラフの全域木 <var>T</var> に対して、<var>T</var> のコストを <var>T</var> に含まれる辺の重みの総和を <var>K</var> で割ったあまりで定めます。\nこのグラフの全域木のコストの最小値を求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2\\leq N\\leq8</var></li>\n<li><var>N-1\\leq M\\leq\\dfrac{N(N-1)}2</var></li>\n<li><var>1\\leq K\\leq10^{15}</var></li>\n<li><var>1\\leq u _ i\\lt v _ i\\leq N\\ (1\\leq i\\leq M)</var></li>\n<li><var>0\\leq w _ i\\lt K\\ (1\\leq i\\leq M)</var></li>\n<li>与えられるグラフは単純かつ連結</li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var> <var>K</var>\n<var>u _ 1</var> <var>v _ 1</var> <var>w _ 1</var>\n<var>u _ 2</var> <var>v _ 2</var> <var>w _ 2</var>\n<var>\\vdots</var>\n<var>u _ M</var> <var>v _ M</var> <var>w _ M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>5 6 328\n1 2 99\n1 3 102\n2 3 86\n2 4 94\n2 5 95\n3 4 81\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>33\n</pre>\n<p>与えられるグラフは次のようになります。</p>\n<p><img src=\"https://img.atcoder.jp/abc328/67d2cc2b93ec47687a733cd379c3c07c.png\" style=\"max-width:95%\"></p>\n<p>辺 <var>1,3,5,6</var> の <var>4</var> 本を含む全域木のコストは <var>(99+86+81+95)\\bmod{328}=361\\bmod{328}=33</var> となります。\nこのグラフの全域木のコストはすべて <var>33</var> 以上であるため、<var>33</var> を出力してください。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>6 5 998244353\n1 2 337361568\n1 6 450343304\n2 3 61477244\n2 5 745383438\n4 5 727360840\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>325437688\n</pre>\n<p>このグラフのただ一つの全域木のコスト <var>325437688</var> を出力してください。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>8 28 936294041850197\n1 2 473294720906780\n1 3 743030800139244\n1 4 709363019414774\n1 5 383643612490312\n1 6 557102781022861\n1 7 623179288538138\n1 8 739618599410809\n2 3 857687812294404\n2 4 893923168139714\n2 5 581822471860662\n2 6 740549363586558\n2 7 307226438833222\n2 8 447399029952998\n3 4 636318083622768\n3 5 44548707643622\n3 6 307262781240755\n3 7 12070267388230\n3 8 700247263184082\n4 5 560567890325333\n4 6 704726113717147\n4 7 588263818615687\n4 8 549007536393172\n5 6 779230871080408\n5 7 825982583786498\n5 8 713928998174272\n6 7 751331074538826\n6 8 449873635430228\n7 8 11298381761479\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>11360716373\n</pre>\n<p>入力や答えが <var>32\\operatorname{bit}</var> 整数に収まらない場合があることに注意してください。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>475</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given a weighted simple connected undirected graph with <var>N</var> vertices and <var>M</var> edges, where vertices are numbered <var>1</var> to <var>N</var>, and edges are numbered <var>1</var> to <var>M</var>. Additionally, a positive integer <var>K</var> is given.<br>\nEdge <var>i\\ (1\\leq i\\leq M)</var> connects vertices <var>u_i</var> and <var>v_i</var> and has a weight of <var>w_i</var>.</p>\n<p>For a spanning tree <var>T</var> of this graph, the cost of <var>T</var> is defined as the sum, modulo <var>K</var>, of the weights of the edges in <var>T</var>.\nFind the minimum cost of a spanning tree of this graph.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2\\leq N\\leq8</var></li>\n<li><var>N-1\\leq M\\leq\\dfrac{N(N-1)}2</var></li>\n<li><var>1\\leq K\\leq10^{15}</var></li>\n<li><var>1\\leq u_i\\lt v_i\\leq N\\ (1\\leq i\\leq M)</var></li>\n<li><var>0\\leq w_i\\lt K\\ (1\\leq i\\leq M)</var></li>\n<li>The given graph is simple and connected.</li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>K</var>\n<var>u_1</var> <var>v_1</var> <var>w_1</var>\n<var>u_2</var> <var>v_2</var> <var>w_2</var>\n<var>\\vdots</var>\n<var>u_M</var> <var>v_M</var> <var>w_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>5 6 328\n1 2 99\n1 3 102\n2 3 86\n2 4 94\n2 5 95\n3 4 81\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>33\n</pre>\n<p>The given graph is shown below:</p>\n<p><img src=\"https://img.atcoder.jp/abc328/67d2cc2b93ec47687a733cd379c3c07c.png\" style=\"max-width:95%\"></p>\n<p>The cost of the spanning tree containing edges <var>1,3,5,6</var> is <var>(99+86+81+95)\\bmod{328}=361\\bmod{328}=33</var>.\nThe cost of every spanning tree of this graph is at least <var>33</var>, so print <var>33</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>6 5 998244353\n1 2 337361568\n1 6 450343304\n2 3 61477244\n2 5 745383438\n4 5 727360840\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>325437688\n</pre>\n<p>Print the cost of the only spanning tree of this graph, which is  <var>325437688</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>8 28 936294041850197\n1 2 473294720906780\n1 3 743030800139244\n1 4 709363019414774\n1 5 383643612490312\n1 6 557102781022861\n1 7 623179288538138\n1 8 739618599410809\n2 3 857687812294404\n2 4 893923168139714\n2 5 581822471860662\n2 6 740549363586558\n2 7 307226438833222\n2 8 447399029952998\n3 4 636318083622768\n3 5 44548707643622\n3 6 307262781240755\n3 7 12070267388230\n3 8 700247263184082\n4 5 560567890325333\n4 6 704726113717147\n4 7 588263818615687\n4 8 549007536393172\n5 6 779230871080408\n5 7 825982583786498\n5 8 713928998174272\n6 7 751331074538826\n6 8 449873635430228\n7 8 11298381761479\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>11360716373\n</pre>\n<p>Note that the input and the answer may not fit into a <var>32\\operatorname{bit}</var> integer.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc328/tasks/abc328_e"}