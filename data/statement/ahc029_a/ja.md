## 問題文

                    

                        あなたは会社を経営するゲームをプレイしている。
                        会社が進めている複数の**プロジェクト**に対して、毎ターンごとに手札から**方針カード**を一つ選び消費し、そのカードに従ってプロジェクトを進め、手札の方針カードを補充する、ということを繰り返すターン制のゲームである。
                        全 $T$ ターンが終了した時点で**所持金**を最大化することがこのゲームの目的である。
                    

                    

                        プロジェクトには**残務量**と**価値**という整数値のペアが定まっている。残務量が $0$ 以下になるとプロジェクトは完了し、価値が所持金に追加される。
                    

                    

                        あなたはプロジェクトの進め方の方針が書かれた「方針カード」というカードを手札として $N$ 枚持っている。ターンごとに手札の中から1枚の方針カードを選び、その内容にしたがってプロジェクトを進める。
                        方針カードには以下の 5 種類がある。
                        

- **通常労働カード**: このカードには**労働力**という正整数が定まっている。このカードを選ぶと、現在管理しているプロジェクトのうち一つを指定し、そのプロジェクトの残務量を労働力分だけ減らす。
- **全力労働カード**: このカードには**労働力**という正整数が定まっている。このカードを選ぶと、現在管理している全てのプロジェクトについてそれぞれの残務量を労働力分だけ減らす。
- **キャンセルカード**: このカードを選ぶと、現在管理しているプロジェクトのうち一つを指定し、そのプロジェクトの実行を取りやめる。
- **業務転換カード**: このカードを選ぶと、現在管理しているプロジェクト全てを取りやめる。
- **増資カード**: このカードを選ぶと、今後出現するプロジェクトの残務量と価値 及び 今後出現する方針カードの労働力とコスト(後述)が $2$ 倍になる。すでに出現しているプロジェクトと手札にある方針カードの数値は変更されない。<font color="red">**このカードはテストケース内で $20$ 回までしか使用できない。**</font>

                    

                    

### ゲームの進め方

                    

                        ゲーム開始時点で、会社が管理している $M$ 個のプロジェクトの情報と、あなたが持っている $N$ 枚の方針カードの情報が与えられる。また、開始時点の所持金は $0$ である。
                        各ターンは次の流れで進んでいく。
                        

1. 手札から方針カードを1枚選択し実行する。選択したカードは手札から消える。
2. 1.    - プロジェクトが完了した場合、プロジェクトの価値の分だけ所持金が増加し、そのプロジェクトは消える。
2.    - プロジェクトの実行を取りやめた場合、そのプロジェクトは消える。

3. 存在するプロジェクトの数が $M$ 個を下回った場合、 プロジェクトの数が $M$ 個になるように新たなプロジェクトが与えられる。
4. $K$ 枚の方針カードおよびそれらのコストが提示される。あなたはその中から 1 枚を選び手札に加える。この際に選んだカードのコストの分だけ所持金が減る。
5. 1.    - コストの分だけ所持金が減ることで所持金が負になるような方針カードを選択することはできない。後述するが、$K$ 枚のカード中にコスト $0$ のカードが存在するため、必ずカードを選択できることが保証されている。

                        以上の手順から分かる通り、ターン開始時には必ず手札に $N$ 枚の方針カードがあり、会社は $M$ 個のプロジェクトを管理している。
                    

                    

                        このゲームを上手にプレイして、$T$ ターン後の時点の所持金をできるだけ多くしてほしい。
                    

                
            
            
            
                
                    

## 順位付け

                    

                        相対評価システムを採用します。<br>
                        各テストケース毎に、 $T$ ターン後の時点での所持金の値を絶対スコアとして $\mathrm{round} \lparen 10^9 \times \frac{自身の絶対スコア}{全参加者中の最大絶対スコア} \rparen$の <font color="red">**相対評価スコア**</font> が得られ、その和が提出の得点となります。
                    

                    

                        最終順位はコンテスト終了後に実施されるより多くの入力に対するシステムテストにおける得点で決定されます。暫定テスト・システムテストのどちらにおいても、一部のテストケースで不正な出力や制限時間超過をした場合、そのテストケースに関する相対評価スコアは0点となり、そのテストケースにおいては「全参加者中の最大絶対スコア」の計算対象から除外されます。<br>
                    

                    

                        また、システムテストは <font color="red">**CE 以外の結果を得た一番最後の提出**</font>に対してのみ行われるため、最終的に提出する解答を間違えないよう注意してください。
                    

                    

### テストケース数

                    

- 暫定テスト: 50個
- システムテスト: 3000個
                            -   - コンテスト終了後に [seeds.txt](https://img.atcoder.jp/ahc029/seeds.txt) (sha256=`aa53f4b2ae15494c08f8304459afd7523eb10b704394ad1c6a0a92fa052bbe14`) を公開します。

                    

### 相対評価システムについて

                    

                        暫定テスト・システムテストともに、CE以外の結果を得た一番最後の提出のみが順位表に反映されます。<br>
                        相対評価スコアの計算に用いられる各テストケース毎の「全参加者中の最大絶対スコア」の算出には、各参加者の順位表に反映されている提出のみが用いられます。<br>
                        順位表に表示されるスコアは相対評価スコアであり、新規提出があるたびに相対評価スコアが再計算されます。 一方、提出一覧から確認できる各提出のスコアは、各テストケース毎の絶対スコアをそのまま足し合わせたものであり、相対評価スコアは表示されません。 最新以外の提出の、現在の順位表における相対評価スコアを知るためには、再提出が必要となります。<br>
                        不正な出力や制限時間超過をした場合、提出一覧から確認できるスコアは0となりますが、順位表には正解したテストケースに対する相対評価スコアの和が表示されます。<br>
                    

                    

### 実行時間について

                    

                        実行時間には多少のブレが生じます。
                        また、システムテストでは同時に大量の実行を行うため、暫定テストに比べて数%程度実行時間が伸びる現象が確認されています。
                        そのため、実行時間制限ギリギリの提出がシステムテストで TLE となる可能性があります。
                        プログラム内で時間を計測して処理を打ち切るか、実行時間に余裕を持たせるようお願いします。
                    

                
            
            

            
                
                    
                        

## 入出力

                        

**※この問題はインタラクティブ形式である。以下の内容を読み、ジャッジプログラムとのやり取りを行うこと。**

                        

最初に問題のパラメタと初期状態が以下の形式で標準入力から与えられる。

> \(
> 
> N ~ M ~ K ~ T \\
> 
> t_0 ~ w_0 \\
> 
> \vdots \\
> 
> t_{N-1} ~ w_{N-1} \\
> 
> h_0 ~ v_0 \\
> 
> \vdots \\
> 
> h_{M-1} ~ v_{M-1} \)
                        

- 1行目には4つの整数 $N,M,K,T$ がスペース区切りで与えられる。
- -   - $N$ は手札に持つ方針カードの枚数で、 $2 \le N \le 7$ を満たす。
-   - $M$ は会社が管理するプロジェクトの数で、 $2 \le M \le 8$ を満たす。
-   - $K$ は手札に補充する方針カードの提示枚数で、 $2 \le K \le 5$ を満たす。
-   - $T$ はゲームのターン数で、 $T = 1000$ を満たす。

- 続く $N$ 行には開始時点の手札の方針カードの情報が与えられる。
- -   - 各行には 2 つの整数 $t_i$, $w_i$ がスペース区切りで含まれており、$i$ 番目の方針カードの種類と労働力を表す。
-   - -   -   - $t_i = 0$ のとき そのカードが労働力 $w_i$ の通常労働カードであることを表す。
-   -   - $t_i = 1$ のとき そのカードが労働力 $w_i$ の全力労働カードであることを表す。
-   -   - $t_i = 2$ のとき そのカードがキャンセルカードであることを表す。
-   -   - $t_i = 3$ のとき そのカードが業務転換カードであることを表す。
-   -   - $t_i = 4$ のとき そのカードが増資カードであることを表す。

-   - $t_i, w_i (0 \leq i \lt N)$ の値の範囲は「入力生成方法」セクションを参照すること。

- 続く $M$ 行には開始時点のプロジェクトの情報が与えられる。
- -   - 各行には 2 つの整数 $h_i$, $v_i$ がスペース区切りで含まれており、$i$ 番目のプロジェクトの残務量と価値を表す。
-   - $h_i, v_i (0 \leq i \lt M)$ の値の範囲は「入力生成方法」セクションを参照すること。

                        

上記の入力を受け取った後は $T$ ターンに渡りゲームを進めていく。ターンごとに以下の形式でやりとりを行うこと。

                        

                            まず手札から使用する方針カードを1枚選び、そのカードの情報を以下の形式で標準出力へ出力せよ。
                        

                        
> \(
> 
> c ~ m\)
                        

- 1 行に 2 つの整数 $c,m$ を出力せよ。
- -   - $c$ は手札のうち何番目の方針カードを使用するかを表す。
-   - $m$ はカードの効果を適用するプロジェクトの番号を表す。
-   - $0 \leq c \lt N, 0 \leq m \lt M$ を満たす必要がある。
-   - 選んだカードが全力労働カード, 業務転換カード, 増資カードのいずれかの場合は $m = 0$ を満たす必要がある。

- テストケース内で増資カードは 20 回までしか使用できない。
- 制約を満たさない出力をした場合、 WA となる。
- 出力の後には改行をし、標準出力をflushする必要がある。そうしなかった場合、 TLE となる可能性がある。<br>

                        

                            続いて、カード使用後のプロジェクトの状況の情報を標準入力から受け取る。
                        

> \(          
> 
> h_0 ~ v_0 \\
> 
> \vdots \\
> 
> h_{M-1} ~ v_{M-1} \)
                        

- 入力は $M$ 行で、各行には直前の方針カードを使用した直後のプロジェクトの情報が、最初の入力と同じ形式で与えられる。
- 完了したり取りやめたりしたプロジェクトがあった場合は、そのプロジェクトと同じ位置に新たに生成されたプロジェクトの情報が与えられる。

                        

                            続いて、現在の所持金の情報を標準入力から受け取る。
                        

> \(
> 
> money\)
                        

- 1 つの整数 $money$ が与えられる。これは現時点での所持金を表す。

                        

                            続いて、手札に補充する方針カードの候補の情報を標準入力から受け取る。
                        

> \(
> 
> t_0 ~ w_0 ~ p_0 \\
> 
> \vdots \\
> 
> t_{K-1} ~ w_{K-1} ~ p_{K-1} \)
                        

- 入力は $K$ 行で、各行には3つの整数が空白区切りで含まれている。
- $t_i, w_i$ は $i$ 番目の方針カード候補の情報を最初の入力と同じ形式で表したものである。
- $p_i$は$i$ 番目の方針カードのコストを表している。
- **$t_0, w_0, p_0$ は $t_0 = 0, w_0 = 2^L, p_0 = 0$ を満たす。**ただし $L$ はその時点で増資カードを使用した回数( $0 \leq L \leq 20$ )を表す整数とする。
- $t_i, w_i, p_i (1 \leq i \lt K)$ の値の範囲は「入力生成方法」セクションを参照すること。

                        

                            最後に、$K$ 枚の方針カード候補のうち何番目のカードを手札に加えるかの情報を標準出力へ出力せよ。
                        

> \(
> 
> r\)
                            

- 1 行に整数 $r$ を出力せよ。
- -   - 方針カード候補から $r$ 番目の方針カードを選ぶ。
-   - $r$ は $0 \le r \lt K$ を満たす必要がある。
-   - 所持金が負になるカードを選択することはできない。

- ここで選んだカードはこのターンの最初に使用したカードと同じ位置、つまり手札の $c$ 番目に補充される。
- 制約を満たさない出力をした場合、 WA となる。
- 出力の後には改行をし、標準出力をflushする必要がある。そうしなかった場合、 TLE となる可能性がある。<br>

                            

                                以上で1ターンが終了する。
                            

                        
                    
                

                
                    
                        

## 入力生成方法

                        
                            

- $l \leq r$ を満たす整数 $l, r$ に対して、$l$ 以上 $r$ 以下の整数を一様ランダムに生成する関数を $\mathrm{rand}(l, r)$ とする。
- $l \leq r$ を満たす実数 $l, r$ に対して、$l$ 以上 $r$ 以下の実数を一様ランダムに生成する関数を $\mathrm{rand\_double}(l, r)$ とする。
- 平均 $\mu$、標準偏差 $\sigma$ の正規分布から値を生成する関数を $\mathrm{gauss}( \mu , \sigma )$とする。
- $l \leq r$ を満たす実数 $l, r$ 及び 実数 $x$ に対して、$\mathrm{max}(l, \mathrm{min}(r, x))$ を求める関数を $\mathrm{clamp}(x, l, r)$ とする。

                        
                        

### $N, M, K$の生成

                        

- $N = \mathrm{rand}(2, 7)$ で生成する。
- $M = \mathrm{rand}(2, 8)$ で生成する。
- $K = \mathrm{rand}(2, 5)$ で生成する。

                        

### プロジェクトの生成

                        

- $L$ をその時点で増資カードを使用した回数( $0 \leq L \leq 20$ )を表す整数とする。
- $b = \mathrm{rand\_double}(2.0, 8.0)$ とする。
- 残務量 $h$ を $h = \mathrm{round}(2 ^ b) * 2^L$ で生成する。
- 価値 $v$ を $v = \mathrm{round}(2 ^ {\mathrm{clamp}(\mathrm{gauss}(b, 0.5), 0.0, 10.0)}) * 2^L$ で生成する。

                        

### 方針カードの生成

                        

- テストケースごとに、カードの種類の生成確率をコントロールする隠しパラメータ $x_0, x_1, x_2, x_3, x_4$ を以下のように定める。
- -   - $x_0=\mathrm{rand}(1,20), x_1=\mathrm{rand}(1,10), x_2=\mathrm{rand}(1,10), x_3=\mathrm{rand}(1,5), x_4=\mathrm{rand}(1,3)$ とする。

- カードの種類 $t$ は、 $t = i (0 \leq i \leq 4)$ となる確率が $x_i$ に比例するように生成する。
- $L$ をその時点で増資カードを使用した回数( $0 \leq L \leq 20$ )を表す整数とする。
- $t=0$ または $t = 1$ の場合は、労働力 $w$ を $w=\mathrm{rand}(1, 50)* 2^L$ で生成する。$t$ が$0,1$以外の場合は $w=0$ とする。
- カードのコスト $p$ は以下のように決める。
- -   - $t = 0$ の場合 $w' = w/2^L$ とし $p = \mathrm{clamp}(\mathrm{round}(\mathrm{gauss}(w', w'/3)), 1, 10000) * 2^L$ で生成する。
-   - $t = 1$ の場合 $w' = w/2^L$ とし $p = \mathrm{clamp}(\mathrm{round}(\mathrm{gauss}(w'*M, w'*M/3)), 1, 10000) * 2^L$ で生成する。
-   - $t = 2$ の場合 $p = \mathrm{rand}(0, 10) * 2^L$ で生成する。
-   - $t = 3$ の場合 $p = \mathrm{rand}(0, 10) * 2^L$ で生成する。
-   - $t = 4$ の場合 $p = \mathrm{rand}(200, 1000) * 2^L$ で生成する。

                    
                

                
                    
                        

## ツール

                        

- [Web版ビジュアライザ・入力ジェネレータ](https://img.atcoder.jp/ahc029/45e6da0b06.html): アニメーション表示が可能です。
- [ローカル版テスタ・ビジュアライザ・入力ジェネレータ](https://img.atcoder.jp/ahc029/45e6da0b06.zip): 使用するには[Rust言語](https://www.rust-lang.org/ja)のコンパイル環境をご用意下さい。
                                -   - [Windows用のコンパイル済みバイナリ](https://img.atcoder.jp/ahc029/45e6da0b06_windows.zip): Rust言語の環境構築が面倒な方は代わりにこちらをご利用下さい。
- [サンプルコード（C++, Python）](https://img.atcoder.jp/ahc029/45e6da0b06_sample.zip): サンプルの解答です。次の処理を実装しています。
                                -   - 方針カードを使用する際は、常に 0 番目のカードを使用する。そのカードが通常労働カードまたはキャンセルカードの場合、 0 番目のプロジェクトを対象とする。
-   - 候補となる方針カードからどれを手札に加えるかの選択では、常に 0 番目の方針カードを選択する。
                                        -   -   - 0 番目の方針カードのコストは $0$ であることが保証されているため、現在の所持金に関わらずこの選択は常に可能である。

                        

                            <font color="red">**コンテスト期間中に、ビジュアライズ結果の共有や、解法・考察に関する言及は禁止されています。ご注意下さい。**</font>
                        

                        

### ツールで用いられる入出力ファイルの仕様

                        

ローカルテスタに与える入力ファイルは以下の形式を用いています。

> \(
> 
> N ~ M ~ K ~ T \\
> 
> h_{init,0} ~ v_{init,0} \\
> 
> \vdots \\
> 
> h_{init,M-1} ~ v_{init,M-1} \\
> 
> h_{0} ~ v_{0} \\
> 
> \vdots \\
> 
> h_{T*M-1} ~ v_{T*M-1} \\
> 
> t_{init,0} ~ w_{init,0} \\
> 
> \vdots \\
> 
> t_{init,N-1} ~ w_{init,N-1} \\
> 
> t_{0,0} ~ w_{0,0} ~ p_{0,0} \\
> 
> \vdots \\
> 
> t_{0,K-1} ~ w_{0,K-1} ~ p_{0,K-1} \\
> 
> t_{1,0} ~ w_{1,0} ~ p_{1,0} \\
> 
> \vdots \\
> 
> t_{T-1,K-1} ~ w_{T-1,K-1} ~ p_{T-1,K-1} \)
                        

- $h_{init,i}, v_{init,i}$ は、はじめに与えられるプロジェクトのうち $i$ 番目のものの残務量と価値を表します。
- $h_{i}, v_{i}$ は、新たに発生するプロジェクトの残務量と価値を表し、先頭から順に使用されます。新しいプロジェクトを生成する際は、それまでに増資カードを使用した回数を $L$ として $2^L$ 倍された値が使われます。
- $t_{init,i}, w_{init,i}$ は、はじめに与えられる方針カードのうち $i$ 番目のものの種類と労働力を表します。
- $t_{i,j}, w_{i,j}, p_{i,j}$ は、 $i$ ターン目で候補として与えられる $j$ 番目の方針カードの種類、労働力、コストを表します。方針カードを生成する際は、それまでに増資カードを使用した回数を $L$ として $2^L$ 倍された値が使われます。

                        

ローカルテスタは解答プログラムの出力をそのまま出力ファイルに書き出します。<br>
                        解答プログラムは、`#` から始まるコメント行を出力に含めてもかまいません。
                        Web版ビジュアライザを使用すると、コメント行を対応するタイミングで表示できるため、デバッグや考察等に役立てることができます。
                        ジャッジプログラムはコメント行を全て無視するため、コメント行を出力するプログラムをそのまま提出可能です。

                    
                
            

            
            
                
                    

## 入出力例

                    
                        
                            
                                Input
                                Output
                                説明
                            
                        
                        
                            
                                
```plain
3 2 4 3
0 29
3 0
4 0
38 113
17 46
```
                                
                                
                                
                                    入力の制約を満たさない、説明用の入力である点に注意せよ。
                                    初期状態の手札の $3$ 枚の方針カードの情報と、$2$ つのプロジェクトの情報を受け取る。
                                
                            
                            
                                
                                
```plain
0 1
```
                                
                                
                                    ここから最初のターンが始まる。
                                    手札の $0$ 番目にあった通常労働カードを $1$ 番目のプロジェクトに適用する。
                                    このプロジェクトの残務量は $17-29=-12$ と負になるため、プロジェクトは完了する。
                                    プロジェクトが完了したため所持金は $46$ に増加する。
                                
                            
                            
                                
```plain
38 113
51 82
```
                                
                                

                                
                                
                                    現在のプロジェクトの情報を受け取る。
                                    直前の行動で $1$ 番目のプロジェクトが完了したため、$1$ 番目の位置には新しいプロジェクトが出現している。
                                
                            
                            
                                
```plain
46
```
                                
                                 
                                
                                    現在の所持金の情報を受け取る。
                                
                            
                            
                                
```plain
0 1 0
3 0 8
1 18 22
4 0 685
```
                                
                                

                                
                                
                                    $4$ 枚の方針カードとコストが提示される。なお、$3$ 番目のカードはコストが所持金を上回るため選択することはできない。
                                
                            
                            
                                
                                
                                
```plain
2
```
                                
                                
                                    $2$ 番目の全力労働カードを選択した。このカードは手札の $0$ 番目の位置に置かれる。現時点での手札は以下のようになっている。
```plain
1 18
3 0
4 0
```
                                    所持金は $46-22=24$ に減少する。
                                    以上でターンは終了となる。
                                
                            
                            
                                
                                
```plain
1 0
```
                                
                                
                                    ここから次のターンが始まる。
                                    手札の $1$ 番目にあった業務転換カードを使用する。
                                    全てのプロジェクトは取りやめられ、所持金は変化しない。
                                
                            
                            
                                
```plain
49 84
140 127
```
                                
                                

                                
                                
                                    現在のプロジェクトの情報を受け取る。
                                    実行を取りやめたプロジェクトに代わり、新たなプロジェクトの情報が与えられる。
                                
                            
                            
                                
```plain
24
```
                                
                                 
                                
                                    現在の所持金の情報を受け取る。
                                
                            
                            
                                
```plain
0 1 0
2 0 2
0 25 44
1 43 130
```
                                
                                

                                
                                
                                    $4$ 枚の方針カードとコストが提示される。
                                
                            
                            
                                
                                
                                
```plain
1
```
                                
                                
                                    $1$ 番目のキャンセルカードを選択した。このカードは手札の $1$ 番目の位置に置かれる。現時点での手札は以下のようになっている。
```plain
1 18
2 0
4 0
```
                                    所持金は $24-2=22$ に減少する。
                                    以上でターンは終了となる。
                                
                            
                            
                                
                                
```plain
2 0
```
                                
                                
                                    ここから最後のターンが始まる。
                                    手札の $2$ 番目にあった増資カードを使用する。
                                    すでに出現している方針カードやプロジェクトには影響はなく、所持金は増加しない。
                                
                            
                            
                                
```plain
49 84
140 127
```
                                
                                

                                
                                
                                    現在のプロジェクトの情報を受け取る。
                                
                            
                            
                                
```plain
22
```
                                
                                 
                                
                                    現在の所持金の情報を受け取る。
                                
                            
                            
                                
```plain
0 2 0
3 0 32
2 0 18
1 84 212
```
                                
                                

                                
                                
                                    $4$ 枚の方針カードとコストが提示される。
                                    増資カードを使ったため、提示された方針カードの労働力やコストの生成に用いるパラメータが変わっている。
                                
                            
                            
                                
                                
                                
```plain
0
```
                                
                                
                                    $0$ 番目の通常労働カードを選択した。このカードは手札の $2$ 番目の位置に置かれる。現時点での手札は以下のようになっている。
```plain
1 18
2 0
0 2
```
                                    所持金は $22-0=22$ となる。
                                    以上でターンは終了となる。
                                    全ターン終了時の所持金 $22$ が本テストケースのスコアとなる。