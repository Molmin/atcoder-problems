{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1200</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>AtCoder 共和国の首都タカハ市には，東西に伸びる道路が <var>N</var> 本，南北に伸びる道路が <var>M</var> 本あり，これ以外の道路はありません．\n北から <var>i</var> 本目の東西方向の道路と，西から <var>j</var> 本目の南北方向の道路は，交差点 <var>(i, j)</var> で交わっています．\n東西方向の道路同士，南北方向の道路同士が交わることはありません．\nまた，同じ方向の隣り合う道路の間は距離 <var>1</var> ずつ離れています．</p>\n<p>それぞれの道路は一方通行で，片方の向きにのみ通行可能です．各道路の通行可能な方向は，長さ <var>N</var> の文字列 <var>S</var>，長さ <var>M</var> の文字列 <var>T</var> を用いて，次のようになっています：</p>\n<ul>\n<li><var>S</var> の <var>i</var> 文字目が <code>W</code> のとき，北から <var>i</var> 本目の東西方向の道路は，西向きにのみ通行可能．</li>\n<li><var>S</var> の <var>i</var> 文字目が <code>E</code> のとき，北から <var>i</var> 本目の東西方向の道路は，東向きにのみ通行可能．</li>\n<li><var>T</var> の <var>j</var> 文字目が <code>N</code> のとき，西から <var>j</var> 本目の南北方向の道路は，北向きにのみ通行可能．</li>\n<li><var>T</var> の <var>j</var> 文字目が <code>S</code> のとき，西から <var>j</var> 本目の南北方向の道路は，南向きにのみ通行可能．</li>\n</ul>\n<p>次のような形式の <var>Q</var> 個の質問に答えてください．</p>\n<ul>\n<li><var>i</var> 番目の質問では，<var>a_i, b_i, c_i, d_i</var> が与えられる．このとき，交差点 <var>(a_i, b_i)</var> から <var>(c_i, d_i)</var> まで，道路のみを通行して移動するときの，最小の移動距離はいくらか？</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq N \\leq 100000</var></li>\n<li><var>2 \\leq M \\leq 100000</var></li>\n<li><var>2 \\leq Q \\leq 200000</var></li>\n<li><var>|S| = N</var></li>\n<li><var>S</var> は <code>W</code>, <code>E</code> のみからなる</li>\n<li><var>|T| = M</var></li>\n<li><var>T</var> は <code>N</code>, <code>S</code> のみからなる</li>\n<li><var>1 \\leq a_i \\leq N</var></li>\n<li><var>1 \\leq b_i \\leq M</var></li>\n<li><var>1 \\leq c_i \\leq N</var></li>\n<li><var>1 \\leq d_i \\leq M</var></li>\n<li><var>(a_i, b_i) \\neq (c_i, d_i)</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる．</p>\n<pre><var>N</var> <var>M</var> <var>Q</var>\n<var>S</var>\n<var>T</var>\n<var>a_1</var> <var>b_1</var> <var>c_1</var> <var>d_1</var>\n<var>a_2</var> <var>b_2</var> <var>c_2</var> <var>d_2</var>\n<var>:</var>\n<var>a_Q</var> <var>b_Q</var> <var>c_Q</var> <var>d_Q</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>i</var> 行目には，<var>i</var> 番目の質問に対する答えを出力せよ．ただし，交差点 <var>(a_i, b_i)</var> から <var>(c_i, d_i)</var> まで，道路のみを通行して移動することが不可能なときは，代わりに <code>-1</code> を出力せよ．</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 5 4\nEEWW\nNSNNS\n4 1 1 4\n1 3 1 2\n4 2 3 2\n3 3 3 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>6\n11\n5\n4\n</pre>\n\n<p>各道路の通行可能な方向は下図の通りです（上向きを北とします）：</p>\n<p><img alt=\"\" src=\"https://img.atcoder.jp/exawizards2019/bfb8c54cc4098353946320d8c263807e.png\"></p>\n<p><var>4</var> 個の質問それぞれについて，最小の移動距離を達成する経路の例は次の通りです：</p>\n<p><img alt=\"\" src=\"https://img.atcoder.jp/exawizards2019/d1918596004a23a20aa138e591e0ee99.png\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 3 2\nEEE\nSSS\n1 1 3 3\n3 3 1 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>4\n-1\n</pre>\n\n<p>移動が不可能な場合もあります．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>9 7 10\nEEEEEWEWW\nNSSSNSN\n4 6 9 2\n3 7 6 7\n7 5 3 5\n1 1 8 1\n4 3 5 4\n7 4 6 4\n2 5 8 6\n6 6 2 7\n2 4 7 5\n7 2 9 7\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>9\n-1\n4\n9\n2\n3\n7\n7\n6\n-1\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1200</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>In Takaha-shi, the capital of Republic of AtCoder, there are <var>N</var> roads extending east and west, and <var>M</var> roads extending north and south. There are no other roads.\nThe <var>i</var>-th east-west road from the north and the <var>j</var>-th north-south road from the west cross at the intersection <var>(i, j)</var>.\nTwo east-west roads do not cross, nor do two north-south roads.\nThe distance between two adjacent roads in the same direction is <var>1</var>.</p>\n<p>Each road is one-way; one can only walk in one direction. The permitted direction for each road is described by a string <var>S</var> of length <var>N</var> and a string <var>T</var> of length <var>M</var>, as follows:</p>\n<ul>\n<li>If the <var>i</var>-th character in <var>S</var> is <code>W</code>, one can only walk westward along the <var>i</var>-th east-west road from the north;</li>\n<li>If the <var>i</var>-th character in <var>S</var> is <code>E</code>, one can only walk eastward along the <var>i</var>-th east-west road from the north;</li>\n<li>If the <var>i</var>-th character in <var>T</var> is <code>N</code>, one can only walk northward along the <var>i</var>-th north-south road from the west;</li>\n<li>If the <var>i</var>-th character in <var>T</var> is <code>S</code>, one can only walk southward along the <var>i</var>-th south-west road from the west.</li>\n</ul>\n<p>Process the following <var>Q</var> queries:</p>\n<ul>\n<li>In the <var>i</var>-th query, <var>a_i, b_i, c_i</var> and <var>d_i</var> are given. What is the minimum distance to travel to reach the intersection <var>(c_i, d_i)</var> from the intersection <var>(a_i, b_i)</var> by walking along the roads?</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 100000</var></li>\n<li><var>2 \\leq M \\leq 100000</var></li>\n<li><var>2 \\leq Q \\leq 200000</var></li>\n<li><var>|S| = N</var></li>\n<li><var>S</var> consists of <code>W</code> and <code>E</code>.</li>\n<li><var>|T| = M</var></li>\n<li><var>T</var> consists of <code>N</code> and <code>S</code>.</li>\n<li><var>1 \\leq a_i \\leq N</var></li>\n<li><var>1 \\leq b_i \\leq M</var></li>\n<li><var>1 \\leq c_i \\leq N</var></li>\n<li><var>1 \\leq d_i \\leq M</var></li>\n<li><var>(a_i, b_i) \\neq (c_i, d_i)</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>Q</var>\n<var>S</var>\n<var>T</var>\n<var>a_1</var> <var>b_1</var> <var>c_1</var> <var>d_1</var>\n<var>a_2</var> <var>b_2</var> <var>c_2</var> <var>d_2</var>\n<var>:</var>\n<var>a_Q</var> <var>b_Q</var> <var>c_Q</var> <var>d_Q</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>In the <var>i</var>-th line, print the response to the <var>i</var>-th query. If the intersection <var>(c_i, d_i)</var> cannot be reached from the intersection <var>(a_i, b_i)</var> by walking along the roads, print <code>-1</code> instead.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 5 4\nEEWW\nNSNNS\n4 1 1 4\n1 3 1 2\n4 2 3 2\n3 3 3 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>6\n11\n5\n4\n</pre>\n\n<p>The permitted direction for each road is shown in the following figure (north upward):</p>\n<p><img alt=\"\" src=\"https://img.atcoder.jp/exawizards2019/bfb8c54cc4098353946320d8c263807e.png\"></p>\n<p>For each of the four queries, a route that achieves the minimum travel distance is as follows:</p>\n<p><img alt=\"\" src=\"https://img.atcoder.jp/exawizards2019/d1918596004a23a20aa138e591e0ee99.png\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 3 2\nEEE\nSSS\n1 1 3 3\n3 3 1 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>4\n-1\n</pre>\n\n<p>The travel may be impossible.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>9 7 10\nEEEEEWEWW\nNSSSNSN\n4 6 9 2\n3 7 6 7\n7 5 3 5\n1 1 8 1\n4 3 5 4\n7 4 6 4\n2 5 8 6\n6 6 2 7\n2 4 7 5\n7 2 9 7\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>9\n-1\n4\n9\n2\n3\n7\n7\n6\n-1\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/exawizards2019/tasks/exawizards2019_f"}