{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>450</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>AtCoder 国には駅 <var>1,</var> 駅 <var>2,\\ldots,</var> 駅 <var>N</var> の <var>N</var> 個の駅があります。</p>\n<p>AtCoder 国に存在する電車の情報が <var>M</var> 個与えられます。\n<var>i</var> 番目 <var>(1\\leq i\\leq M)</var> の情報は正整数の <var>6</var> つ組 <var>(l _ i,d _ i,k _ i,c _ i,A _ i,B _ i)</var> で表され、次のような情報に対応しています。</p>\n<ul>\n<li><var>t=l _ i,l _ i+d _ i,l _ i+2d _ i,\\ldots,l _ i+(k _ i-1)d _ i</var> それぞれについて、次のような電車が存在する。<ul>\n<li>時刻 <var>t</var> に 駅 <var>A _ i</var> を出発し、時刻 <var>t+c _ i</var> に駅 <var>B _ i</var> に到着する。</li>\n</ul>\n</li>\n</ul>\n<p>これらの情報にあてはまらない電車は存在せず、電車以外の方法である駅から異なる駅へ移動することはできません。<br>\nまた、乗り換えにかかる時間は無視できるとします。</p>\n<p>駅 <var>S</var> から駅 <var>N</var> に到着できる最終時刻を <var>f(S)</var> とします。<br>\nより厳密には、整数の <var>4</var> つ組の列 <var>\\big((t _ i,c _ i,A _ i,B _ i)\\big) _ {i=1,2,\\ldots,k}</var> であって、次のすべての条件を満たすものが存在するような <var>t</var> の最大値を <var>f(S)</var> とします。</p>\n<ul>\n<li><var>t\\leq t _ 1</var></li>\n<li><var>A _ 1=S,B _ k=N</var></li>\n<li>すべての <var>1\\leq i\\lt k</var> について、<var>B _ i=A _ {i+1}</var></li>\n<li>すべての <var>1\\leq i\\leq k</var> について、時刻 <var>t _ i</var> に駅 <var>A _ i</var> を出発して時刻 <var>t _ i+c _ i</var> に駅 <var>B _ i</var> に到着する電車が存在する。</li>\n<li>すべての <var>1\\leq i\\lt k</var> について、<var>t _ i+c _ i\\leq t _ {i+1}</var></li>\n</ul>\n<p>ただし、そのような <var>t</var> が存在しないとき <var>f(S)=-\\infty</var> とします。</p>\n<p><var>f(1),f(2),\\ldots,f(N-1)</var> を求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2\\leq N\\leq2\\times10 ^ 5</var></li>\n<li><var>1\\leq M\\leq2\\times10 ^ 5</var></li>\n<li><var>1\\leq l _ i,d _ i,k _ i,c _ i\\leq10 ^ 9\\ (1\\leq i\\leq M)</var></li>\n<li><var>1\\leq A _ i,B _ i\\leq N\\ (1\\leq i\\leq M)</var></li>\n<li><var>A _ i\\neq B _ i\\ (1\\leq i\\leq M)</var></li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>l _ 1</var> <var>d _ 1</var> <var>k _ 1</var> <var>c _ 1</var> <var>A _ 1</var> <var>B _ 1</var>\n<var>l _ 2</var> <var>d _ 2</var> <var>k _ 2</var> <var>c _ 2</var> <var>A _ 2</var> <var>B _ 2</var>\n<var>\\vdots</var>\n<var>l _ M</var> <var>d _ M</var> <var>k _ M</var> <var>c _ M</var> <var>A _ M</var> <var>B _ M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>N-1</var> 行出力せよ。\n<var>k</var> 行目には <var>f(k)\\neq-\\infty</var> ならば <var>f(k)</var> を、<var>f(k)=-\\infty</var> ならば <code>Unreachable</code> を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>6 7\n10 5 10 3 1 3\n13 5 10 2 3 4\n15 5 10 7 4 6\n3 10 2 4 2 5\n7 10 2 3 5 6\n5 3 18 2 2 3\n6 3 20 4 2 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>55\n56\n58\n60\n17\n</pre>\n<p>AtCoder 国に走っている電車は以下の図のようになります（発着時間の情報は図には含まれていません）。</p>\n<p><img src=\"https://img.atcoder.jp/abc342/c3007f6fd6e6bffff5483312395e51f6.png\" style=\"max-width:95%\"></p>\n<p>駅 <var>2</var> から駅 <var>6</var> に到着できる最終時刻について考えます。\n次の図のように、駅 <var>2</var> を時刻 <var>56</var> に出発して駅 <var>2\\rightarrow</var> 駅 <var>3\\rightarrow</var> 駅 <var>4\\rightarrow</var> 駅 <var>6</var> のように移動することで駅 <var>6</var> に到着することができます。</p>\n<p><img src=\"https://img.atcoder.jp/abc342/bf9e3c0a042ef63f63e45fd5b94a23af.png\" style=\"max-width:95%\"></p>\n<!---\n英語版の図\n<img src='https://img.atcoder.jp/abc342/b6667844f8166458430c27bd93838a76.png' style='max-width:95%'/>\n--->\n\n<p>駅 <var>2</var> を時刻 <var>56</var> より遅く出発して駅 <var>6</var> に到着することはできないため、<var>f(2)=56</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5 5\n1000000000 1000000000 1000000000 1000000000 1 5\n5 9 2 6 2 3\n10 4 1 6 2 3\n1 1 1 1 3 5\n3 1 4 1 5 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>1000000000000000000\nUnreachable\n1\nUnreachable\n</pre>\n<p>駅 <var>1</var> を時刻 <var>10 ^ {18}</var> に出発して駅 <var>5</var> に時刻 <var>10 ^ {18}+10 ^ 9</var> に到着するような電車が存在します。それ以降に駅 <var>1</var> を出発する電車はないため、<var>f(1)=10 ^ {18}</var> です。\nこのように、答えが <var>32\\operatorname{bit}</var> 整数におさまらない場合もあります。</p>\n<p>また、時刻 <var>14</var> に駅 <var>2</var> を出発して時刻 <var>20</var> に駅 <var>3</var> に到着するような電車は <var>2</var> 番目の情報と <var>3</var> 番目の情報の両方で存在が保証されています。\nこのように、複数の情報に重複している電車もあります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>16 20\n4018 9698 2850 3026 8 11\n2310 7571 7732 1862 13 14\n2440 2121 20 1849 11 16\n2560 5115 190 3655 5 16\n1936 6664 39 8822 4 16\n7597 8325 20 7576 12 5\n5396 1088 540 7765 15 1\n3226 88 6988 2504 13 5\n1838 7490 63 4098 8 3\n1456 5042 4 2815 14 7\n3762 6803 5054 6994 10 9\n9526 6001 61 8025 7 8\n5176 6747 107 3403 1 5\n2014 5533 2031 8127 8 11\n8102 5878 58 9548 9 10\n3788 174 3088 5950 3 13\n7778 5389 100 9003 10 15\n556 9425 9458 109 3 11\n5725 7937 10 3282 2 9\n6951 7211 8590 1994 15 12\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>720358\n77158\n540926\n255168\n969295\nUnreachable\n369586\n466218\n343148\n541289\n42739\n165772\n618082\n16582\n591828\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score: <var>450</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>In the country of AtCoder, there are <var>N</var> stations: station <var>1</var>, station <var>2</var>, <var>\\ldots</var>, station <var>N</var>.</p>\n<p>You are given <var>M</var> pieces of information about trains in the country. The <var>i</var>-th piece of information <var>(1\\leq i\\leq M)</var> is represented by a tuple of six positive integers <var>(l _ i,d _ i,k _ i,c _ i,A _ i,B _ i)</var>, which corresponds to the following information:</p>\n<ul>\n<li>For each <var>t=l _ i,l _ i+d _ i,l _ i+2d _ i,\\ldots,l _ i+(k _ i-1)d _ i</var>, there is a train as follows:<ul>\n<li>The train departs from station <var>A _ i</var> at time <var>t</var> and arrives at station <var>B _ i</var> at time <var>t+c _ i</var>.</li>\n</ul>\n</li>\n</ul>\n<p>No trains exist other than those described by this information, and it is impossible to move from one station to another by any means other than by train.<br>\nAlso, assume that the time required for transfers is negligible.</p>\n<p>Let <var>f(S)</var> be the latest time at which one can arrive at station <var>N</var> from station <var>S</var>.<br>\nMore precisely, <var>f(S)</var> is defined as the maximum value of <var>t</var> for which there is a sequence of tuples of four integers <var>\\big((t _ i,c _ i,A _ i,B _ i)\\big) _ {i=1,2,\\ldots,k}</var> that satisfies all of the following conditions:</p>\n<ul>\n<li><var>t\\leq t _ 1</var></li>\n<li><var>A _ 1=S,B _ k=N</var></li>\n<li><var>B _ i=A _ {i+1}</var> for all <var>1\\leq i\\lt k</var>, </li>\n<li>For all <var>1\\leq i\\leq k</var>, there is a train that departs from station <var>A _ i</var> at time <var>t _ i</var> and arrives at station <var>B _ i</var> at time <var>t _ i+c _ i</var>.</li>\n<li><var>t _ i+c _ i\\leq t _ {i+1}</var> for all <var>1\\leq i\\lt k</var>.</li>\n</ul>\n<p>If no such <var>t</var> exists, set <var>f(S)=-\\infty</var>.</p>\n<p>Find <var>f(1),f(2),\\ldots,f(N-1)</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2\\leq N\\leq2\\times10 ^ 5</var></li>\n<li><var>1\\leq M\\leq2\\times10 ^ 5</var></li>\n<li><var>1\\leq l _ i,d _ i,k _ i,c _ i\\leq10 ^ 9\\ (1\\leq i\\leq M)</var></li>\n<li><var>1\\leq A _ i,B _ i\\leq N\\ (1\\leq i\\leq M)</var></li>\n<li><var>A _ i\\neq B _ i\\ (1\\leq i\\leq M)</var></li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>l _ 1</var> <var>d _ 1</var> <var>k _ 1</var> <var>c _ 1</var> <var>A _ 1</var> <var>B _ 1</var>\n<var>l _ 2</var> <var>d _ 2</var> <var>k _ 2</var> <var>c _ 2</var> <var>A _ 2</var> <var>B _ 2</var>\n<var>\\vdots</var>\n<var>l _ M</var> <var>d _ M</var> <var>k _ M</var> <var>c _ M</var> <var>A _ M</var> <var>B _ M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>N-1</var> lines.\nThe <var>k</var>-th line should contain <var>f(k)</var> if <var>f(k)\\neq-\\infty</var>, and <code>Unreachable</code> if <var>f(k)=-\\infty</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>6 7\n10 5 10 3 1 3\n13 5 10 2 3 4\n15 5 10 7 4 6\n3 10 2 4 2 5\n7 10 2 3 5 6\n5 3 18 2 2 3\n6 3 20 4 2 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>55\n56\n58\n60\n17\n</pre>\n<p>The following diagram shows the trains running in the country (information about arrival and departure times is omitted).</p>\n<p><img src=\"https://img.atcoder.jp/abc342/c3007f6fd6e6bffff5483312395e51f6.png\" style=\"max-width:95%\"></p>\n<p>Consider the latest time at which one can arrive at station <var>6</var> from station <var>2</var>.\nAs shown in the following diagram, one can arrive at station <var>6</var> by departing from station <var>2</var> at time <var>56</var> and moving as station <var>2\\rightarrow</var> station <var>3\\rightarrow</var> station <var>4\\rightarrow</var> station <var>6</var>.</p>\n<p><img src=\"https://img.atcoder.jp/abc342/b6667844f8166458430c27bd93838a76.png\" style=\"max-width:95%\"></p>\n<p>It is impossible to depart from station <var>2</var> after time <var>56</var> and arrive at station <var>6</var>, so <var>f(2)=56</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5 5\n1000000000 1000000000 1000000000 1000000000 1 5\n5 9 2 6 2 3\n10 4 1 6 2 3\n1 1 1 1 3 5\n3 1 4 1 5 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>1000000000000000000\nUnreachable\n1\nUnreachable\n</pre>\n<p>There is a train that departs from station <var>1</var> at time <var>10 ^ {18}</var> and arrives at station <var>5</var> at time <var>10 ^ {18}+10 ^ 9</var>. There are no trains departing from station <var>1</var> after that time, so <var>f(1)=10 ^ {18}</var>.\nAs seen here, the answer may not fit within a <var>32\\operatorname{bit}</var> integer.</p>\n<p>Also, both the second and third pieces of information guarantee that there is a train that departs from station <var>2</var> at time <var>14</var> and arrives at station <var>3</var> at time <var>20</var>.\nAs seen here, some trains may appear in multiple pieces of information.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>16 20\n4018 9698 2850 3026 8 11\n2310 7571 7732 1862 13 14\n2440 2121 20 1849 11 16\n2560 5115 190 3655 5 16\n1936 6664 39 8822 4 16\n7597 8325 20 7576 12 5\n5396 1088 540 7765 15 1\n3226 88 6988 2504 13 5\n1838 7490 63 4098 8 3\n1456 5042 4 2815 14 7\n3762 6803 5054 6994 10 9\n9526 6001 61 8025 7 8\n5176 6747 107 3403 1 5\n2014 5533 2031 8127 8 11\n8102 5878 58 9548 9 10\n3788 174 3088 5950 3 13\n7778 5389 100 9003 10 15\n556 9425 9458 109 3 11\n5725 7937 10 3282 2 9\n6951 7211 8590 1994 15 12\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>720358\n77158\n540926\n255168\n969295\nUnreachable\n369586\n466218\n343148\n541289\n42739\n165772\n618082\n16582\n591828\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc342/tasks/abc342_e"}