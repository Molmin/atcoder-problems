{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>450</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 頂点からなる重み付き無向グラフ <var>G</var> があります。\n<var>G</var> の各頂点には <var>1</var> から <var>N</var> までの番号が付けられています。\n最初、<var>G</var> には辺が <var>1</var> 本も存在しません。</p>\n<p>今から、<var>M</var> 回の操作を行うことによって <var>G</var> に辺を追加していきます。\n<var>i\\ (1\\leq i\\leq M)</var> 回目の操作は以下の通りです。</p>\n<ul>\n<li><var>K_i</var> 頂点からなる頂点の部分集合 <var>S_i=\\lbrace A_{i,1},A_{i,2},\\dots,A_{i,K_i}\\rbrace</var> が与えられる。\n<var>u,v\\in S_i</var> かつ <var>u&lt;v</var> を満たす全ての <var>u,v</var> について、頂点 <var>u</var> と頂点 <var>v</var> の間に重み <var>C_i</var> の辺を追加する。</li>\n</ul>\n<p><var>M</var> 回の操作を全て行ったとき <var>G</var> が連結になるか判定し、連結になるならば <var>G</var> の最小全域木に含まれる辺の重みの総和を求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2\\leq N \\leq 2\\times 10^5</var></li>\n<li><var>1\\leq M \\leq 2\\times 10^5</var></li>\n<li><var>2\\leq K_i \\leq N</var></li>\n<li><var>\\displaystyle \\sum_{i=1}^{M} K_i \\leq 4\\times 10^5</var></li>\n<li><var>1\\leq A_{i,1} &lt; A_{i,2} &lt; \\dots &lt; A_{i,K_i}\\leq N</var></li>\n<li><var>1\\leq C_i\\leq 10^9</var></li>\n<li>入力は全て整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>K_1</var> <var>C_1</var>\n<var>A_{1,1}</var> <var>A_{1,2}</var> <var>\\dots</var> <var>A_{1,K_1}</var>\n<var>K_2</var> <var>C_2</var>\n<var>A_{2,1}</var> <var>A_{2,2}</var> <var>\\dots</var> <var>A_{2,K_2}</var>\n<var>\\vdots</var>\n<var>K_M</var> <var>C_M</var>\n<var>A_{M,1}</var> <var>A_{M,2}</var> <var>\\dots</var> <var>A_{M,K_M}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>M</var> 回の操作を全て行ったとき <var>G</var> が連結にならないならば <code>-1</code> を、連結になるならば <var>G</var> の最小全域木に含まれる辺の重みの総和を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 3\n3 3\n1 2 3\n2 2\n1 2\n3 4\n1 3 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>9\n</pre>\n<p><img src=\"https://img.atcoder.jp/abc352/b54e4b0cfe2f7e5974a2b95be370953a.png\" height=\"200\"></p>\n<p>左の図は <var>M</var> 回の操作を全て行ったあとの <var>G</var> を、右の図はその最小全域木の <var>1</var> つを表しています（辺の横に書かれた数はその辺の重みを示します）。</p>\n<p>最小全域木に含まれる辺の重みの総和は <var>3+2+4=9</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 2\n2 1\n1 2\n2 1\n1 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>-1\n</pre>\n<p><var>M</var> 回の操作を全て行っても <var>G</var> は連結になりません。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>10 5\n6 158260522\n1 3 6 8 9 10\n10 877914575\n1 2 3 4 5 6 7 8 9 10\n4 602436426\n2 6 7 9\n6 24979445\n2 3 4 5 8 10\n4 861648772\n2 4 8 9\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1202115217\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score: <var>450</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given a weighted undirected graph <var>G</var> with <var>N</var> vertices, numbered <var>1</var> to <var>N</var>. Initially, <var>G</var> has no edges.</p>\n<p>You will perform <var>M</var> operations to add edges to <var>G</var>. The <var>i</var>-th operation <var>(1 \\leq i \\leq M)</var> is as follows:</p>\n<ul>\n<li>You are given a subset of vertices <var>S_i=\\lbrace A_{i,1},A_{i,2},\\dots,A_{i,K_i}\\rbrace</var> consisting of <var>K_i</var> vertices.\nFor every pair <var>u, v</var> such that <var>u, v \\in S_i</var> and <var>u &lt; v</var>, add an edge between vertices <var>u</var> and <var>v</var> with weight <var>C_i</var>.</li>\n</ul>\n<p>After performing all <var>M</var> operations, determine whether <var>G</var> is connected. If it is, find the total weight of the edges in a minimum spanning tree of <var>G</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq M \\leq 2 \\times 10^5</var></li>\n<li><var>2 \\leq K_i \\leq N</var></li>\n<li><var>\\sum_{i=1}^{M} K_i \\leq 4 \\times 10^5</var></li>\n<li><var>1 \\leq A_{i,1} &lt; A_{i,2} &lt; \\dots &lt; A_{i,K_i} \\leq N</var></li>\n<li><var>1 \\leq C_i \\leq 10^9</var></li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>K_1</var> <var>C_1</var>\n<var>A_{1,1}</var> <var>A_{1,2}</var> <var>\\dots</var> <var>A_{1,K_1}</var>\n<var>K_2</var> <var>C_2</var>\n<var>A_{2,1}</var> <var>A_{2,2}</var> <var>\\dots</var> <var>A_{2,K_2}</var>\n<var>\\vdots</var>\n<var>K_M</var> <var>C_M</var>\n<var>A_{M,1}</var> <var>A_{M,2}</var> <var>\\dots</var> <var>A_{M,K_M}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>If <var>G</var> is not connected after all <var>M</var> operations, print <code>-1</code>. If <var>G</var> is connected, print the total weight of the edges in a minimum spanning tree of <var>G</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 3\n3 3\n1 2 3\n2 2\n1 2\n3 4\n1 3 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>9\n</pre>\n<p><img src=\"https://img.atcoder.jp/abc352/b54e4b0cfe2f7e5974a2b95be370953a.png\" height=\"200\"></p>\n<p>The left diagram shows <var>G</var> after all <var>M</var> operations, and the right diagram shows a minimum spanning tree of <var>G</var> (the numbers next to the edges indicate their weights).</p>\n<p>The total weight of the edges in the minimum spanning tree is <var>3 + 2 + 4 = 9</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 2\n2 1\n1 2\n2 1\n1 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>-1\n</pre>\n<p><var>G</var> is not connected even after all <var>M</var> operations.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>10 5\n6 158260522\n1 3 6 8 9 10\n10 877914575\n1 2 3 4 5 6 7 8 9 10\n4 602436426\n2 6 7 9\n6 24979445\n2 3 4 5 8 10\n4 861648772\n2 4 8 9\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1202115217\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc352/tasks/abc352_e"}