{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 個の文字列 <var>S_1,S_2,\\ldots, S_N</var> が与えられます。\n<var>M = \\displaystyle\\sum_{i=1}^N \\frac{|S_i|(|S_i|+1)}{2}</var> とおきます。<br>\nまた、文字列 <var>S</var> と整数 <var>L, R</var> に対し、<var>S[L, R]</var> で <var>S</var> の <var>L</var> 文字目から <var>R</var> 文字目までの文字からなる部分文字列を表します。</p>\n<p>整数の三つ組からなる長さ <var>M</var> の列 <var>((K_1, L_1, R_1), (K_2, L_2, R_2), \\ldots, (K_M, L_M, R_M))</var> は以下の条件をみたします：</p>\n<ul>\n<li><var>M</var> 個の要素は相異なる。</li>\n<li>すべての <var>1 \\leq i \\leq M</var> に対して、<var>1 \\leq K_i \\leq N</var> かつ <var>1 \\leq L_i \\leq R_i \\leq |S_{K_i}|</var> である。</li>\n<li>すべての <var>1 \\leq i \\leq j \\leq M</var> に対して、辞書順で <var>S_{K_i}[L_i, R_i] \\leq S_{K_j}[L_j, R_j]</var> である。</li>\n</ul>\n<p><var>1</var> 以上 <var>M</var> 以下の整数 <var>Q</var> 個 <var>x_1,x_2,\\ldots, x_Q</var> が与えられます。各 <var>1 \\leq i \\leq Q</var> に対して、<var>(K_{x_i}, L_{x_i}, R_{x_i})</var> としてあり得るものを <var>1</var> つずつ求めてください。なお、条件をみたす三つ組の列が必ず <var>1</var> つ以上存在することが証明できます。条件をみたす三つ組が複数存在する場合、どれを出力しても構いません。また、異なる <var>x_i</var> の間で、条件をみたす三つ組の列が共通のものである必要もありません。</p>\n<details>\n    <summary>辞書順とは</summary>\n    <var>2</var> つの文字列 <var>S, T</var> が以下の条件のいずれかをみたすとき、かつそのときに限り、辞書順で <var>S \\leq T</var> であると言います。\n<ul>\n    <li> <var>|S| \\leq |T|</var> かつ <var>S = T[1, |S|]</var> である。 </li>\n    <li> ある <var>1\\leq k\\leq \\min(|S|, |T|)</var> が存在し、<var>1\\leq i\\leq k-1</var> について、<var>S</var> と <var>T</var> の <var>i</var> 文字目は等しく、<var>S</var> の <var>k</var> 文字目は <var>T</var> の <var>k</var> 文字目よりアルファベット順で真に小さい。  </li>\n</ul>\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 10^5</var></li>\n<li><var>1 \\leq \\lvert S_i\\rvert \\leq 10^5</var></li>\n<li><var>\\displaystyle\\sum_{i=1}^N \\lvert S_i\\rvert\\leq 10^5</var></li>\n<li><var>1 \\leq Q \\leq 2\\times 10^5</var></li>\n<li><var>1 \\leq x_1&lt;x_2&lt;\\cdots&lt;x_Q \\leq \\displaystyle\\sum_{i=1}^N \\frac{|S_i|(|S_i|+1)}{2}</var></li>\n<li><var>N,Q,x_1,x_2,\\ldots,x_Q</var> は整数</li>\n<li><var>S_i</var> は英小文字のみからなる文字列</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>S_1</var>\n<var>S_2</var>\n<var>\\vdots</var>\n<var>S_N</var>\n<var>Q</var>\n<var>x_1</var> <var>x_2</var> <var>\\ldots</var> <var>x_Q</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>Q</var> 行出力せよ。<var>i</var> 行目には、条件をみたす <var>(K_{x_i}, L_{x_i}, R_{x_i})</var> としてあり得るものを空白区切りで出力せよ。\n条件をみたす三つ組が複数存在する場合、どれを出力してもよい。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2\nabab\ncab\n2\n5 14\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>1 3 4\n2 1 1\n</pre>\n<p><var>M=16</var> であり、条件をみたす三つ組の列としては、\n <var>(1,1,1), (1,3,3), (2,2,2), (1,1,2), (1,3,4), (2,2,3), (1,1,3), (1,1,4), (1,2,2), (1,4,4), (2,3,3), (1,2,3), (1,2,4), (2,1,1), (2,1,2), (2,1,3)</var> が考えられます。\n この順で並べた時の <var>(K_i,L_i, R_i)</var> に対応する <var>S_{K_i}[L_i, R_i]</var> の列は、(<code>a</code>, <code>a</code>, <code>a</code>, <code>ab</code>, <code>ab</code>, <code>ab</code>, <code>aba</code>,  <code>abab</code>, <code>b</code>, <code>b</code>, <code>b</code>, <code>ba</code>, <code>bab</code>, <code>c</code>, <code>ca</code>, <code>cab</code>)となります。</p>\n<p>なお、<var>5</var> 番目の要素 <var>(1,3,4)</var> を、<var>4</var> 番目や <var>6</var> 番目の要素と入れ替えた列も条件をみたすため、\n<var>(K_{x_1}, L_{x_1}, R_{x_1})=(1,1,2), (2,2,3)</var> も正解となります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3\na\na\nba\n2\n1 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>1 1 1\n1 1 1\n</pre>\n<p><var>M=5</var> であり、条件をみたす三つ組の列としては、<br>\n<var>(1,1,1), (2,1,1), (3,2,2), (3,1,1), (3,1,2)</var> や <var>(2,1,1), (3,2,2), (1,1,1), (3,1,1), (3,1,2)</var>\nが考えられます。</p>\n<p>出力する <var>(K_{x_i}, L_{x_i}, R_{x_i})</var> について、<var>x_i</var> 番目の要素が <var>(K_{x_i}, L_{x_i}, R_{x_i})</var> であるような条件をみたす列は異なる <var>i</var> の間で共通のものである必要が <strong>ない</strong>、\nすなわち、「任意の <var>1\\leq i\\leq Q</var> について <var>x_i</var> 番目の要素が <var>(K_{x_i}, L_{x_i}, R_{x_i})</var> である」\nような列は <strong>必ずしも存在する必要がない</strong> ことに注意してください。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>10\ngxgpuamkx\nszhkbpphykin\nezplvfja\nmopodotkrj\nrimlvumuar\nnexcfyce\neurgvjyos\ndhvuyfvt\nnrdyluacvra\nggwnpnzij\n6\n74 268 310 380 455 489\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>3 1 2\n4 4 5\n4 3 7\n9 6 6\n6 6 6\n2 2 12\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given <var>N</var> strings <var>S_1,S_2,\\ldots, S_N</var>.\nLet <var>M = \\displaystyle\\sum_{i=1}^N \\frac{|S_i|(|S_i|+1)}{2}</var>.<br>\nFor a string <var>S</var> and integers <var>L</var> and <var>R</var>, let us denote by <var>S[L, R]</var> the substring consisting of the <var>L</var>-th through <var>R</var>-th characters of <var>S</var>.</p>\n<p>A sequence of triples of integers <var>((K_1, L_1, R_1), (K_2, L_2, R_2), \\ldots, (K_M, L_M, R_M))</var> of length <var>M</var> satisfies the following conditions:</p>\n<ul>\n<li>The <var>M</var> elements are pairwise distinct.</li>\n<li>For all <var>1 \\leq i \\leq M</var>, it holds that <var>1 \\leq K_i \\leq N</var> and <var>1 \\leq L_i \\leq R_i \\leq |S_{K_i}|</var>.</li>\n<li>For all <var>1 \\leq i \\leq j \\leq M</var>, it holds that <var>S_{K_i}[L_i, R_i] \\leq S_{K_j}[L_j, R_j]</var> in the lexicographical order.</li>\n</ul>\n<p>You are given <var>Q</var> integers <var>x_1,x_2,\\ldots, x_Q</var> between <var>1</var> and <var>M</var>, inclusive.  For each <var>1 \\leq i \\leq Q</var>, find a possible instance of <var>(K_{x_i}, L_{x_i}, R_{x_i})</var>.  We can prove that there always exists a sequence of triples that satisfies the conditions.  If multiple triples satisfy the conditions, print any of them.  In addition, among different <var>x_i</var>'s, the conforming sequence of triples does not have to be common.</p>\n<details>\n    <summary>What is the lexicographical order?</summary>\n    Two strings <var>S</var> and <var>T</var> are said to be <var>S \\leq T</var> in the lexicographical order if and only if one of the following conditions is satisfied:\n<ul>\n    <li> <var>|S| \\leq |T|</var> and <var>S = T[1, |S|]</var>. </li>\n    <li> There exists <var>1\\leq k\\leq \\min(|S|, |T|)</var> such that the <var>i</var>-th characters of <var>S</var> and <var>T</var> are the same for all <var>1\\leq i\\leq k-1</var>, and the <var>k</var>-th character of <var>S</var> is alphabetically strictly smaller than that of <var>T</var>.  </li>\n</ul>\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 10^5</var></li>\n<li><var>1 \\leq \\lvert S_i\\rvert \\leq 10^5</var></li>\n<li><var>\\displaystyle\\sum_{i=1}^N \\lvert S_i\\rvert\\leq 10^5</var></li>\n<li><var>1 \\leq Q \\leq 2\\times 10^5</var></li>\n<li><var>1 \\leq x_1&lt;x_2&lt;\\cdots&lt;x_Q \\leq \\displaystyle\\sum_{i=1}^N \\frac{|S_i|(|S_i|+1)}{2}</var></li>\n<li><var>N,Q,x_1,x_2,\\ldots,x_Q</var> are integers.</li>\n<li><var>S_i</var> is a string consisting of lowercase English letters.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>S_1</var>\n<var>S_2</var>\n<var>\\vdots</var>\n<var>S_N</var>\n<var>Q</var>\n<var>x_1</var> <var>x_2</var> <var>\\ldots</var> <var>x_Q</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>Q</var> lines.  The <var>i</var>-th line should contain an instance of conforming <var>(K_{x_i}, L_{x_i}, R_{x_i})</var>, separated by spaces.\nIf multiple triples satisfy the conditions, print any of them.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2\nabab\ncab\n2\n5 14\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>1 3 4\n2 1 1\n</pre>\n<p>We have <var>M=16</var>.  One possible sequence of triples that satisfies the conditions is\n<var>((1,1,1), (1,3,3), (2,2,2), (1,1,2), (1,3,4), (2,2,3), (1,1,3), (1,1,4), (1,2,2), (1,4,4), (2,3,3), (1,2,3), (1,2,4), (2,1,1), (2,1,2), (2,1,3))</var>.\n The corresponding sequence of <var>S_{K_i}[L_i, R_i]</var> for these <var>(K_i,L_i, R_i)</var> in this order is (<code>a</code>, <code>a</code>, <code>a</code>, <code>ab</code>, <code>ab</code>, <code>ab</code>, <code>aba</code>,  <code>abab</code>, <code>b</code>, <code>b</code>, <code>b</code>, <code>ba</code>, <code>bab</code>, <code>c</code>, <code>ca</code>, <code>cab</code>).</p>\n<p>Note that the sequence satisfies the conditions even if we swap the <var>5</var>-th element <var>(1,3,4)</var> with the <var>4</var>-th or <var>6</var>-th one,\nso <var>(K_{x_1}, L_{x_1}, R_{x_1})=(1,1,2), (2,2,3)</var> will also be accepted.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3\na\na\nba\n2\n1 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>1 1 1\n1 1 1\n</pre>\n<p>We have <var>M=5</var>.  The sequence of triples that satisfies the conditions can be<br>\n<var>(1,1,1), (2,1,1), (3,2,2), (3,1,1), (3,1,2)</var> or <var>(2,1,1), (3,2,2), (1,1,1), (3,1,1), (3,1,2)</var>,\nfor example.</p>\n<p>Note that, for <var>(K_{x_i}, L_{x_i}, R_{x_i})</var> that you print, the conforming sequence whose <var>x_i</var>-th element is <var>(K_{x_i}, L_{x_i}, R_{x_i})</var> does <strong>not</strong> have to be common among different <var>i</var>;\nin other words, there does <strong>not necessarily have to exist</strong> a sequence\nwhose \"<var>x_i</var>-th element is <var>(K_{x_i}, L_{x_i}, R_{x_i})</var> for all <var>1\\leq i\\leq Q</var>.\"</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>10\ngxgpuamkx\nszhkbpphykin\nezplvfja\nmopodotkrj\nrimlvumuar\nnexcfyce\neurgvjyos\ndhvuyfvt\nnrdyluacvra\nggwnpnzij\n6\n74 268 310 380 455 489\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>3 1 2\n4 4 5\n4 3 7\n9 6 6\n6 6 6\n2 2 12\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc280/tasks/abc280_h"}