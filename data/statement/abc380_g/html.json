{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>575</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>(1,2,\\dots,N)</var> の順列 <var>P</var> と整数 <var>K</var> が与えられます。  </p>\n<p>順列 <var>P</var> に以下の操作を行った後の転倒数の期待値を <var>\\text{mod} \\ 998244353</var> で求めてください。</p>\n<ul>\n<li>まず、整数 <var>i</var> を <var>1</var> 以上 <var>N-K+1</var> 以下の整数の中から一様ランダムに選択する。</li>\n<li>その後、 <var>P_i,P_{i+1},\\dots,P_{i+K-1}</var> を一様ランダムにシャッフルする。</li>\n</ul>\n<details>\n<summary>転倒数とは?</summary>\n数列 <var>(A_1,A_2,\\dots,A_N)</var> の転倒数とは、 <var>1 \\le i &lt; j \\le N</var> かつ <var>A_i &gt; A_j</var> を満たす整数組 <var>(i,j)</var> の個数を指します。\n</details>\n\n<details>\n<summary>期待値 <var>\\text{mod} \\ 998244353</var> とは?</summary>\n求める期待値は必ず有理数になることが証明できます。 また、この問題の制約のもとでは、その値を既約分数 <var>\\frac{P}{Q}</var> で表した時、<var>Q \\not \\equiv 0 \\pmod{998244353}</var> となることも証明できます。 よって、<var>R \\times Q \\equiv P \\pmod{998244353}, 0 \\leq R &lt; 998244353</var> を満たす整数 <var>R</var> が一意に定まります。 この <var>R</var> を答えてください。\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li>入力は全て整数</li>\n<li><var>1 \\le K \\le N \\le 2 \\times 10^5</var></li>\n<li><var>P</var> は <var>(1,2,\\dots,N)</var> の順列</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>K</var>\n<var>P_1</var> <var>P_2</var> <var>\\dots</var> <var>P_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを <var>1</var> 行に出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 2\n1 4 2 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>166374061\n</pre>\n<p>操作によって、順列 <var>P</var> は以下のように変化します。</p>\n<ul>\n<li><var>(1,4,2,3)</var> ... 確率 <var>1/2</var></li>\n<li><var>(4,1,2,3)</var> ... 確率 <var>1/6</var></li>\n<li><var>(1,2,4,3)</var> ... 確率 <var>1/6</var></li>\n<li><var>(1,4,3,2)</var> ... 確率 <var>1/6</var></li>\n</ul>\n<p>転倒数の期待値は、 <var>\\displaystyle 2 \\times \\frac{1}{2} + 3 \\times \\frac{1}{6} + 1 \\times \\frac{1}{6} + 3 \\times \\frac{1}{6} = \\frac{13}{6}</var> となります。<br>\n<var>\\displaystyle \\frac{13}{6}</var> を <var>\\text{mod} \\ 998244353</var> で表現すると <var>166374061</var> となるので、これを出力してください。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>1 1\n1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>10 6\n7 4 10 5 6 1 8 2 3 9\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>499122200\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>575</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given a permutation <var>P</var> of <var>(1,2,\\dots,N)</var> and an integer <var>K</var>.  </p>\n<p>Find the expected value, modulo <var>998244353</var>, of the inversion number of <var>P</var> after performing the following operation:</p>\n<ul>\n<li>First, choose an integer <var>i</var> uniformly at random between <var>1</var> and <var>N - K + 1</var>, inclusive.</li>\n<li>Then, shuffle <var>P_i, P_{i+1}, \\dots, P_{i+K-1}</var> uniformly at random.</li>\n</ul>\n<details>\n<summary>What is the inversion number?</summary>\nThe inversion number of a sequence <var>(A_1, A_2, \\dots, A_N)</var> is the number of integer pairs <var>(i, j)</var> satisfying <var>1 \\le i &lt; j \\le N</var> and <var>A_i &gt; A_j</var>.\n</details>\n\n<details>\n<summary>What does \"expected value modulo <var>998244353</var>\" mean?</summary>\nIt can be proved that the sought expected value is always rational. Under the constraints of this problem, when this value is represented as an irreducible fraction <var>\\frac{P}{Q}</var>, it can also be proved that <var>Q \\not\\equiv 0 \\pmod{998244353}</var>. Thus, there is a unique integer <var>R</var> satisfying <var>R \\times Q \\equiv P \\pmod{998244353}, \\ 0 \\le R &lt; 998244353</var>. Report this integer <var>R</var>.\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li>All input values are integers.</li>\n<li><var>1 \\le K \\le N \\le 2 \\times 10^5</var></li>\n<li><var>P</var> is a permutation of <var>(1,2,\\dots,N)</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>K</var>\n<var>P_1</var> <var>P_2</var> <var>\\dots</var> <var>P_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer in one line.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 2\n1 4 2 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>166374061\n</pre>\n<p>The operation changes the permutation <var>P</var> into the following:</p>\n<ul>\n<li><var>(1,4,2,3)</var> ... probability <var>1/2</var></li>\n<li><var>(4,1,2,3)</var> ... probability <var>1/6</var></li>\n<li><var>(1,2,4,3)</var> ... probability <var>1/6</var></li>\n<li><var>(1,4,3,2)</var> ... probability <var>1/6</var></li>\n</ul>\n<p>The expected value of the inversion number is <var>\\displaystyle 2 \\times \\frac{1}{2} + 3 \\times \\frac{1}{6} + 1 \\times \\frac{1}{6} + 3 \\times \\frac{1}{6} = \\frac{13}{6}</var>.</p>\n<p><var>\\displaystyle \\frac{13}{6}</var> modulo <var>998244353</var> is <var>166374061</var>, so print this number.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>1 1\n1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>10 6\n7 4 10 5 6 1 8 2 3 9\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>499122200\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc380/tasks/abc380_g"}