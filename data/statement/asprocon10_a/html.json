{"html":{"ja":"<span class=\"lang-ja\">\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>サイズが <var>H \\times W</var> の長方形の土地があります。この土地はサイズ <var>1 \\times 1</var> の正方形の<strong>区画</strong>に分割されており、区画と区画の境界は一部が<strong>水路</strong>となっています。また、土地の外周は柵で囲まれており、外周に一箇所だけ設置されている<strong>出入口</strong>からのみ出入りできます。出入口はいずれか一つの区画の一辺に含まれており、複数の区画にまたがることはありません。</p>\n<p><img src=\"data:image/png;base64,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\" class=\"img-responsive center-block\"></p>\n<p>あなたはこの土地を使って<strong>作物</strong>を育てたいと考えました。ある区画で作物を植えたり収穫したりするときは農機を使うので、出入口からその区画まで農機を移動させる必要があります。ただし、農機が通るための通路は設置されていません。</p>\n<p>これから通路を整備するのは大変なため、あなたは作物を栽培中ではない区画だけを通って農機を移動させることにしました。すなわち、ある区画に作物を植えるときやある区画から作物を収穫するときは、出入口から目的の区画まで以下の条件のもとで到達できなければなりません。</p>\n<ul>\n<li>各区画からは隣接する4区画にのみ移動できる（斜めには移動できない）</li>\n<li>ただし、境界が水路であるような二つの区画の間は直接移動できない</li>\n<li>栽培中の区画を通ってはならない</li>\n</ul>\n<p>これから <var>T</var> ヶ月の間に栽培する作物の候補が <var>K</var> 種類あり、<var>1, 2, \\dots, K</var> と番号が付けられています。作物 <var>k</var> を栽培するには、<var>S_k</var> ヶ月目までに植える必要があります。また、作物 <var>k</var> は <var>D_k</var> ヶ月目に収穫する必要があります。作物 <var>k</var> を <var>S_k</var> ヶ月目より早く植えることは可能ですが、その場合でも <var>D_k</var> ヶ月目より早く収穫することはできません。</p>\n<p>どの作物をどの区画で栽培してもかまいませんが、一つの作物を複数の区画で栽培したり、複数の作物を一つの区画で同時に栽培したりすることはできません。</p>\n<p>なるべく多くの区画を有効に利用できるような計画を立ててください。</p>\n<h4>土地情報の詳細</h4>\n<p>土地は北西の角の座標が <var>(0, 0)</var>、南西の角の座標が <var>(H, 0)</var>、北東の角の座標が <var>(0, W)</var>、南東の角の座標が <var>(H, W)</var> です。北から <var>i+1</var> 番目、西から <var>j+1</var> 番目の区画は点 <var>(i, j)</var> と点 <var>(i + 1, j + 1)</var> を対角線とする正方形であり、これを区画 <var>(i, j)</var> と呼ぶことにします(<var>0 \\le i \\le H - 1</var>, <var>0 \\le j \\le W - 1</var>)。</p>\n<p>出入口は区画 <var>(i_0, 0)</var> の西側の境界部分（言い換えると、点 <var>(i_0, 0)</var> と点 <var>(i_0 + 1, 0)</var> を結ぶ線分上）にあります。</p>\n<p>辺を共有する2区画の境界のそれぞれについて、その部分に水路があるかどうかが指定されます。水路の情報のフォーマットは「入力」のセクションを参照してください。</p>\n<h4>計画の詳細</h4>\n<p>計画は、どの作物をどの区画で作り、何ヶ月目に植えるかの情報からなり、列 <var>(k_1, i_1, j_1, s_1), \\dots, (k_M, i_M, j_M, s_M)</var> で表されます。この列の <var>m</var> 番目の要素は、作物 <var>k_m</var> を区画 <var>(i_m, j_m)</var> で <var>s_m</var> ヶ月目に植えることを意味します。</p>\n<p>計画が与えられたとき、<var>t</var> ヶ月目 (<var>t = 1, 2, \\dots, T</var>) には以下のことを行います。</p>\n<ol>\n<li><var>t</var> ヶ月目の始めに、<var>s_m = t</var> を満たすすべての <var>m</var> について、<var>k_m</var> を <var>(i_m, j_m)</var> に植える。このとき、各 <var>m</var> について出入口から <var>(i_m, j_m)</var> まで水路や栽培中の区画を通ることなく移動できなければならない。</li>\n<li><var>t</var> ヶ月目の終わりに、<var>D_{k_m} = t</var> を満たすすべての <var>m</var> について、<var>k_m</var> を <var>(i_m, j_m)</var> から収穫する。このとき、各 <var>m</var> について出入口から <var>(i_m, j_m)</var> まで水路や栽培中の区画を通ることなく移動できなければならない。</li>\n</ol>\n<p>なお、同じ月に複数の作物を植えるとき、植える順番によって上の条件が満たされるかどうかが変わることがあります。例えば、作物 <var>k_1</var> と <var>k_2</var> を同じ月に植えたく、かつ <var>(i_1, j_1)</var> を通らないと <var>(i_2, j_2)</var> に移動できない場合、先に <var>k_1</var> を植えると <var>k_2</var> が植えられなくなります。</p>\n<p>このような場合は、各月ごとの植える順番を適切に決めることですべての作物を植えられるなら、実行可能な計画と判定されます。そのような順番が存在するかどうかはジャッジにより判定されるため、計画中で植える順番を指定する必要はありません。同じ月に複数の作物を収穫する場合も同様に、収穫する適切な順番が存在するかどうかはジャッジにより判定されるため、計画中で収穫の順番を指定する必要はありません。</p>\n<p>計画は以下の条件を満たす必要があります。</p>\n<ul>\n<li>同じ作物は一つの区画でしか作ることができない</li>\n<li>一つの区画では同時に一つの作物しか作ることができない</li>\n<li>作物 <var>k</var> を植える場合は <var>S_k</var> ヶ月目までに植えなければならない</li>\n<li>作物を植えたり収穫したりする際、出入口と目的の区画の間を移動できなければならない</li>\n</ul>\n<p>なお、すべての作物を植える必要はありません。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>得点</h3><p>作物 <var>k</var> のスコア <var>X_k</var> を以下のように定めます。</p>\n<ol>\n<li>作物 <var>k</var> が計画に含まれていなければ <var>X_k = 0</var> とする</li>\n<li>作物 <var>k</var> が計画に含まれているとき <var>X_k = D_k - S_k + 1</var> とする</li>\n</ol>\n<p><span class=\"label label-success\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"正解\">AC</span> の判定がされたテストケースの得点は <var>10^6 \\times {\\sum_{k = 1}^K X_k \\over HWT}</var> となります（この値は暫定テストとシステムテストで使用されるすべてのテストケースに対して整数になります）。<span class=\"label label-success\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"正解\">AC</span> 以外の判定がされたテストケースの得点は <var>0</var> となります。</p>\n<p>暫定テストでは、すべてのテストケースで <span class=\"label label-success\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"正解\">AC</span> の判定がされた場合は各テストケースの得点の合計が提出の得点となり、そうでない場合は提出の得点は <var>0</var> となります。</p>\n<p>システムテストでは、各テストケースの得点の合計が提出の得点となります。</p>\n<p>最終順位はコンテスト終了後に実施されるより多くの入力に対するシステムテストにおける得点で決定されます。システムテストは <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"コンパイルエラー\">CE</span>  以外の結果を得た一番最後の提出に対してのみ行われるため、最終的に提出する解答を間違えないよう注意してください。</p>\n<h4>テストケース数</h4>\n<ul>\n<li>暫定テスト: 50個</li>\n<li>システムテスト: 2000個、コンテスト終了後に <a href=\"https://img.atcoder.jp/ahc023/seeds.txt\">seeds.txt</a> (sha256=0c2ffe8037c0c232ed9775b89a892fc1f68709a1582c83fd6bb609244cefcf32) を公開</li>\n</ul>\n<p>システムテストのテストケースには水路の生成に使用するパラメータ <var>d</var> が <var>1, 2, 3, 4</var> のものがそれぞれ同数ずつ含まれます（詳細は入力生成方法を参照してください）。</p>\n<h4>実行時間について</h4>\n<p>実行時間には多少のブレが生じます。また、システムテストでは同時に大量の実行を行うため、暫定テストに比べて数%程度実行時間が伸びる現象が確認されています。 そのため、実行時間制限ギリギリの提出がシステムテストで <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"実行時間制限超過\">TLE</span> となる可能性があります。プログラム内で時間を計測して処理を打ち切るか、実行時間に余裕を持たせるようお願いします。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下のフォーマットで標準入力から与えられます。</p>\n<pre><var>T</var> <var>H</var> <var>W</var> <var>i_0</var>\n<var>h_{0, 0}h_{0, 1}\\cdots h_{0, W-1}</var>\n<var>\\vdots</var>\n<var>h_{H-2, 0}h_{H-2, 1}\\cdots h_{H-2, W-1}</var>\n<var>v_{0, 0}v_{0, 1}\\cdots v_{0, W-2}</var>\n<var>\\vdots</var>\n<var>v_{H-1, 0}v_{H-1, 1}\\cdots v_{H-1, W-2}</var>\n<var>K</var>\n<var>S_1</var> <var>D_1</var>\n<var>\\vdots</var>\n<var>S_K</var> <var>D_K</var>\n</pre>\n<p><var>h_{i, 0} \\cdots h_{i, W-1}</var> は <var>0</var> または <var>1</var> のみからなる <var>W</var> 文字の文字列であり、区画 <var>(i, j)</var> の南側（座標 <var>(i+1, j)</var> と <var>(i+1, j+1)</var> の間を結ぶ線分上）に水路があるときに <var>h_{i,j} = 1</var>、そうでないときに <var>h_{i,j} = 0</var> です。</p>\n<p><var>v_{i, 0} \\cdots v_{i, W-2}</var> は <var>0</var> または <var>1</var> のみからなる <var>W-1</var> 文字の文字列であり、区画 <var>(i, j)</var> の東側（座標 <var>(i, j+1)</var> と <var>(i+1, j+1)</var> の間を結ぶ線分上）に水路があるときに <var>v_{i,j} = 1</var>、そうでないときに <var>v_{i,j} = 0</var> です。</p>\n<p>暫定テストおよびシステムテストに用いられる入力は「入力生成方法」のセクションに述べられている方法で生成され、以下の条件を満たします。</p>\n<ul>\n<li><var>T = 100</var></li>\n<li><var>H = W = 20</var></li>\n<li><var>0 \\le i_0 \\le H - 1</var></li>\n<li><var>0 &lt; K \\le HWT</var></li>\n<li><var>1 \\le S_k &lt; D_k \\le T \\quad (1 \\le k \\le K)</var></li>\n<li>出入口からどの区画へも、隣接する区画への移動を繰り返すことで水路を通ることなく到達可能である</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>作る作物の数を <var>M</var>、作る作物を任意の順番で並べたものを <var>k_1, \\dots, k_M</var> とし、<var>k_m</var> を区画 <var>(i_m, j_m)</var> で <var>s_m</var> ヶ月目に植えるとします。</p>\n<p>このとき、以下の形式で標準出力に出力してください。</p>\n<pre><var>M</var>\n<var>k_1</var> <var>i_1</var> <var>j_1</var> <var>s_1</var>\n<var>\\vdots</var>\n<var>k_M</var> <var>i_M</var> <var>j_M</var> <var>s_M</var>\n</pre>\n<p>出力は問題文中に記述されている計画の要件を満たす必要があります。満たさない場合は <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"不正解\">WA</span> と判定されます。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>入力生成方法</h3><details>\n<summary>詳細</summary>\n<div>\n<p><var>\\mathrm{rand}(L, U)</var> で <var>L</var> 以上 <var>U</var> 未満の実数を一様ランダムに生成する関数を表す。また平均 <var>\\mu</var>、分散 <var>\\sigma^2</var> の<a href=\"https://ja.wikipedia.org/wiki/%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83\">正規分布</a>から実数値をランダムに生成する関数を <var>\\mathrm{normal}(\\mu, \\sigma^2)</var> で表す。</p>\n<ul>\n<li><var>T = 100</var></li>\n<li><var>H = W = 20</var></li>\n<li><var>0 \\le i_0 \\le H - 1</var> となるように <var>i_0</var> を一様ランダムに選ぶ</li>\n<li>土地（外周も含む）に含まれる格子点を頂点とし、距離 <var>1</var> の頂点間すべてに辺を張ってできる無向グラフを <var>G = (V, E)</var> とする。つまり <var>V, E</var> は以下のように定義される。<ul>\n<li><var>V = \\lbrace(i, j) \\mid 0 \\le i \\le H, 0 \\le j \\le W\\rbrace</var> </li>\n<li><var>E = \\lbrace((i_1, j_1), (i_2, j_2)) \\in V \\times V \\mid |i_1 - i_2| + |j_1 - j_2| = 1\\rbrace</var></li>\n</ul>\n</li>\n<li><var>G</var> を使って以下のように水路を生成する。<ul>\n<li><var>d = 1 + (\\mathit{seed} \\bmod 4)</var></li>\n<li>外周に含まれる点（すなわち、<var>i = 0, i = H, j = 0, j = W</var> のいずれかを満たす <var>(i, j) \\in V</var>）すべてにマークを付ける</li>\n<li>以下の処理を繰り返す<ul>\n<li><var>V'</var> をこの時点でマークの付いている点全体の集合、<var>V'' = \\lbrace (i', j') \\in V \\mid \\forall (i, j) \\in V', |i - i'| + |j - j'| &gt; d \\rbrace</var> とする</li>\n<li><var>V''</var> が空なら水路の生成を終了する。空でないなら <var>V''</var> の要素を一様ランダムに一つ選んで <var>(i, j)</var> とする。</li>\n<li><var>V'</var> の点のうち、<var>G</var> において <var>(i, j)</var> から最も近い点を <var>(i', j')</var> とする。最も近い点が複数ある場合は、その中から一様ランダムに選ぶ。</li>\n<li><var>(i, j)</var> と <var>(i', j')</var> の間の <var>G</var> における最短路を <var>P</var> とする。最短路が複数ある場合は、向きを変える回数が最も少ないもの（最大2通りある）の中から一様ランダムに選ぶ。</li>\n<li><var>P</var> に含まれるすべての辺を水路にする</li>\n<li><var>P</var> に含まれるすべての頂点にマークを付ける</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><var>L = \\mathrm{round}(HWT \\times \\mathrm{rand(1.0, 2.0)})</var> とする。<var>k = 1, 2, \\dots</var> に対して以下を繰り返すことで <var>D_k, S_k</var> を生成する。<ul>\n<li><var>L_k = \\mathrm{round}(10^{\\mathrm{normal}(1, 0.25^2)})</var> とする。ただし <var>2 \\le L_k \\le T</var> を満たさなかったら <var>L_k</var> の生成をやり直す。</li>\n<li><var>D_k</var> を <var>L_k \\le D_k \\le T</var> の範囲で一様ランダムに生成する</li>\n<li><var>S_k = D_k - L_k + 1</var> とする</li>\n<li><var>\\sum_{i = 1}^k L_i \\ge L</var> なら生成を終了する</li>\n</ul>\n</li>\n</ul>\n</div>\n</details>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>ツール</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc023/5XtyY7PgVPtBANvV.html\">Web版</a>: ローカル版より高性能でアニメーション表示が可能です。</li>\n<li><a href=\"https://img.atcoder.jp/ahc023/asprocon10_5XtyY7PgVPtBANvV.zip\">ローカル版</a>: 使用するには<a href=\"https://www.rust-lang.org/ja\">Rust言語</a>のコンパイル環境をご用意下さい。<ul>\n<li><a href=\"https://img.atcoder.jp/ahc023/asprocon10_5XtyY7PgVPtBANvV_windows.zip\">Windows用のコンパイル済みバイナリ</a>: Rust言語の環境構築が面倒な方は代わりにこちらをご利用下さい。</li>\n</ul>\n</li>\n<li><a href=\"https://img.atcoder.jp/ahc023/5XtyY7PgVPtBANvV_sample.zip\">サンプルコード(C++)</a>: 最初の <var>\\min(K, 10)</var> 個の作物について、植えられる区画を探して最初に見つかった区画に植える処理を実装しています。</li>\n</ul>\n<p><font color=\"red\"><strong>コンテスト終了までビジュアライズ結果の共有は禁止されています。ご注意下さい。</strong></font></p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>10 6 6 3\n011010\n000001\n011000\n000110\n011000\n00000\n10001\n10010\n00110\n10101\n10000\n20\n2 10\n1 10\n4 10\n1 10\n2 9\n4 5\n2 8\n4 10\n4 9\n1 9\n1 3\n1 6\n1 7\n3 6\n8 10\n1 7\n3 8\n2 8\n1 10\n2 10\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>12\n1 0 0 2\n2 0 1 1\n3 1 0 4\n4 0 2 1\n5 3 1 2\n6 2 0 4\n7 4 0 2\n10 3 2 1\n15 2 0 8\n18 5 0 2\n19 0 3 1\n20 4 1 2\n</pre>\n<p>このサンプルは入出力の例を示すための、採点に使われる入力データよりも小さいものです。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There is a rectangular piece of land with size <var>H \\times W</var>.\nThis land is divided into square <strong>blocks</strong> of size <var>1 \\times 1</var>, and some of the boundaries between the blocks are separated by <strong>waterways</strong>.\nThe border of the land is surrounded by fences except for a single <strong>entrance</strong>, which is the only way to enter or exit the land.\nThe entrance is set on one side of a single block.</p>\n<p><img src=\"data:image/png;base64,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\" class=\"img-responsive center-block\"></p>\n<p>You plan to grow <strong>crops</strong> on this land.\nWhen planting or harvesting crops, you will need to move agricultural machinery from the entrance to the block you plan to work on.\nHowever, there are no fixed pathways set as the passage for the machinery.</p>\n<p>As it would be a challenging task to establish the pathways now, you have decided to move the machinery through the blocks which are not currently being used for growing crops.\nIn other words, when planting or harvesting crops in a particular block, it must be possible to reach to the block from the entrance while satisfying the following conditions:</p>\n<ul>\n<li>You can only move to the four adjacent blocks from each block (moving diagonally is not allowed).</li>\n<li>Yon cannot move from one block to another if they are separated by a waterway.</li>\n<li>You may not pass through blocks which are currently being used for growing crops.</li>\n</ul>\n<p>There are <var>K</var> kinds of crops available for planting, numbered <var>1, 2, \\dots, K</var>.\nYou are to choose some of them to be planted and harvested in the following <var>T</var> months.\nTo plant crop <var>k</var>, you will need to plant it <strong>no later than</strong> the <var>S_k</var>-th month, and harvest it <strong>at</strong> the <var>D_k</var>-th month.\nYou can plant crop <var>k</var> before the <var>S_k</var>-th month, but even if you plant it earlier than required, you cannot harvest it before <var>D_k</var>-th month.</p>\n<p>It is allowed to plant any kind of crop in any block, but one kind of crop cannot be planted in multiple blocks, and multiple kinds of crops cannot be planted in a single block.</p>\n<p>Please make a planting plan which maximizes the utility of the land.</p>\n<h4>Details of the land</h4>\n<p>The land has coordinates with the northwest corner at <var>(0, 0)</var>, the southwest corner at <var>(H, 0)</var>, the northeast corner at <var>(0, W)</var>, and the southeast corner at <var>(H, W)</var>.\nThe block at the <var>i+1</var>-th row from the north and the <var>j+1</var>-th column from the west is a square with diagonal points <var>(i, j)</var> and <var>(i + 1, j + 1)</var>.\nThis square is referred to as block <var>(i, j)</var> (<var>0 \\le i \\le H - 1</var>, <var>0 \\le j \\le W - 1</var>).</p>\n<p>The entrance is set at the west side of block <var>(i_0, 0)</var> (that is, on the segment between coordinates <var>(i_0, 0)</var> and <var>(i_0 + 1, 0)</var>).</p>\n<p>For the blocks which shares sides, whether there is a waterway between them is determined by the given input.\nPlease refer to the \"Input\" section for the details of the input format for the waterway.</p>\n<h4>Details of the planting plan</h4>\n<p>A planting plan describes which crop are grown on which blocks, and when they are planted.\nIt is represented by a sequence <var>(k_1, i_1, j_1, s_1), \\dots, (k_M, i_M, j_M, s_M)</var>.\nThe <var>m</var>-th element of this sequence signifies that crop <var>k_m</var> is planted in block <var>(i_m, j_m)</var> on the <var>s_m</var>-th month.</p>\n<p>Based on a given planting plan, the following actions are taken on the <var>t</var>-th month (<var>t = 1, 2, \\dots, T</var>).</p>\n<ol>\n<li>At the beginning of the <var>t</var>-th month, for all <var>m</var> where <var>s_m = t</var>, crop <var>k_m</var> is planted in block <var>(i_m, j_m)</var>. During this process, <var>(i_m, j_m)</var> must be reachable from the entrance without  crossing waterways or passing through blocks where crops are currently growing in.</li>\n<li>At the end of the <var>t</var>-th month, for all <var>m</var> where <var>D_{k_m} = t</var>, crop <var>k_m</var> is harvested from block <var>(i_m, j_m)</var>. During this process, <var>(i_m, j_m)</var> must be reachable from the entrance without  crossing waterways or passing through blocks where crops are currently growing in.</li>\n</ol>\n<p>When planting multiple crops in a same month, the reachability condition above may depend on the order in which crops are planted.\nFor example, if crops <var>k_1</var> and <var>k_2</var> are to be planted in a same month, and <var>(i_2, j_2)</var> cannot be reached without passing through <var>(i_1, j_1)</var>, then planting crop <var>k_1</var> before <var>k_2</var> blocks the way for planting <var>k_2</var>.</p>\n<p>In this case, a planting plan is considered valid if there exists an order such that planting them by the order does not lead to the situation above.\nSuch an order will be calculated by the judging program, so it does not have to be determined in the output.\nSimilarly, when harvesting multiple crops in a same month, the order of the crops will be calculated by the judging program and does not have to be determined in the output.</p>\n<p>The planting plan must satisfy the following conditions.</p>\n<ul>\n<li>The same crop can only be planted in the same block.</li>\n<li>A block can only contains at most one kind of crop at the same time.</li>\n<li>When planting crop <var>k</var>, it must be planted before <var>S_k</var>-th month.</li>\n<li>When planting or harvesting crop, the target crop must be reachable from the entrance.</li>\n</ul>\n<p>Note that, it is not required to plant all the <var>K</var> crops.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Scoring</h3><p>The score of crop <var>k</var>, <var>X_k</var>, is determined as the following rules.</p>\n<ol>\n<li>If crop <var>k</var> is not planted, then <var>X_k = 0</var>.</li>\n<li>If crop <var>k</var> is planted, then <var>X_k = D_k - S_k + 1</var>.</li>\n</ol>\n<p>For each test case that received an <span class=\"label label-success\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"\" data-original-title=\"Accepted\">AC</span> verdict, the score of the test case will be <var>10^6 \\times {\\sum_{k = 1}^K X_k \\over HWT}</var> (this number will be an integer in all test cases used in provisional test and system test).\nFor each test case that received a not <span class=\"label label-success\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"\" data-original-title=\"Accepted\">AC</span> verdict, the score of the test case will be <var>0</var>.</p>\n<p>In provisional test, if a submission receives <span class=\"label label-success\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"\" data-original-title=\"Accepted\">AC</span> in all test cases, the score of the submission will be the sum of the score of all test cases. Otherwise, the score of the submission will be <var>0</var>.</p>\n<p>In system test, the score of the submission will be the sum of the score of all test cases.</p>\n<p>The final standings will be determined by the system test which is conducted after the contest.\nThe system test will be performed only for the last submission which received a result other than <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"\" data-original-title=\"Compilation Error\">CE</span>.\nBe careful not to make a mistake in the final submission.</p>\n<h4>Number of test cases</h4>\n<ul>\n<li>Provisional test: 50</li>\n<li>System test: 2000; We will publish <a href=\"https://img.atcoder.jp/ahc023/seeds.txt\">seeds.txt</a> (sha256=0c2ffe8037c0c232ed9775b89a892fc1f68709a1582c83fd6bb609244cefcf32) after the contest is over.</li>\n</ul>\n<p>The test cases in the system test contains the same amount of test cases with <var>d = 1, 2, 3, 4</var>, where <var>d</var> is a parameter used in generating the waterways (for details, please refer to the input generation).</p>\n<h4>About execution time</h4>\n<p>Execution time may vary slightly from run to run. In addition, since system tests simultaneously perform a large number of executions, it has been observed that execution time increases by several percent compared to provisional tests. For these reasons, submissions that are very close to the time limit may result in <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"\" data-original-title=\"Time Limit Exceeded\">TLE</span> in the system test. Please measure the execution time in your program to terminate the process, or have enough margin in the execution time.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>T</var> <var>H</var> <var>W</var> <var>i_0</var>\n<var>h_{0, 0}h_{0, 1}\\cdots h_{0, W-1}</var>\n<var>\\vdots</var>\n<var>h_{H-2, 0}h_{H-2, 1}\\cdots h_{H-2, W-1}</var>\n<var>v_{0, 0}v_{0, 1}\\cdots v_{0, W-2}</var>\n<var>\\vdots</var>\n<var>v_{H-1, 0}v_{H-1, 1}\\cdots v_{H-1, W-2}</var>\n<var>K</var>\n<var>S_1</var> <var>D_1</var>\n<var>\\vdots</var>\n<var>S_K</var> <var>D_K</var>\n</pre>\n<p><var>h_{i, 0} \\cdots h_{i, W-1}</var> is a string of length <var>W</var> consisting of only <var>0</var> and <var>1</var>.\nFor block <var>(i, j)</var>, if there is a waterway on the south side (along the segment between coordinates <var>(i + 1, j)</var> and <var>(i + 1, j + 1)</var>), then <var>h_{i, j} = 1</var>.\nOtherwise, if there is no waterway, <var>h_{i, j} = 0</var>.</p>\n<p><var>v_{i, 0} \\cdots v_{i, W-2}</var> is a string of length <var>W - 1</var> consisting of only <var>0</var> and <var>1</var>.\nFor block <var>(i, j)</var>, if there is a waterway on the east side (along the segment between coordinates <var>(i, j + 1)</var> and <var>(i + 1, j + 1)</var>), then <var>v_{i, j} = 1</var>.\nOtherwise, if there is no waterway, <var>v_{i, j} = 0</var>.</p>\n<p>The inputs of provisional test and system test are generated by the method described below in \"Input Generation\".\nThe inputs satisfy the following regulations.</p>\n<ul>\n<li><var>T = 100</var></li>\n<li><var>H = W = 20</var></li>\n<li><var>0 \\le i_0 \\le H - 1</var></li>\n<li><var>0 &lt; K \\le HWT</var></li>\n<li><var>1 \\le S_k &lt; D_k \\le T \\quad (1 \\le k \\le K)</var></li>\n<li>For any particular block, it is possible to reach it from the entrance by moving between adjacent blocks without crossing the waterway.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Let the number of crops to plant be <var>M</var>, <var>k_1, \\dots, k_M</var> be an arbitrary order of the crops to be planted, and crop <var>k_m</var> is planned to be planted in block <var>(i_m, j_m)</var> in the <var>s_m</var>-th month.</p>\n<p>In this case, output to standard output (stdout) in the following format.</p>\n<pre><var>M</var>\n<var>k_1</var> <var>i_1</var> <var>j_1</var> <var>s_1</var>\n<var>\\vdots</var>\n<var>k_M</var> <var>i_M</var> <var>j_M</var> <var>s_M</var>\n</pre>\n<p>The output must meet the requirements described in the problem statement.\nOtherwise, the test case will be judged as <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"\" data-original-title=\"Wrong Answer\">WA</span>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Input Generation</h3><details>\n<summary>Details</summary>\n<div>\n<p>Let <var>\\mathrm{rand}(L, U)</var> be a function that generates a uniform random floating-point number at least L and less than U.\nLet <var>\\mathrm{normal}(\\mu, \\sigma^2)</var> be a function that generates a random value from <a href=\"https://en.wikipedia.org/wiki/Normal_distribution#Standard_normal_distribution\">the standard normal distribution</a> with <var>\\mu</var> as its mean and <var>\\sigma^2</var> as its variance.</p>\n<ul>\n<li><var>T = 100</var></li>\n<li><var>H = W = 20</var></li>\n<li>Generate <var>i_0</var> randomly from <var>{0, 1, \\dots, H - 1}</var>.</li>\n<li>Let <var>G = (V, E)</var> be the undirected graph with the lattice points on the land (including border) as its vertices, and segments of length <var>1</var> connecting two lattice points as its edges. Formally, <var>V</var> and <var>E</var> are defined as the following:<ul>\n<li><var>V = \\lbrace(i, j) \\mid 0 \\le i \\le H, 0 \\le j \\le W\\rbrace</var></li>\n<li><var>E = \\lbrace((i_1, j_1), (i_2, j_2)) \\in V \\times V \\mid |i_1 - i_2| + |j_1 - j_2| = 1\\rbrace</var></li>\n</ul>\n</li>\n<li>Generate the waterways in the following way.<ul>\n<li><var>d = 1 + (\\mathit{seed} \\bmod 4)</var></li>\n<li>Mark all vertices which locates on the border (that is, all <var>(i, j) \\in V</var> where <var>i = 0, i = H, j = 0</var>, or <var>j = W</var> is satisfied).</li>\n<li>Repeat the following processes.<ul>\n<li>Let <var>V'</var> be the set of vertices that is marked, and <var>V'' = \\lbrace (i', j') \\in V \\mid \\forall (i, j) \\in V', |i - i'| + |j - j'| &gt; d \\rbrace</var>.</li>\n<li>If <var>V''</var> is empty, the process of generating waterways is ended. Otherwise, let <var>(i, j)</var> be a element selected randomly from <var>V''</var>.</li>\n<li>Let <var>(i', j')</var> be the vertex in <var>V'</var> which is nearest to <var>(i, j)</var>. If there are multiple candidates of <var>(i', j')</var>, let <var>(i', j')</var> be one of them randomly.</li>\n<li>Let <var>P</var> be the shortest path in <var>G</var> connecting <var>(i, j)</var> and <var>(i', j')</var>. If there are multiple candidates of <var>P</var>, let <var>P</var> be one of the paths having the least turning points. If there are still multiple (at most <var>2</var>) candidates of <var>P</var>, let <var>P</var> be one of them randomly.</li>\n<li>Set all edges in <var>P</var> to waterways.</li>\n<li>Mark all vertices in <var>P</var>.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Let <var>L = \\mathrm{round}(HWT \\times \\mathrm{rand(1.0, 2.0)})</var>. For <var>k = 1, 2, \\dots</var>, repeat the following processes to generate <var>D_k</var> and <var>S_k</var>.<ul>\n<li>Let <var>L_k = \\mathrm{round}(10^{\\mathrm{normal}(1, 0.25^2)})</var>. If <var>2 \\le L_k \\le T</var> isn't satisfied, regenerate <var>L_k</var>.</li>\n<li>Generate <var>D_k</var> randomly from <var>{L_k, L_k + 1, \\dots, T}</var>.</li>\n<li>Let <var>S_k = D_k - L_k + 1</var>.</li>\n<li>If <var>\\sum_{i = 1}^k L_i \\ge L</var>, then the processes are ended.</li>\n</ul>\n</li>\n</ul>\n</div>\n</details>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Tools</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc023/5XtyY7PgVPtBANvV.html?lang=en\">Web version</a>: This is more powerful than the local version when displaying animations.</li>\n<li><a href=\"https://img.atcoder.jp/ahc023/asprocon10_5XtyY7PgVPtBANvV.zip\">Local version</a>: You need a compilation environment of <a href=\"https://www.rust-lang.org/\">Rust language</a>.<ul>\n<li><a href=\"https://img.atcoder.jp/ahc023/asprocon10_5XtyY7PgVPtBANvV_windows.zip\">Pre-compiled binary for Windows</a>: If you are not familiar with the Rust language environment, please use this instead.</li>\n</ul>\n</li>\n<li><a href=\"https://img.atcoder.jp/ahc023/5XtyY7PgVPtBANvV_sample.zip\">Sample code (C++)</a>: This sample code searches for a block to plant each crop, and choose the first one found.  Only the first <var>\\min(K, 10)</var> crops are considered.</li>\n</ul>\n<p><font color=\"red\"><strong>Sharing visualization results is not allowed until the end of the contest.</strong></font></p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>10 6 6 3\n011010\n000001\n011000\n000110\n011000\n00000\n10001\n10010\n00110\n10101\n10000\n20\n2 10\n1 10\n4 10\n1 10\n2 9\n4 5\n2 8\n4 10\n4 9\n1 9\n1 3\n1 6\n1 7\n3 6\n8 10\n1 7\n3 8\n2 8\n1 10\n2 10\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>12\n1 0 0 2\n2 0 1 1\n3 1 0 4\n4 0 2 1\n5 3 1 2\n6 2 0 4\n7 4 0 2\n10 3 2 1\n15 2 0 8\n18 5 0 2\n19 0 3 1\n20 4 1 2\n</pre>\n<p>This sample is only to show a concrete example of input/output, and is smaller than the actual test cases used for scoring.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/ahc023/tasks/asprocon10_a"}