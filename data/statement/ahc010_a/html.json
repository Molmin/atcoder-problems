{"html":{"ja":"<span class=\"lang-ja\">\n\n<div class=\"part\">\n<section>\n<h3>ストーリー</h3><p>環状線が大好きな高橋くんは鉄道玩具で遊んでいる。\nこの玩具は、下図のように並べられた正方形の線路タイルを回転させることで線路を繋ぎ、その上を電車の模型を走らせるというものである。\n高橋くんは電車の模型を2台持っているので、出来るだけ大きな環状線を2つ作ってほしい。</p>\n<table>\n<tbody><tr align=\"center\">\n<td>\n<svg height=\"100\" id=\"vis\" viewBox=\"-5 -5 100 100\" width=\"100\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect fill=\"white\" height=\"100\" width=\"100\" x=\"-5\" y=\"-5\"></rect>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"0\" y2=\"0\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"30\" y2=\"30\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"30\" x2=\"30\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"60\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"60\" x2=\"60\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"90\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"90\" x2=\"90\" y1=\"0\" y2=\"90\"></line>\n<defs>\n<g id=\"rail1\" stroke-width=\"2\">\n<line x1=\"12\" x2=\"12\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"18\" x2=\"18\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"3\" y2=\"3\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"9\" y2=\"9\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"15\" y2=\"15\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"21\" y2=\"21\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"27\" y2=\"27\"></line>\n</g>\n<g fill=\"none\" id=\"rail2\" stroke-width=\"2\">\n<path d=\"M12,0 A12,12 0 0,1 0,12\"></path>\n<path d=\"M18,0 A18,18 0 0,1 0,18\"></path>\n<line x1=\"12\" x2=\"18\" y1=\"2\" y2=\"3\"></line>\n<line x1=\"11\" x2=\"16\" y1=\"5\" y2=\"8\"></line>\n<line x1=\"8\" x2=\"13\" y1=\"8\" y2=\"13\"></line>\n<line x1=\"5\" x2=\"8\" y1=\"11\" y2=\"16\"></line>\n<line x1=\"2\" x2=\"3\" y1=\"12\" y2=\"18\"></line>\n</g>\n</defs>\n<use href=\"#rail1\" stroke=\"silver\" x=\"0\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"30\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,15)\" x=\"30\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"60\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"0\" y=\"30\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,15,45)\" x=\"0\" y=\"30\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"30\" y=\"30\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,45)\" x=\"30\" y=\"30\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,75,45)\" x=\"60\" y=\"30\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,15,75)\" x=\"0\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(90,15,75)\" x=\"0\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"30\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,75)\" x=\"30\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"60\" y=\"60\"></use>\n</svg>\n</td>\n<td>\n<svg height=\"100\" id=\"vis\" viewBox=\"-5 -5 100 100\" width=\"100\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect fill=\"white\" height=\"100\" width=\"100\" x=\"-5\" y=\"-5\"></rect>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"0\" y2=\"0\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"30\" y2=\"30\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"30\" x2=\"30\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"60\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"60\" x2=\"60\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"90\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"90\" x2=\"90\" y1=\"0\" y2=\"90\"></line>\n<defs>\n<g id=\"rail1\" stroke-width=\"2\">\n<line x1=\"12\" x2=\"12\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"18\" x2=\"18\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"3\" y2=\"3\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"9\" y2=\"9\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"15\" y2=\"15\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"21\" y2=\"21\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"27\" y2=\"27\"></line>\n</g>\n<g fill=\"none\" id=\"rail2\" stroke-width=\"2\">\n<path d=\"M12,0 A12,12 0 0,1 0,12\"></path>\n<path d=\"M18,0 A18,18 0 0,1 0,18\"></path>\n<line x1=\"12\" x2=\"18\" y1=\"2\" y2=\"3\"></line>\n<line x1=\"11\" x2=\"16\" y1=\"5\" y2=\"8\"></line>\n<line x1=\"8\" x2=\"13\" y1=\"8\" y2=\"13\"></line>\n<line x1=\"5\" x2=\"8\" y1=\"11\" y2=\"16\"></line>\n<line x1=\"2\" x2=\"3\" y1=\"12\" y2=\"18\"></line>\n</g>\n</defs>\n<use href=\"#rail1\" stroke=\"silver\" x=\"0\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"30\" y=\"0\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,45,15)\" x=\"30\" y=\"0\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(270,75,15)\" x=\"60\" y=\"0\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" x=\"0\" y=\"30\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,15,45)\" x=\"0\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"30\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,45,45)\" x=\"30\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"60\" y=\"30\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,15,75)\" x=\"0\" y=\"60\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(90,15,75)\" x=\"0\" y=\"60\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"30\" y=\"60\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,75)\" x=\"30\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"60\" y=\"60\"></use>\n</svg>\n</td>\n</tr>\n<tr align=\"center\">\n<td>\n初期状態\n</td>\n<td>\n右上と右中央を回転\n</td>\n</tr>\n</tbody></table>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>30\\times 30</var> マスに並んだ線路タイルが与えられる。\nタイルは回転したものを区別すると8種類あり、以下のように番号付ける。</p>\n<p><svg height=\"70\" id=\"vis\" viewBox=\"-5 -5 250 70\" width=\"250\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect fill=\"white\" height=\"70\" width=\"250\" x=\"-5\" y=\"-5\"></rect>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"0\" y2=\"0\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"30\" y2=\"30\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"30\" x2=\"30\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"60\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"60\" x2=\"60\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"90\" x2=\"90\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"120\" x2=\"120\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"150\" x2=\"150\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"180\" x2=\"180\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"210\" x2=\"210\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"240\" x2=\"240\" y1=\"0\" y2=\"60\"></line>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"15\" y=\"55\">\n0\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"45\" y=\"55\">\n1\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"75\" y=\"55\">\n2\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"105\" y=\"55\">\n3\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"135\" y=\"55\">\n4\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"165\" y=\"55\">\n5\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"195\" y=\"55\">\n6\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"225\" y=\"55\">\n7\n</text>\n<defs>\n<g id=\"rail1\" stroke-width=\"2\">\n<line x1=\"12\" x2=\"12\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"18\" x2=\"18\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"3\" y2=\"3\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"9\" y2=\"9\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"15\" y2=\"15\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"21\" y2=\"21\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"27\" y2=\"27\"></line>\n</g>\n<g fill=\"none\" id=\"rail2\" stroke-width=\"2\">\n<path d=\"M12,0 A12,12 0 0,1 0,12\"></path>\n<path d=\"M18,0 A18,18 0 0,1 0,18\"></path>\n<line x1=\"12\" x2=\"18\" y1=\"2\" y2=\"3\"></line>\n<line x1=\"11\" x2=\"16\" y1=\"5\" y2=\"8\"></line>\n<line x1=\"8\" x2=\"13\" y1=\"8\" y2=\"13\"></line>\n<line x1=\"5\" x2=\"8\" y1=\"11\" y2=\"16\"></line>\n<line x1=\"2\" x2=\"3\" y1=\"12\" y2=\"18\"></line>\n</g>\n</defs>\n<use href=\"#rail2\" stroke=\"silver\" x=\"0\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,45,15)\" x=\"30\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,75,15)\" x=\"60\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(90,105,15)\" x=\"90\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"120\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,135,15)\" x=\"120\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,165,15)\" x=\"150\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(90,165,15)\" x=\"150\" y=\"0\"></use>\n<use href=\"#rail1\" stroke=\"silver\" transform=\"rotate(90,195,15)\" x=\"180\" y=\"0\"></use>\n<use href=\"#rail1\" stroke=\"silver\" x=\"210\" y=\"0\"></use>\n</svg></p>\n<p>0から3番のタイルにはカーブした1本の線路、4番と5番のタイルにはカーブした2本の線路、6番と7番のタイルには直線の1本の線路が乗っている。\n各タイルは90度ずつ回転させることが出来、反時計回りに90度回転させると次のようになる。</p>\n<p><svg height=\"70\" id=\"vis\" viewBox=\"-5 -5 250 70\" width=\"250\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect fill=\"white\" height=\"70\" width=\"250\" x=\"-5\" y=\"-5\"></rect>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"0\" y2=\"0\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"30\" y2=\"30\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"30\" x2=\"30\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"60\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"60\" x2=\"60\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"90\" x2=\"90\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"120\" x2=\"120\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"150\" x2=\"150\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"180\" x2=\"180\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"210\" x2=\"210\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"240\" x2=\"240\" y1=\"0\" y2=\"60\"></line>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"15\" y=\"55\">\n1\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"45\" y=\"55\">\n2\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"75\" y=\"55\">\n3\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"105\" y=\"55\">\n0\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"135\" y=\"55\">\n5\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"165\" y=\"55\">\n4\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"195\" y=\"55\">\n7\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"225\" y=\"55\">\n6\n</text>\n<defs>\n<g id=\"rail1\" stroke-width=\"2\">\n<line x1=\"12\" x2=\"12\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"18\" x2=\"18\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"3\" y2=\"3\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"9\" y2=\"9\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"15\" y2=\"15\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"21\" y2=\"21\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"27\" y2=\"27\"></line>\n</g>\n<g fill=\"none\" id=\"rail2\" stroke-width=\"2\">\n<path d=\"M12,0 A12,12 0 0,1 0,12\"></path>\n<path d=\"M18,0 A18,18 0 0,1 0,18\"></path>\n<line x1=\"12\" x2=\"18\" y1=\"2\" y2=\"3\"></line>\n<line x1=\"11\" x2=\"16\" y1=\"5\" y2=\"8\"></line>\n<line x1=\"8\" x2=\"13\" y1=\"8\" y2=\"13\"></line>\n<line x1=\"5\" x2=\"8\" y1=\"11\" y2=\"16\"></line>\n<line x1=\"2\" x2=\"3\" y1=\"12\" y2=\"18\"></line>\n</g>\n</defs>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,15,15)\" x=\"0\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,15)\" x=\"30\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(90,75,15)\" x=\"60\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"90\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,135,15)\" x=\"120\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(90,135,15)\" x=\"120\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"150\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,165,15)\" x=\"150\" y=\"0\"></use>\n<use href=\"#rail1\" stroke=\"silver\" x=\"180\" y=\"0\"></use>\n<use href=\"#rail1\" stroke=\"silver\" transform=\"rotate(90,225,15)\" x=\"210\" y=\"0\"></use>\n</svg></p>\n<p>線路に枝分かれはないため、各線路はパスもしくは閉路をなす。\n閉路をなす線路の集合を「環状線」と呼び、その長さを、線路に沿って一周する際にタイルから隣接タイルへ移動する回数と定義する。\n例えば、以下の環状線は7タイルからなるが、真ん中のタイルを二回通るため、長さは8である。</p>\n<p><svg height=\"100\" id=\"vis\" viewBox=\"-5 -5 100 100\" width=\"100\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect fill=\"white\" height=\"100\" width=\"100\" x=\"-5\" y=\"-5\"></rect>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"0\" y2=\"0\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"30\" y2=\"30\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"30\" x2=\"30\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"60\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"60\" x2=\"60\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"90\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"90\" x2=\"90\" y1=\"0\" y2=\"90\"></line>\n<defs>\n<g id=\"rail1\" stroke-width=\"2\">\n<line x1=\"12\" x2=\"12\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"18\" x2=\"18\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"3\" y2=\"3\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"9\" y2=\"9\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"15\" y2=\"15\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"21\" y2=\"21\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"27\" y2=\"27\"></line>\n</g>\n<g fill=\"none\" id=\"rail2\" stroke-width=\"2\">\n<path d=\"M12,0 A12,12 0 0,1 0,12\"></path>\n<path d=\"M18,0 A18,18 0 0,1 0,18\"></path>\n<line x1=\"12\" x2=\"18\" y1=\"2\" y2=\"3\"></line>\n<line x1=\"11\" x2=\"16\" y1=\"5\" y2=\"8\"></line>\n<line x1=\"8\" x2=\"13\" y1=\"8\" y2=\"13\"></line>\n<line x1=\"5\" x2=\"8\" y1=\"11\" y2=\"16\"></line>\n<line x1=\"2\" x2=\"3\" y1=\"12\" y2=\"18\"></line>\n</g>\n</defs>\n<use href=\"#rail1\" stroke=\"silver\" x=\"0\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"30\" y=\"0\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,45,15)\" x=\"30\" y=\"0\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(270,75,15)\" x=\"60\" y=\"0\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" x=\"0\" y=\"30\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,15,45)\" x=\"0\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"30\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,45,45)\" x=\"30\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"60\" y=\"30\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,15,75)\" x=\"0\" y=\"60\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(90,15,75)\" x=\"0\" y=\"60\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"30\" y=\"60\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,75)\" x=\"30\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"60\" y=\"60\"></use>\n</svg></p>\n<p>各タイルを回転させる回数を決定せよ。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>得点</h3><p>出力に従ってタイルを回転させることで得られた環状線のうち、一番長いものの長さを<var>L_1</var>、二番目に長いものの長さを<var>L_2</var>とする(最長のものが複数ある場合は<var>L_1=L_2</var>)。\nこのとき、<var>L_1\\times L_2</var> の得点が得られる。\n環状線の個数が <var>1</var> 以下の場合、そのテストケースの得点は <var>0</var> 点となる。</p>\n<p>テストケースは全部で 100 個あり、各テストケースの得点の合計が提出の得点となる。\n1つ以上のテストケースで <span class=\"label label-success\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"正解\">AC</span> 以外の判定がされた場合、提出の得点は0点となる。\nコンテスト時間中に得た最高得点で最終順位が決定され、コンテスト終了後のシステムテストは行われない。\n同じ得点を複数の参加者が得た場合、その得点を獲得した提出の早い方が上位となる。</p>\n<p>環状線の長さの求め方のヒント\n</p><details>\n<font color=\"red\">\n疑似コードを更新しました。\n</font>\n環状線の長さは例えば以下のようにして計算できる。\nタイルの状態が入った二次元配列を <code>tiles</code> とする。\n方向を左上右下の順に0,1,2,3と番号付けると、座標の変化は配列 <code>di = [0, -1, 0, 1]</code> と <code>dj = [-1, 0, 1, 0]</code> で表される。\n状態 <code>t</code> 番のタイルに <code>d</code> の方向から侵入した際に次に向かうタイルの方向を <code>to[t][d]</code>、ただしそのような方向から侵入不可能な場合は<code>-1</code>とすると、以下のような二次元配列となる。<p></p>\n<pre>to = [\n    [1, 0, -1, -1],\n    [3, -1, -1, 0],\n    [-1, -1, 3, 2],\n    [-1, 2, 1, -1],\n    [1, 0, 3, 2],\n    [3, 2, 1, 0],\n    [2, -1, 0, -1],\n    [-1, 3, -1, 1],\n];\n</pre>\n\n<p>位置 <code>(i, j)</code> のタイルに <code>d</code> の方向のタイルから侵入したとき、これらの組を以下のように更新出来る。</p>\n<pre>d2 = to[tiles[i][j]][d]; // 次のタイルの方向\nif (d2 == -1) return 0; // 線路が途切れている\ni += di[d2];\nj += dj[d2];\nif (i &lt; 0 || i &gt;= 30 || j &lt; 0 || j &gt;= 30) return 0; // 線路が途切れている\nd = (d2 + 2) % 4; // 今居たタイルの方向\n</pre>\n\n<p>あとはこの処理を最初の位置と向き(同じタイルを二度通る可能性があることに注意)に戻ってくるまで繰り返せば、繰り返し回数が環状線の長さとなる。</p>\n<pre>// (si, sj) のタイルに sd 方向のタイルから侵入した状態からスタートして環状線の長さを求める\ni = si;\nj = sj;\nd = sd;\nloop {\n    d2 = to[tiles[i][j]][d];\n    if (d2 == -1) return 0;\n    i += di[d2];\n    j += dj[d2];\n    if (i &lt; 0 || i &gt;= 30 || j &lt; 0 || j &gt;= 30) return 0;\n    d = (d2 + 2) % 4;\n    length += 1;\n    if (i == si &amp;&amp; j == sj &amp;&amp; d == sd) return length;\n}\n</pre>\n\n</details>\n\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>t_{0,0}</var> <var>\\cdots</var> <var>t_{0,29}</var>\n<var>\\vdots</var>\n<var>t_{29,0}</var> <var>\\cdots</var> <var>t_{29,29}</var>\n</pre>\n\n<p>各 <var>t_{i,0}\\cdots t_{i,29}</var> は長さ <var>30</var> の文字列である。\n上から <var>i</var> <var>(0\\leq i\\leq 29)</var> 番目、左から <var>j</var> <var>(0\\leq j\\leq 29)</var> 番目のタイルを <var>(i, j)</var> と表す。\n<var>t_{i,j}</var> はタイル <var>(i,j)</var> の状態を表す <var>0</var> 以上 <var>7</var> 以下の数字である。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>タイル <var>(i,j)</var> を反時計回りに90度回転させる回数を <var>r_{i,j}</var> (<var>0\\leq r_{i,j}\\leq 3</var>) としたとき、<var>30i+j</var> 文字目が <var>r_{i,j}</var> となるような長さ <var>900</var> の文字列を1行に出力せよ。</p>\n<p>解を複数回出力しても良い。複数出力された場合は一番最後のもののみが採点に用いられる。ビジュアライザでは複数出力された解の比較が可能である。</p>\n<p><a href=\"https://img.atcoder.jp/ahc010/d3a6c91ee76cb8.html?lang=ja&amp;show=example\">例を見る</a></p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>入力生成方法</h3><p><var>L</var> 以上 <var>U</var> 以下の整数値を一様ランダムに生成する関数を <var>\\mathrm{rand}(L,U)</var> で表す。</p>\n<p>各 <var>t_{i,j}</var> はそれぞれ独立に以下のように生成される。</p>\n<ul>\n<li>25% の確率で <var>t_{i,j}=\\mathrm{rand}(0, 3)</var> と生成する。</li>\n<li>50% の確率で <var>t_{i,j}=\\mathrm{rand}(4, 5)</var> と生成する。</li>\n<li>25% の確率で <var>t_{i,j}=\\mathrm{rand}(6, 7)</var> と生成する。</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>ツール(入力ジェネレータ・ビジュアライザ)</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc010/d3a6c91ee76cb8.html?lang=ja\">Web版</a>: ローカル版より高性能でアニメーション表示が可能です。</li>\n<li><a href=\"https://img.atcoder.jp/ahc010/d3a6c91ee76cb8.zip\">ローカル版</a>: 使用するには<a href=\"https://www.rust-lang.org/ja\">Rust言語</a>のコンパイル環境をご用意下さい。<ul>\n<li><a href=\"https://img.atcoder.jp/ahc010/d3a6c91ee76cb8_windows.zip\">Windows用のコンパイル済みバイナリ</a>: Rust言語の環境構築が面倒な方は代わりにこちらをご利用下さい。</li>\n</ul>\n</li>\n</ul>\n<p><font color=\"red\"><strong>コンテスト終了までビジュアライズ結果の共有は禁止されています。ご注意下さい。</strong></font></p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">436204751575440756541724746755\n347475575404531645424640344414\n556644445442451553264555436757\n761235545455474254546631467555\n356447405421445153457656535564\n014274425356522445253477726464\n311765446655556346633757446600\n471744514426443445162555525455\n616053450444473274742055767455\n254124557527462423444450075637\n046546764557475436717475255501\n752005462554554414031525515356\n452524742177476245065554577605\n664465643742341605007655253777\n444571276444165545442447340356\n435050335454565235025507452540\n467560030465475447567644441426\n735730577745561712541450443547\n472675153755474445700540444544\n507472724556677621365747544757\n535177720776402476665547676174\n636275455643650141456764547131\n164624553536572554544165746536\n521574724335644274433544442556\n576732703453654464555315065544\n656244747015464523316444145414\n555646775254464367454454067475\n665624154657072514445150474444\n570004746554540445465051654541\n635504417414262014475547424275\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n\n<div class=\"part\">\n<section>\n<h3>Story</h3><p>Takahashi, who loves loop lines, is playing with a toy train.\nAs shown in the figure below, this toy consists of square tiles containing railroad lines.\nBy rotating the tiles, he can connect lines and play with toy trains running on the lines.\nBecause Takahashi has two toy trains, please create two large loop lines as much as possible.</p>\n<table>\n<tbody><tr align=\"center\">\n<td>\n<svg height=\"100\" id=\"vis\" viewBox=\"-5 -5 100 100\" width=\"100\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect fill=\"white\" height=\"100\" width=\"100\" x=\"-5\" y=\"-5\"></rect>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"0\" y2=\"0\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"30\" y2=\"30\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"30\" x2=\"30\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"60\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"60\" x2=\"60\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"90\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"90\" x2=\"90\" y1=\"0\" y2=\"90\"></line>\n<defs>\n<g id=\"rail1\" stroke-width=\"2\">\n<line x1=\"12\" x2=\"12\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"18\" x2=\"18\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"3\" y2=\"3\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"9\" y2=\"9\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"15\" y2=\"15\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"21\" y2=\"21\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"27\" y2=\"27\"></line>\n</g>\n<g fill=\"none\" id=\"rail2\" stroke-width=\"2\">\n<path d=\"M12,0 A12,12 0 0,1 0,12\"></path>\n<path d=\"M18,0 A18,18 0 0,1 0,18\"></path>\n<line x1=\"12\" x2=\"18\" y1=\"2\" y2=\"3\"></line>\n<line x1=\"11\" x2=\"16\" y1=\"5\" y2=\"8\"></line>\n<line x1=\"8\" x2=\"13\" y1=\"8\" y2=\"13\"></line>\n<line x1=\"5\" x2=\"8\" y1=\"11\" y2=\"16\"></line>\n<line x1=\"2\" x2=\"3\" y1=\"12\" y2=\"18\"></line>\n</g>\n</defs>\n<use href=\"#rail1\" stroke=\"silver\" x=\"0\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"30\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,15)\" x=\"30\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"60\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"0\" y=\"30\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,15,45)\" x=\"0\" y=\"30\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"30\" y=\"30\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,45)\" x=\"30\" y=\"30\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,75,45)\" x=\"60\" y=\"30\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,15,75)\" x=\"0\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(90,15,75)\" x=\"0\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"30\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,75)\" x=\"30\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"60\" y=\"60\"></use>\n</svg>\n</td>\n<td>\n<svg height=\"100\" id=\"vis\" viewBox=\"-5 -5 100 100\" width=\"100\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect fill=\"white\" height=\"100\" width=\"100\" x=\"-5\" y=\"-5\"></rect>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"0\" y2=\"0\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"30\" y2=\"30\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"30\" x2=\"30\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"60\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"60\" x2=\"60\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"90\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"90\" x2=\"90\" y1=\"0\" y2=\"90\"></line>\n<defs>\n<g id=\"rail1\" stroke-width=\"2\">\n<line x1=\"12\" x2=\"12\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"18\" x2=\"18\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"3\" y2=\"3\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"9\" y2=\"9\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"15\" y2=\"15\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"21\" y2=\"21\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"27\" y2=\"27\"></line>\n</g>\n<g fill=\"none\" id=\"rail2\" stroke-width=\"2\">\n<path d=\"M12,0 A12,12 0 0,1 0,12\"></path>\n<path d=\"M18,0 A18,18 0 0,1 0,18\"></path>\n<line x1=\"12\" x2=\"18\" y1=\"2\" y2=\"3\"></line>\n<line x1=\"11\" x2=\"16\" y1=\"5\" y2=\"8\"></line>\n<line x1=\"8\" x2=\"13\" y1=\"8\" y2=\"13\"></line>\n<line x1=\"5\" x2=\"8\" y1=\"11\" y2=\"16\"></line>\n<line x1=\"2\" x2=\"3\" y1=\"12\" y2=\"18\"></line>\n</g>\n</defs>\n<use href=\"#rail1\" stroke=\"silver\" x=\"0\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"30\" y=\"0\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,45,15)\" x=\"30\" y=\"0\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(270,75,15)\" x=\"60\" y=\"0\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" x=\"0\" y=\"30\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,15,45)\" x=\"0\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"30\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,45,45)\" x=\"30\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"60\" y=\"30\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,15,75)\" x=\"0\" y=\"60\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(90,15,75)\" x=\"0\" y=\"60\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"30\" y=\"60\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,75)\" x=\"30\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"60\" y=\"60\"></use>\n</svg>\n</td>\n</tr>\n<tr align=\"center\">\n<td>\nInitial State.\n</td>\n<td>\nAfter rotating the top-right tile and the middle-right tile.\n</td>\n</tr>\n</tbody></table>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given tiles containing railroad lines arranged in a 30 x 30 square.\nThere are 8 types of tiles by distinguishing rotations which are numbered as follows.</p>\n<p><svg height=\"70\" id=\"vis\" viewBox=\"-5 -5 250 70\" width=\"250\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect fill=\"white\" height=\"70\" width=\"250\" x=\"-5\" y=\"-5\"></rect>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"0\" y2=\"0\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"30\" y2=\"30\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"30\" x2=\"30\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"60\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"60\" x2=\"60\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"90\" x2=\"90\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"120\" x2=\"120\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"150\" x2=\"150\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"180\" x2=\"180\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"210\" x2=\"210\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"240\" x2=\"240\" y1=\"0\" y2=\"60\"></line>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"15\" y=\"55\">\n0\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"45\" y=\"55\">\n1\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"75\" y=\"55\">\n2\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"105\" y=\"55\">\n3\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"135\" y=\"55\">\n4\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"165\" y=\"55\">\n5\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"195\" y=\"55\">\n6\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"225\" y=\"55\">\n7\n</text>\n<defs>\n<g id=\"rail1\" stroke-width=\"2\">\n<line x1=\"12\" x2=\"12\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"18\" x2=\"18\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"3\" y2=\"3\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"9\" y2=\"9\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"15\" y2=\"15\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"21\" y2=\"21\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"27\" y2=\"27\"></line>\n</g>\n<g fill=\"none\" id=\"rail2\" stroke-width=\"2\">\n<path d=\"M12,0 A12,12 0 0,1 0,12\"></path>\n<path d=\"M18,0 A18,18 0 0,1 0,18\"></path>\n<line x1=\"12\" x2=\"18\" y1=\"2\" y2=\"3\"></line>\n<line x1=\"11\" x2=\"16\" y1=\"5\" y2=\"8\"></line>\n<line x1=\"8\" x2=\"13\" y1=\"8\" y2=\"13\"></line>\n<line x1=\"5\" x2=\"8\" y1=\"11\" y2=\"16\"></line>\n<line x1=\"2\" x2=\"3\" y1=\"12\" y2=\"18\"></line>\n</g>\n</defs>\n<use href=\"#rail2\" stroke=\"silver\" x=\"0\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,45,15)\" x=\"30\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,75,15)\" x=\"60\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(90,105,15)\" x=\"90\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"120\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,135,15)\" x=\"120\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,165,15)\" x=\"150\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(90,165,15)\" x=\"150\" y=\"0\"></use>\n<use href=\"#rail1\" stroke=\"silver\" transform=\"rotate(90,195,15)\" x=\"180\" y=\"0\"></use>\n<use href=\"#rail1\" stroke=\"silver\" x=\"210\" y=\"0\"></use>\n</svg></p>\n<p>Tiles 0 to 3 contain one curved line, tiles 4 and 5 contain two curved lines, and tiles 6 and 7 contain one straight line.\nEach tile can be rotated every 90 degrees.\nBy rotating a tile 90 degrees counterclockwise, the tile will become as follows.</p>\n<p><svg height=\"70\" id=\"vis\" viewBox=\"-5 -5 250 70\" width=\"250\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect fill=\"white\" height=\"70\" width=\"250\" x=\"-5\" y=\"-5\"></rect>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"0\" y2=\"0\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"30\" y2=\"30\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"30\" x2=\"30\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"240\" y1=\"60\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"60\" x2=\"60\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"90\" x2=\"90\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"120\" x2=\"120\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"150\" x2=\"150\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"180\" x2=\"180\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"210\" x2=\"210\" y1=\"0\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"240\" x2=\"240\" y1=\"0\" y2=\"60\"></line>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"15\" y=\"55\">\n1\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"45\" y=\"55\">\n2\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"75\" y=\"55\">\n3\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"105\" y=\"55\">\n0\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"135\" y=\"55\">\n5\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"165\" y=\"55\">\n4\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"195\" y=\"55\">\n7\n</text>\n<text font-size=\"22\" text-anchor=\"middle\" x=\"225\" y=\"55\">\n6\n</text>\n<defs>\n<g id=\"rail1\" stroke-width=\"2\">\n<line x1=\"12\" x2=\"12\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"18\" x2=\"18\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"3\" y2=\"3\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"9\" y2=\"9\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"15\" y2=\"15\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"21\" y2=\"21\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"27\" y2=\"27\"></line>\n</g>\n<g fill=\"none\" id=\"rail2\" stroke-width=\"2\">\n<path d=\"M12,0 A12,12 0 0,1 0,12\"></path>\n<path d=\"M18,0 A18,18 0 0,1 0,18\"></path>\n<line x1=\"12\" x2=\"18\" y1=\"2\" y2=\"3\"></line>\n<line x1=\"11\" x2=\"16\" y1=\"5\" y2=\"8\"></line>\n<line x1=\"8\" x2=\"13\" y1=\"8\" y2=\"13\"></line>\n<line x1=\"5\" x2=\"8\" y1=\"11\" y2=\"16\"></line>\n<line x1=\"2\" x2=\"3\" y1=\"12\" y2=\"18\"></line>\n</g>\n</defs>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,15,15)\" x=\"0\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,15)\" x=\"30\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(90,75,15)\" x=\"60\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"90\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,135,15)\" x=\"120\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(90,135,15)\" x=\"120\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"150\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,165,15)\" x=\"150\" y=\"0\"></use>\n<use href=\"#rail1\" stroke=\"silver\" x=\"180\" y=\"0\"></use>\n<use href=\"#rail1\" stroke=\"silver\" transform=\"rotate(90,225,15)\" x=\"210\" y=\"0\"></use>\n</svg></p>\n<p>Since there are no branches on the lines, each line is part of a path or cycle.\nA set of lines forming a cycle is called a \"loop line,\" and its length is defined as the number of times to move from a tile to its adjacent tile in a round trip along the loop line.\nFor example, the loop line below consists of 7 tiles, but its length is 8 because it passes through the center tile twice.</p>\n<p><svg height=\"100\" id=\"vis\" viewBox=\"-5 -5 100 100\" width=\"100\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect fill=\"white\" height=\"100\" width=\"100\" x=\"-5\" y=\"-5\"></rect>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"0\" y2=\"0\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"30\" y2=\"30\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"30\" x2=\"30\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"60\" y2=\"60\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"60\" x2=\"60\" y1=\"0\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"0\" x2=\"90\" y1=\"90\" y2=\"90\"></line>\n<line stroke=\"lightgray\" stroke-width=\"1\" x1=\"90\" x2=\"90\" y1=\"0\" y2=\"90\"></line>\n<defs>\n<g id=\"rail1\" stroke-width=\"2\">\n<line x1=\"12\" x2=\"12\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"18\" x2=\"18\" y1=\"0\" y2=\"30\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"3\" y2=\"3\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"9\" y2=\"9\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"15\" y2=\"15\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"21\" y2=\"21\"></line>\n<line x1=\"12\" x2=\"18\" y1=\"27\" y2=\"27\"></line>\n</g>\n<g fill=\"none\" id=\"rail2\" stroke-width=\"2\">\n<path d=\"M12,0 A12,12 0 0,1 0,12\"></path>\n<path d=\"M18,0 A18,18 0 0,1 0,18\"></path>\n<line x1=\"12\" x2=\"18\" y1=\"2\" y2=\"3\"></line>\n<line x1=\"11\" x2=\"16\" y1=\"5\" y2=\"8\"></line>\n<line x1=\"8\" x2=\"13\" y1=\"8\" y2=\"13\"></line>\n<line x1=\"5\" x2=\"8\" y1=\"11\" y2=\"16\"></line>\n<line x1=\"2\" x2=\"3\" y1=\"12\" y2=\"18\"></line>\n</g>\n</defs>\n<use href=\"#rail1\" stroke=\"silver\" x=\"0\" y=\"0\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"30\" y=\"0\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,45,15)\" x=\"30\" y=\"0\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(270,75,15)\" x=\"60\" y=\"0\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" x=\"0\" y=\"30\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,15,45)\" x=\"0\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"30\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(180,45,45)\" x=\"30\" y=\"30\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"60\" y=\"30\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(270,15,75)\" x=\"0\" y=\"60\"></use>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" transform=\"rotate(90,15,75)\" x=\"0\" y=\"60\"></use>\n</g>\n<g>\n<use href=\"#rail2\" stroke=\"brown\" x=\"30\" y=\"60\"></use>\n</g>\n<use href=\"#rail2\" stroke=\"silver\" transform=\"rotate(180,45,75)\" x=\"30\" y=\"60\"></use>\n<use href=\"#rail2\" stroke=\"silver\" x=\"60\" y=\"60\"></use>\n</svg></p>\n<p>Your task is to determine the number of times to rotate each tile.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Scoring</h3><p>Let <var>L_1</var> be the length of the longest loop line obtained by rotating the tiles according to the output, and <var>L_2</var> be the length of the second longest one (<var>L_1=L_2</var> if there is more than one longest one).\nThen, you will get a score of <var>L_1\\times L_2</var>.\nIf the number of loop lines is less than or equal to <var>1</var>, the score for that test case is <var>0</var>.</p>\n<p>There are 100 test cases, and the score of a submission is the total score for each test case. If you get a result other than <span class=\"label label-success\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Accepted\">AC</span> for one or more test cases, the score of the submission will be zero. The highest score obtained during the contest time will determine the final ranking, and there will be no system test after the contest. If more than one participant gets the same score, the ranking will be determined by the submission time of the submission that received that score.</p>\n<p>Hints on how to compute the length of a loop line.\n</p><details>\n<font color=\"red\">\nPseudo code has been updated.\n</font>\nYou can compute the length of a loop line, for example, as follows.\nLet <code>tiles</code> be a two-dimensional array containing the tile states.\nBy numbering the directions 0, 1, 2, 3 in order of left, up, right, and down, the change in coordinates is represented by the arrays <code>di = [0, -1, 0, 1]</code> and <code>dj = [-1, 0, 1, 0]</code>.\nWhen a train enters a tile of state <code>t</code> from its adjacent tile in direction <code>d</code>, let <code>to[t][d]</code> be the direction to the next tile, or <code>-1</code> if the train cannot enter from such a direction, then we obtain the following two-dimensional array.<p></p>\n<pre>to = [\n    [1, 0, -1, -1],\n    [3, -1, -1, 0],\n    [-1, -1, 3, 2],\n    [-1, 2, 1, -1],\n    [1, 0, 3, 2],\n    [3, 2, 1, 0],\n    [2, -1, 0, -1],\n    [-1, 3, -1, 1],\n];\n</pre>\n\n<p>When a train enters tile at position <code>(i, j)</code> from its adjacent tile in direction <code>d</code>, you can update these variables as follows.</p>\n<pre>d2 = to[tiles[i][j]][d]; // Direction to the next tile\nif (d2 == -1) return 0; // The line is broken.\ni += di[d2];\nj += dj[d2];\nif (i &lt; 0 || i &gt;= 30 || j &lt; 0 || j &gt;= 30) return 0; // The line is broken.\nd = (d2 + 2) % 4; // Direction to the previous tile.\n</pre>\n\n<p>After repeating this process until the train returns to its initial position and direction (note that it may pass through the same tile twice), the number of iterations is the length of the loop line.</p>\n<pre>// Suppose that a train enters a tile (si, sj) from direction sd.\ni = si;\nj = sj;\nd = sd;\nlength = 0;\nloop {\n    d2 = to[tiles[i][j]][d];\n    if (d2 == -1) return 0;\n    i += di[d2];\n    j += dj[d2];\n    if (i &lt; 0 || i &gt;= 30 || j &lt; 0 || j &gt;= 30) return 0;\n    d = (d2 + 2) % 4;\n    length += 1;\n    if (i == si &amp;&amp; j == sj &amp;&amp; d == sd) return length;\n}\n</pre>\n\n</details>\n\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>t_{0,0}</var> <var>\\cdots</var> <var>t_{0,29}</var>\n<var>\\vdots</var>\n<var>t_{29,0}</var> <var>\\cdots</var> <var>t_{29,29}</var>\n</pre>\n\n<p>Each <var>t_{i,0}\\cdots t_{i,29}</var> is a string of <var>30</var> characters.\nLet <var>(i,j)</var> denote the <var>i</var>-th <var>(0\\leq i\\leq 29)</var> tile from the top and <var>j</var>-th <var>(0\\leq j\\leq 29)</var> tile from the left.\nThen, <var>t_{i,j}</var> is an integer between <var>0</var> and <var>7</var> representing the state of the tile <var>(i, j)</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Let <var>r_{i,j}</var> (<var>0\\leq r_{i,j}\\leq 3</var>) be the number of times the tile <var>(i,j)</var> is rotated 90 degrees counterclockwise.\nOutput a string of length <var>900</var> such that the <var>30i+j</var>-th character is <var>r_{i,j}</var> in one line to Standard Output.</p>\n<p><a href=\"https://img.atcoder.jp/ahc010/d3a6c91ee76cb8.html?lang=en&amp;show=example\">Show example</a></p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Input Generation</h3><p>Let <var>\\mathrm{rand}(L,U)</var> be a function that generates a uniform random integer between <var>L</var> and <var>U</var>, inclusive.</p>\n<p>Each <var>t_{i,j}</var> is independently generated as follows.</p>\n<ul>\n<li>With probability 25%, <var>t_{i,j}=\\mathrm{rand}(0, 3)</var>.</li>\n<li>With probability 50%, <var>t_{i,j}=\\mathrm{rand}(4, 5)</var>.</li>\n<li>With probability 25%, <var>t_{i,j}=\\mathrm{rand}(6, 7)</var>.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Tools (Input generator and visualizer)</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc010/d3a6c91ee76cb8.html?lang=en\">Web version</a>: This is more powerful than the local version and can display animations.</li>\n<li><a href=\"https://img.atcoder.jp/ahc010/d3a6c91ee76cb8.zip\">Local version</a>: You need a compilation environment of <a href=\"https://www.rust-lang.org/\">Rust language</a>.<ul>\n<li><a href=\"https://img.atcoder.jp/ahc010/d3a6c91ee76cb8_windows.zip\">Pre-compiled binary for Windows</a>: If you are not familiar with the Rust language environment, please use this instead.</li>\n</ul>\n</li>\n</ul>\n<p><font color=\"red\"><strong>Sharing visualization results is not allowed until the end of the contest. </strong></font></p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">436204751575440756541724746755\n347475575404531645424640344414\n556644445442451553264555436757\n761235545455474254546631467555\n356447405421445153457656535564\n014274425356522445253477726464\n311765446655556346633757446600\n471744514426443445162555525455\n616053450444473274742055767455\n254124557527462423444450075637\n046546764557475436717475255501\n752005462554554414031525515356\n452524742177476245065554577605\n664465643742341605007655253777\n444571276444165545442447340356\n435050335454565235025507452540\n467560030465475447567644441426\n735730577745561712541450443547\n472675153755474445700540444544\n507472724556677621365747544757\n535177720776402476665547676174\n636275455643650141456764547131\n164624553536572554544165746536\n521574724335644274433544442556\n576732703453654464555315065544\n656244747015464523316444145414\n555646775254464367454454067475\n665624154657072514445150474444\n570004746554540445465051654541\n635504417414262014475547424275\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/ahc010/tasks/ahc010_a"}