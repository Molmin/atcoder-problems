{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>700</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>全ての要素が <var>1</var> 以上 <var>N</var> 以下である長さ <var>N</var> の整数列 <var>X=(X_1,X_2,\\dots,X_N)</var> に対して次の問題を考え、その答えを <var>f(X)</var> とします。</p>\n<blockquote>\n    <var>N</var> 頂点の無向グラフ <var>G</var> があります。(<var>G</var> は多重辺や自己ループを含むことがあります。) <var>G</var> の辺は <var>N</var> 本あり、そのうち <var>i</var> 番目の辺は頂点 <var>i</var> と頂点 <var>X_i</var> を繋ぐ辺です。<var>G</var> の連結成分の個数を求めてください。\n</blockquote>\n\n<p>長さ <var>N</var> の整数列 <var>A=(A_1,A_2,\\dots,A_N)</var> が与えられます。各 <var>A_i</var> は <var>1</var> 以上 <var>N</var> 以下の整数あるいは <var>-1</var> です。</p>\n<p>全ての要素が <var>1</var> 以上 <var>N</var> 以下である長さ <var>N</var> の整数列 <var>X=(X_1,X_2,\\dots,X_N)</var> であって、<var>A_i \\neq -1 \\Rightarrow A_i = X_i</var> を満たすものを考えます。そのような全ての <var>X</var> に対する <var>f(X)</var> の総和を <var>998244353</var> で割ったあまりを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n    <li><var>1 \\le N \\le 2000</var></li>\n    <li><var>A_i</var> は <var>1</var> 以上 <var>N</var> 以下あるいは <var>-1</var> である。</li>\n    <li>入力は全て整数である。</li>\n</ul>\n\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>A_1</var> <var>A_2</var> <var>\\dots</var> <var>A_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n-1 1 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>5\n</pre>\n<p><var>X</var> として条件を満たすものは以下の <var>3</var> 通りがあります。</p>\n<ul>\n    <li><var>X=(1,1,3)</var> の時、問題の答えは <var>2</var> です。</li>\n    <li><var>X=(2,1,3)</var> の時、問題の答えは <var>2</var> です。</li>\n    <li><var>X=(3,1,3)</var> の時、問題の答えは <var>1</var> です。</li>\n</ul>\n\n<p>よって答えは <var>2+2+1=5</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>1\n1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>8\n-1 3 -1 -1 8 -1 -1 -1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>433760\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>700</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>For an integer sequence <var>X=(X_1,X_2,\\dots,X_N)</var> of length <var>N</var> whose elements are all between <var>1</var> and <var>N</var> (inclusive), consider the question below, and let <var>f(X)</var> be the answer.</p>\n<blockquote>\n    There is an undirected graph <var>G</var> with <var>N</var> vertices (and possibly multi-edges and self-loops). <var>G</var> has <var>N</var> edges, the <var>i</var>-th of which connects Vertex <var>i</var> and Vertex <var>X_i</var>. Find the number of connected components in <var>G</var>.\n</blockquote>\n\n<p>You are given an integer sequence <var>A=(A_1,A_2,\\dots,A_N)</var> of length <var>N</var>, where each <var>A_i</var> is an integer between <var>1</var> and <var>N</var> (inclusive) or <var>-1</var>.</p>\n<p>Consider an integer sequence <var>X=(X_1,X_2,\\dots,X_N)</var> of length <var>N</var> whose elements are all between <var>1</var> and <var>N</var> such that <var>A_i \\neq -1 \\Rightarrow A_i = X_i</var>. Find the sum of <var>f(X)</var> over all such <var>X</var>, modulo <var>998244353</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n    <li><var>1 \\le N \\le 2000</var></li>\n    <li><var>A_i</var> is between <var>1</var> and <var>N</var> (inclusive) or <var>-1</var>.</li>\n    <li>All values in input are integers.</li>\n</ul>\n\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>A_1</var> <var>A_2</var> <var>\\dots</var> <var>A_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Prin the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n-1 1 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>5\n</pre>\n<p>There are three sequences <var>X</var> satisfying the requirement, as follows.</p>\n<ul>\n    <li><var>X=(1,1,3)</var>, for which the answer to the question is <var>2</var>.</li>\n    <li><var>X=(2,1,3)</var>, for which the answer to the question is <var>2</var>.</li>\n    <li><var>X=(3,1,3)</var>, for which the answer to the question is <var>1</var>.</li>\n</ul>\n\n<p>Thus, the answer is <var>2+2+1=5</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>1\n1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>8\n-1 3 -1 -1 8 -1 -1 -1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>433760\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc140/tasks/arc140_d"}