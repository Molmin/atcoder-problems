{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>700</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 頂点からなる根付き二分木があり、各頂点には <var>1</var> から <var>N</var> までの番号がついています。\n頂点 <var>1</var> が根であり、頂点 <var>i</var> (<var>i \\geqq 2</var>) の親は頂点 <var>\\left[ \\frac{i}{2} \\right]</var> です。</p>\n<p>各頂点には <var>1</var> つのアイテムがあります。頂点 <var>i</var> にあるアイテムの価値は <var>V_i</var> であり、重さは <var>W_i</var> です。\nそこで、次のクエリに <var>Q</var> 回答えてください。</p>\n<ul>\n<li>二分木の頂点 <var>v</var> 及び正の整数 <var>L</var> が与えられる。\n  <var>v</var> 及び <var>v</var> の先祖にあるアイテムを、重さの合計が <var>L</var> 以下となるようにいくつか（<var>0</var> 個でもよい）選ぶ。\n  このとき、選んだアイテムの価値の総和の最大値を求めよ。</li>\n</ul>\n<p>ただし、頂点 <var>u</var> が頂点 <var>v</var> の先祖であるとは、頂点 <var>u</var> が頂点 <var>v</var> の間接的な親である、つまり、\n<var>w_1=v</var>、<var>w_k=u</var>、さらに各 <var>i</var> について <var>w_{i+1}</var> が <var>w_i</var> の親となるような頂点の列 <var>w_1,w_2,\\ldots,w_k</var> (<var>k\\geqq 2</var>) が存在することを指します。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leqq N &lt; 2^{18}</var></li>\n<li><var>1 \\leqq Q \\leqq 10^5</var></li>\n<li><var>1 \\leqq V_i \\leqq 10^5</var></li>\n<li><var>1 \\leqq W_i \\leqq 10^5</var></li>\n<li>各クエリで指定される <var>v</var>, <var>L</var> は <var>1 \\leqq v \\leqq N</var>, <var>1 \\leqq L \\leqq 10^5</var> を満たす。</li>\n<li>入力で与えられる値はすべて整数である。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p><var>i</var> 回目のクエリで指定される <var>v</var>, <var>L</var> をそれぞれ <var>v_i</var>, <var>L_i</var> とする。\nこのとき、入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>V_1</var> <var>W_1</var>\n<var>:</var>\n<var>V_N</var> <var>W_N</var>\n<var>Q</var>\n<var>v_1</var> <var>L_1</var>\n<var>:</var>\n<var>v_Q</var> <var>L_Q</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>1</var> から <var>Q</var> までの各整数 <var>i</var> について、\n<var>i</var> 回目のクエリに対する答えを <var>i</var> 行目に出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n1 2\n2 3\n3 4\n3\n1 1\n2 5\n3 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>0\n3\n3\n</pre>\n\n<p>最初のクエリでは、選ぶことのできるアイテムは <var>(V,W)=(1,2)</var> なるアイテムのみであるので、\n<var>L=1</var> より <var>1</var> つもアイテムを選ぶことができません。\nしたがって、答えは <var>0</var> になります。</p>\n<p>一方で <var>2</var> 番目のクエリでは、選ぶことのできるアイテムは <var>(V,W)=(1,2)</var> なるアイテムと <var>(V,W)=(2,3)</var> なるアイテムの <var>2</var> つであり、\n<var>L=5</var> より両方を選ぶことができます。\nしたがって、答えは <var>3</var> になります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>15\n123 119\n129 120\n132 112\n126 109\n118 103\n115 109\n102 100\n130 120\n105 105\n132 115\n104 102\n107 107\n127 116\n121 104\n121 115\n8\n8 234\n9 244\n10 226\n11 227\n12 240\n13 237\n14 206\n15 227\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>256\n255\n250\n247\n255\n259\n223\n253\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>700</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have a rooted binary tree with <var>N</var> vertices, where the vertices are numbered <var>1</var> to <var>N</var>.\nVertex <var>1</var> is the root, and the parent of Vertex <var>i</var> (<var>i \\geq 2</var>) is Vertex <var>\\left[ \\frac{i}{2} \\right]</var>.</p>\n<p>Each vertex has one item in it. The item in Vertex <var>i</var> has a value of <var>V_i</var> and a weight of <var>W_i</var>.\nNow, process the following query <var>Q</var> times:</p>\n<ul>\n<li>Given are a vertex <var>v</var> of the tree and a positive integer <var>L</var>.\n  Let us choose some (possibly none) of the items in <var>v</var> and the ancestors of <var>v</var> so that their total weight is at most <var>L</var>.\n  Find the maximum possible total value of the chosen items.</li>\n</ul>\n<p>Here, Vertex <var>u</var> is said to be an ancestor of Vertex <var>v</var> when <var>u</var> is an indirect parent of <var>v</var>, that is, there exists a sequence of vertices <var>w_1,w_2,\\ldots,w_k</var> (<var>k\\geq 2</var>) where <var>w_1=v</var>, <var>w_k=u</var>, and <var>w_{i+1}</var> is the parent of <var>w_i</var> for each <var>i</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li>All values in input are integers.</li>\n<li><var>1 \\leq N &lt; 2^{18}</var></li>\n<li><var>1 \\leq Q \\leq 10^5</var></li>\n<li><var>1 \\leq V_i \\leq 10^5</var></li>\n<li><var>1 \\leq W_i \\leq 10^5</var></li>\n<li>For the values <var>v</var> and <var>L</var> given in each query, <var>1 \\leq v \\leq N</var> and <var>1 \\leq L \\leq 10^5</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Let <var>v_i</var> and <var>L_i</var> be the values <var>v</var> and <var>L</var> given in the <var>i</var>-th query.\nThen, Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>V_1</var> <var>W_1</var>\n<var>:</var>\n<var>V_N</var> <var>W_N</var>\n<var>Q</var>\n<var>v_1</var> <var>L_1</var>\n<var>:</var>\n<var>v_Q</var> <var>L_Q</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>For each integer <var>i</var> from <var>1</var> through <var>Q</var>,\nthe <var>i</var>-th line should contain the response to the <var>i</var>-th query.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n1 2\n2 3\n3 4\n3\n1 1\n2 5\n3 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>0\n3\n3\n</pre>\n\n<p>In the first query, we are given only one choice: the item with <var>(V, W)=(1,2)</var>. Since <var>L = 1</var>, we cannot actually choose it, so our response should be <var>0</var>.</p>\n<p>In the second query, we are given two choices: the items with <var>(V, W)=(1,2)</var> and <var>(V, W)=(2,3)</var>. Since <var>L = 5</var>, we can choose both of them, so our response should be <var>3</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>15\n123 119\n129 120\n132 112\n126 109\n118 103\n115 109\n102 100\n130 120\n105 105\n132 115\n104 102\n107 107\n127 116\n121 104\n121 115\n8\n8 234\n9 244\n10 226\n11 227\n12 240\n13 237\n14 206\n15 227\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>256\n255\n250\n247\n255\n259\n223\n253\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/tokiomarine2020/tasks/tokiomarine2020_d"}