{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>キャベツ農家の高橋君は、品種 <var>1</var> から品種 <var>N</var> までの <var>N</var> 種類のキャベツを育てました。高橋君は品種 <var>i</var> <var>(1 \\leq i \\leq N)</var> のキャベツを <var>A_i</var> 個持っています。ここで、 <strong>すべてのキャベツは区別できます。</strong><br>\nキャベツの卸先として会社 <var>1</var> から会社 <var>M</var> までの <var>M</var> 個の会社があり、会社 <var>j</var> <var>(1 \\leq j \\leq M)</var> からは <var>B_j</var> 個のキャベツの注文を受けています。<br>\n出荷できるキャベツの品種は会社ごとに異なっており、すべての <var>i, j</var> の組 <var>(1 \\leq i \\leq N, 1 \\leq j \\leq M)</var> について</p>\n<ul>\n<li><var>c_{i, j} = 1</var> のとき、品種 <var>i</var> のキャベツを会社 <var>j</var> に出荷できます。</li>\n<li><var>c_{i, j} = 0</var> のとき、品種 <var>i</var> のキャベツを会社 <var>j</var> に出荷できません。</li>\n</ul>\n<p>高橋君は、すべてのキャベツの出荷先を適切に決めることで、すべての会社 <var>j</var> <var>(1 \\leq j \\leq M)</var> にキャベツを <var>B_j</var> 個以上出荷することができれば「キャベツ名人」の称号を得ることができます。</p>\n<p>すぬけ君は、高橋君がどのようにキャベツの出荷先を決めても「キャベツ名人」の称号を得られないように <var>0</var> 個以上のキャベツを選んで食べることにしました。キャベツが苦手なすぬけ君は、前述の条件のもとで食べるキャベツの個数が <strong>最少</strong> となるように食べるキャベツの組み合わせを選択します。</p>\n<p>すぬけ君が食べるキャベツの個数、およびすぬけ君が食べるキャベツの選び方が何通りあるかを <var>998244353</var> で割ったあまりの <var>2</var> つを出力してください。<br>\nただし、 キャベツの選び方が異なるとは、一方の選び方で食べられたがもう一方の選び方で食べられていないようなキャベツが存在することをいいます。ここで、異なる <var>2</var> つのキャベツは <strong>品種が同じでも区別される</strong> ことに注意してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 20</var></li>\n<li><var>1 \\leq M \\leq 10^4</var></li>\n<li><var>1 \\leq A_i \\leq 10^5</var></li>\n<li><var>1 \\leq B_j \\leq 10^5</var></li>\n<li><var>c_{i, j} \\in \\lbrace 0, 1 \\rbrace</var></li>\n<li>任意の <var>1 \\leq j \\leq M</var> に対して、ある <var>1 \\leq i \\leq N</var> が存在して <var>c_{i, j} = 1</var> が成り立つ</li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>A_1</var> <var>A_2</var> <var>\\ldots</var> <var>A_N</var>\n<var>B_1</var> <var>B_2</var> <var>\\ldots</var> <var>B_M</var>\n<var>c_{1, 1}</var> <var>c_{1, 2}</var> <var>\\ldots</var> <var>c_{1, M}</var>\n<var>c_{2, 1}</var> <var>c_{2, 2}</var> <var>\\ldots</var> <var>c_{2, M}</var>\n<var>\\vdots</var>\n<var>c_{N, 1}</var> <var>c_{N, 2}</var> <var>\\ldots</var> <var>c_{N, M}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>すぬけ君が食べるキャベツの個数 <var>X</var> と、すぬけ君が食べるキャベツの選び方が何通りあるかを <var>998244353</var> で割ったあまり <var>Y</var> を、この順番に空白区切りで出力せよ。</p>\n<pre><var>X</var> <var>Y</var>\n</pre>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 2\n2 2 5\n3 4\n1 0\n1 1\n0 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2 6\n</pre>\n<p>高橋君がキャベツ名人になれないようにするために、すぬけ君が食べるキャベツの個数は <var>2</var> 個です。\nまた、便宜上 「品種 <var>i</var> の <var>j</var> 番目のキャベツ」を <var>(i,j)</var> のように表したとき、すぬけ君が食べるキャベツの組み合わせとして考えられるものは以下の <var>6</var> 通りです。</p>\n<ul>\n<li><var>(1, 1), (1, 2)</var></li>\n<li><var>(1, 1), (2, 1)</var></li>\n<li><var>(1, 1), (2, 2)</var></li>\n<li><var>(1, 2), (2, 1)</var></li>\n<li><var>(1, 2), (2, 2)</var></li>\n<li><var>(2, 1), (2, 2)</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>1 1\n3\n4\n1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0 1\n</pre>\n<p>すぬけ君がキャベツを <var>1</var> 個も食べなくても、高橋君がキャベツ名人になることができない場合もあります。<br>\nこのとき、すぬけ君が食べるキャベツの個数は <var>0</var> 個であり、すぬけ君が食べるキャベツの組み合わせとして考えられるのは、「どのキャベツも食べない」という <var>1</var> 通りのみです。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>1 3\n100\n30 30 30\n1 1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>11 892328666\n</pre>\n<p>すぬけ君が食べるキャベツの選び方が何通りあるかについては、 <var>998244353</var> で割ったあまりを出力することに注意してください。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Takahashi, a cabbage farmer, has grown <var>N</var> brands of cabbages, called Brand <var>1</var> through Brand <var>N</var>. He has <var>A_i</var> heads of cabbage of Brand <var>i</var> <var>(1 \\leq i \\leq N)</var>. Here, <strong>all heads of cabbages are distinguishable.</strong><br>\nHe has <var>M</var> clients called Company <var>1</var> through Company <var>M</var>. Company <var>j</var> <var>(1 \\leq j \\leq M)</var> has ordered <var>B_j</var> heads of cabbages.<br>\nDifferent companies accept different brands of cabbages. For each pair <var>i, j</var> <var>(1 \\leq i \\leq N, 1 \\leq j \\leq M)</var>,</p>\n<ul>\n<li>if <var>c_{i, j} = 1</var>, cabbage of Brand <var>i</var> can be shipped to Company <var>j</var>;</li>\n<li>if <var>c_{i, j} = 0</var>, cabbage of Brand <var>i</var> cannot be shipped to Company <var>j</var>.</li>\n</ul>\n<p>Takahashi will be called a Cabbage Master if he succeeds in deciding where to ship the heads of cabbages so that <var>B_j</var> or more heads of cabbages will be shipped to every company <var>j</var> <var>(1 \\leq j \\leq M)</var>.</p>\n<p>Snuke has decided to choose and eat zero or more heads of cabbages so that Takahashi cannot get the title of Cabbage Master, regardless of where to ship his cabbages. He does not like cabbage very much, so he will choose to eat the <strong>minimum</strong> number of heads of cabbages needed to achieve his objective.</p>\n<p>Print the number of heads of cabbages Snuke will eat, and the number of ways, modulo <var>998244353</var>, for Snuke to choose heads of cabbages to eat. Two ways to choose heads of cabbages are considered different when there is a head of cabbage that is eaten in one way but not in the other. Here, remember that any two heads of cabbages are <strong>distinguishable even if they are of the same brand</strong>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 20</var></li>\n<li><var>1 \\leq M \\leq 10^4</var></li>\n<li><var>1 \\leq A_i \\leq 10^5</var></li>\n<li><var>1 \\leq B_j \\leq 10^5</var></li>\n<li><var>c_{i, j} \\in \\lbrace 0, 1 \\rbrace</var></li>\n<li>For every <var>1 \\leq j \\leq M</var>, there exists <var>1 \\leq i \\leq N</var> such that <var>c_{i, j} = 1</var>.</li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>A_1</var> <var>A_2</var> <var>\\ldots</var> <var>A_N</var>\n<var>B_1</var> <var>B_2</var> <var>\\ldots</var> <var>B_M</var>\n<var>c_{1, 1}</var> <var>c_{1, 2}</var> <var>\\ldots</var> <var>c_{1, M}</var>\n<var>c_{2, 1}</var> <var>c_{2, 2}</var> <var>\\ldots</var> <var>c_{2, M}</var>\n<var>\\vdots</var>\n<var>c_{N, 1}</var> <var>c_{N, 2}</var> <var>\\ldots</var> <var>c_{N, M}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>X</var>, the number of heads of cabbages Snuke will eat, and <var>Y</var>, the number of ways for Snuke to choose heads of cabbages to eat, modulo <var>998244353</var>, in this order, with a space in between.</p>\n<pre><var>X</var> <var>Y</var>\n</pre>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 2\n2 2 5\n3 4\n1 0\n1 1\n0 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2 6\n</pre>\n<p>Snuke will eat two heads of cabbages to prevent Takahashi from becoming a Cabbage Master. There are six such ways to choose heads of cabbages to eat, as shown below, where <var>(i, j)</var> denotes the <var>j</var>-th head of cabbage of Brand <var>i</var>.</p>\n<ul>\n<li><var>(1, 1), (1, 2)</var></li>\n<li><var>(1, 1), (2, 1)</var></li>\n<li><var>(1, 1), (2, 2)</var></li>\n<li><var>(1, 2), (2, 1)</var></li>\n<li><var>(1, 2), (2, 2)</var></li>\n<li><var>(2, 1), (2, 2)</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>1 1\n3\n4\n1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0 1\n</pre>\n<p>It is possible that Takahashi is unable to become a Cabbage Master even if Snuke eats no cabbage.\nThen, Snuke will eat zero heads of cabbages, and there is just one way for him to choose heads of cabbages to eat: do not eat anything.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>1 3\n100\n30 30 30\n1 1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>11 892328666\n</pre>\n<p>For the number of ways for Snuke to choose heads of cabbages to eat, be sure to print it modulo <var>998244353</var>.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc215/tasks/abc215_h"}