{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1000</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>H</var> 行 <var>W</var> 列からなる盤面があり，各マスには <code>0</code> か <code>1</code> が書き込まれています．\n盤面の状態は <var>H</var> 個の文字列 <var>S_1,S_2,\\cdots,S_H</var> で表され，\n<var>S_i</var> の <var>j</var> 文字目が，上から <var>i</var> 行目，左から <var>j</var> 列目のマスに書かれている数字を表します．</p>\n<p>すぬけくんはこれから，次の操作を繰り返します．</p>\n<ul>\n<li>一つのマス目を一様ランダムに選ぶ．\nそして，そのマス目に書かれている値を flip する．（つまり，<code>0</code> ならば <code>1</code> に変え，<code>1</code> ならば <code>0</code> に変える）</li>\n</ul>\n<p>ところで，すぬけ君は整数列 <var>A=(A_1,A_2,\\cdots,A_H)</var> が大好きです．\nそのため，以下の条件が満たされた瞬間，操作を終了します．</p>\n<ul>\n<li>すべての <var>i</var> (<var>1 \\leq i \\leq H</var>) について，<var>i</var> 行目にある <code>1</code> の個数がちょうど <var>A_i</var> である．</li>\n</ul>\n<p>特に，操作を <var>0</var> 回しか行わないこともありえます．</p>\n<p>すぬけくんが行う操作回数の期待値を <var>\\text{mod }{998244353}</var> で求めてください．</p>\n<details><summary>期待値 <var>\\text{mod }{998244353}</var> の定義</summary><p>\n\n求める期待値は必ず有理数になることが証明できます。 また、この問題の制約のもとでは、その値を既約分数 <var>\\frac{P}{Q}</var> で表した時、<var>Q \\not \\equiv 0 \\pmod{998244353}</var> となることも証明できます。 よって、<var>R \\times Q \\equiv P \\pmod{998244353}, 0 \\leq R &lt; 998244353</var> を満たす整数 <var>R</var> が一意に定まります。 この <var>R</var> を答えてください。\n\n</p></details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq H,W \\leq 50</var></li>\n<li><var>S_i</var> は <code>0</code>, <code>1</code> からなる長さ <var>W</var> の文字列</li>\n<li><var>0 \\leq A_i \\leq W</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる．</p>\n<pre><var>H</var> <var>W</var>\n<var>S_1</var>\n<var>S_2</var>\n<var>\\vdots</var>\n<var>S_H</var>\n<var>A_1</var> <var>A_2</var> <var>\\cdots</var> <var>A_H</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ．</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>1 2\n01\n0\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>3\n</pre>\n<p>操作の様子は以下のようになります．</p>\n<ul>\n<li>確率 <var>1/2</var> で <code>1</code> の書かれたマスを flip する．<var>1</var> 行目にある <code>1</code> の個数が <var>0</var> になり，操作が終了する．</li>\n<li>確率 <var>1/2</var> で <code>0</code> の書かれたマスを flip する．<var>1</var> 行目にある <code>1</code> の個数は <var>2</var> になり，操作は継続する．<ul>\n<li>いずれかのマスを flip する．flip したマスに依らず，<var>1</var> 行目にある <code>1</code> の個数は <var>1</var> になり，操作は継続する．<ul>\n<li>確率 <var>1/2</var> で <code>1</code> の書かれたマスを flip する．<var>1</var> 行目にある <code>1</code> の個数が <var>0</var> になり，操作が終了する．</li>\n<li>確率 <var>1/2</var> で <code>0</code> の書かれたマスを flip する．<var>1</var> 行目にある <code>1</code> の個数は <var>2</var> になり，操作は継続する．</li>\n<li><var>\\vdots</var></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>操作回数の期待値は <var>3</var> になります．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 3\n000\n100\n110\n0 1 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>2 2\n00\n01\n1 0\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>332748127\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>5 4\n1101\n0000\n0010\n0100\n1111\n1 3 3 2 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>647836743\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1000</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have a checkerboard with <var>H</var> rows and <var>W</var> columns, where each square has a <code>0</code> or <code>1</code> written on it.\nThe current state of checkerboard is represented by <var>H</var> strings <var>S_1,S_2,\\cdots,S_H</var>: the <var>j</var>-th character of <var>S_i</var> represents the digit in the square at the <var>i</var>-th row from the top and <var>j</var>-th column from the left.</p>\n<p>Snuke will repeat the following operation.</p>\n<ul>\n<li>Choose one square uniformly at random.\nThen, flip the value written in that square. (In other words, change <code>0</code> to <code>1</code> and vice versa.)</li>\n</ul>\n<p>By the way, he loves an integer sequence <var>A=(A_1,A_2,\\cdots,A_H)</var>, so he will terminate the process at the moment when the following condition is satisfied.</p>\n<ul>\n<li>For every <var>i</var> (<var>1 \\leq i \\leq H</var>), the <var>i</var>-th row from the top contains exactly <var>A_i</var> <code>1</code>s.</li>\n</ul>\n<p>Particularly, he may do zero operations.</p>\n<p>Find the expected value of the number of operations Snuke does, modulo <var>998244353</var>.</p>\n<details><summary>Definition of the expected value modulo <var>998244353</var></summary><p>\n\nIt can be proved that the sought expected value is always a rational number. Additionally, under the Constraints of this problem, when that value is represented as an irreducible fraction <var>\\frac{P}{Q}</var>, it can also be proved that <var>Q \\not \\equiv 0 \\pmod{998244353}</var>. Thus, there uniquely exists an integer <var>R</var> such that <var>R \\times Q \\equiv P \\pmod{998244353}, 0 \\leq R &lt; 998244353</var>. Find this <var>R</var>.\n\n</p></details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq H,W \\leq 50</var></li>\n<li><var>S_i</var> is a string of length <var>W</var> consisting of <code>0</code>, <code>1</code>.</li>\n<li><var>0 \\leq A_i \\leq W</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>H</var> <var>W</var>\n<var>S_1</var>\n<var>S_2</var>\n<var>\\vdots</var>\n<var>S_H</var>\n<var>A_1</var> <var>A_2</var> <var>\\cdots</var> <var>A_H</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>1 2\n01\n0\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>3\n</pre>\n<p>The process goes as follows.</p>\n<ul>\n<li>With probability <var>1/2</var>, a square with <code>1</code> is flipped. The <var>1</var>-st row now contains zero <code>1</code>s, terminating the process.</li>\n<li>With probability <var>1/2</var>, a square with <code>0</code> is flipped. The <var>1</var>-st row now contains two <code>1</code>s, continuing the process.<ul>\n<li>One of the squares is flipped. Regardless of which square is flipped, the <var>1</var>-st row now contains one <code>1</code>, continuing the process.<ul>\n<li>With probability <var>1/2</var>, a square with <code>1</code> is flipped. The <var>1</var>-st row now contains zero <code>1</code>s, terminating the process.</li>\n<li>With probability <var>1/2</var>, a square with <code>0</code> is flipped. The <var>1</var>-st row now contains two <code>1</code>s, continuing the process.</li>\n<li><var>\\vdots</var></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>The expected value of the number of operations is <var>3</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 3\n000\n100\n110\n0 1 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>2 2\n00\n01\n1 0\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>332748127\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>5 4\n1101\n0000\n0010\n0100\n1111\n1 3 3 2 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>647836743\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc136/tasks/arc136_f"}