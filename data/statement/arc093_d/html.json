{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1100</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>2^N</var> 人の選手がおり、それぞれ <var>1, 2, ..., 2^N</var> の番号がついています。\nこれらの選手でトーナメントを行うことにしました。</p>\n<p>トーナメントは以下のようにして行われます。</p>\n<ul>\n<li><var>1, 2, ..., 2^N</var> の置換 <var>p_1, p_2, ..., p_{2^N}</var> を選ぶ。</li>\n<li>選手たちが選手 <var>p_1</var>, 選手 <var>p_2</var>, <var>...</var>, 選手 <var>p_{2^N}</var> の順に一列に並ぶ。</li>\n<li>列に残っている選手が <var>1</var> 人だけになるまで、以下を繰り返す。<ul>\n<li>列の前から <var>1</var> 番目と <var>2</var> 番目、<var>3</var> 番目と <var>4</var> 番目、<var>...</var> の選手が対戦を行う。\n負けた選手は列から離れる。勝った選手たちは相対順序を保ったまま改めて一列に並ぶ。</li>\n</ul>\n</li>\n<li>最後まで残った選手が優勝である。</li>\n</ul>\n<p><var>2</var> 人の選手が対戦したときの結果は、入力として与えられる <var>M</var> 個の\n整数 <var>A_1, A_2, ..., A_M</var> を用いて以下のように書けることが分かっています。</p>\n<ul>\n<li>ある <var>i</var> について <var>y = A_i</var> のとき、選手 <var>1</var> と選手 <var>y</var> (<var>2 \\leq y \\leq 2^N</var>) が対戦すると選手 <var>y</var> が勝つ。</li>\n<li>どの <var>i</var> についても <var>y \\neq A_i</var> のとき、選手 <var>1</var> と選手 <var>y</var> (<var>2 \\leq y \\leq 2^N</var>) が対戦すると選手 <var>1</var> が勝つ。</li>\n<li><var>2 \\leq x &lt; y \\leq 2^N</var> のとき、選手 <var>x</var> と選手 <var>y</var> が対戦すると選手 <var>x</var> が勝つ。</li>\n</ul>\n<p>このトーナメントの優勝者は、最初に選ぶ置換 <var>p_1, p_2, ..., p_{2^N}</var> だけに依存します。\nトーナメントを行う際に最初に選ぶ置換 <var>p_1, p_2, ..., p_{2^N}</var> であって、\nトーナメントの結果選手 <var>1</var> が優勝するようなものの個数を <var>10^9 + 7</var> で割ったあまりを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 16</var></li>\n<li><var>0 \\leq M \\leq 16</var></li>\n<li><var>2 \\leq A_i \\leq 2^N</var> (<var>1 \\leq i \\leq M</var>)</li>\n<li><var>A_i &lt; A_{i + 1}</var> (<var>1 \\leq i &lt; M</var>)</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>A_1</var> <var>A_2</var> <var>...</var> <var>A_M</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2 1\n3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>8\n</pre>\n\n<p>条件を満たす <var>p</var> としては <var>[1, 4, 2, 3]</var> や <var>[3, 2, 1, 4]</var> などが、条件を満たさない <var>p</var> としては <var>[1, 2, 3, 4]</var> や <var>[1, 3, 2, 4]</var> などがあります。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>4 3\n2 4 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>3 0\n\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>40320\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>3 3\n3 4 7\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>2688\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 5</h3><pre>16 16\n5489 5490 5491 5492 5493 5494 5495 5497 18993 18995 18997 18999 19000 19001 19002 19003\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 5</h3><pre>816646464\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1100</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>2^N</var> players, numbered <var>1, 2, ..., 2^N</var>.\nThey decided to hold a tournament.</p>\n<p>The tournament proceeds as follows:</p>\n<ul>\n<li>Choose a permutation of <var>1, 2, ..., 2^N</var>: <var>p_1, p_2, ..., p_{2^N}</var>.</li>\n<li>The players stand in a row in the order of Player <var>p_1</var>, Player <var>p_2</var>, <var>...</var>, Player <var>p_{2^N}</var>.</li>\n<li>Repeat the following until there is only one player remaining in the row:<ul>\n<li>Play the following matches: the first player in the row versus the second player in the row, the third player versus the fourth player, and so on. The players who lose leave the row. The players who win stand in a row again, preserving the relative order of the players.</li>\n</ul>\n</li>\n<li>The last player who remains in the row is the champion.</li>\n</ul>\n<p>It is known that, the result of the match between two players can be written as follows, using <var>M</var> integers <var>A_1, A_2, ..., A_M</var> given as input:</p>\n<ul>\n<li>When <var>y = A_i</var> for some <var>i</var>, the winner of the match between Player <var>1</var> and Player <var>y</var> (<var>2 \\leq y \\leq 2^N</var>) will be Player <var>y</var>.</li>\n<li>When <var>y \\neq A_i</var> for every <var>i</var>, the winner of the match between Player <var>1</var> and Player <var>y</var> (<var>2 \\leq y \\leq 2^N</var>) will be Player <var>1</var>.</li>\n<li>When <var>2 \\leq x &lt; y \\leq 2^N</var>, the winner of the match between Player <var>x</var> and Player <var>y</var> will be Player <var>x</var>.</li>\n</ul>\n<p>The champion of this tournament depends only on the permutation <var>p_1, p_2, ..., p_{2^N}</var> chosen at the beginning.\nFind the number of permutation <var>p_1, p_2, ..., p_{2^N}</var> chosen at the beginning of the tournament that would result in Player <var>1</var> becoming the champion, modulo <var>10^9 + 7</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 16</var></li>\n<li><var>0 \\leq M \\leq 16</var></li>\n<li><var>2 \\leq A_i \\leq 2^N</var> (<var>1 \\leq i \\leq M</var>)</li>\n<li><var>A_i &lt; A_{i + 1}</var> (<var>1 \\leq i &lt; M</var>)</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>A_1</var> <var>A_2</var> <var>...</var> <var>A_M</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2 1\n3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>8\n</pre>\n\n<p>Examples of <var>p</var> that satisfy the condition are: <var>[1, 4, 2, 3]</var> and <var>[3, 2, 1, 4]</var>. Examples of <var>p</var> that do not satisfy the condition are: <var>[1, 2, 3, 4]</var> and <var>[1, 3, 2, 4]</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>4 3\n2 4 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>3 0\n\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>40320\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>3 3\n3 4 7\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>2688\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 5</h3><pre>16 16\n5489 5490 5491 5492 5493 5494 5495 5497 18993 18995 18997 18999 19000 19001 19002 19003\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 5</h3><pre>816646464\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc093/tasks/arc093_d"}