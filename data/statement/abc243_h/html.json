{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>縦横 <var>H \\times W</var> マスのグリッドがあります。上から <var>i</var> 行目、左から <var>j</var> 列目のマスを <var>(i,j)</var> と表します。<br>\n各マスの状態は <var>C_{i,j}</var> で表されます。各マスの状態は次の <var>4</var> つのいずれかです。</p>\n<ul>\n<li><code>S</code> : スタート地点。グリッド上にちょうど <var>1</var> つだけ存在する。</li>\n<li><code>G</code> : ゴール地点。グリッド上にちょうど <var>1</var> つだけ存在する。</li>\n<li><code>.</code> : 壁を建ててよいマス。</li>\n<li><code>O</code> : 壁を建ててはいけないマス。</li>\n</ul>\n<p>青木君はスタート地点を出発してグリッド上を移動してゴール地点へ行こうとしています。青木君は <var>(i,j)</var> にいるときにマス <var>(i+1,j),(i,j+1),(i-1,j),(i,j-1)</var> のいずれかに移動することができます。ただし、グリッドの外に出るような移動や、壁があるマスへの移動を行うことはできません。</p>\n<p>高橋君は、青木君が移動を開始する前に壁を建ててよいマスを <var>1</var> マス以上選んで壁を建てることで、青木君がどのように移動してもゴール地点へ行くことができないようにすることにしました。ただし、スタート地点およびゴール地点は選ぶことができません。  </p>\n<p>高橋君は青木君がゴールできないように壁を建てることができますか？さらに、壁を建てられる場合は</p>\n<ul>\n<li>青木君がゴールできないように壁を建てるときの最小枚数 <var>n</var> 、および</li>\n<li>最小枚数を達成する壁の立て方が何通りあるかを <var>998244353</var> で割ったあまり <var>r</var> </li>\n</ul>\n<p>の <var>2</var> つも合わせて計算してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq H \\leq 100</var></li>\n<li><var>2 \\leq W \\leq 100</var></li>\n<li><var>C_{i,j}</var> は <code>S</code>, <code>G</code>, <code>.</code>, <code>O</code> のいずれかである。</li>\n<li><code>S</code>, <code>G</code> は <var>C_{i,j}</var> の中でちょうど <var>1</var> 回だけ登場する。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>H</var> <var>W</var>\n<var>C_{1,1}</var><var>C_{1,2}</var><var>\\dots</var><var>C_{1,W}</var>\n<var>C_{2,1}</var><var>C_{2,2}</var><var>\\dots</var><var>C_{2,W}</var>\n<var>\\vdots</var>\n<var>C_{H,1}</var><var>C_{H,2}</var><var>\\dots</var><var>C_{H,W}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>青木君がゴールできないように壁を建てられる場合は、文字列 <code>Yes</code> 、および問題文中で定義された整数 <var>n</var>, <var>r</var> を以下の形式で出力せよ。</p>\n<pre>Yes\n<var>n</var> <var>r</var>\n</pre>\n<p>そうでない場合は <code>No</code> を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 3\nS..\nO..\n..O\n..G\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>Yes\n3 6\n</pre>\n<p>壁を建てるマスを <code>#</code> で表すと、最小枚数を達成する壁の建て方は次の <var>6</var> 通りとなります。</p>\n<pre>S#.  S.#  S..  S..  S..  S..\nO#.  O#.  O##  O.#  O.#  O.#\n#.O  #.O  #.O  ##O  .#O  .#O\n..G  ..G  ..G  ..G  #.G  .#G\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 2\n.G\n.O\n.S\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>No\n</pre>\n<p>高橋君がどのように壁を建てても青木君はゴール地点へ行くことができます。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>2 2\nS.\n.G\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>Yes\n2 1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>10 10\nOOO...OOO.\n.....OOO.O\nOOO.OO.OOO\nOOO..O..S.\n....O.O.O.\n.OO.O.OOOO\n..OOOG.O.O\n.O.O..OOOO\n.O.O.OO...\n...O..O..O\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>Yes\n10 12\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There is a grid with <var>H \\times W</var> squares. Let <var>(i,j)</var> denote the square at the <var>i</var>-th row from the top and <var>j</var>-th column from the left.<br>\n<var>C_{i,j}</var> represents the state of each square. Each square is in one of the following four states.</p>\n<ul>\n<li><code>S</code>: The starting point. The grid has exactly one starting point.</li>\n<li><code>G</code>: The goal. The grid has exactly one goal.</li>\n<li><code>.</code>: A constructible square, where a wall can be built.</li>\n<li><code>O</code>: An unconstructible square, where a wall cannot be built.</li>\n</ul>\n<p>Aoki intends to start at the starting point and get to the goal. When he is at <var>(i,j)</var>, he can go to <var>(i+1,j)</var>, <var>(i,j+1)</var>, <var>(i-1,j)</var>, or <var>(i,j-1)</var>. It is not allowed to exit the grid or enter a square with a wall.</p>\n<p>Takahashi decides to build a wall on one or more constructible squares of his choice before Aoki starts so that there is no way for Aoki to reach the goal. Here, the starting point and the goal cannot be chosen.</p>\n<p>Is it possible for Takahashi to build walls to prevent Aoki from reaching the goal? If it is possible, also compute the two values below:</p>\n<ul>\n<li>the minimum number <var>n</var> of walls needed to prevent Aoki from reaching the goal, and</li>\n<li>the number of ways modulo <var>998244353</var>, <var>r</var>, to achieve that minimum number of walls.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq H \\leq 100</var></li>\n<li><var>2 \\leq W \\leq 100</var></li>\n<li><var>C_{i,j}</var> is <code>S</code>, <code>G</code>, <code>.</code>, or <code>O</code>.</li>\n<li>Each of <code>S</code> and <code>G</code> appears exactly once in <var>C_{i,j}</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>H</var> <var>W</var>\n<var>C_{1,1}</var><var>C_{1,2}</var><var>\\dots</var><var>C_{1,W}</var>\n<var>C_{2,1}</var><var>C_{2,2}</var><var>\\dots</var><var>C_{2,W}</var>\n<var>\\vdots</var>\n<var>C_{H,1}</var><var>C_{H,2}</var><var>\\dots</var><var>C_{H,W}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>If it is possible to build walls to prevent Aoki from reaching the goal, print the string <code>Yes</code> and the integers <var>n</var> and <var>r</var> defined in the Problem Statement, in the following format:</p>\n<pre>Yes\n<var>n</var> <var>r</var>\n</pre>\n<p>Otherwise, print <code>No</code>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 3\nS..\nO..\n..O\n..G\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>Yes\n3 6\n</pre>\n<p>Let <code>#</code> represent a square to build a wall on. The six ways to achieve the minimum number of walls are as follows:</p>\n<pre>S#.  S.#  S..  S..  S..  S..\nO#.  O#.  O##  O.#  O.#  O.#\n#.O  #.O  #.O  ##O  .#O  .#O\n..G  ..G  ..G  ..G  #.G  .#G\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 2\n.G\n.O\n.S\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>No\n</pre>\n<p>Regardless of how Takahashi builds walls, Aoki can always reach the goal.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>2 2\nS.\n.G\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>Yes\n2 1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>10 10\nOOO...OOO.\n.....OOO.O\nOOO.OO.OOO\nOOO..O..S.\n....O.O.O.\n.OO.O.OOOO\n..OOOG.O.O\n.O.O..OOOO\n.O.O.OO...\n...O..O..O\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>Yes\n10 12\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc243/tasks/abc243_h"}