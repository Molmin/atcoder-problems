{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>900</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>パティシエの赤木さんは、「お菓子の素」という粉のみを材料として <var>N</var> 種類のドーナツを作ることができます。これらのドーナツはドーナツ <var>1</var>、ドーナツ <var>2</var>、<var>...</var>、ドーナツ <var>N</var> と呼ばれます。ドーナツ <var>i</var> <var>(1 ≤ i ≤ N)</var> を <var>1</var> 個作るには、お菓子の素 <var>m_i</var> グラムを消費する必要があります。なお、<var>0.5</var> 個など整数でない個数のドーナツを作ることはできません。</p>\n<p>これらのドーナツのレシピは、ドーナツ <var>1</var> のレシピから改変を繰り返して開発されたものです。\n具体的には、ドーナツ <var>i</var> <var>(2 ≤ i ≤ N)</var> のレシピはドーナツ <var>p_i</var> <var>(1 ≤ p_i &lt; i)</var> のレシピを直接改変したものです。</p>\n<p>いま、赤木さんはお菓子の素を <var>X</var> グラム持っています。これを使って、今夜のパーティーに向けて可能な限りたくさんのドーナツを作ることにしました。ただし、来客の好みは様々なので、次の条件を守ることにしました。</p>\n<ul>\n<li>ドーナツ <var>i</var> <var>(1 ≤ i ≤ N)</var> を作る個数を <var>c_i</var> とする。<var>2 ≤ i ≤ N</var> であるようなどの整数 <var>i</var> に対しても、<var>c_{p_i} ≤ c_i ≤ c_{p_i} + D</var> となるように作る。ここで、<var>D</var> はあらかじめ決まった値である。</li>\n</ul>\n<p>このとき、最大で何個のドーナツを作ることができるでしょうか？お菓子の素を使い切る必要はありません。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 ≤ N ≤ 50</var></li>\n<li><var>1 ≤ X ≤ 10^9</var></li>\n<li><var>0 ≤ D ≤ 10^9</var></li>\n<li><var>1 ≤ m_i ≤ 10^9</var> <var>(1 ≤ i ≤ N)</var></li>\n<li><var>1 ≤ p_i &lt; i</var> <var>(2 ≤ i ≤ N)</var></li>\n<li>入力中の値はすべて整数である。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>X</var> <var>D</var>\n<var>m_1</var>\n<var>m_2</var> <var>p_2</var>\n<var>:</var>\n<var>m_N</var> <var>p_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>条件を守って作ることのできるドーナツの最大の個数を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 100 1\n15\n10 1\n20 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>7\n</pre>\n\n<p><var>100</var> グラムのお菓子の素があり、赤木さんは <var>3</var> 種類のドーナツを作ることができ、守るべき条件は <var>c_1 ≤ c_2 ≤ c_1 + 1</var>、<var>c_1 ≤ c_3 ≤ c_1 + 1</var> です。ドーナツ <var>1</var> を <var>2</var> 個、ドーナツ <var>2</var> を <var>3</var> 個、ドーナツ <var>3</var> を <var>2</var> 個作るのが最適です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 100 10\n15\n10 1\n20 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>10\n</pre>\n\n<p>入力例 1 からお菓子の素の量やドーナツのレシピそのものは変わっていませんが、最後の条件が緩くなっています。この場合、ドーナツ <var>2</var> だけを <var>10</var> 個作るのが最適です。このように、必ずしもすべての種類のドーナツを作らなくても構いません。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>5 1000000000 1000000\n123\n159 1\n111 1\n135 3\n147 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>7496296\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>900</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Akaki, a patissier, can make <var>N</var> kinds of doughnut using only a certain powder called \"Okashi no Moto\" (literally \"material of pastry\", simply called Moto below) as ingredient. These doughnuts are called Doughnut <var>1</var>, Doughnut <var>2</var>, <var>...,</var> Doughnut <var>N</var>. In order to make one Doughnut <var>i</var> <var>(1 ≤ i ≤ N)</var>, she needs to consume <var>m_i</var> grams of Moto. She cannot make a non-integer number of doughnuts, such as <var>0.5</var> doughnuts.</p>\n<p>The recipes of these doughnuts are developed by repeated modifications from the recipe of Doughnut <var>1</var>. Specifically, the recipe of Doughnut <var>i</var> <var>(2 ≤ i ≤ N)</var> is a direct modification of the recipe of Doughnut <var>p_i</var> <var>(1 ≤ p_i &lt; i)</var>.</p>\n<p>Now, she has <var>X</var> grams of Moto. She decides to make as many doughnuts as possible for a party tonight. However, since the tastes of the guests differ, she will obey the following condition:</p>\n<ul>\n<li>Let <var>c_i</var> be the number of Doughnut <var>i</var> <var>(1 ≤ i ≤ N)</var> that she makes. For each integer <var>i</var> such that <var>2 ≤ i ≤ N</var>, <var>c_{p_i} ≤ c_i ≤ c_{p_i} + D</var> must hold. Here, <var>D</var> is a predetermined value.</li>\n</ul>\n<p>At most how many doughnuts can be made here? She does not necessarily need to consume all of her Moto.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 ≤ N ≤ 50</var></li>\n<li><var>1 ≤ X ≤ 10^9</var></li>\n<li><var>0 ≤ D ≤ 10^9</var></li>\n<li><var>1 ≤ m_i ≤ 10^9</var> <var>(1 ≤ i ≤ N)</var></li>\n<li><var>1 ≤ p_i &lt; i</var> <var>(2 ≤ i ≤ N)</var></li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>X</var> <var>D</var>\n<var>m_1</var>\n<var>m_2</var> <var>p_2</var>\n<var>:</var>\n<var>m_N</var> <var>p_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the maximum number of doughnuts that can be made under the condition.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 100 1\n15\n10 1\n20 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>7\n</pre>\n\n<p>She has <var>100</var> grams of Moto, can make three kinds of doughnuts, and the conditions that must hold are <var>c_1 ≤ c_2 ≤ c_1 + 1</var> and <var>c_1 ≤ c_3 ≤ c_1 + 1</var>. It is optimal to make two Doughnuts <var>1</var>, three Doughnuts <var>2</var> and two Doughnuts <var>3</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 100 10\n15\n10 1\n20 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>10\n</pre>\n\n<p>The amount of Moto and the recipes of the doughnuts are not changed from Sample Input 1, but the last conditions are relaxed. In this case, it is optimal to make just ten Doughnuts <var>2</var>. As seen here, she does not necessarily need to make all kinds of doughnuts.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>5 1000000000 1000000\n123\n159 1\n111 1\n135 3\n147 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>7496296\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc096/tasks/arc096_d"}