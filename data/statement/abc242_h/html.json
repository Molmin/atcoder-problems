{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>1</var> から <var>N</var> までの番号が振られた <var>N</var> 個のマスがあり、始めすべてのマスは白く塗られています。</p>\n<p>また、箱の中に <var>1</var> から <var>M</var> までの番号が振られた <var>M</var> 個のボールが入っています。</p>\n<p>以下の操作を、<var>N</var> 個のマスがすべて黒く塗られるまで繰り返します。</p>\n<ol>\n<li>箱から <var>1</var> つボールを取り出す。取り出し方は完全ランダムであり、各ボールは等確率で選ばれる。</li>\n<li>取り出したボールの番号を <var>x</var> として、マス <var>L_x, L_x+1, \\ldots, R_x</var> を黒く塗る。</li>\n<li>取り出したボールを箱に戻す。</li>\n</ol>\n<p>操作回数の期待値を <var>\\text{mod } 998244353</var> で求めてください（注記参照）。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>注記</h3><p>求める期待値は必ず有理数となることが証明できます。またこの問題の制約下では、その値を互いに素な <var>2</var> つの整数 <var>P</var>, <var>Q</var> を用いて <var>\\frac{P}{Q}</var> と表したとき、<var>R \\times Q \\equiv P\\pmod{998244353}</var> かつ <var>0 \\leq R \\lt 998244353</var> を満たす整数 <var>R</var> がただ一つ存在することが証明できます。この <var>R</var> を求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N,M \\leq 400</var></li>\n<li><var>1 \\leq L_i \\leq R_i \\leq N</var></li>\n<li>すべてのマス <var>i</var> についてある整数 <var>j</var> が存在し、<var>L_j \\leq i \\leq R_j</var></li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>L_1</var> <var>R_1</var>\n<var>L_2</var> <var>R_2</var>\n<var>\\hspace{0.5cm}\\vdots</var>\n<var>L_M</var> <var>R_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>求めた期待値を <var>\\text{mod } 998244353</var> で出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 3\n1 1\n1 2\n2 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>499122180\n</pre>\n<p>求める期待値は <var>\\frac{7}{2}</var> です。</p>\n<p><var>499122180 \\times 2 \\equiv 7\\pmod{998244353}</var> なので、<var>499122180</var> を出力します。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>13 10\n3 5\n5 9\n3 12\n1 13\n9 11\n12 13\n2 4\n9 12\n9 11\n7 11\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>10\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>100 11\n22 43\n84 93\n12 71\n49 56\n8 11\n1 61\n13 80\n26 83\n23 100\n80 85\n9 89\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>499122193\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>N</var> squares numbered <var>1</var> to <var>N</var>. Initially, all squares are painted white.</p>\n<p>Additionally, there are <var>M</var> balls numbered <var>1</var> to <var>M</var> in a box.</p>\n<p>We repeat the procedure below until all squares are painted black.</p>\n<ol>\n<li>Pick up a ball from a box uniformly at random.</li>\n<li>Let <var>x</var> be the index of the ball. Paint Squares <var>L_x, L_x+1, \\ldots, R_x</var> black.</li>\n<li>Return the ball to the box.</li>\n</ol>\n<p>Find the expected value of the number of times the procedure is done, modulo <var>998244353</var> (see Notes).</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Notes</h3><p>It can be proved that the sought expected value is always a rational number. Additionally, under the Constraints of this problem, when that value is represented as <var>\\frac{P}{Q}</var> using two coprime integers <var>P</var> and <var>Q</var>, it can be proved that there uniquely exists an integer <var>R</var> such that <var>R \\times Q \\equiv P\\pmod{998244353}</var> and <var>0 \\leq R \\lt 998244353</var>. You should find this <var>R</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N,M \\leq 400</var></li>\n<li><var>1 \\leq L_i \\leq R_i \\leq N</var></li>\n<li>For every square <var>i</var>, there is an integer <var>j</var> such that <var>L_j \\leq i \\leq R_j</var>.</li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>L_1</var> <var>R_1</var>\n<var>L_2</var> <var>R_2</var>\n<var>\\hspace{0.5cm}\\vdots</var>\n<var>L_M</var> <var>R_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the sought expected value modulo <var>998244353</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 3\n1 1\n1 2\n2 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>499122180\n</pre>\n<p>The sought expected value is <var>\\frac{7}{2}</var>.</p>\n<p>We have <var>499122180 \\times 2 \\equiv 7\\pmod{998244353}</var>, so <var>499122180</var> should be printed.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>13 10\n3 5\n5 9\n3 12\n1 13\n9 11\n12 13\n2 4\n9 12\n9 11\n7 11\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>10\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>100 11\n22 43\n84 93\n12 71\n49 56\n8 11\n1 61\n13 80\n26 83\n23 100\n80 85\n9 89\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>499122193\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc242/tasks/abc242_h"}