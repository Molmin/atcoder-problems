{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>900</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>x</var> を長さ <var>1</var> 以上の文字列とします。\nいかなる文字列 <var>y</var> および <var>2</var> 以上の整数 <var>k</var> に対しても、\n<var>y</var> を <var>k</var> 回繰り返した文字列が <var>x</var> と異なるならば、\n<var>x</var> を<em>良い文字列</em>であると呼ぶことにします。\n例えば、<code>a</code>, <code>bbc</code>, <code>cdcdc</code> などは良い文字列ですが、\n<code>aa</code>, <code>bbbb</code>, <code>cdcdcd</code> などは良い文字列ではありません。</p>\n<p><var>w</var> を長さ <var>1</var> 以上の文字列とします。\n<var>m</var> 項からなる列 <var>F=(\\,f_1,\\,f_2,\\,...,\\,f_m)</var> について、\n次の条件がともに満たされるならば、<var>F</var> を <var>w</var> の<em>良い表現</em>と呼ぶことにします。</p>\n<ul>\n<li>すべての <var>i \\, (1 \\leq i \\leq m)</var> について、<var>f_i</var> は良い文字列である。</li>\n<li><var>f_1,\\,f_2,\\,...,\\,f_m</var> をこの順に連結すると <var>w</var> になる。</li>\n</ul>\n<p>例えば、<var>w=</var><code>aabb</code> の場合、<var>w</var> の良い表現は次の <var>5</var> つとなります。</p>\n<ul>\n<li><var>(</var><code>aabb</code><var>)</var></li>\n<li><var>(</var><code>a</code><var>,</var><code>abb</code><var>)</var></li>\n<li><var>(</var><code>aab</code><var>,</var><code>b</code><var>)</var></li>\n<li><var>(</var><code>a</code><var>,</var><code>ab</code><var>,</var><code>b</code><var>)</var></li>\n<li><var>(</var><code>a</code><var>,</var><code>a</code><var>,</var><code>b</code><var>,</var><code>b</code><var>)</var></li>\n</ul>\n<p>文字列 <var>w</var> の良い表現のうち、項数 <var>m</var> が最小であるものを、\n<var>w</var> の<em>最良表現</em>と呼ぶことにします。\n例えば、<var>w=</var><code>aabb</code> の最良表現は <var>(</var><code>aabb</code><var>)</var> の <var>1</var> つのみとなります。</p>\n<p>文字列 <var>w</var> が与えられます。次の <var>2</var> つを求めてください。</p>\n<ul>\n<li><var>w</var> の最良表現の項数</li>\n<li><var>w</var> の最良表現の総数を <var>1000000007 \\, (=10^9+7)</var> で割った余り</li>\n</ul>\n<p>なお、<var>w</var> に対し、良い表現が存在することは保証されます。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq |w| \\leq 500000 \\, (=5 \\times 10^5)</var></li>\n<li><var>w</var> は英小文字 (<code>a</code>-<code>z</code>) のみからなる文字列である</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>部分点</h3><ul>\n<li><var>1 \\leq |w| \\leq 4000</var> を満たすデータセットに正解した場合は、<var>400</var> 点が与えられる。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>w</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>出力は <var>2</var> 行からなる。</p>\n<ul>\n<li><var>1</var> 行目に、<var>w</var> の最良表現の項数を出力せよ。</li>\n<li><var>2</var> 行目に、<var>w</var> の最良表現の総数を <var>1000000007</var> で割った余りを出力せよ。</li>\n</ul>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>aab\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>1\n1\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>bcbc\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>2\n3\n</pre>\n\n<ul>\n<li>この入力に対しては、項数が <var>2</var> の最良表現が以下の <var>3</var> 通り存在します。<ul>\n<li><var>(</var><code>b</code><var>,</var><code>cbc</code><var>)</var></li>\n<li><var>(</var><code>bc</code><var>,</var><code>bc</code><var>)</var></li>\n<li><var>(</var><code>bcb</code><var>,</var><code>c</code><var>)</var></li>\n</ul>\n</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>ddd\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>3\n1\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>900</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Let <var>x</var> be a string of length at least <var>1</var>.\nWe will call <var>x</var> a <em>good</em> string, if for any string <var>y</var> and any integer <var>k (k \\geq 2)</var>, the string obtained by concatenating <var>k</var> copies of <var>y</var> is different from <var>x</var>.\nFor example, <code>a</code>, <code>bbc</code> and <code>cdcdc</code> are good strings, while <code>aa</code>, <code>bbbb</code> and <code>cdcdcd</code> are not.</p>\n<p>Let <var>w</var> be a string of length at least <var>1</var>.\nFor a sequence <var>F=(\\,f_1,\\,f_2,\\,...,\\,f_m)</var> consisting of <var>m</var> elements,\nwe will call <var>F</var> a <em>good representation</em> of <var>w</var>, if the following conditions are both satisfied:</p>\n<ul>\n<li>For any <var>i \\, (1 \\leq i \\leq m)</var>, <var>f_i</var> is a good string.</li>\n<li>The string obtained by concatenating <var>f_1,\\,f_2,\\,...,\\,f_m</var> in this order, is <var>w</var>.</li>\n</ul>\n<p>For example, when <var>w=</var><code>aabb</code>, there are five good representations of <var>w</var>:</p>\n<ul>\n<li><var>(</var><code>aabb</code><var>)</var></li>\n<li><var>(</var><code>a</code><var>,</var><code>abb</code><var>)</var></li>\n<li><var>(</var><code>aab</code><var>,</var><code>b</code><var>)</var></li>\n<li><var>(</var><code>a</code><var>,</var><code>ab</code><var>,</var><code>b</code><var>)</var></li>\n<li><var>(</var><code>a</code><var>,</var><code>a</code><var>,</var><code>b</code><var>,</var><code>b</code><var>)</var></li>\n</ul>\n<p>Among the good representations of <var>w</var>, the ones with the smallest number of elements are called the <em>best representations</em> of <var>w</var>.\nFor example, there are only one best representation of <var>w=</var><code>aabb</code>: <var>(</var><code>aabb</code><var>)</var>.</p>\n<p>You are given a string <var>w</var>. Find the following:</p>\n<ul>\n<li>the number of elements of a best representation of <var>w</var></li>\n<li>the number of the best representations of <var>w</var>, modulo <var>1000000007 \\, (=10^9+7)</var></li>\n</ul>\n<p>(It is guaranteed that a good representation of <var>w</var> always exists.)</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq |w| \\leq 500000 \\, (=5 \\times 10^5)</var></li>\n<li><var>w</var> consists of lowercase letters (<code>a</code>-<code>z</code>).</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Partial Score</h3><ul>\n<li><var>400</var> points will be awarded for passing the test set satisfying <var>1 \\leq |w| \\leq 4000</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>w</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>2</var> lines.</p>\n<ul>\n<li>In the first line, print the number of elements of a best representation of <var>w</var>.</li>\n<li>In the second line, print the number of the best representations of <var>w</var>, modulo <var>1000000007</var>.</li>\n</ul>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>aab\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>1\n1\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>bcbc\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>2\n3\n</pre>\n\n<ul>\n<li>In this case, there are <var>3</var> best representations of <var>2</var> elements:<ul>\n<li><var>(</var><code>b</code><var>,</var><code>cbc</code><var>)</var></li>\n<li><var>(</var><code>bc</code><var>,</var><code>bc</code><var>)</var></li>\n<li><var>(</var><code>bcb</code><var>,</var><code>c</code><var>)</var></li>\n</ul>\n</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>ddd\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>3\n1\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc060/tasks/arc060_d"}