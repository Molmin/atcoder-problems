{"html":{"en":"<span class=\"lang-en\">\n<p>Score : <var>1400</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><style>\n   #nck {\n      width: 30px;\n      height: auto;\n   }\n</style>\n\n<p>In the country there are <var>N</var> cities numbered <var>1</var> through <var>N</var>, which are connected by <var>N-1</var> bidirectional roads. In terms of graph theory, there is a unique simple path connecting every pair of cities. That is, the <var>N</var> cities form a tree. Besides, if we view city <var>1</var> as the root of this tree, the tree will be a full binary tree (a tree is a full binary tree if and only if every non-leaf vertex in the tree has exactly two children). Roads are numbered <var>1</var> through <var>N-1</var>. The <var>i</var>-th road connects city <var>i+1</var> and city <var>a_i</var>. When you pass through road <var>i</var>, the toll you should pay is <var>v_i</var> (if <var>v_i</var> is <var>0</var>, it indicates the road does not require a toll).</p>\n<p>A company in city <var>1</var> will give each employee a family travel and cover a large part of the tolls incurred. Each employee can design the travel by themselves. That is, which cities he/she wants to visit in each day and which city to stay at each night. However, there are some constraints. More details are as follows:</p>\n<ul>\n<li>\n<p>The travel must start and end at city <var>1</var>. If there are <var>m</var> leaves in the tree formed by the cities, then the number of days in the travel must be <var>m+1</var>. At the end of each day, except for the last day, the employee must stay at some hotel in a leaf city. During the whole travel, the employee must stay at all leaf cities exactly once.</p>\n</li>\n<li>\n<p>During the whole travel, all roads of the country must be passed through exactly twice.</p>\n</li>\n<li>\n<p>The amount that the employee must pay for tolls by him/herself is the maximum total toll incurred in a single day during the travel, except the first day and the last day. The remaining tolls will be covered by the company.</p>\n</li>\n</ul>\n<p>Shik, as an employee of this company, has only one hope for his travel. He hopes that the amount he must pay for tolls by himself will be as small as possible. Please help Shik to design the travel which satisfies his hope.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 &lt; N &lt; 131,072</var></li>\n<li><var>1 \\leq a_i \\leq i</var> for all <var>i</var></li>\n<li><var>0 \\leq v_i \\leq 131,072</var></li>\n<li><var>v_i</var> is an integer</li>\n<li>The given tree is a full binary tree</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>a_1</var> <var>v_1</var>\n<var>a_2</var> <var>v_2</var>\n<var>:</var>\n<var>a_{N-1}</var> <var>v_{N-1}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print an integer denoting the minimum amount Shik must pay by himself for tolls incurred during the travel.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>7\n1 1\n1 1\n2 1\n2 1\n3 1\n3 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>4\n</pre>\n\n<p>There are <var>4</var> leaves in the tree formed by the cities (cities <var>4</var>, <var>5</var>, <var>6</var>, and <var>7</var>), so the travel must be <var>5</var> days long. There are <var>4! = 24</var> possible arrangements of the leaf cities to stay during the travel, but some of them are invalid. For example, <var>(4,5,6,7)</var> and <var>(6,7,5,4)</var> are valid orders, but <var>(5,6,7,4)</var> is invalid because the route passes <var>4</var> times through the road connecting city <var>1</var> and city <var>2</var>. The figure below shows the routes of the travel for these arrangements.</p>\n<div style=\"text-align: center;\">\n<img alt=\"04b39e0341af562ba20ba2d49c6f2b69.jpg\" src=\"https://atcoder.jp/img/agc007/04b39e0341af562ba20ba2d49c6f2b69.jpg\">\n</div>\n\n<p>For all valid orders, day <var>3</var> is the day with the maximum total incurred toll of <var>4</var>, passing through <var>4</var> roads.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>9\n1 2\n1 2\n3 2\n3 2\n5 2\n5 2\n7 2\n7 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>6\n</pre>\n\n<p>The following figure shows the route of the travel for one possible arrangement of the stayed cities for the solution. Note that the tolls incurred in the first day and the last day are always covered by the company.</p>\n<div style=\"text-align: center;\">\n<img alt=\"92271892911b34032766803fa9c9e159.jpg\" src=\"https://atcoder.jp/img/agc007/92271892911b34032766803fa9c9e159.jpg\">\n</div>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>15\n1 2\n1 5\n3 3\n4 3\n4 3\n6 5\n5 4\n5 3\n6 3\n3 2\n11 5\n11 3\n13 2\n13 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>15\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>3\n1 0\n1 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>0\n</pre></section>\n</div>\n</span>","ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1400</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><style>\n   #nck {\n      width: 30px;\n      height: auto;\n   }\n</style>\n\n<p>ある国には <var>N</var> 個の都市があり、それらは <var>N-1</var> 本の道路で結ばれています。道路は双方向に通行できます。便宜上、都市には <var>1</var> から <var>N</var> の、道路には <var>1</var> から <var>N-1</var> の番号が振られています。グラフ理論の用語を用いると、任意の二つの都市に対し、それらを結ぶ単純道がちょうど一つ存在します。すなわち、都市と道路から構成されるグラフは木です。また、<var>1</var> 番の都市をこの木の根とみなすと、この木は全二分木となっています。（全二分木とは、葉以外の任意の頂点がちょうど二つの子を持つような根付き木のことをいいます。）<var>i</var> 番の道路は <var>i+1</var> 番の都市と <var>a_i</var> 番の都市を結び、一回の通行ごとに <var>v_i</var> の通行料が発生します。（<var>v_i</var> が <var>0</var> であるような道路では通行料は発生しません。）</p>\n<p><var>1</var> 番の都市に、社員の旅行を奨励していることで有名な会社があります。この会社には道路通行料補助制度という制度があり、社員の旅行中に発生する道路の通行料のほとんどを会社が負担します。旅行がこの制度の適用対象となるためにはいくつかの制約を満たす必要があり、その範囲内であれば好きなように旅程を決めることができます。これらの詳細は以下の通りです。</p>\n<ul>\n<li>\n<p>制度の適用対象となるためには、旅行の出発点と終着点はともに <var>1</var> 番の都市でなければならない。また、この国の都市と道路を <var>1</var> 番の都市を根とする根付き木とみなしたとき、この木の葉の個数を <var>m</var> とすると、旅行日程は <var>m</var> 泊 <var>m+1</var> 日でなければならない。これらの <var>m</var> 回の宿泊は、木の葉に相当する都市のすべてで一度ずつ行わなければならない。</p>\n</li>\n<li>\n<p>旅行全体を通じて、この国のすべての道路をそれぞれちょうど二度ずつ通行しなければならない。</p>\n</li>\n<li>\n<p>旅行中に発生する道路の通行料のうち、社員自身が負担しなければならない金額は、発生する通行料の合計が最大であるような日（ただし旅行初日および最終日を除く）に発生する通行料の合計である。残りの金額は会社の負担となる。</p>\n</li>\n</ul>\n<p>シックはこの会社の従業員です。道路通行料補助制度のもとで行う今度の旅行では、発生する通行料のうち自分自身で支払わなければならない金額を最小にすることだけを考えています。そのような旅程を組む手伝いをしてあげてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 &lt; N &lt; 131,072</var></li>\n<li>すべての <var>i</var> に対し、<var>1 \\leq a_i \\leq i</var></li>\n<li><var>0 \\leq v_i \\leq 131,072</var></li>\n<li><var>v_i</var> は整数である。</li>\n<li>与えられる木は全二分木である。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>a_1</var> <var>v_1</var>\n<var>a_2</var> <var>v_2</var>\n<var>.</var>\n<var>.</var>\n<var>a_{N-1}</var> <var>v_{N-1}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>道路通行料補助制度のもとで旅行を行うとき、発生する通行料のうち自分自身で負担しなければならない金額の最小値を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>7\n1 1\n1 1\n2 1\n2 1\n3 1\n3 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>4\n</pre>\n\n<p>都市と道路を <var>1</var> 番の都市を根とする根付き木とみなしたとき、この木には <var>4</var> 個の葉が存在するため（<var>4, 5, 6, 7</var> 番の都市に相当する頂点）、 旅行日程は <var>4</var> 泊 <var>5</var> 日となります。これらの <var>4</var> つの都市に宿泊する順序は <var>4! = 24</var> 通り存在しますが、そのうちの一部では道路通行料補助制度の対象外となってしまいます。例えば、<var>(4,5,6,7)</var> や <var>(6,7,5,4)</var> の順に都市を訪れると制度の対象になりますが、<var>(5,6,7,4)</var> の順に訪れると経路中に <var>1</var> 番の都市と <var>2</var> 番の都市を結ぶ道路を <var>4</var> 回通ってしまい、制度の対象外となってしまいます。下図にこれらの訪問順序に対応する旅行の経路を示します。</p>\n<div style=\"text-align: center;\">\n<img alt=\"04b39e0341af562ba20ba2d49c6f2b69.jpg\" src=\"https://atcoder.jp/img/agc007/04b39e0341af562ba20ba2d49c6f2b69.jpg\">\n</div>\n\n<p>制度の対象となるような都市の訪問順序すべてにおいて、対応する旅程では <var>3</var> 日目に <var>4</var> 本の道路を通行して合計で <var>4</var> の通行料が発生し、発生する通行料の合計が最大であるような日はこの日となります。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>9\n1 2\n1 2\n3 2\n3 2\n5 2\n5 2\n7 2\n7 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>6\n</pre>\n\n<p>下図に負担金額が最小となるような旅行の経路をひとつ示します。</p>\n<div style=\"text-align: center;\">\n<img alt=\"92271892911b34032766803fa9c9e159.jpg\" src=\"https://atcoder.jp/img/agc007/92271892911b34032766803fa9c9e159.jpg\">\n</div>\n\n<p>負担金額を算出する際に、旅行初日および最終日に発生する通行料は考えないことに注意してください。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>15\n1 2\n1 5\n3 3\n4 3\n4 3\n6 5\n5 4\n5 3\n6 3\n3 2\n11 5\n11 3\n13 2\n13 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>15\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>3\n1 0\n1 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>0\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc007/tasks/agc007_e"}