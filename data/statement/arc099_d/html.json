{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1200</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>高橋君は，いつも頭の中に，長さ <var>2 \\times 10^9 + 1</var> の整数列 <var>A = (A_{-10^9}, A_{-10^9 + 1}, ..., A_{10^9 - 1}, A_{10^9})</var> と，整数 <var>P</var> を思い浮かべています．</p>\n<p>はじめ，高橋君が思い浮かべている整数列 <var>A</var> のすべての要素は <var>0</var> です．\nまた，整数 <var>P</var> の値は <var>0</var> です．</p>\n<p>高橋君は，<code>+</code>, <code>-</code>, <code>&gt;</code>, <code>&lt;</code> の記号を食べると，それぞれ次のように思い浮かべている整数列 <var>A</var>，整数 <var>P</var> が変化します：</p>\n<ul>\n<li><code>+</code> を食べた場合，<var>A_P</var> の値が <var>1</var> 大きくなる．</li>\n<li><code>-</code> を食べた場合，<var>A_P</var> の値が <var>1</var> 小さくなる．</li>\n<li><code>&gt;</code> を食べた場合，<var>P</var> の値が <var>1</var> 大きくなる．</li>\n<li><code>&lt;</code> を食べた場合，<var>P</var> の値が <var>1</var> 小さくなる．</li>\n</ul>\n<p>高橋君は，長さ <var>N</var> の文字列 <var>S</var> を持っています．<var>S</var> の各文字は <code>+</code>, <code>-</code>, <code>&gt;</code>, <code>&lt;</code> の記号のいずれかです．\n高橋君は，<var>1 \\leq i \\leq j \\leq N</var> なる整数の組 <var>(i, j)</var> を選んで，<var>S</var> の <var>i, i+1, ..., j</var> 文字目の記号をこの順に食べました．\n高橋君が記号を食べ終わった後，高橋君が思い浮かべている整数列 <var>A</var> は，高橋君が <var>S</var> のすべての記号を <var>1</var> 文字目から順に食べた場合と等しくなったといいます．\nこのような <var>(i, j)</var> として考えられるものは何通りあるか求めてください．</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 250000</var></li>\n<li><var>|S| = N</var></li>\n<li><var>S</var> の各文字は <code>+</code>, <code>-</code>, <code>&gt;</code>, <code>&lt;</code> のいずれか</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる．</p>\n<pre><var>N</var>\n<var>S</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ．</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>5\n+&gt;+&lt;-\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>3\n</pre>\n\n<p>高橋君が <var>S</var> のすべての記号を食べた場合，<var>A_1 = 1</var> で，<var>A</var> の他の要素はすべて <var>0</var> になります．\n<var>A</var> がこれと等しくなるような <var>(i, j)</var> は次の通りです：</p>\n<ul>\n<li><var>(1, 5)</var></li>\n<li><var>(2, 3)</var></li>\n<li><var>(2, 4)</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5\n+&gt;+-&lt;\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>5\n</pre>\n\n<p>高橋君が <var>S</var> のすべての記号を食べた場合と <var>P</var> が異なっていてもかまわないことに注意してください．</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>48\n-+&gt;&lt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&gt;&gt;+-&lt;&lt;&gt;-&gt;&gt;&gt;&lt;&lt;&gt;&lt;&lt;-+&lt;&gt;&gt;&lt;+&lt;&lt;&gt;+&gt;&lt;-+-&gt;&gt;&lt;&lt;\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>475\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1200</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>In Takahashi's mind, there is always an integer sequence of length <var>2 \\times 10^9 + 1</var>: <var>A = (A_{-10^9}, A_{-10^9 + 1}, ..., A_{10^9 - 1}, A_{10^9})</var> and an integer <var>P</var>.</p>\n<p>Initially, all the elements in the sequence <var>A</var> in Takahashi's mind are <var>0</var>, and the value of the integer <var>P</var> is <var>0</var>.</p>\n<p>When Takahashi eats symbols <code>+</code>, <code>-</code>, <code>&gt;</code> and <code>&lt;</code>, the sequence <var>A</var> and the integer <var>P</var> will change as follows:</p>\n<ul>\n<li>When he eats <code>+</code>, the value of <var>A_P</var> increases by <var>1</var>;</li>\n<li>When he eats <code>-</code>, the value of <var>A_P</var> decreases by <var>1</var>;</li>\n<li>When he eats <code>&gt;</code>, the value of <var>P</var> increases by <var>1</var>;</li>\n<li>When he eats <code>&lt;</code>, the value of <var>P</var> decreases by <var>1</var>.</li>\n</ul>\n<p>Takahashi has a string <var>S</var> of length <var>N</var>. Each character in <var>S</var> is one of the symbols <code>+</code>, <code>-</code>, <code>&gt;</code> and <code>&lt;</code>.\nHe chose a pair of integers <var>(i, j)</var> such that <var>1 \\leq i \\leq j \\leq N</var> and ate the symbols that are the <var>i</var>-th, <var>(i+1)</var>-th, <var>...</var>, <var>j</var>-th characters in <var>S</var>, in this order.\nWe heard that, after he finished eating, the sequence <var>A</var> became the same as if he had eaten all the symbols in <var>S</var> from first to last.\nHow many such possible pairs <var>(i, j)</var> are there?</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 250000</var></li>\n<li><var>|S| = N</var></li>\n<li>Each character in <var>S</var> is <code>+</code>, <code>-</code>, <code>&gt;</code> or <code>&lt;</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>S</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>5\n+&gt;+&lt;-\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>3\n</pre>\n\n<p>If Takahashi eats all the symbols in <var>S</var>, <var>A_1 = 1</var> and all other elements would be <var>0</var>.\nThe pairs <var>(i, j)</var> that leads to the same sequence <var>A</var> are as follows:</p>\n<ul>\n<li><var>(1, 5)</var></li>\n<li><var>(2, 3)</var></li>\n<li><var>(2, 4)</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5\n+&gt;+-&lt;\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>5\n</pre>\n\n<p>Note that the value of <var>P</var> may be different from the value when Takahashi eats all the symbols in <var>S</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>48\n-+&gt;&lt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&gt;&gt;+-&lt;&lt;&gt;-&gt;&gt;&gt;&lt;&lt;&gt;&lt;&lt;-+&lt;&gt;&gt;&lt;+&lt;&lt;&gt;+&gt;&lt;-+-&gt;&gt;&lt;&lt;\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>475\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc099/tasks/arc099_d"}