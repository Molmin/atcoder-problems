{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>475</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>とあるゲームの大会に、プレイヤー <var>1</var> 、プレイヤー <var>2</var> 、<var>\\ldots</var> 、プレイヤー <var>N</var> の <var>N</var> 人のプレイヤーが参加します。\n大会の開始直前、各プレイヤーはそれぞれ <var>1</var> 人のみからなるチームをなし、全部で <var>N</var> 個のチームがあります。</p>\n<p>大会では全部で <var>N−1</var> 回の試合があり、各試合では <var>2</var> つの異なるチームが選ばれ、一方が先攻を、もう一方が後攻を受け持って対戦し、その結果ちょうど一方のチームが勝ちます。\n具体的には、<var>i = 1, 2, \\ldots, N-1</var> について <var>i</var> 回目の試合は下記の通りに進行します。</p>\n<ul>\n<li>プレイヤー <var>p_i</var> の属するチームが先攻、プレイヤー <var>q_i</var> の属するチームが後攻として、対戦を行う。</li>\n<li>その結果、先攻チームの人数を <var>a</var> 、後攻チームの人数を <var>b</var> として、<var>\\frac{a}{a+b}</var> の確率で先攻のチームが、<var>\\frac{b}{a+b}</var> の確率で後攻のチームが勝つ。</li>\n<li>その後、勝負した <var>2</var> チームは <var>1</var> つのチームに併合される。</li>\n</ul>\n<p>なお、各試合の対戦結果は他の試合の対戦結果とは独立です。</p>\n<p><var>N</var> 人のプレイヤーそれぞれについて、大会全体で自分が所属するチームが勝つという出来事が起こる回数の期待値 <var>\\text{mod } 998244353</var> を出力してください。</p>\n<details> <summary>期待値 <var>\\text{mod } 998244353</var> の定義</summary>\n\n<p>この問題で求める期待値は必ず有理数になることが証明できます。 また、この問題の制約下では、求める期待値を既約分数 <var>\\frac{y}{x}</var> で表したときに <var>x</var> が <var>998244353</var> で割り切れないことが保証されます。</p> <p>このとき <var>xz \\equiv y \\pmod{998244353}</var> を満たすような <var>0</var> 以上 <var>998244352</var> 以下の整数 <var>z</var> が一意に定まります。この <var>z</var> を答えてください。</p> </details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq p_i, q_i \\leq N</var></li>\n<li><var>i</var> 回目の試合の直前、プレイヤー <var>p_i</var> が属するチームとプレイヤー <var>q_i</var> が属するチームは異なる。</li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>p_1</var> <var>q_1</var>\n<var>p_2</var> <var>q_2</var>\n<var>\\vdots</var>\n<var>p_{N-1}</var> <var>q_{N-1}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>各 <var>i = 1, 2, \\ldots, N</var> について、大会全体でプレイヤー <var>i</var> が所属するチームが勝つという出来事が起こる回数の期待値 <var>\\text{mod } 998244353</var> である <var>E_i</var> を、\n下記の形式にしたがって空白区切りで出力せよ。</p>\n<pre><var>E_1</var> <var>E_2</var> <var>\\ldots</var> <var>E_N</var>\n</pre>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>5\n1 2\n4 3\n5 3\n1 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>698771048 698771048 964969543 964969543 133099248\n</pre>\n<p>チームに所属するプレイヤーの番号が <var>x_1, x_2, \\ldots, x_k</var> であるチームを、チーム <var>\\lbrace x_1, x_2, \\ldots, x_k \\rbrace</var> と呼びます。</p>\n<ul>\n<li><var>1</var> 回目の試合では、プレイヤー <var>1</var> が所属するチーム <var>\\lbrace 1 \\rbrace</var> とプレイヤー <var>2</var> が所属するチーム <var>\\lbrace 2 \\rbrace</var> が対戦し、\n<var>\\frac{1}{2}</var> の確率でチーム <var>\\lbrace 1 \\rbrace</var> が、<var>\\frac{1}{2}</var> の確率でチーム <var>\\lbrace 2 \\rbrace</var> が勝ちます。\nその後、<var>2</var> つのチームは併合され、<var>1</var> つのチーム <var>\\lbrace 1, 2 \\rbrace</var> になります。</li>\n<li><var>2</var> 回目の試合では、プレイヤー <var>4</var> が所属するチーム <var>\\lbrace 4 \\rbrace</var> とプレイヤー <var>3</var> が所属するチーム <var>\\lbrace 3 \\rbrace</var> が対戦し、\n<var>\\frac{1}{2}</var> の確率でチーム <var>\\lbrace 4 \\rbrace</var> が、<var>\\frac{1}{2}</var> の確率でチーム <var>\\lbrace 3 \\rbrace</var> が勝ちます。\nその後、<var>2</var> つのチームは併合され、<var>1</var> つのチーム <var>\\lbrace 3, 4 \\rbrace</var> になります。</li>\n<li><var>3</var> 回目の試合では、プレイヤー <var>5</var> が所属するチーム <var>\\lbrace 5 \\rbrace</var> とプレイヤー <var>3</var> が所属するチーム <var>\\lbrace 3, 4 \\rbrace</var> が対戦し、\n<var>\\frac{1}{3}</var> の確率でチーム <var>\\lbrace 5 \\rbrace</var> が、<var>\\frac{2}{3}</var> の確率でチーム <var>\\lbrace 3, 4 \\rbrace</var> が勝ちます。\nその後、<var>2</var> つのチームは併合され、<var>1</var> つのチーム <var>\\lbrace 3, 4, 5 \\rbrace</var> になります。</li>\n<li><var>4</var> 回目の試合では、プレイヤー <var>1</var> が所属するチーム <var>\\lbrace 1, 2 \\rbrace</var> とプレイヤー <var>4</var> が所属するチーム <var>\\lbrace 3, 4, 5 \\rbrace</var> が対戦し、\n<var>\\frac{2}{5}</var> の確率でチーム <var>\\lbrace 1, 2 \\rbrace</var> が、<var>\\frac{3}{5}</var> の確率でチーム <var>\\lbrace 3, 4, 5 \\rbrace</var> が勝ちます。\nその後、<var>2</var> つのチームは併合され、<var>1</var> つのチーム <var>\\lbrace 1, 2, 3, 4, 5 \\rbrace</var> になります。</li>\n</ul>\n<p>プレイヤー <var>1, 2, 3, 4, 5</var> それぞれの、大会全体で自分が所属するチームが勝つという出来事が起こる回数の期待値 <var>E_1, E_2, E_3, E_4, E_5</var> は、それぞれ\n<var>\\frac{9}{10}, \\frac{9}{10}, \\frac{53}{30}, \\frac{53}{30}, \\frac{14}{15}</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>15\n9 2\n8 10\n13 6\n12 11\n7 10\n4 10\n14 2\n5 4\n1 15\n15 2\n6 9\n8 11\n6 3\n2 8\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>43970290 310168785 806914186 501498951 950708909 272140427 335124893 168750835 310168785 168750835 280459129 280459129 272140427 476542843 43970290\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>475</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p><var>N</var> players, player <var>1</var>, player <var>2</var>, ..., player <var>N</var>, participate in a game tournament. Just before the tournament starts, each player forms a one-person team, so there are <var>N</var> teams in total.</p>\n<p>The tournament has a total of <var>N-1</var> matches. In each match, two different teams are chosen. One team goes first, and the other goes second. Each match will result in exactly one team winning. Specifically, for each <var>i = 1, 2, \\ldots, N-1</var>, the <var>i</var>-th match proceeds as follows.</p>\n<ul>\n<li>The team with player <var>p_i</var> goes first, and the team with player <var>q_i</var> goes second.</li>\n<li>Let <var>a</var> and <var>b</var> be the numbers of players in the first and second teams, respectively. The first team wins with probability <var>\\frac{a}{a+b}</var>, and the second team wins with probability <var>\\frac{b}{a+b}</var>.</li>\n<li>Then, the two teams are combined into a single team.</li>\n</ul>\n<p>The result of each match is independent of those of the others.</p>\n<p>For each of the <var>N</var> players, print the expected number of times the team with that player wins throughout the tournament, modulo <var>998244353</var>.</p>\n<details> <summary>How to print an expected value modulo <var>998244353</var></summary>\n\n<p>It can be proved that the sought expected value is always rational. Also, the constraints of this problem guarantee that if the sought expected value is expressed as an irreducible fraction <var>\\frac{y}{x}</var>, then <var>x</var> is not divisible by <var>998244353</var>.</p> <p>Now, there is a unique integer <var>z</var> between <var>0</var> and <var>998244352</var>, inclusive, such that <var>xz \\equiv y \\pmod{998244353}</var>. Report this <var>z</var>.</p> </details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq p_i, q_i \\leq N</var></li>\n<li>Just before the <var>i</var>-th match, player <var>p_i</var> and player <var>q_i</var> belong to different teams.</li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>p_1</var> <var>q_1</var>\n<var>p_2</var> <var>q_2</var>\n<var>\\vdots</var>\n<var>p_{N-1}</var> <var>q_{N-1}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>For each <var>i = 1, 2, \\ldots, N</var>, print <var>E_i</var>, the expected number, modulo <var>998244353</var>, of times the team with player <var>i</var> wins throughout the tournament, separated by spaces, in the following format:</p>\n<pre><var>E_1</var> <var>E_2</var> <var>\\ldots</var> <var>E_N</var>\n</pre>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>5\n1 2\n4 3\n5 3\n1 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>698771048 698771048 964969543 964969543 133099248\n</pre>\n<p>We call a team formed by player <var>x_1</var>, player <var>x_2</var>, <var>\\ldots</var>, player <var>x_k</var> as team <var>\\lbrace x_1, x_2, \\ldots, x_k \\rbrace</var>.</p>\n<ul>\n<li>The first match is played by team <var>\\lbrace 1 \\rbrace</var>, with player <var>1</var>, and team <var>\\lbrace 2 \\rbrace</var>, with player <var>2</var>. Team <var>\\lbrace 1 \\rbrace</var> wins with probability <var>\\frac{1}{2}</var>, and team <var>\\lbrace 2 \\rbrace</var> wins with probability <var>\\frac{1}{2}</var>. Then, the two teams are combined into a single team <var>\\lbrace 1, 2 \\rbrace</var>.</li>\n<li>The second match is played by team <var>\\lbrace 4 \\rbrace</var>, with player <var>4</var>, and team <var>\\lbrace 3 \\rbrace</var>, with player <var>3</var>. Team <var>\\lbrace 4 \\rbrace</var> wins with probability <var>\\frac{1}{2}</var>, and team <var>\\lbrace 3 \\rbrace</var> wins with probability <var>\\frac{1}{2}</var>. Then, the two teams are combined into a single team <var>\\lbrace 3, 4 \\rbrace</var>.</li>\n<li>The third match is played by team <var>\\lbrace 5 \\rbrace</var>, with player <var>5</var>, and team <var>\\lbrace 3, 4 \\rbrace</var>, with player <var>3</var>. Team <var>\\lbrace 5 \\rbrace</var> wins with probability <var>\\frac{1}{3}</var>, and team <var>\\lbrace 3, 4 \\rbrace</var> wins with probability <var>\\frac{2}{3}</var>. Then, the two teams are combined into a single team <var>\\lbrace 3, 4, 5 \\rbrace</var>.</li>\n<li>The fourth match is played by team <var>\\lbrace 1, 2 \\rbrace</var>, with player <var>1</var>, and team <var>\\lbrace 3, 4, 5 \\rbrace</var>, with player <var>4</var>. Team <var>\\lbrace 1, 2 \\rbrace</var> wins with probability <var>\\frac{2}{5}</var>, and team <var>\\lbrace 3, 4, 5 \\rbrace</var> wins with probability <var>\\frac{3}{5}</var>. Then, the two teams are combined into a single team <var>\\lbrace 1, 2, 3, 4, 5 \\rbrace</var>.</li>\n</ul>\n<p>The expected numbers of times the teams with players <var>1, 2, 3, 4, 5</var> win throughout the tournament, <var>E_1, E_2, E_3, E_4, E_5</var>, are <var>\\frac{9}{10}, \\frac{9}{10}, \\frac{53}{30}, \\frac{53}{30}, \\frac{14}{15}</var>, respectively.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>15\n9 2\n8 10\n13 6\n12 11\n7 10\n4 10\n14 2\n5 4\n1 15\n15 2\n6 9\n8 11\n6 3\n2 8\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>43970290 310168785 806914186 501498951 950708909 272140427 335124893 168750835 310168785 168750835 280459129 280459129 272140427 476542843 43970290\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc314/tasks/abc314_f"}