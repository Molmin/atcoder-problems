{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1000</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3>\n<p>AtCoder 王国には <var>2N</var> 個の交差点があり、各交差点には <var>1</var> から <var>2N</var> までの番号が付けられています。\nまた、AtCoder 王国には以下の <var>3</var> 種類の<strong>一方通行の</strong>道路があります。</p>\n<ul>\n<li><strong>タイプ A:</strong> <var>2 \\leq i \\leq N</var> について、交差点 <var>2i-3</var> から交差点 <var>2i-1</var> へ向かう道路</li>\n<li><strong>タイプ B:</strong> <var>2 \\leq i \\leq N</var> について、交差点 <var>2i-2</var> から交差点 <var>2i</var> へ向かう道路</li>\n<li><strong>タイプ C:</strong> <var>1 \\leq i \\leq N</var> について、交差点 <var>2i-1</var> と交差点 <var>2i</var> を結ぶ向き <var>s_i</var> の道路</li>\n</ul>\n<p>ここで、<var>s_i</var> は <code>X</code> または <code>Y</code> であり、向き <code>X</code> は交差点 <var>2i-1</var> から交差点 <var>2i</var> に向かう方向、向き <code>Y</code> は交差点 <var>2i</var> から交差点 <var>2i-1</var> に向かう方向を指します。</p>\n<p>高橋君は<strong>ウォーキング</strong>を何回か行うことで、各 <var>1 \\leq i \\leq N</var> について、交差点 <var>2i-1</var> と交差点 <var>2i</var> を結ぶタイプ C の道路の向きを <var>t_i</var> にしたいです。</p>\n<blockquote>\n<p><strong>ウォーキングとは</strong></p>\n<p>好きな交差点から出発し、以下の行動を <var>0</var> 回以上繰り返す。</p>\n<ul>\n<li>もし現在いる交差点からタイプ C の道路に進めるのであれば、タイプ C の道路を次の交差点まで歩く。</li>\n<li>上記以外で、現在いる交差点からタイプ A または B の道路に進めるのであれば、その道路を次の交差点まで歩く。</li>\n</ul>\n<p>その後、通ったすべてのタイプ C の道路の向きを反転させる。</p>\n</blockquote>\n<p>最小何回のウォーキングで目的を達成できるかを計算し、最小回数で目的を達成する方法を <var>1</var> つ答えてください。\nなお、この問題の制約下では有限回で目的を達成できることが証明できます。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3>\n<ul>\n<li><var>N</var> は <var>1 \\leq N \\leq 4000</var> を満たす整数</li>\n<li><var>s_1, s_2, \\dots, s_N</var> は <code>X</code> または <code>Y</code></li>\n<li><var>t_1, t_2, \\dots, t_N</var> は <code>X</code> または <code>Y</code></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3>\n<p>入力は以下の形式で標準入力から与えられます。</p>\n<pre><var>N</var>\n<var>s_1 s_2 \\cdots s_N</var>\n<var>t_1 t_2 \\cdots t_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3>\n<p>以下の形式で出力してください。\nただし、ウォーキングの回数を <var>X</var> とします。また、<var>i</var> 回目 <var>(1 \\leq i \\leq X)</var> のウォーキングでは交差点 <var>a_i</var> から出発し、交差点 <var>b_i</var> でウォーキングを終えるものとします。</p>\n<pre><var>X</var>\n<var>a_1</var> <var>b_1</var>\n<var>a_2</var> <var>b_2</var>\n<var>\\vdots</var>\n<var>a_X</var> <var>b_X</var>\n</pre>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>5\nXYXYX\nXXYXX\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>1\n2 7\n</pre>\n<p>この入力例では、高橋君は以下のようなウォーキングを行います。</p>\n<ul>\n<li>交差点 <var>2</var> から出発する。</li>\n<li>交差点 <var>2</var> から進めるタイプ C の道路はないので、タイプ B の道路を通って交差点 <var>4</var> まで進む。</li>\n<li>交差点 <var>4</var> から進めるタイプ C の道路はあるので、タイプ C の道路を通って交差点 <var>3</var> まで進む。</li>\n<li>交差点 <var>3</var> から進めるタイプ C の道路はないので、タイプ A の道路を通って交差点 <var>5</var> まで進む。</li>\n<li>交差点 <var>5</var> から進めるタイプ C の道路はあるので、タイプ C の道路を通って交差点 <var>6</var> まで進む。</li>\n<li>交差点 <var>6</var> から進めるタイプ C の道路はないので、タイプ B の道路を通って交差点 <var>8</var> まで進む。</li>\n<li>交差点 <var>8</var> から進めるタイプ C の道路はあるので、タイプ C の道路を通って交差点 <var>7</var> まで進む。</li>\n<li>交差点 <var>7</var> でウォーキングを終える。</li>\n</ul>\n<p>ここで、このウォーキングでは、以下の <var>3</var> 本のタイプ C の道路を通っています。</p>\n<ul>\n<li>交差点 <var>3</var> と交差点 <var>4</var> を結ぶ道路</li>\n<li>交差点 <var>5</var> と交差点 <var>6</var> を結ぶ道路</li>\n<li>交差点 <var>7</var> と交差点 <var>8</var> を結ぶ道路</li>\n</ul>\n<p>これらの道路の向きが反転するため、<var>i = 1, 2, 3, 4, 5</var> について交差点 <var>2i-1</var> と交差点 <var>2i</var> を結ぶ道路の向きは順に <code>X</code>、<code>X</code>、<code>Y</code>、<code>X</code>、<code>X</code> となり、目的を達成します。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5\nXXYYX\nXXYYX\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n<p>最初の時点で目的が達成されているため、<var>1</var> 回もウォーキングを行う必要がないことに注意してください。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>5\nXXXXX\nYYYYY\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>5\n1 2\n3 4\n5 6\n7 8\n9 10\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>20\nXXXYXYYXXXYXXXXYYXXY\nXXYXYYXXYXXYXYXYXYXY\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>5\n14 18\n29 38\n14 26\n5 10\n27 35\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 5</h3><pre>20\nYXYXYXYYYXYYXYYXYXXX\nXXXXXYXYYYXYYXXYYYXY\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 5</h3><pre>5\n29 36\n10 38\n2 3\n4 7\n28 40\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score: <var>1000</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3>\n<p>The Kingdom of AtCoder has <var>2N</var> intersections labeled with numbers from <var>1</var> to <var>2N</var>. Additionally, there are three types of <strong>one-way</strong> roads in the kingdom:</p>\n<ul>\n<li><strong>Type A:</strong> For each <var>2 \\leq i \\leq N</var>, there is a road from intersection <var>2i-3</var> to intersection <var>2i-1</var>.</li>\n<li><strong>Type B:</strong> For each <var>2 \\leq i \\leq N</var>, there is a road from intersection <var>2i-2</var> to intersection <var>2i</var>.</li>\n<li><strong>Type C:</strong> For each <var>1 \\leq i \\leq N</var>, there is a road connecting intersection <var>2i-1</var> and intersection <var>2i</var> with direction <var>s_i</var>.</li>\n</ul>\n<p>Here, <var>s_i</var> is <code>X</code> or <code>Y</code>, where direction <code>X</code> means the road goes from intersection <var>2i-1</var> to intersection <var>2i</var>, and direction <code>Y</code> means it goes from intersection <var>2i</var> to intersection <var>2i-1</var>.</p>\n<p>Takahashi wants to <strong>walk</strong> several times so that for each <var>1 \\leq i \\leq N</var>, the direction of Type-C road connecting intersections <var>2i-1</var> and <var>2i</var> will be <var>t_i</var>.</p>\n<blockquote>\n<p><strong>What is a walk?</strong></p>\n<p>Start at any intersection and repeat the following action zero or more times:</p>\n<ul>\n<li>If it is possible to proceed to a Type-C road from the current intersection, walk along the Type-C road to the next intersection.</li>\n<li>Otherwise, if it is possible to proceed to a Type-A or B road from the current intersection, walk along that road to the next intersection.</li>\n</ul>\n<p>Then, reverse the directions of all Type-C roads that were passed.</p>\n</blockquote>\n<p>Calculate the minimum number of walks needed to achieve the goal and provide one method to achieve the goal in the minimum number of walks. Under the constraints of this problem, it can be proved that the goal can be achieved in a finite number of walks.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3>\n<ul>\n<li><var>N</var> is an integer such that <var>1 \\leq N \\leq 4000</var>.</li>\n<li>Each of <var>s_1, s_2, \\dots, s_N</var> is <code>X</code> or <code>Y</code>.</li>\n<li>Each of <var>t_1, t_2, \\dots, t_N</var> is <code>X</code> or <code>Y</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3>\n<p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>s_1 s_2 \\cdots s_N</var>\n<var>t_1 t_2 \\cdots t_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3>\n<p>Print your solution in the following format, where <var>X</var> is the number of walks, and the <var>i</var>-th walk <var>(1 \\leq i \\leq X)</var> starts at intersection <var>a_i</var> and finishes at intersection <var>b_i</var>.</p>\n<pre><var>X</var>\n<var>a_1</var> <var>b_1</var>\n<var>a_2</var> <var>b_2</var>\n<var>\\vdots</var>\n<var>a_X</var> <var>b_X</var>\n</pre>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>5\nXYXYX\nXXYXX\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>1\n2 7\n</pre>\n<p>In this sample input, Takahashi will walk as follows:</p>\n<ul>\n<li>Start at intersection <var>2</var>.</li>\n<li>Since there is no Type-C road to proceed from intersection <var>2</var>, walk along the Type-B road to intersection <var>4</var>.</li>\n<li>Since there is a Type-C road to proceed from intersection <var>4</var>, walk along the Type-C road to intersection <var>3</var>.</li>\n<li>Since there is no Type-C road to proceed from intersection <var>3</var>, walk along the Type-A road to intersection <var>5</var>.</li>\n<li>Since there is a Type-C road to proceed from intersection <var>5</var>, walk along the Type-C road to intersection <var>6</var>.</li>\n<li>Since there is no Type-C road to proceed from intersection <var>6</var>, walk along the Type-B road to intersection <var>8</var>.</li>\n<li>Since there is a Type-C road to proceed from intersection <var>8</var>, walk along the Type-C road to intersection <var>7</var>.</li>\n<li>Finish at intersection <var>7</var>.</li>\n</ul>\n<p>This walk passes through the following three Type-C roads:</p>\n<ul>\n<li>The road connecting intersection <var>3</var> and intersection <var>4</var>.</li>\n<li>The road connecting intersection <var>5</var> and intersection <var>6</var>.</li>\n<li>The road connecting intersection <var>7</var> and intersection <var>8</var>.</li>\n</ul>\n<p>The directions of these roads are reversed, so the directions of the roads connecting intersections <var>2i-1</var> and <var>2i</var> for <var>i = 1, 2, 3, 4, 5</var> are now <code>X</code>, <code>X</code>, <code>Y</code>, <code>X</code>, <code>X</code>, respectively, achieving the goal.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5\nXXYYX\nXXYYX\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n<p>Note that the goal is already achieved at the beginning, so there is no need to walk even once.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>5\nXXXXX\nYYYYY\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>5\n1 2\n3 4\n5 6\n7 8\n9 10\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>20\nXXXYXYYXXXYXXXXYYXXY\nXXYXYYXXYXXYXYXYXYXY\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>5\n14 18\n29 38\n14 26\n5 10\n27 35\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 5</h3><pre>20\nYXYXYXYYYXYYXYYXYXXX\nXXXXXYXYYYXYYXXYYYXY\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 5</h3><pre>5\n29 36\n10 38\n2 3\n4 7\n28 40\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc172/tasks/arc172_f"}