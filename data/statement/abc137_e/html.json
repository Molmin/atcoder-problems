{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>500</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>1</var> から <var>N</var> までの番号がつけられた <var>N</var> 頂点と <var>M</var> 辺からなる有向グラフがあります。\n<var>i</var> 番目の辺は頂点 <var>A_i</var> から頂点 <var>B_i</var> へと向かい、この辺の上には <var>C_i</var> 枚のコインが置かれています。\nまた、頂点 <var>N</var> にはボタンが設置されています。</p>\n<p>このグラフ上でゲームを行います。\nあなたは頂点 <var>1</var> でコインを <var>0</var> 枚持ってゲームを開始し、辺をたどってコインを拾いながら頂点 <var>N</var> を目指します。\n<var>1</var> 本の辺を通るには <var>1</var> 分の時間がかかり、辺を通るたびにその辺の上に置かれているすべてのコインを拾うことができます。\nゲームの世界ではよくあるように、ある辺を通ってその上のコインを拾っても、その辺を次に通る際には同じ枚数のコインが再び出現しており、それらを再び拾うことができます。</p>\n<p>頂点 <var>N</var> に到着したとき、ボタンを押してゲームを終了することができます。(ボタンを押さずに移動を続けることもできます。)\nただし、ゲームを終了する際に、ゲーム開始からの経過時間を <var>T</var> 分として <var>T \\times P</var> 枚のコインの支払いが要求されます。持っているコインの枚数が <var>T \\times P</var> 枚未満の場合は、代わりに持っているコインをすべて支払います。</p>\n<p>この支払いの後に残ったコインの枚数があなたのスコアとなります。\n獲得できるスコアの最大値が存在するか判定し、存在する場合はその最大値を求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq N \\leq 2500</var></li>\n<li><var>1 \\leq M \\leq 5000</var></li>\n<li><var>1 \\leq A_i, B_i \\leq N</var></li>\n<li><var>1 \\leq C_i \\leq 10^5</var></li>\n<li><var>0 \\leq P \\leq 10^5</var></li>\n<li>入力中の値はすべて整数である。</li>\n<li>頂点 <var>1</var> から頂点 <var>N</var> に到達することが可能である。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var> <var>P</var>\n<var>A_1</var> <var>B_1</var> <var>C_1</var>\n<var>:</var>\n<var>A_M</var> <var>B_M</var> <var>C_M</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>獲得できるスコアの最大値が存在する場合はその最大値を、存在しない場合は <code>-1</code> を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 3 10\n1 2 20\n2 3 30\n1 3 45\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>35\n</pre>\n\n<p><img alt=\"入力例 1 で与えられるグラフの図\" src=\"https://img.atcoder.jp/ghi/5cb074e2d7c3282da137ac4ab2fbc700.png\"></p>\n<p>頂点 <var>1</var> から頂点 <var>3</var> に移動する方法は以下の <var>2</var> 通りです。</p>\n<ul>\n<li>頂点 <var>1 \\rightarrow 2 \\rightarrow 3</var>: 道中でコインを <var>20 + 30 = 50</var> 枚拾う。ゲーム開始から <var>2</var> 分後に頂点 <var>3</var> に着き、ボタンを押してコインを <var>2 \\times 10 = 20</var> 枚支払い、<var>50 - 20 = 30</var> 枚残る。</li>\n<li>頂点 <var>1 \\rightarrow 3</var>: 道中でコインを <var>45</var> 枚拾う。ゲーム開始から <var>1</var> 分後に頂点 <var>3</var> に着き、ボタンを押してコインを <var>1 \\times 10 = 10</var> 枚支払い、<var>45 - 10 = 35</var> 枚残る。</li>\n</ul>\n<p>よって、獲得できるスコアの最大値は <var>35</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>2 2 10\n1 2 100\n2 2 100\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>-1\n</pre>\n\n<p><img alt=\"入力例 2 で与えられるグラフの図\" src=\"https://img.atcoder.jp/ghi/eb2188ad1e8189f963d233415fb293b6.png\"></p>\n<p>頂点 <var>1</var> から伸びる辺を通ると頂点 <var>2</var> に着き、ここで頂点 <var>2</var> から自分自身へと向かう辺を <var>t</var> 回通ってからボタンを押すとスコアは <var>90 + 90t</var> となります。よってスコアは無限に高めることができ、獲得できるスコアの最大値は存在しません。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>4 5 10\n1 2 1\n1 4 1\n3 4 1\n2 2 100\n3 3 100\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>0\n</pre>\n\n<p><img alt=\"入力例 3 で与えられるグラフの図\" src=\"https://img.atcoder.jp/ghi/217f7a224b80a05d8e25140c57e65ae7.png\"></p>\n<p>頂点 <var>1</var> から頂点 <var>4</var> へと直接向かう辺を通ること以外に頂点 <var>1</var> から頂点 <var>4</var> に移動する方法はありません。この辺の上で <var>1</var> 枚のコインを拾いますが、ゲーム終了時に <var>10</var> 枚のコインの支払いを要求されてスコアは <var>0</var> となります。</p>\n<p>なお、頂点 <var>1</var> から頂点 <var>2</var> へと向かう辺を通るとその後コインを無限に拾えますが、頂点 <var>4</var> に到達してゲームを終了することができなくなるため無意味です。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>500</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There is a directed graph with <var>N</var> vertices numbered <var>1</var> to <var>N</var> and <var>M</var> edges.\nThe <var>i</var>-th edge is directed from Vertex <var>A_i</var> to Vertex <var>B_i</var>, and there are <var>C_i</var> coins \bplaced along that edge.\nAdditionally, there is a button on Vertex <var>N</var>.</p>\n<p>We will play a game on this graph.\nYou start the game on Vertex <var>1</var> with zero coins, and head for Vertex <var>N</var> by traversing the edges while collecting coins.\nIt takes one minute to traverse an edge, and you can collect the coins placed along the edge each time you traverse it.\nAs usual in games, even if you traverse an edge once and collect the coins, the same number of coins will reappear next time you traverse that edge, which you can collect again.</p>\n<p>When you reach Vertex <var>N</var>, you can end the game by pressing the button. (You can also choose to leave Vertex <var>N</var> without pressing the button and continue traveling.)\nHowever, when you end the game, you will be asked to pay <var>T \\times P</var> coins, where <var>T</var> is the number of minutes elapsed since the start of the game. If you have less than <var>T \\times P</var> coins, you will have to pay all of your coins instead.</p>\n<p>Your score will be the number of coins you have after this payment.\nDetermine if there exists a maximum value of the score that can be obtained. If the answer is yes, find that maximum value.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 2500</var></li>\n<li><var>1 \\leq M \\leq 5000</var></li>\n<li><var>1 \\leq A_i, B_i \\leq N</var></li>\n<li><var>1 \\leq C_i \\leq 10^5</var></li>\n<li><var>0 \\leq P \\leq 10^5</var></li>\n<li>All values in input are integers.</li>\n<li>Vertex <var>N</var> can be reached from Vertex <var>1</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>P</var>\n<var>A_1</var> <var>B_1</var> <var>C_1</var>\n<var>:</var>\n<var>A_M</var> <var>B_M</var> <var>C_M</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>If there exists a maximum value of the score that can be obtained, print that maximum value; otherwise, print <code>-1</code>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 3 10\n1 2 20\n2 3 30\n1 3 45\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>35\n</pre>\n\n<p><img alt=\"Figure of the graph given in Sample Input 1\" src=\"https://img.atcoder.jp/ghi/5cb074e2d7c3282da137ac4ab2fbc700.png\"></p>\n<p>There are two ways to travel from Vertex <var>1</var> to Vertex <var>3</var>:</p>\n<ul>\n<li>Vertex <var>1 \\rightarrow 2 \\rightarrow 3</var>: You collect <var>20 + 30 = 50</var> coins on the way. After two minutes from the start of the game, you press the button, pay <var>2 \\times 10 = 20</var> coins, and you have <var>50 - 20 = 30</var> coins left.</li>\n<li>Vertex <var>1 \\rightarrow 2</var>: You collect <var>45</var> coins on the way. After one minute from the start of the game, you press the button, pay <var>1 \\times 10 = 10</var> coins, and you have <var>45 - 10 = 35</var> coins left.</li>\n</ul>\n<p>Thus, the maximum score that can be obtained is <var>35</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>2 2 10\n1 2 100\n2 2 100\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>-1\n</pre>\n\n<p><img alt=\"Figure of the graph given in Sample Input 2\" src=\"https://img.atcoder.jp/ghi/eb2188ad1e8189f963d233415fb293b6.png\"></p>\n<p>The edge extending from Vertex <var>1</var> takes you to Vertex <var>2</var>. If you then traverse the edge extending from Vertex <var>2</var> to itself <var>t</var> times and press the button, your score will be <var>90 + 90t</var>. Thus, you can infinitely increase your score, which means there is no maximum value of the score that can be obtained.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>4 5 10\n1 2 1\n1 4 1\n3 4 1\n2 2 100\n3 3 100\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>0\n</pre>\n\n<p><img alt=\"Figure of the graph given in Sample Input 3\" src=\"https://img.atcoder.jp/ghi/217f7a224b80a05d8e25140c57e65ae7.png\"></p>\n<p>There is no way to travel from Vertex <var>1</var> to Vertex <var>4</var> other than traversing the edge leading from Vertex <var>1</var> to Vertex <var>4</var> directly. You will pick up one coin along this edge, but after being asked to paying <var>10</var> coins, your score will be <var>0</var>.</p>\n<p>Note that you can collect an infinite number of coins if you traverse the edge leading from Vertex <var>1</var> to Vertex <var>2</var>, but this is pointless since you can no longer reach Vertex <var>4</var> and end the game.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc137/tasks/abc137_e"}