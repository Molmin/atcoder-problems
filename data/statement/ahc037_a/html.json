{"html":{"ja":"<span class=\"lang-ja\">\n\n<div class=\"part\">\n<section>\n<h3>ストーリー</h3><p>あなたはある飲料工場で働いています。この工場では、ベースとなる飲料水が大量に用意されており、それにシロップと炭酸を加えることで製品である炭酸飲料を作ります。加えるシロップと炭酸の量を変えることで複数の炭酸飲料を作ることができます。さらに、すでに作られた炭酸飲料にシロップや炭酸を追加して別の炭酸飲料を作ることも可能です。</p>\n<p>作りたい炭酸飲料の甘さと炭酸の強さの組合わせが複数与えられたとき、なるべく効率的にそれらを作る手順を見つけてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>炭酸飲料の<strong>甘さ</strong>と<strong>炭酸の強さ</strong>は、それぞれ非負整数で表されます。甘さ <var>x</var>、炭酸の強さ <var>y</var> の炭酸飲料を <var>(x, y)</var> と表記します。</p>\n<p>あなたは最初、炭酸飲料 <var>(0, 0)</var> だけを持っています。以下、すでに作られた炭酸飲料の集合を <var>S</var> と書きます。最初は <var>S = \\{(0, 0)\\}</var> です。</p>\n<p>あなたは以下の操作を繰り返し行うことで複数の炭酸飲料を作ることができます。</p>\n<ul>\n<li>すでに持っている炭酸飲料 <var>(x, y) \\in S</var> を一つ選ぶ</li>\n<li><var>x' \\ge x</var> かつ <var>y' \\ge y</var> を満たす整数 <var>x', y'</var> を選ぶ</li>\n<li><var>(x, y)</var> を二つの容器に分ける。片方はそのまま取っておき、もう一方にシロップと炭酸を加えることで炭酸飲料 <var>(x', y')</var> を作る。<var>S</var> に <var>(x', y')</var> が追加される。<ul>\n<li>このとき <var>(x, y)</var> が <var>S</var> から削除<strong>されない</strong>ことに注意してください</li>\n</ul>\n</li>\n<li>コストが <var>(x' - x) + (y' - y)</var> かかる</li>\n</ul>\n<p>入力として <var>N</var> 種類の炭酸飲料 <var>(A_1, B_1), \\dots, (A_N, B_N)</var> が指定されます。操作を <var>5N</var> 回まで行えるとき、指定された炭酸飲料をすべて作るような操作列（つまり、操作をすべて終えたときにどの <var>i \\in \\{1, 2, \\dots, N\\}</var> に対しても <var>(A_i, B_i) \\in S</var> が成り立つ操作列）のうち、コストの総和がなるべく小さいものを見つけてください。途中で入力に含まれない炭酸飲料が作られても構いません。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>得点</h3><p>コストの総和を <var>C</var> とし、<var>L = \\max\\{A_1, B_1, A_2, B_2, \\dots, A_N, B_N\\}</var> とする。このとき得点は <var>\\mathrm{round}\\left(10^6 \\times \\frac{NL}{1 + C}\\right)</var> で与えられる。</p>\n<p>テストケースは全部で 150 個あり、各テストケースの得点の合計が提出の得点となる。\n一つ以上のテストケースで不正な出力や制限時間超過をした場合、提出全体の判定が <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"不正解\">WA</span> や <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"実行時間制限超過\">TLE</span> となる。\nコンテスト時間中に得た最高得点で最終順位が決定され、コンテスト終了後のシステムテストは行われない。 同じ得点を複数の参加者が得た場合、提出時刻に関わらず同じ順位となる。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>A_1</var> <var>B_1</var>\n<var>\\vdots</var>\n<var>A_N</var> <var>B_N</var>\n</pre>\n\n<p>入力はすべて整数であり、以下の制約を満たす。</p>\n<ul>\n<li><var>N = 1000</var></li>\n<li><var>0 \\le A_i &lt; 10^9</var></li>\n<li><var>0 \\le B_i &lt; 10^9</var></li>\n<li><var>A_1, A_2, \\dots, A_N</var> は相異なる</li>\n<li><var>B_1, B_2, \\dots, B_N</var> は相異なる</li>\n<li><var>A_i = 0</var> を満たす <var>i</var> が存在する</li>\n<li><var>B_i = 0</var> を満たす <var>i</var> が存在する</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>操作の回数を <var>M</var> とする。<var>m</var> 回目の操作で <var>(x_m, y_m)</var> から <var>(x'_m, y'_m)</var> を作るとして、以下のフォーマットで標準出力に出力せよ。</p>\n<pre><var>M</var>\n<var>x_1</var> <var>y_1</var> <var>x'_1</var> <var>y'_1</var>\n<var>\\vdots</var>\n<var>x_M</var> <var>y_M</var> <var>x'_M</var> <var>y'_M</var>\n</pre>\n\n<p>出力はすべて整数で、以下の条件を満たさなければならない。</p>\n<ul>\n<li><var>0 \\le M \\le 5N</var></li>\n<li><var>0 \\le x_m \\le x'_m &lt; 10^9</var> かつ <var>0 \\le y_m \\le y'_m &lt; 10^9</var></li>\n<li><var>(x_m, y_m) \\ne (0, 0)</var> ならば、ある <var>k &lt; m</var> に対して <var>(x_m, y_m) = (x'_k, y'_k)</var></li>\n<li><var>(A_i, B_i) \\ne (0, 0)</var> ならば、ある <var>m</var> に対して <var>(A_i, B_i) = (x'_m, y'_m)</var></li>\n</ul>\n<p>なお、<var>M \\le 5N</var> 以外の条件をすべて満たす操作列でコスト <var>C</var> のものがあるとき、コストが <var>C</var> 以下の操作列で <var>M \\le 5N</var> を含むすべての条件を満たすものが存在することが証明できる。</p>\n<p><a href=\"https://img.atcoder.jp/ahc037/WneGTzJP.html?lang=ja&amp;seed=0&amp;output=sample\">例を見る</a></p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>入力生成方法</h3><p><var>N = 1000</var> とする。</p>\n<p><var>A_1, \\dots, A_N</var> を以下のように生成する。</p>\n<ul>\n<li><var>a_1 = 0</var> とし、<var>a_2, \\dots, a_N</var> を <var>1</var> 以上 <var>10^9</var> 未満の範囲から重複しないよう一様ランダムに選ぶ</li>\n<li><var>a_1, \\dots, a_N</var> をランダムに並べ替えたものを <var>A_1, \\dots, A_N</var> とする</li>\n</ul>\n<p><var>B_1, \\dots, B_N</var> も同様の方法で生成する。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>ツール(入力ジェネレータ・ビジュアライザ)</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc037/WneGTzJP.html?lang=ja\">Web版</a>: ローカル版より高性能でアニメーション表示が可能です。</li>\n<li><a href=\"https://img.atcoder.jp/ahc037/WneGTzJP.zip\">ローカル版</a>: 使用するには<a href=\"https://www.rust-lang.org/ja\">Rust言語</a>のコンパイル環境をご用意下さい。<ul>\n<li><a href=\"https://img.atcoder.jp/ahc037/WneGTzJP_windows.zip\">Windows用のコンパイル済みバイナリ</a>: Rust言語の環境構築が面倒な方は代わりにこちらをご利用下さい。</li>\n</ul>\n</li>\n</ul>\n<p>コンテスト期間中に、ビジュアライズ結果の共有や、解法・考察に関する言及は禁止されています。ご注意下さい。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">4\n0 6\n2 5\n3 2\n4 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">6\n0 0 2 0\n0 0 0 6\n2 0 4 0\n2 0 2 2\n2 2 3 2\n2 2 2 5\n</pre>\n\n<p>これは説明のための例であり、入力の制約は満たしていません。</p>\n<p>作りたい炭酸飲料は <var>(0, 6), (2, 5), (3, 2), (4, 0)</var> です。問題文と同様に、すでに作られた炭酸飲料の集合を <var>S</var> で表します。</p>\n<ul>\n<li>最初の操作では <var>(0, 0)</var> から <var>(2, 0)</var> を作る。コストが <var>2</var> かかる。<ul>\n<li>この時点で <var>S = \\{(0, 0), (2, 0)\\}</var> である。</li>\n</ul>\n</li>\n<li>2番目の操作では <var>(0, 0)</var> から <var>(0, 6)</var> を作る。コストが <var>6</var> かかる。<ul>\n<li>この時点で <var>S = \\{(0, 0), (2, 0), (0, 6)\\}</var> である。</li>\n</ul>\n</li>\n<li>3番目の操作では <var>(2, 0)</var> から <var>(4, 0)</var> を作る。コストが <var>2</var> かかる。<ul>\n<li>この時点で <var>S = \\{(0, 0), (2, 0), (0, 6), (4, 0)\\}</var> である。</li>\n</ul>\n</li>\n<li>4番目の操作では <var>(2, 0)</var> から <var>(2, 2)</var> を作る。コストが <var>2</var> かかる。<ul>\n<li>この時点で <var>S = \\{(0, 0), (2, 0), (0, 6), (4, 0), (2, 2)\\}</var> である。</li>\n</ul>\n</li>\n<li>5番目の操作では <var>(2, 2)</var> から <var>(3, 2)</var> を作る。コストが <var>1</var> かかる。<ul>\n<li>この時点で <var>S = \\{(0, 0), (2, 0), (0, 6), (4, 0), (2, 2), (3, 2)\\}</var> である。</li>\n</ul>\n</li>\n<li>6番目の操作では <var>(2, 2)</var> から <var>(2, 5)</var> を作る。コストが <var>3</var> かかる。<ul>\n<li>この時点で <var>S = \\{(0, 0), (2, 0), (0, 6), (4, 0), (2, 2), (3, 2), (2, 5)\\}</var> である。</li>\n</ul>\n</li>\n</ul>\n<p>最終的に <var>S</var> に <var>(0, 6), (2, 5), (3, 2), (4, 0)</var> がすべて含まれているので、この出力は <span class=\"label label-success\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"正解\">AC</span> と判定されます。</p>\n<p>コストの総和は <var>16</var> です。<var>C = 16, L = 6, N = 4</var> なので、スコアは\n<var>\\mathrm{round}\\left(10^6 \\times \\frac{6 \\times 4}{1 + 16}\\right) = 1411765</var> となります。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n\n<div class=\"part\">\n<section>\n<h3>Story</h3><p>You work in a beverage factory.  In this factory, a large quantity of drinking water is prepared, and carbonated beverages, the final products, are made by adding syrup and carbon dioxide.  By varying the amounts of syrup and carbon dioxide added, multiple variants of carbonated beverages can be produced.  Furthermore, it is possible to add syrup or carbon dioxide to already made beverages to make other variants.</p>\n<p>Given multiple combinations of desired sweetness and carbonation levels of the beverages you want to make, find an efficient way to produce them.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>The <strong>sweetness</strong> and <strong>carbonation level</strong> of beverages are represented by non-negative integers.  A beverage with sweetness <var>x</var> and carbonation level <var>y</var> is denoted by <var>(x, y)</var>.</p>\n<p>Initially you only have beverage <var>(0, 0)</var>.  Below we write <var>S</var> for the set of beverages already made.  Initially <var>S = \\{(0, 0)\\}</var>.</p>\n<p>You can repeat the following operation to make multiple beverages.</p>\n<ul>\n<li>Choose an already made beverage <var>(x, y) \\in S</var>.</li>\n<li>Choose integers <var>x', y'</var> such that <var>x' \\ge x</var> and <var>y' \\ge y</var>.</li>\n<li>Divide beverage <var>(x, y)</var> into two containers, and keep one of them.  Make a new beverage <var>(x', y')</var> by adding the appropriate amount of syrup and carbon dioxide to the other.  Add <var>(x', y')</var> to <var>S</var>.<ul>\n<li>Notice that <var>(x, y)</var> will <strong>not</strong> be removed from <var>S</var>.</li>\n</ul>\n</li>\n<li>This operation costs <var>(x' - x) + (y' - y)</var>.</li>\n</ul>\n<p>Given <var>N</var> beverages <var>(A_1, B_1), \\dots, (A_N, B_N)</var> in the input, you can perform the above operation up to <var>5N</var> times.  Find a sequence of operations that makes all of the specified beverages (that is, a sequence of operations such that <var>(A_i, B_i) \\in S</var> holds for all <var>i \\in \\{1, 2, \\dots, N\\}</var> after all operations) with the total cost as small as possible.  It is allowed to make beverages not present in the input during the process.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Scoring</h3><p>Let <var>C</var> be the total cost, and <var>L = \\max\\{A_1, B_1, A_2, B_2, \\dots, A_N, B_N\\}</var>.  Then the score is given by <var>\\mathrm{round}\\left(10^6 \\times \\frac{NL}{1 + C}\\right)</var>.</p>\n<p>There are <var>150</var> test cases, and the score of a submission is the total score for each test case.\nIf your submission produces an illegal output or exceeds the time limit for some test cases, the submission itself will be judged as <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Wrong Answer\">WA</span> or <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Time Limit Exceeded\">TLE</span>.\nThe highest score obtained during the contest will determine the final ranking, and there will be no system test after the contest.\nIf more than one participant gets the same score, they will be ranked in the same place regardless of the submission time.</p>\n\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from standard input in the following format:</p>\n<pre><var>N</var>\n<var>A_1</var> <var>B_1</var>\n<var>\\vdots</var>\n<var>A_N</var> <var>B_N</var>\n</pre>\n\n<p>All values are integers, and the input satisfies the following constraints:</p>\n<ul>\n<li><var>N = 1000</var></li>\n<li><var>0 \\le A_i &lt; 10^9</var></li>\n<li><var>0 \\le B_i &lt; 10^9</var></li>\n<li><var>A_1, A_2, \\dots, A_N</var> are pairwise distinct</li>\n<li><var>B_1, B_2, \\dots, B_N</var> are pairwise distinct</li>\n<li>there exists <var>i</var> such that <var>A_i = 0</var></li>\n<li>there exists <var>i</var> such that <var>B_i = 0</var></li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Let <var>M</var> be the number of operations, and suppose that <var>m</var>-th operation makes <var>(x'_m, y'_m)</var> from <var>(x_m, y_m)</var>.  Then, output to standard output in the following format:</p>\n<pre><var>M</var>\n<var>x_1</var> <var>y_1</var> <var>x'_1</var> <var>y'_1</var>\n<var>\\vdots</var>\n<var>x_M</var> <var>y_M</var> <var>x'_M</var> <var>y'_M</var>\n</pre>\n\n<p>All values should be integers, and satisfy the following conditions:</p>\n<ul>\n<li><var>0 \\le M \\le 5N</var></li>\n<li><var>0 \\le x_m \\le x'_m &lt; 10^9</var> and <var>0 \\le y_m \\le y'_m &lt; 10^9</var></li>\n<li>if <var>(x_m, y_m) \\ne (0, 0)</var>, then there exists <var>k &lt; m</var> such that <var>(x_m, y_m) = (x'_k, y'_k)</var></li>\n<li>if <var>(A_i, B_i) \\ne (0, 0)</var>, then there exists <var>m</var> such that <var>(A_i, B_i) = (x'_m, y'_m)</var></li>\n</ul>\n<p>It is possible to prove that if there is a sequence of operations with cost <var>C</var> that satisfies all the conditions except <var>M \\le 5N</var>, then there is a sequence of operations with cost at most <var>C</var> that satisfies all the conditions including <var>M \\le 5N</var>.</p>\n<p><a href=\"https://img.atcoder.jp/ahc037/WneGTzJP.html?lang=en&amp;seed=0&amp;output=sample\">Show example</a></p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Input Generation</h3><p>Let <var>N = 1000</var>.</p>\n<p><var>A_1, \\dots, A_N</var> are generated as follows:</p>\n<ul>\n<li>Let <var>a_1 = 0</var>, and generate pairwise distinct integers <var>a_2, \\dots, a_N</var> between <var>1</var> (inclusive) and <var>10^9</var> (exclusive) uniformly at random.</li>\n<li>Let <var>A_1, \\dots, A_N</var> be a random permutation of <var>a_1, \\dots, a_N</var>.</li>\n</ul>\n<p><var>B_1, \\dots, B_N</var> are generated in the same manner.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Tools (Input generator and visualizer)</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc037/WneGTzJP.html?lang=en\">Web version</a>: This is more powerful than the local version providing animations.</li>\n<li><a href=\"https://img.atcoder.jp/ahc037/WneGTzJP.zip\">Local version</a>: You need a compilation environment of <a href=\"https://www.rust-lang.org/\">Rust language</a>.<ul>\n<li><a href=\"https://img.atcoder.jp/ahc037/WneGTzJP_windows.zip\">Pre-compiled binary for Windows</a>: If you are not familiar with the Rust language environment, please use this instead.</li>\n</ul>\n</li>\n</ul>\n<p>Please be aware that sharing visualization results or discussing solutions/ideas during the contest is prohibited.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">4\n0 6\n2 5\n3 2\n4 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">6\n0 0 2 0\n0 0 0 6\n2 0 4 0\n2 0 2 2\n2 2 3 2\n2 2 2 5\n</pre>\n\n<p>This is an example for illustrative purposes, and does not satisfy the constraints on input.</p>\n<p>The beverages you want to make are <var>(0, 6), (2, 5), (3, 2), (4, 0)</var>.  Let <var>S</var> be the set of beverages already made, as in the problem statement.</p>\n<ul>\n<li>The first operation makes <var>(2, 0)</var> from <var>(0, 0)</var>, and costs <var>2</var>.<ul>\n<li>After this operation, <var>S = \\{(0, 0), (2, 0)\\}</var>.</li>\n</ul>\n</li>\n<li>The second operation makes <var>(0, 6)</var> from <var>(0, 0)</var>, and costs <var>6</var>.<ul>\n<li>After this operation, <var>S = \\{(0, 0), (2, 0), (0, 6)\\}</var>.</li>\n</ul>\n</li>\n<li>The third operation makes <var>(4, 0)</var> from <var>(2, 0)</var>, and costs <var>2</var>.<ul>\n<li>After this operation, <var>S = \\{(0, 0), (2, 0), (0, 6), (4, 0)\\}</var>.</li>\n</ul>\n</li>\n<li>The fourth operation makes <var>(2, 2)</var> from <var>(2, 0)</var>, and costs <var>2</var>.<ul>\n<li>After this operation, <var>S = \\{(0, 0), (2, 0), (0, 6), (4, 0), (2, 2)\\}</var>.</li>\n</ul>\n</li>\n<li>The fifth operation makes <var>(3, 2)</var> from <var>(2, 2)</var>, and costs <var>1</var>.<ul>\n<li>After this operation, <var>S = \\{(0, 0), (2, 0), (0, 6), (4, 0), (2, 2), (3, 2)\\}</var>.</li>\n</ul>\n</li>\n<li>The sixth operation makes <var>(2, 5)</var> from <var>(2, 2)</var>, and costs <var>3</var>.<ul>\n<li>After this operation, <var>S = \\{(0, 0), (2, 0), (0, 6), (4, 0), (2, 2), (3, 2), (2, 5)\\}</var>.</li>\n</ul>\n</li>\n</ul>\n<p>Finally, <var>S</var> contains all of <var>(0, 6), (2, 5), (3, 2), (4, 0)</var>, so this output will be judged as <span class=\"label label-success\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Accepted\">AC</span>.</p>\n<p>The total cost is <var>16</var>.  Since <var>C = 16, L = 6, N = 4</var>, the score is\n<var>\\mathrm{round}\\left(10^6 \\times \\frac{6 \\times 4}{1 + 16}\\right) = 1411765</var>.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/ahc037/tasks/ahc037_a"}