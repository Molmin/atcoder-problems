{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>6</var> 面サイコロ専門店「さいころや」には、<var>N</var> 個のサイコロが売られています。 <var>i</var> 番目のサイコロに書かれている目は <var>A_{i,1},A_{i,2},\\ldots,A_{i,6}</var> であり、価格は <var>C_i</var> です。</p>\n<p>高橋君はこの中からちょうど <var>K</var> 個のサイコロを選んで購入します。</p>\n<p>現在「さいころや」ではキャンペーンが行われており、購入した <var>K</var> 個のサイコロをそれぞれ一度ずつ振り、出た目の総和の二乗のお金を貰えます。なお、どの目が出るかは一様ランダムであり、各サイコロについて独立です。</p>\n<p>買う <var>K</var> 個のサイコロを適切に決めることで、<var>(</var>キャンペーンで貰えるお金 <var>)-(</var> 購入した <var>K</var> 個のサイコロの価格の合計<var>)</var> の期待値を最大化し、最大化した際の期待値を <var>\\bmod 998244353</var> で求めてください。</p>\n<details>\n<summary>期待値 <var>\\bmod 998244353</var> の定義</summary>\n\n<p>この問題で求める期待値は必ず有理数になることが証明できます。\nまた、この問題の制約下では、求める期待値を既約分数 <var>\\frac{y}{x}</var> で表したときに <var>x</var> が <var>998244353</var> で割り切れないことが保証されます。</p>\n<p>このとき <var>xz \\equiv y \\pmod{998244353}</var> を満たすような <var>0</var> 以上 <var>998244352</var> 以下の整数 <var>z</var> が一意に定まります。この <var>z</var> を答えてください。</p>\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 1000</var></li>\n<li><var>1 \\leq K \\leq N</var></li>\n<li><var>1 \\leq C_i \\leq 10^5</var></li>\n<li><var>1 \\leq A_{i,j} \\leq 10^5</var></li>\n<li>入力は全て整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>K</var>\n<var>C_1</var> <var>C_2</var> <var>\\ldots</var> <var>C_N</var>\n<var>A_{1,1}</var> <var>A_{1,2}</var> <var>\\ldots</var> <var>A_{1,6}</var>\n<var>\\vdots</var>\n<var>A_{N,1}</var> <var>A_{N,2}</var> <var>\\ldots</var> <var>A_{N,6}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 2\n1 2 3\n1 1 1 1 1 1\n2 2 2 2 2 2\n3 3 3 3 3 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>20\n</pre>\n<p><var>2</var> 番目のサイコロと <var>3</var> 番目のサイコロを買うことにすると、<var>(</var>キャンペーンで貰えるお金 <var>)-(</var> 購入した <var>K</var> 個のサイコロの価格の合計<var>)</var> の期待値は <var>(2 + 3)^2 - (2 + 3) = 20</var> となります。これが期待値の最大値です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>10 5\n2 5 6 5 2 1 7 9 7 2\n5 5 2 4 7 6\n2 2 8 7 7 9\n8 1 9 6 10 8\n8 6 10 3 3 9\n1 10 5 8 1 10\n7 8 4 8 6 5\n1 10 2 5 1 7\n7 4 1 4 5 4\n5 10 1 5 1 2\n5 1 2 3 6 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>1014\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>The six-sided dice speciality shop \"Saikoroya\" sells <var>N</var> dice.  The <var>i</var>-th die (singular of dice) has <var>A_{i,1},A_{i,2},\\ldots,A_{i,6}</var> written on its each side, and has a price of <var>C_i</var>.</p>\n<p>Takahashi is going to choose exactly <var>K</var> of them and buy them.</p>\n<p>Currently, \"Saikoroya\" is conducting a promotion: Takahashi may roll each of the purchased dice once and claim money whose amount is equal to the square of the sum of the numbers shown by the dice.  Here, each die shows one of the six numbers uniformly at random and independently.</p>\n<p>Maximize the expected value of (the amount of money he claims) - (the sum of money he pays for the purchased <var>K</var> dice) by properly choosing <var>K</var> dice to buy.  Print the maximized expected value modulo <var>998244353</var>.</p>\n<details>\n<summary>Definition of the expected value modulo <var>998244353</var></summary>\n\n<p>We can prove that the sought expected value is always a rational number.\nMoreover, under the Constraints of this problem, the sought expected value can be expressed by an irreducible fraction <var>\\frac{y}{x}</var> where <var>x</var> is indivisible by <var>998244353</var>.</p>\n<p>In this case, we can uniquely determine the integer <var>z</var> between <var>0</var> and <var>998244352</var> (inclusive) such that <var>xz \\equiv y \\pmod{998244353}</var>.  Print such <var>z</var>.</p>\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 1000</var></li>\n<li><var>1 \\leq K \\leq N</var></li>\n<li><var>1 \\leq C_i \\leq 10^5</var></li>\n<li><var>1 \\leq A_{i,j} \\leq 10^5</var></li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>K</var>\n<var>C_1</var> <var>C_2</var> <var>\\ldots</var> <var>C_N</var>\n<var>A_{1,1}</var> <var>A_{1,2}</var> <var>\\ldots</var> <var>A_{1,6}</var>\n<var>\\vdots</var>\n<var>A_{N,1}</var> <var>A_{N,2}</var> <var>\\ldots</var> <var>A_{N,6}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 2\n1 2 3\n1 1 1 1 1 1\n2 2 2 2 2 2\n3 3 3 3 3 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>20\n</pre>\n<p>If he buys the <var>2</var>-nd and <var>3</var>-rd dice, the expected value of (the amount of money he claims) - (the sum of money he pays for the purchased <var>K</var> dice) equals <var>(2 + 3)^2 - (2 + 3) = 20</var>, which is the maximum expected value.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>10 5\n2 5 6 5 2 1 7 9 7 2\n5 5 2 4 7 6\n2 2 8 7 7 9\n8 1 9 6 10 8\n8 6 10 3 3 9\n1 10 5 8 1 10\n7 8 4 8 6 5\n1 10 2 5 1 7\n7 4 1 4 5 4\n5 10 1 5 1 2\n5 1 2 3 6 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>1014\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc257/tasks/abc257_h"}