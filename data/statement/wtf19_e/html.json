{"html":{"en":"<span class=\"lang-en\">\n<p>Score : <var>2718</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There is a very long bench.\nThe bench is divided into <var>M</var> sections, where <var>M</var> is a very large integer.</p>\n<p>Initially, the bench is vacant.\nThen, <var>M</var> people come to the bench one by one, and perform the following action:</p>\n<ul>\n<li>We call a section <em>comfortable</em> if the section is currently unoccupied and is not adjacent to any occupied sections.\nIf there is no comfortable section, the person leaves the bench.\nOtherwise, the person chooses one of comfortable sections uniformly at random, and sits there.\n(The choices are independent from each other).</li>\n</ul>\n<p>After all <var>M</var> people perform actions, Snuke chooses an interval of <var>N</var> consecutive sections uniformly at random (from <var>M-N+1</var> possible intervals), and takes a photo.\nHis photo can be described by a string of length <var>N</var> consisting of <code>X</code> and <code>-</code>: the <var>i</var>-th character of the string is <code>X</code> if the <var>i</var>-th section from the left in the interval is occupied, and <code>-</code> otherwise.\nNote that the photo is directed.\nFor example, <code>-X--X</code> and <code>X--X-</code> are different photos.</p>\n<p>What is the probability that the photo matches a given string <var>s</var>?\nThis probability depends on <var>M</var>.\nYou need to compute the limit of this probability when <var>M</var> goes infinity.</p>\n<p>Here, we can prove that the limit can be uniquely written in the following format using three <strong>rational</strong> numbers <var>p, q, r</var> and <var>e = 2.718 \\ldots</var> (the base of natural logarithm):</p>\n<p><var>p + \\frac{q}{e} + \\frac{r}{e^2}</var></p>\n<p>Your task is to compute these three rational numbers, and print them modulo <var>10^9 + 7</var>, as described in Notes section.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Notes</h3><p>When you print a rational number, first write it as a fraction <var>\\frac{y}{x}</var>, where <var>x, y</var> are integers and <var>x</var> is not divisible by <var>10^9 + 7</var>\n(under the constraints of the problem, such representation is always possible).\nThen, you need to print the only integer <var>z</var> between <var>0</var> and <var>10^9 + 6</var>, inclusive, that satisfies <var>xz \\equiv y \\pmod{10^9 + 7}</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 1000</var></li>\n<li><var>|s| = N</var></li>\n<li><var>s</var> consists of <code>X</code> and <code>-</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>s</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print three rational numbers <var>p, q, r</var>, separated by spaces.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>1\nX\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>500000004 0 500000003\n</pre>\n\n<p>The probability that a randomly chosen section is occupied converge to <var>\\frac{1}{2} - \\frac{1}{2e^2}</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3\n---\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0 0 0\n</pre>\n\n<p>After the actions, no three consecutive unoccupied sections can be left.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>5\nX--X-\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>0 0 1\n</pre>\n\n<p>The limit is <var>\\frac{1}{e^2}</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>5\nX-X-X\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>500000004 0 833333337\n</pre>\n\n<p>The limit is <var>\\frac{1}{2} - \\frac{13}{6e^2}</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 5</h3><pre>20\n-X--X--X-X--X--X-X-X\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 5</h3><pre>0 0 183703705\n</pre>\n\n<p>The limit is <var>\\frac{7}{675e^2}</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 6</h3><pre>100\nX-X-X-X-X-X-X-X-X-X--X-X-X-X-X-X-X-X-X-X-X-X-X-X-X--X--X-X-X-X--X--X-X-X--X-X-X--X-X--X--X-X--X-X-X-\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 6</h3><pre>0 0 435664291\n</pre></section>\n</div>\n</span>","ja":"<span class=\"lang-ja\">\n<p>配点 : <var>2718</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>非常に細長いベンチがあります。\nこのベンチは <var>M</var> 個の区画に分かれています。ここで、<var>M</var> は非常に大きい整数です。</p>\n<p>はじめ、ベンチには誰も座っていません。\nこのベンチに <var>M</var> 人の人たちが一人ずつ訪れ、以下の行動を行います。</p>\n<ul>\n<li>まだ人が座っておらず、人が座っている区画と隣接もしていないような区画を <em>快適</em> であると呼ぶことにする。\n快適な区画が存在しなければ、ベンチから立ち去る。\nそうでなければ、快適な区画の一つを一様ランダムに選んでそこに座る (人々の座る区画の選択は互いに独立である)。</li>\n</ul>\n<p><var>M</var> 人全員が上記の行動を取ったあと、すぬけ君は <var>N</var> 個の連続する区画からなる区間を (<var>M-N+1</var> 個の候補から) 一様ランダムに選び、その区間の写真を撮ります。\nこの写真は、<code>X</code> と <code>-</code> からなる長さ <var>N</var> の次のような文字列により表現できます: <var>i</var> 文字目は、区間の左から <var>i</var> 番目の区画に人が座っていれば <code>X</code>、そうでなければ <code>-</code> であるような文字列。\nなお、写真の左右は区別されます。\n例えば、<code>-X--X</code> と <code>X--X-</code> は異なる写真です。</p>\n<p>撮った写真が与えられる文字列 <var>s</var> に一致する確率はいくつでしょうか？\nこの確率は <var>M</var> に依存しますが、<var>M</var> が限りなく大きくなるときのこの確率の極限を求めてください。</p>\n<p>ここで、この極限は <var>3</var> つの<strong>有理</strong>数 <var>p, q, r</var> と <var>e = 2.718 \\ldots</var> (自然対数の底) を用いて以下の形式で一意に表せることが証明できます。</p>\n<p><var>p + \\frac{q}{e} + \\frac{r}{e^2}</var></p>\n<p>これら <var>3</var> つの有理数を求め、それらを注記で述べるように mod <var>10^9 + 7</var> で出力してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>注記</h3><p>有理数を出力する際は、まずその有理数を分数 <var>\\frac{y}{x}</var> として表してください。ここで、<var>x, y</var> は整数であり、<var>x</var> は <var>10^9 + 7</var> で割り切れてはなりません (この問題の制約下で、そのような表現は必ず可能です)。そして、<var>xz \\equiv y \\pmod{10^9 + 7}</var> を満たすような <var>0</var> 以上 <var>10^9 + 6</var> 以下の唯一の整数 <var>z</var> を出力してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 1000</var></li>\n<li><var>|s| = N</var></li>\n<li><var>s</var> は <code>X</code> と <code>-</code> からなる。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>s</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>3</var> つの有理数 <var>p, q, r</var> を空白で区切って出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>1\nX\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>500000004 0 500000003\n</pre>\n\n<p>ランダムに選ばれた区画に人が座っている確率は <var>\\frac{1}{2} - \\frac{1}{2e^2}</var> に収束します。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3\n---\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0 0 0\n</pre>\n\n<p>人々の行動のあと、人が座っていない区画が <var>3</var> つ連続して残ることはありません。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>5\nX--X-\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>0 0 1\n</pre>\n\n<p>極限は <var>\\frac{1}{e^2}</var> です。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>5\nX-X-X\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>500000004 0 833333337\n</pre>\n\n<p>極限は <var>\\frac{1}{2} - \\frac{13}{6e^2}</var> です。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 5</h3><pre>20\n-X--X--X-X--X--X-X-X\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 5</h3><pre>0 0 183703705\n</pre>\n\n<p>極限は <var>\\frac{7}{675e^2}</var> です。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 6</h3><pre>100\nX-X-X-X-X-X-X-X-X-X--X-X-X-X-X-X-X-X-X-X-X-X-X-X-X--X--X-X-X-X--X--X-X-X--X-X-X--X-X--X--X-X--X-X-X-\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 6</h3><pre>0 0 435664291\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/wtf19/tasks/wtf19_e"}