{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>800</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>正整数 <var>N,X,Y</var> と長さ <var>N</var> の非負整数列 <var>A=(A_1,A_2,\\ldots,A_N)</var>, <var>B=(B_1,B_2,\\ldots,B_N)</var> が与えられます。</p>\n<p><var>N</var> 個の袋があり、それぞれ袋 <var>1</var> から袋 <var>N</var> までの番号が付けられています。袋 <var>i</var> にははじめ金貨が <var>A_i</var> 枚、銀貨が <var>B_i</var> 枚入っています。</p>\n<p>この <var>N</var> 個の袋を使って高橋君と青木君がゲームをすることを考えます。最初に高橋君がいくつかの袋を取り（一つも取らなくても良い）、高橋君が取らなかった袋を全て青木君が取ります。その後、高橋君から始めて <var>2</var> 人は交互に以下の操作を繰り返します。</p>\n<ul>\n<li>自分の持っている袋のうち金貨か銀貨が <var>1</var> 枚以上入っている袋を選び、選んだ袋に対し以下の <var>2</var> つのうちいずれかを行う。<ul>\n<li>金貨を <var>1</var> 枚取り除き、銀貨を入れる。ただし、銀貨を入れる枚数は高橋君なら <var>X</var> 枚、青木君なら <var>Y</var> 枚である。この操作は金貨が選んだ袋に <var>1</var> 枚以上ある場合にのみ行うことができる。</li>\n<li>銀貨を <var>1</var> 枚取り除く。この操作は銀貨が選んだ袋に <var>1</var> 枚以上ある場合にのみ行うことができる。</li>\n</ul>\n</li>\n<li>その後、選んだ袋を相手に渡す。</li>\n</ul>\n<p>先に操作ができなくなったプレイヤーが負けとなります。</p>\n<p><var>2</var> 人が自分が勝つために最適な行動を取ったとき、高橋君が勝てるような最初の袋の取り方が何通りあるかを <var>998244353</var> で割ったあまりを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1\\le N\\le 2\\times 10^5</var></li>\n<li><var>1\\le X,Y\\le 10^9</var></li>\n<li><var>0\\le A_i,B_i\\le 10^9</var></li>\n<li>入力される値は全て整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>X</var> <var>Y</var>\n<var>A_1</var> <var>B_1</var>\n<var>A_2</var> <var>B_2</var>\n<var>\\vdots</var>\n<var>A_N</var> <var>B_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>2</var> 人が自分が勝つために最適な行動をしたとしたとき、高橋君が勝てるような最初の袋の取り方が何通りあるかを <var>998244353</var> で割ったあまりを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2 1 1\n1 0\n1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2\n</pre>\n<p>高橋君が最初に袋 <var>1,2</var> の両方を取った場合のゲームの進行の一例を示します。</p>\n<ul>\n<li>高橋君が袋 <var>2</var> から金貨を <var>1</var> 枚取り除き、銀貨を <var>1</var> 枚入れる。その後、袋 <var>2</var> を青木君に渡す。<ul>\n<li>高橋君は金貨が <var>1</var> 枚入った袋 <var>1</var> を、青木君は銀貨が <var>2</var> 枚入った袋 <var>2</var> を持っている。</li>\n</ul>\n</li>\n<li>青木君が袋 <var>2</var> から銀貨を <var>1</var> 枚取り除く。その後、袋 <var>2</var> を高橋君に渡す。<ul>\n<li>高橋君は金貨が <var>1</var> 枚入った袋 <var>1</var> と銀貨が <var>1</var> 枚入った袋 <var>2</var> を持っており、青木君は何も持っていない。</li>\n</ul>\n</li>\n<li>高橋君が袋 <var>1</var> から金貨を <var>1</var> 枚取り除き、銀貨を <var>1</var> 枚入れる。その後、袋 <var>1</var> を青木君に渡す。<ul>\n<li>高橋君は銀貨が <var>1</var> 枚入った袋 <var>2</var> を持っており、青木君は銀貨が <var>1</var> 枚入った袋 <var>1</var> を持っている。</li>\n</ul>\n</li>\n<li>青木君が袋 <var>1</var> から銀貨を <var>1</var> 枚取り除く。その後、袋 <var>1</var> を高橋君に渡す。<ul>\n<li>高橋君は空の袋 <var>1</var> と銀貨が <var>1</var> 枚入った袋 <var>2</var> を持っており、青木君は何も持っていない。</li>\n</ul>\n</li>\n<li>高橋君が袋 <var>2</var> から銀貨を <var>1</var> 枚取り除く。その後、袋 <var>2</var> を青木君に渡す。<ul>\n<li>高橋君は空の袋 <var>1</var> を持っており、青木君は空の袋 <var>2</var> を持っている。</li>\n</ul>\n</li>\n<li>青木君は操作ができないので、青木君の負けであり、高橋君の勝ちである。</li>\n</ul>\n<p>高橋君は最初に取る袋が袋 <var>2</var> のみであるか袋 <var>1,2</var> の両方である場合にこのゲームに勝つことができます。したがって、 <var>2</var> を出力してください。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>2 2 1\n1 2\n1 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>3\n</pre>\n<p>高橋君は最初に袋 <var>1,2</var> のどちらか、または両方取った場合にこのゲームに勝つことができます。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>5 8 3\n0 0\n0 0\n0 0\n0 0\n0 0\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>0\n</pre>\n<p>最初に高橋君がどのように袋を取っても高橋君は負けます。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>7 2025 191\n1323 9953\n2763 3225\n2624 5938\n6718 2998\n3741 7040\n9837 1681\n8817 4471\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>40\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>800</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given positive integers <var>N</var>, <var>X</var>, and <var>Y</var>, and two length-<var>N</var> sequences of non-negative integers <var>A = (A_1,A_2,\\ldots,A_N)</var> and <var>B = (B_1,B_2,\\ldots,B_N)</var>.</p>\n<p>There are <var>N</var> bags, numbered from <var>1</var> to <var>N</var>. Initially, bag <var>i</var> contains <var>A_i</var> gold coins and <var>B_i</var> silver coins.</p>\n<p>Consider the following game played by Takahashi and Aoki using these <var>N</var> bags. First, Takahashi takes some of these bags (possibly zero), and Aoki takes all remaining bags. Then, starting with Takahashi, the two players alternate performing the following operation.</p>\n<ul>\n<li>Choose one bag held by the player with at least one gold coin or silver coin in it, and do one of the following two actions for that bag.<ul>\n<li>Remove one gold coin and add silver coins; the number of silver coins to be added is <var>X</var> for Takahashi and <var>Y</var> for Aoki. This action can only be done if the chosen bag has at least one gold coin.</li>\n<li>Remove one silver coin. This action can only be done if the chosen bag has at least one silver coin.</li>\n</ul>\n</li>\n<li>Then, give the chosen bag to the other player.</li>\n</ul>\n<p>The player who cannot perform the operation loses the game.</p>\n<p>Find the number, modulo <var>998244353</var>, of ways Takahashi can initially take bags so that he will win under optimal play by both players.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\le N \\le 2\\times 10^5</var></li>\n<li><var>1 \\le X, Y \\le 10^9</var></li>\n<li><var>0 \\le A_i, B_i \\le 10^9</var></li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>X</var> <var>Y</var>\n<var>A_1</var> <var>B_1</var>\n<var>A_2</var> <var>B_2</var>\n<var>\\vdots</var>\n<var>A_N</var> <var>B_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the number, modulo <var>998244353</var>, of ways Takahashi can initially take bags so that he will win under optimal play by both players.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2 1 1\n1 0\n1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2\n</pre>\n<p>Consider the case where Takahashi initially takes bags <var>1</var> and <var>2</var>. One possible progression of the game is as follows:</p>\n<ol>\n<li>Takahashi chooses bag <var>2</var>, removes <var>1</var> gold coin, and adds <var>1</var> silver coin. Then, he gives bag <var>2</var> to Aoki.<ul>\n<li>Takahashi holds bag <var>1</var> with <var>1</var> gold coin. Aoki holds bag <var>2</var> with <var>2</var> silver coins.</li>\n</ul>\n</li>\n<li>Aoki chooses bag <var>2</var> and removes <var>1</var> silver coin. Then, gives bag <var>2</var> to Takahashi.<ul>\n<li>Takahashi holds bags <var>1</var> with <var>1</var> gold coin and bag <var>2</var> with <var>1</var> silver coin. Aoki holds none.</li>\n</ul>\n</li>\n<li>Takahashi chooses bag <var>1</var>, removes <var>1</var> gold coin, and adds <var>1</var> silver coin. Then, he gives bag <var>1</var> to Aoki.<ul>\n<li>Takahashi holds bag <var>2</var> with <var>1</var> silver coin. Aoki holds bag <var>1</var> with <var>1</var> silver coin.</li>\n</ul>\n</li>\n<li>Aoki chooses bag <var>1</var>, removes <var>1</var> silver coin. Then, he gives bag <var>1</var> to Takahashi.<ul>\n<li>Takahashi holds bag <var>1</var> which is empty and bag <var>2</var> with <var>1</var> silver coin. Aoki holds none.</li>\n</ul>\n</li>\n<li>Takahashi chooses bag <var>2</var> and removes <var>1</var> silver coin. Then, he gives bag <var>2</var> to Aoki.<ul>\n<li>Takahashi holds bag <var>1</var> which is empty. Aoki holds bag <var>2</var> which is empty.</li>\n</ul>\n</li>\n<li>Aoki cannot perform the operation, so Aoki loses and Takahashi wins.</li>\n</ol>\n<p>Takahashi can win if he initially takes only bag <var>2</var>, or if he takes both bags <var>1</var> and <var>2</var>. Therefore, the answer is <var>2</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>2 2 1\n1 2\n1 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>3\n</pre>\n<p>Takahashi wins if he initially takes bag <var>1</var>, bag <var>2</var>, or both. </p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>5 8 3\n0 0\n0 0\n0 0\n0 0\n0 0\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>0\n</pre>\n<p>No matter how Takahashi chooses the bags initially, he will lose.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>7 2025 191\n1323 9953\n2763 3225\n2624 5938\n6718 2998\n3741 7040\n9837 1681\n8817 4471\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>40\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc191/tasks/arc191_e"}