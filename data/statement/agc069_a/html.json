{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>900</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>高橋君は全 <var>10^9</var> 日間からなるトーナメント形式の大会を開くことにしました。<br>\n選手は <var>2^N</var> 人いて、それぞれ選手 <var>1</var>、<var>\\ldots</var>、選手 <var>2^N</var> と呼ばれます。 選手 <var>i</var> は大会の <var>l_i</var> 日目から <var>r_i</var> 日目までの <var>r_i-l_i+1</var> 日間参加する予定です。</p>\n<p>まず、大会の流れを述べます。<var>1 \\leq i \\leq N, 1 \\leq j \\leq 2^{N-i}</var> を満たす整数組 <var>(i,j)</var> は <var>2^N-1</var> 通りありますが、それらと大会中の試合が一対一で対応します。<var>(i,j)</var> に対応する試合では以下に述べる <var>2</var> 人の選手が対戦して勝者と敗者を決めます。</p>\n<ul>\n<li><var>i=1</var> の場合、選手 <var>2j-1</var> と選手 <var>2j</var></li>\n<li><var>i \\geq 2</var> の場合、<var>(i-1, 2j-1)</var> に対応する試合の勝者と <var>(i-1,2j)</var> に対応する試合の勝者</li>\n</ul>\n<p>各試合は、対戦することになる <var>2</var> 人を決める為に必要な試合すべてが完了していて、かつその <var>2</var> 人が大会に参加中ならばただちに完了させられます。特に、一人の選手が同日に複数の試合を行うことも可能です。<br>\n<var>(N, 1)</var> に対応する試合は決勝戦と呼ばれ、これを完了させるのが大会の目的です。 </p>\n<p>高橋君は決勝戦を完了させて大会を成功させるために、以下の工作を行うことにしました。</p>\n<ul>\n<li>審判に指示を出し、各試合の勝者を都合よく決める。</li>\n<li>各選手にお金を払い、参加する日程を変えてもらう。選手 <var>i</var> に <var>l'_i</var> 日目から <var>r'_i</var> 日目まで参加してもらう場合、<var>|l_i-l'_i|+|r_i-r'_i|</var> 円を支払う必要がある。ここで、<var>l'_i, r'_i</var> は <var>1\\leq l'_i \\leq r'_i \\leq 10^9</var> を満たす整数である。</li>\n</ul>\n<p>高橋君が選手たちに支払う必要のある金額の総和の最小値を求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 18</var></li>\n<li><var>1 \\leq l_i \\leq r_i \\leq 10^9</var></li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>l_1</var> <var>r_1</var>\n<var>\\vdots</var>\n<var>l_{2^N}</var> <var>r_{2^N}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>支払う必要のある金額の総和の最小値を <var>X</var> 円とする。<var>X</var> を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n1 4\n1 3\n3 4\n2 2\n3 4\n4 4\n2 3\n3 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>1\n</pre>\n<p>選手 <var>4</var> に <var>1</var> 円を払って <var>(l'_4, r'_4)=(2,3)</var> に変え、他の選手の日程は変えないことにします。すると、例えば以下のようにして決勝戦を完了させることができます。</p>\n<ol>\n<li><var>1</var> 日目に <var>(1,1)</var> に対応する試合(選手 <var>1</var> 対選手 <var>2</var> )を行い、選手 <var>2</var> を勝たせる。</li>\n<li><var>3</var> 日目に <var>(1,2)</var> に対応する試合(選手 <var>3</var> 対選手 <var>4</var> )を行い、選手 <var>3</var> を勝たせる。</li>\n<li><var>3</var> 日目に <var>(2,1)</var> に対応する試合(選手 <var>2</var> 対選手 <var>3</var> )を行い、選手 <var>3</var> を勝たせる。</li>\n<li><var>3</var> 日目に <var>(1,4)</var> に対応する試合(選手 <var>7</var> 対選手 <var>8</var> )を行い、選手 <var>8</var> を勝たせる。</li>\n<li><var>4</var> 日目に <var>(1,3)</var> に対応する試合(選手 <var>5</var> 対選手 <var>6</var> )を行い、選手 <var>5</var> を勝たせる。</li>\n<li><var>4</var> 日目に <var>(2,2)</var> に対応する試合(選手 <var>5</var> 対選手 <var>8</var> )を行い、選手 <var>8</var> を勝たせる。</li>\n<li><var>4</var> 日目に <var>(3,1)</var> に対応する試合(選手 <var>3</var> 対選手 <var>8</var> )を行い、選手 <var>8</var> を勝たせる。</li>\n</ol>\n<p>一方、<var>1</var> 円未満の支払いで決勝戦を完了させることはできません。そのため、<var>1</var> が期待される出力です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>1\n1 1\n1000000000 1000000000\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>999999999\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>4\n158260522 877914575\n24979445 602436426\n623690081 861648772\n433933447 476190629\n211047202 262703497\n628894325 971407775\n731963982 822804784\n430302156 450968417\n161735902 982631932\n880895728 923078537\n189330739 707723857\n802329211 910286918\n303238506 404539679\n317063340 492686568\n125660016 773361868\n650287940 839296263\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1088492036\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>900</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Takahashi decided to hold a tournament that lasts for <var>10^9</var> days in a single-elimination format.<br>\nThere are <var>2^N</var> players, called player <var>1</var>, <var>\\ldots</var>, player <var>2^N</var>. Player <var>i</var> plans to participate from day <var>l_i</var> to day <var>r_i</var> of the tournament, for a total of <var>r_i - l_i + 1</var> days.</p>\n<p>First, we describe the flow of the tournament. There are <var>2^N - 1</var> matches in total, corresponding one-to-one with the integer pairs <var>(i, j)</var> satisfying <var>1 \\leq i \\leq N</var> and <var>1 \\leq j \\leq 2^{N - i}</var>. In the match corresponding to <var>(i, j)</var>, the following two players compete to decide the winner and the loser:</p>\n<ul>\n<li>If <var>i = 1</var>, players <var>2j - 1</var> and <var>2j</var></li>\n<li>If <var>i \\geq 2</var>, the winners of the matches corresponding to <var>(i - 1, 2j - 1)</var> and <var>(i - 1, 2j)</var></li>\n</ul>\n<p>Each match can be completed immediately when all the matches necessary to determine the two players who will compete in it have been completed, and both players are currently participating in the tournament. In particular, a single player can participate in multiple matches on the same day.<br>\nThe match corresponding to <var>(N, 1)</var> is called the final, and the goal of the tournament is to complete it.</p>\n<p>To successfully complete the final, Takahashi decided to perform the following manipulations:</p>\n<ul>\n<li>Instruct the referees to fix the outcomes of the matches as desired.</li>\n<li>Pay the players to change their participation schedules. To make player <var>i</var> participate from day <var>l'_i</var> to day <var>r'_i</var>, Takahashi needs to pay <var>|l_i - l'_i| + |r_i - r'_i|</var> yen. Here, <var>l'_i</var> and <var>r'_i</var> are integers satisfying <var>1 \\leq l'_i \\leq r'_i \\leq 10^9</var>.</li>\n</ul>\n<p>Find the minimum total amount of money Takahashi needs to pay the players.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 18</var></li>\n<li><var>1 \\leq l_i \\leq r_i \\leq 10^9</var></li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>l_1</var> <var>r_1</var>\n<var>\\vdots</var>\n<var>l_{2^N}</var> <var>r_{2^N}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Let <var>X</var> be the minimum total amount of money Takahashi needs to pay. Print <var>X</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n1 4\n1 3\n3 4\n2 2\n3 4\n4 4\n2 3\n3 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>1\n</pre>\n<p>Assume that Takahashi pays <var>1</var> yen to player <var>4</var> to change his participation schedule to <var>(l'_4, r'_4) = (2, 3)</var>, and not change the schedules of the other players. Then, for example, the final can be completed as follows:</p>\n<ol>\n<li>On Day <var>1</var>, conduct the match corresponding to <var>(1, 1)</var> (player <var>1</var> vs. player <var>2</var>), and let player <var>2</var> win.</li>\n<li>On Day <var>3</var>, conduct the match corresponding to <var>(1, 2)</var> (player <var>3</var> vs. player <var>4</var>), and let player <var>3</var> win.</li>\n<li>On Day <var>3</var>, conduct the match corresponding to <var>(2, 1)</var> (player <var>2</var> vs. player <var>3</var>), and let player <var>3</var> win.</li>\n<li>On Day <var>3</var>, conduct the match corresponding to <var>(1, 4)</var> (player <var>7</var> vs. player <var>8</var>), and let player <var>8</var> win.</li>\n<li>On Day <var>4</var>, conduct the match corresponding to <var>(1, 3)</var> (player <var>5</var> vs. player <var>6</var>), and let player <var>5</var> win.</li>\n<li>On Day <var>4</var>, conduct the match corresponding to <var>(2, 2)</var> (player <var>5</var> vs. player <var>8</var>), and let player <var>8</var> win.</li>\n<li>On Day <var>4</var>, conduct the match corresponding to <var>(3, 1)</var> (player <var>3</var> vs. player <var>8</var>), and let player <var>8</var> win.</li>\n</ol>\n<p>On the other hand, it is impossible to complete the final with less than <var>1</var> yen of payments. Therefore, the expected output is <var>1</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>1\n1 1\n1000000000 1000000000\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>999999999\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>4\n158260522 877914575\n24979445 602436426\n623690081 861648772\n433933447 476190629\n211047202 262703497\n628894325 971407775\n731963982 822804784\n430302156 450968417\n161735902 982631932\n880895728 923078537\n189330739 707723857\n802329211 910286918\n303238506 404539679\n317063340 492686568\n125660016 773361868\n650287940 839296263\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1088492036\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc069/tasks/agc069_a"}