{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>700</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>H \\times W</var> のマス目に区切られた長方形の紙があり，このうちちょうど <var>2</var> マスが黒く，残りの部分は白く塗られています．マス目の <var>i</var> 行目，<var>j</var> 列目にあるマスを <var>(i, j)</var> で表すと，黒く塗られているのはマス <var>(h_1, w_1)</var> とマス <var>(h_2, w_2)</var> です．</p>\n<p>maroon 君はこれから以下の手順で紙を切断する操作を繰り返します．</p>\n<ul>\n<li>現在の紙のマス目が <var>h \\times w</var> の時，紙の辺に平行でマスの境界を通るような直線には，<var>(h - 1)</var> 本の横線と <var>(w - 1)</var> 本の縦線がある．この中から <var>1</var> 本を一様ランダムに選んで，その直線に沿って紙を <var>2</var> 枚に切断する．このとき，<ul>\n<li><var>2</var> つの黒いマスが同じ紙に存在するとき，もう片方の紙を捨て，操作を続ける</li>\n<li>そうでなければ，操作を終了する</li>\n</ul>\n</li>\n</ul>\n<p>maroon 君が操作を終了するまでに紙を切断する回数の期待値を <var>{\\bmod} 998244353</var> で求めてください．</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>注記</h3><p>求める期待値は必ず有理数になることが証明できます．またこの問題の制約のもとでは，その値を既約分数 <var>\\frac{P}{Q}</var> で表した時，<var>Q \\not \\equiv 0 \\pmod{998244353}</var> となることも証明できます．よって，<var>R \\times Q \\equiv P \\pmod{998244353}, 0 \\leq R &lt; 998244353</var> を満たす整数 <var>R</var> が一意に定まります．この <var>R</var> を答えてください．</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq H, W \\leq 10^5</var></li>\n<li><var>H \\times W \\geq 2</var></li>\n<li><var>1 \\leq h_1, h_2 \\leq H</var></li>\n<li><var>1 \\leq w_1, w_2 \\leq W</var></li>\n<li><var>(h_1, w_1) \\neq (h_2, w_2)</var></li>\n<li>入力は全て整数   </li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる．</p>\n<pre><var>H</var> <var>W</var>\n<var>h_1</var> <var>w_1</var> <var>h_2</var> <var>w_2</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>maroon 君が操作を終了するまでに紙を切断する回数の期待値を <var>{\\bmod} 998244353</var> で出力せよ．</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2 3\n2 2 1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>332748119\n</pre>\n<p>まず，<var>1</var> 回目の切断で確率 <var>2/3</var> で操作が終了します．残りの <var>1/3</var> については，次の切断で操作が終了します．</p>\n<p>よって，紙を切断する回数の期待値は，<var>1 \\times 2/3 + 2 \\times 1/3 = 4/3</var> です．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>1 5\n1 2 1 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>332748120\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>2 1\n2 1 1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1\n</pre>\n<p>操作は <var>1</var> 回の切断で必ず終了します．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>10 10\n3 4 5 6\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>831078040\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>700</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have a rectangular piece of paper divided into <var>H \\times W</var> squares, where two of those squares are painted black and the rest are painted white. If we let <var>(i, j)</var> denote the square at the <var>i</var>-th row and <var>j</var>-th column, the squares painted black are <var>(h_1, w_1)</var> and <var>(h_2, w_2)</var>.</p>\n<p>Maroon will repeat the following operation to cut the piece of paper:</p>\n<ul>\n<li>Assume that we have <var>h \\times w</var> squares remaining. There are <var>(h - 1)</var> horizontal lines and <var>(w - 1)</var> vertical lines that are parallel to the edges of the piece and pass the borders of the squares. He chooses one of these lines uniformly at random and cuts the piece into two along that line. Then,<ul>\n<li>if the two black squares are on the same piece, he throws away the other piece and continues the process;</li>\n<li>otherwise, he ends the process.</li>\n</ul>\n</li>\n</ul>\n<p>Find the expected value of the number of times Maroon cuts a piece of paper until he ends the process, modulo <var>998244353</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Notes</h3><p>We can prove that the expected value in question is always a rational number. Additionally, under the constraints of this problem, we can also prove that if we express that value as an irreducible fraction <var>\\frac{P}{Q}</var>, we have <var>Q \\not \\equiv 0 \\pmod{998244353}</var>. Thus, there exists a unique integer <var>R</var> such that <var>R \\times Q \\equiv P \\pmod{998244353}, 0 \\leq R &lt; 998244353</var>. Answer this <var>R</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq H, W \\leq 10^5</var></li>\n<li><var>H \\times W \\geq 2</var></li>\n<li><var>1 \\leq h_1, h_2 \\leq H</var></li>\n<li><var>1 \\leq w_1, w_2 \\leq W</var></li>\n<li><var>(h_1, w_1) \\neq (h_2, w_2)</var></li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>H</var> <var>W</var>\n<var>h_1</var> <var>w_1</var> <var>h_2</var> <var>w_2</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Print</h3><p>Find the expected value of the number of times Maroon cuts a piece of paper until he ends the process, modulo <var>998244353</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2 3\n2 2 1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>332748119\n</pre>\n<p>In the first cut, the process will end with probability <var>2/3</var>. For the remaining case with probability <var>1/3</var>, the process will end in the second cut.</p>\n<p>Thus, the expected number of cuts is <var>1 \\times 2/3 + 2 \\times 1/3 = 4/3</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>1 5\n1 2 1 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>332748120\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>2 1\n2 1 1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1\n</pre>\n<p>The process will always end in the first cut.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>10 10\n3 4 5 6\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>831078040\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc114/tasks/arc114_e"}