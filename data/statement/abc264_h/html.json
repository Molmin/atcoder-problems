{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>頂点に <var>1,2,\\dots,N</var> の番号が付いた、 <var>N</var> 頂点の根付き木があります。<br>\n根は頂点 <var>1</var> であり、頂点 <var>i \\ge 2</var> について、その親は <var>P_i(&lt;i)</var> です。<br>\n整数 <var>k=1,2,\\dots,N</var> に対し次の問題を解いてください。</p>\n<p>番号が <var>1</var> 以上 <var>k</var> 以下の頂点を、頂点 <var>1</var> を含むようにいくつか選ぶ方法は <var>2^{k-1}</var> 通りあります。<br>\nそのうち、選ばれた頂点集合から誘導される部分グラフの形状が頂点 <var>1</var> を根とする (頂点数がある正整数 <var>d</var> を用いて <var>2^d-1</var> と表せるような) 完全二分木になるような頂点の選び方はいくつですか?<br>\n答えは非常に大きくなる場合があるので、<var>998244353</var> で割った余りを求めてください。</p>\n<details>\n<p></p><summary>誘導される部分グラフとは?</summary><p></p>\n<p>あるグラフ <var>G</var> から、一部の頂点を選んだ集合を <var>S</var> とします。この頂点集合 <var>S</var> から誘導される部分グラフ <var>H</var> は以下のように構成されます。  </p>\n<ul>\n<li><var>H</var> の頂点集合は <var>S</var> と一致させます。</li>\n<li>その後、 <var>H</var> に以下のように辺を追加します。</li>\n<ul>\n<li><var>i,j \\in S, i &lt; j</var> を満たす全ての頂点対 <var>(i,j)</var> について、 <var>G</var> 中に <var>i,j</var> を結ぶ辺が存在すれば、 <var>H</var> にも <var>i,j</var> を結ぶ辺を追加する。</li>\n</ul>\n</ul>\n\n</details>\n<details>\n\n<summary>完全二分木とは?</summary>\n\n完全二分木とは、以下の全ての条件を満たす根付き木です。\n\n<ul>\n<li>葉以外の全ての頂点が、ちょうど <var>2</var> つの子を持つ。</li>\n<li>全ての葉が根から等距離にある。</li>\n</ul>\n\nただし、頂点が <var>1</var> つで辺が <var>0</var> 本のグラフも完全二分木であるものとします。  \n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li>入力は全て整数</li>\n<li><var>1 \\le N \\le 3 \\times 10^5</var></li>\n<li><var>1 \\le P_i &lt; i</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>P_2</var> <var>P_3</var> <var>\\dots</var> <var>P_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>N</var> 行出力せよ。\nそのうち <var>i</var> ( <var>1 \\le i \\le N</var> ) 行目には <var>k=i</var> についての答えを整数として出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>10\n1 1 2 1 2 5 5 5 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>1\n1\n2\n2\n4\n4\n4\n5\n7\n10\n</pre>\n<ul>\n<li><var>k \\ge 1</var> であるとき <var>\\{1\\}</var></li>\n<li><var>k \\ge 3</var> であるとき <var>\\{1,2,3\\}</var></li>\n<li><var>k \\ge 5</var> であるとき <var>\\{1,2,5\\},\\{1,3,5\\}</var></li>\n<li><var>k \\ge 8</var> であるとき <var>\\{1,2,4,5,6,7,8\\}</var></li>\n<li><var>k \\ge 9</var> であるとき <var>\\{1,2,4,5,6,7,9\\},\\{1,2,4,5,6,8,9\\}</var></li>\n<li><var>k = 10</var> であるとき <var>\\{1,2,10\\},\\{1,3,10\\},\\{1,5,10\\}</var></li>\n</ul>\n<p>が数えるべき頂点の選び方となります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>1\n\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>1\n</pre>\n<p><var>N=1</var> である場合、入力の <var>2</var> 行目は空行です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>10\n1 2 3 4 5 6 7 8 9\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>13\n1 1 1 2 2 2 3 3 3 4 4 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>1\n1\n2\n4\n4\n4\n4\n4\n7\n13\n13\n19\n31\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have a rooted tree with <var>N</var> vertices numbered <var>1,2,\\dots,N</var>.<br>\nThe tree is rooted at Vertex <var>1</var>, and the parent of Vertex <var>i \\ge 2</var> is Vertex <var>P_i(&lt;i)</var>.<br>\nFor each integer <var>k=1,2,\\dots,N</var>, solve the following problem:</p>\n<p>There are <var>2^{k-1}</var> ways to choose some of the vertices numbered between <var>1</var> and <var>k</var> so that Vertex <var>1</var> is chosen.<br>\nHow many of them satisfy the following condition: the subgraph induced by the set of chosen vertices forms a perfect binary tree (with <var>2^d-1</var> vertices for a positive integer <var>d</var>) rooted at Vertex <var>1</var>?<br>\nSince the count may be enormous, print the count modulo <var>998244353</var>.</p>\n<details>\n<p></p><summary>What is an induced subgraph?</summary><p></p>\n<p>Let <var>S</var> be a subset of the vertex set of a graph <var>G</var>.  The subgraph <var>H</var> induced by this vertex set <var>S</var> is constructed as follows:  </p>\n<ul>\n<li>Let the vertex set of <var>H</var> equal <var>S</var>.</li>\n<li>Then, we add edges to <var>H</var> as follows:</li>\n<ul>\n<li>For all vertex pairs <var>(i, j)</var> such that <var>i,j \\in S, i &lt; j</var>, if there is an edge connecting <var>i</var> and <var>j</var> in <var>G</var>, then add an edge connecting <var>i</var> and <var>j</var> to <var>H</var>.</li>\n</ul>\n</ul>\n\n</details>\n<details>\n\n<summary>What is a perfect binary tree?</summary>\n\nA perfect binary tree is a rooted tree that satisfies all of the following conditions:\n\n<ul>\n<li>Every vertex that is not a leaf has exactly <var>2</var> children.</li>\n<li>All leaves have the same distance from the root.</li>\n</ul>\n\nHere, we regard a graph with <var>1</var> vertex and <var>0</var> edges as a perfect binary tree, too.  \n\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li>All values in input are integers.</li>\n<li><var>1 \\le N \\le 3 \\times 10^5</var></li>\n<li><var>1 \\le P_i &lt; i</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>P_2</var> <var>P_3</var> <var>\\dots</var> <var>P_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>N</var> lines.\nThe <var>i</var>-th (<var>1 \\le i \\le N</var>) line should contain the answer as an integer when <var>k=i</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>10\n1 1 2 1 2 5 5 5 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>1\n1\n2\n2\n4\n4\n4\n5\n7\n10\n</pre>\n<p>The following ways of choosing vertices should be counted:</p>\n<ul>\n<li><var>\\{1\\}</var> when <var>k \\ge 1</var></li>\n<li><var>\\{1,2,3\\}</var> when <var>k \\ge 3</var></li>\n<li><var>\\{1,2,5\\},\\{1,3,5\\}</var> when <var>k \\ge 5</var></li>\n<li><var>\\{1,2,4,5,6,7,8\\}</var> when <var>k \\ge 8</var></li>\n<li><var>\\{1,2,4,5,6,7,9\\},\\{1,2,4,5,6,8,9\\}</var> when <var>k \\ge 9</var></li>\n<li><var>\\{1,2,10\\},\\{1,3,10\\},\\{1,5,10\\}</var> when <var>k = 10</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>1\n\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>1\n</pre>\n<p>If <var>N=1</var>, the <var>2</var>-nd line of the Input is empty.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>10\n1 2 3 4 5 6 7 8 9\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>13\n1 1 1 2 2 2 3 3 3 4 4 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>1\n1\n2\n4\n4\n4\n4\n4\n7\n13\n13\n19\n31\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc264/tasks/abc264_h"}