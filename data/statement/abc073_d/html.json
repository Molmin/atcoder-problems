{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>400</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>Atcoder国には <var>N</var> 個の町があり、<var>M</var> 本の双方向に移動可能な道で結ばれています。</p>\n<p>また、 <var>i</var> 本目の道は町 <var>A_i</var> と町 <var>B_i</var> の間を距離 <var>C_i</var> で結んでいます。</p>\n<p>joisinoお姉ちゃんは、この国の <var>R</var> 個の町 <var>r_1,r_2..r_R</var> を訪れることとなりました。</p>\n<p>最初に訪れる町までの移動と、最後に訪れる町からの移動は空路で行うが、それ以外は道を使わなければなりません。</p>\n<p>町を訪れる順番を、道での移動距離が最小となるように決めた時の移動距離を答えてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2≦N≦200</var></li>\n<li><var>1≦M≦N×(N-1)/2</var></li>\n<li><var>2≦R≦min(8,N)</var>  ( <var>min(8,N)</var> は <var>8</var> と <var>N</var> のうち小さい方)</li>\n<li><var>r_i≠r_j (i≠j)</var></li>\n<li><var>1≦A_i,B_i≦N , A_i≠B_i</var></li>\n<li><var>(A_i,B_i)≠(A_j,B_j),(A_i,B_i)≠(B_j,A_j) (i≠j)</var></li>\n<li><var>1≦C_i≦100000</var></li>\n<li>すべての町の間は道のみで移動することができる。</li>\n<li>入力は全て整数である。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var> <var>R</var>\n<var>r_1</var> <var>...</var> <var>r_R</var>\n<var>A_1</var> <var>B_1</var> <var>C_1</var>\n<var>:</var>\n<var>A_M</var> <var>B_M</var> <var>C_M</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>町を訪れる順番を、道での移動距離が最小となるように決めた時の移動距離を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 3 3\n1 2 3\n1 2 1\n2 3 1\n3 1 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2\n</pre>\n\n<p>例えば、町 <var>1</var> ,町 <var>2</var> ,町 <var>3</var> の順番で訪れると、移動距離が <var>2</var> となり、最小となります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 3 2\n1 3\n2 3 2\n1 3 6\n1 2 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>4\n</pre>\n\n<p>町 <var>1</var> を訪れたあとに町 <var>3</var> を訪れても、町 <var>3</var> を訪れたあとに町 <var>1</var> を訪れても、町 <var>1</var> と町 <var>3</var> の間の最短距離は <var>4</var> であるため、どの順番を選んだとしても答えは <var>4</var> となります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>4 6 3\n2 3 4\n1 2 4\n2 3 3\n4 3 1\n1 4 1\n4 2 2\n3 1 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>3\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>400</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>N</var> towns in the State of Atcoder, connected by <var>M</var> bidirectional roads.</p>\n<p>The <var>i</var>-th road connects Town <var>A_i</var> and <var>B_i</var> and has a length of <var>C_i</var>.</p>\n<p>Joisino is visiting <var>R</var> towns in the state, <var>r_1,r_2,..,r_R</var> (not necessarily in this order).</p>\n<p>She will fly to the first town she visits, and fly back from the last town she visits, but for the rest of the trip she will have to travel by road.</p>\n<p>If she visits the towns in the order that minimizes the distance traveled by road, what will that distance be?</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2≤N≤200</var></li>\n<li><var>1≤M≤N×(N-1)/2</var></li>\n<li><var>2≤R≤min(8,N)</var> (<var>min(8,N)</var> is the smaller of <var>8</var> and <var>N</var>.)</li>\n<li><var>r_i≠r_j (i≠j)</var></li>\n<li><var>1≤A_i,B_i≤N, A_i≠B_i</var></li>\n<li><var>(A_i,B_i)≠(A_j,B_j),(A_i,B_i)≠(B_j,A_j) (i≠j)</var></li>\n<li><var>1≤C_i≤100000</var></li>\n<li>Every town can be reached from every town by road.</li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>R</var>\n<var>r_1</var> <var>...</var> <var>r_R</var>\n<var>A_1</var> <var>B_1</var> <var>C_1</var>\n<var>:</var>\n<var>A_M</var> <var>B_M</var> <var>C_M</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the distance traveled by road if Joisino visits the towns in the order that minimizes it.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 3 3\n1 2 3\n1 2 1\n2 3 1\n3 1 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2\n</pre>\n\n<p>For example, if she visits the towns in the order of <var>1</var>, <var>2</var>, <var>3</var>, the distance traveled will be <var>2</var>, which is the minimum possible.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 3 2\n1 3\n2 3 2\n1 3 6\n1 2 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>4\n</pre>\n\n<p>The shortest distance between Towns <var>1</var> and <var>3</var> is <var>4</var>. Thus, whether she visits Town <var>1</var> or <var>3</var> first, the distance traveled will be <var>4</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>4 6 3\n2 3 4\n1 2 4\n2 3 3\n4 3 1\n1 4 1\n4 2 2\n3 1 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>3\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc073/tasks/abc073_d"}