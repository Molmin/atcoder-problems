{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1000</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 頂点の木が与えられます。頂点には <var>1, \\ldots,N</var> の番号がついており、<var>i</var> 番目の辺は頂点 <var>u_i</var> と頂点 <var>v_i</var> をつないでいます。また、頂点 <var>i</var> には整数 <var>h_i</var> が書かれています。<br>\n駒が <var>K</var> 個あり、<var>i</var> 番目の駒ははじめ頂点 <var>s_i</var> に置かれています。あなたはこれから「一つ駒を選び、それが現在置かれている頂点に隣接するいずれかの頂点に移動させる」という操作を繰り返します。\n各駒 <var>i</var> が頂点 <var>t_i</var> に置かれている状態になったら操作を終了します。各駒 <var>i</var> を頂点 <var>s_i</var> から頂点 <var>t_i</var> へ最短経路で移動させる必要は<strong>ありません</strong>。<br>\nある駒の配置に対して、それぞれの駒が置かれている頂点に書かれた整数を足し合わせた値を<strong>ポテンシャル</strong>と呼ぶことにします。ただし、同じ頂点に複数の駒がある場合、その頂点の整数はその駒の個数だけ足し合わせるものとします。<br>\n操作を通してのポテンシャルの最大値は最小でいくつになるか求めてください。ただし、はじめの状態と終わりの状態も考えるものとします。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N,K \\leq 2000</var></li>\n<li><var>1 \\leq u_i,v_i \\leq N</var></li>\n<li><var>1 \\leq h_i \\leq 10^9</var></li>\n<li><var>1 \\leq s_i,t_i \\leq N</var></li>\n<li>与えられるグラフは木</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>h_1</var> <var>h_2</var> <var>\\ldots</var> <var>h_N</var>\n<var>u_1</var> <var>v_1</var>\n<var>u_2</var> <var>v_2</var>\n<var>:</var>\n<var>u_{N-1}</var> <var>v_{N-1}</var>\n<var>K</var>\n<var>s_1</var> <var>t_1</var>\n<var>s_2</var> <var>t_2</var>\n<var>:</var>\n<var>s_K</var> <var>t_K</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n1 3 2\n1 2\n2 3\n2\n1 3\n3 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>4\n</pre>\n\n<p>以下のように操作をすることで操作を通してのポテンシャルの最大値は <var>4</var> となります。</p>\n<ul>\n<li>はじめ、ポテンシャルは <var>3</var>。</li>\n<li>駒 <var>2</var> を頂点 <var>2</var> に移動させる。ポテンシャルは <var>4</var> になる。</li>\n<li>駒 <var>2</var> を頂点 <var>1</var> に移動させる。ポテンシャルは <var>2</var> になる。</li>\n<li>駒 <var>1</var> を頂点 <var>2</var> に移動させる。ポテンシャルは <var>4</var> になる。</li>\n<li>駒 <var>1</var> を頂点 <var>3</var> に移動させる。ポテンシャルは <var>3</var> になる。</li>\n</ul>\n<p>ポテンシャルの最大値が <var>4</var> より小さくなるような操作の方法は存在しないため、<var>4</var> が答えです。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>7\n100 101 1 100 101 1 1000\n1 2\n2 3\n4 5\n5 6\n1 7\n4 7\n2\n1 3\n4 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>201\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>5\n2 1 100 5 6\n1 2\n2 3\n3 4\n3 5\n2\n2 2\n4 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>101\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>4\n1 2 3 100\n1 4\n2 4\n3 4\n9\n1 1\n1 2\n1 3\n2 1\n2 2\n2 3\n3 1\n3 2\n3 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>115\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 5</h3><pre>6\n1 100 1 1 10 1000\n1 2\n2 3\n4 5\n1 6\n4 6\n3\n1 3\n5 5\n5 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 5</h3><pre>102\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1000</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Given is a tree with <var>N</var> vertices numbered <var>1, \\ldots, N</var>. The <var>i</var>-th edge connects Vertex <var>u_i</var> and Vertex <var>v_i</var>. Additionally, Vertex <var>i</var> has an integer <var>h_i</var> written on it. <br>\nWe have <var>K</var> pieces, the <var>i</var>-th of which is initially on Vertex <var>s_i</var>. You will repeat the following operation: choose a piece and move it to one of the vertices adjacent to the vertex the piece is currently on.\nYou will end this process when each piece <var>i</var> is on Vertex <var>t_i</var>. It is <strong>not</strong> required for each piece <var>i</var> to go along the shortest path from Vertex <var>s_i</var> to Vertex <var>t_i</var>. <br>\nFor an arrangement of the pieces, let its <strong>potential</strong> be the sum of the integers written on the vertices the pieces are on. If multiple pieces are on the same vertex, the integer on that vertex is added the number of times equal to that number of pieces. <br>\nFind the minimum possible value of the maximum potential during the process, including the initial and final states.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N,K \\leq 2000</var></li>\n<li><var>1 \\leq u_i,v_i \\leq N</var></li>\n<li><var>1 \\leq h_i \\leq 10^9</var></li>\n<li><var>1 \\leq s_i,t_i \\leq N</var></li>\n<li>The given graph is a tree.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>h_1</var> <var>h_2</var> <var>\\ldots</var> <var>h_N</var>\n<var>u_1</var> <var>v_1</var>\n<var>u_2</var> <var>v_2</var>\n<var>:</var>\n<var>u_{N-1}</var> <var>v_{N-1}</var>\n<var>K</var>\n<var>s_1</var> <var>t_1</var>\n<var>s_2</var> <var>t_2</var>\n<var>:</var>\n<var>s_K</var> <var>t_K</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n1 3 2\n1 2\n2 3\n2\n1 3\n3 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>4\n</pre>\n\n<p>We can make <var>4</var> the maximum potential during the process, as follows:</p>\n<ul>\n<li>Initially, the potential is <var>3</var>.</li>\n<li>Move Piece <var>2</var> to Vertex <var>2</var>. The potential is now <var>4</var>.</li>\n<li>Move Piece <var>2</var> to Vertex <var>1</var>. The potential is now <var>2</var>.</li>\n<li>Move Piece <var>1</var> to Vertex <var>2</var>. The potential is now <var>4</var>.</li>\n<li>Move Piece <var>1</var> to Vertex <var>3</var>. The potential is now <var>3</var>.</li>\n</ul>\n<p>There is no way to make the maximum potential during the process less than <var>4</var>, so the answer is <var>4</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>7\n100 101 1 100 101 1 1000\n1 2\n2 3\n4 5\n5 6\n1 7\n4 7\n2\n1 3\n4 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>201\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>5\n2 1 100 5 6\n1 2\n2 3\n3 4\n3 5\n2\n2 2\n4 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>101\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>4\n1 2 3 100\n1 4\n2 4\n3 4\n9\n1 1\n1 2\n1 3\n2 1\n2 2\n2 3\n3 1\n3 2\n3 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>115\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 5</h3><pre>6\n1 100 1 1 10 1000\n1 2\n2 3\n4 5\n1 6\n4 6\n3\n1 3\n5 5\n5 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 5</h3><pre>102\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc115/tasks/arc115_f"}