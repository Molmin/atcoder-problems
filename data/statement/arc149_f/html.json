{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>900</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>r &gt; 1</var> を有理数とし，<var>p</var> を <var>r</var> の分子，<var>q</var> を <var>r</var> の分母とします．つまり <var>p, q</var> は正整数で <var>r = \\frac{p}{q}</var> かつ <var>\\gcd(p,q) = 1</var> が成り立つとします．</p>\n<p>正整数 <var>n</var> の <strong><var>\\boldsymbol{r}</var> 進法展開</strong> を，次の条件をすべて満たす整数列 <var>(a_1, \\ldots, a_k)</var> のことと定義します．</p>\n<ul>\n<li><var>a_i</var> は <var>0</var> 以上 <var>p-1</var> 以下の整数</li>\n<li><var>a_1\\neq 0</var></li>\n<li><var>n = \\sum_{i=1}^k a_ir^{k-i}</var></li>\n</ul>\n<p>任意の正整数 <var>n</var> が唯一の <var>r</var> 進法展開を持つことが証明できます．</p>\n<hr>\n<p>正整数 <var>p, q, N, L, R</var> が与えられます．ここで，<var>p, q</var> は <var>1.01 \\leq \\frac{p}{q}</var> を満たします．</p>\n<p><var>N</var> 以下の正整数全体を，<var>\\frac{p}{q}</var> 進法展開の辞書順が小さい方から順に並べたとき，<var>L, L+1, \\ldots, R</var> 番目に並ぶ正整数を答えてください．</p>\n<p>なお，正整数の入出力には通常の <var>10</var> 進法表記が用いられます．</p>\n<details> <summary>数列の辞書順とは？</summary>\n\n<p>\n数列 <var>A = (A_1, \\ldots, A_{|A|})</var> が <var>B = (B_1, \\ldots, B_{|B|})</var> より<strong>辞書順で小さい</strong>とは，下記の 1. と 2. のどちらかが成り立つことを言います．ここで，<var>|A|</var>, <var>|B|</var> はそれぞれ <var>A</var>, <var>B</var> の長さを表します．\n</p>\n\n<ol>\n<li><var>|A|&lt;|B|</var> かつ <var>(A_{1},\\ldots,A_{|A|}) = (B_1,\\ldots,B_{|A|})</var>. </li>\n<li>ある整数 <var>1\\leq i\\leq \\min\\{|A|,|B|\\}</var> が存在して，下記の <var>2</var> つがともに成り立つ．\n<ul>\n<li><var>(A_{1},\\ldots,A_{i-1}) = (B_1,\\ldots,B_{i-1})</var>. </li>\n<li><var>A_i &lt; B_i</var>. </li>\n</ul>\n</li></ol>\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1\\leq p, q \\leq 10^9</var></li>\n<li><var>\\gcd(p,q) = 1</var></li>\n<li><var>1.01 \\leq \\frac{p}{q}</var></li>\n<li><var>1\\leq N\\leq 10^{18}</var></li>\n<li><var>1\\leq L\\leq R\\leq N</var></li>\n<li><var>R - L + 1\\leq 3\\times 10^5</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられます．</p>\n<pre><var>p</var> <var>q</var> <var>N</var> <var>L</var> <var>R</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>R-L+1</var> 行出力してください．<var>i</var> 行目には，<var>N</var> 以下の正整数全体を，<var>\\frac{p}{q}</var> 進法展開の辞書順が小さい方から順に並べたとき，<var>L + i - 1</var> 番目に並ぶ正整数を出力してください．</p>\n<p>正整数の出力には <var>10</var> 進法表記を用いてください．</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 1 9 1 9\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>1\n3\n9\n4\n5\n2\n6\n7\n8\n</pre>\n<p><var>9</var> 以下の正整数の <var>3</var> 進法展開は次の通りです．</p>\n<pre>1: (1),        2: (2),        3: (1, 0),\n4: (1, 1),     5: (1, 2),     6: (2, 0),\n7: (2, 1),     8: (2, 2),     9: (1, 0, 0).\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 2 9 1 9\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>1\n2\n3\n4\n6\n9\n7\n8\n5\n</pre>\n<p><var>9</var> 以下の正整数の <var>\\frac32</var> 進法展開は次の通りです．</p>\n<pre>1: (1),        2: (2),        3: (2, 0),     \n4: (2, 1),     5: (2, 2),     6: (2, 1, 0),  \n7: (2, 1, 1),  8: (2, 1, 2),  9: (2, 1, 0, 0).\n</pre>\n<p>例えば <var>6</var> の <var>\\frac32</var> 進法展開が <var>(2,1,0)</var> であることは，<var>2\\cdot \\bigl(\\frac32\\bigr)^2 + 1\\cdot \\frac32 + 0\\cdot 1 = 6</var> から分かります．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>3 2 9 3 8\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>3\n4\n6\n9\n7\n8\n</pre>\n<p>入力例 2 の出力のうち <var>3</var> 番目から <var>8</var> 番目が答となります．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>10 9 1000000000000000000 123456789123456789 123456789123456799\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>806324968563249278\n806324968563249279\n725692471706924344\n725692471706924345\n725692471706924346\n725692471706924347\n725692471706924348\n725692471706924349\n653123224536231907\n653123224536231908\n653123224536231909\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>900</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Let <var>r &gt; 1</var> be a rational number, and <var>p</var> and <var>q</var> be the numerator and denominator of <var>r</var>, respectively. That is, <var>p</var> and <var>q</var> are positive integers such that <var>r = \\frac{p}{q}</var> and <var>\\gcd(p,q) = 1</var>.</p>\n<p>Let the <strong>base-<var>\\boldsymbol{r}</var> expansion</strong> of a positive integer <var>n</var> be the integer sequence <var>(a_1, \\ldots, a_k)</var> that satisfies all of the following conditions.</p>\n<ul>\n<li><var>a_i</var> is an integer between <var>0</var> and <var>p-1</var>.</li>\n<li><var>a_1\\neq 0</var>.</li>\n<li><var>n = \\sum_{i=1}^k a_ir^{k-i}</var>.</li>\n</ul>\n<p>It can be proved that any positive integer <var>n</var> has a unique base-<var>r</var> expansion.</p>\n<hr>\n<p>You are given positive integers <var>p</var>, <var>q</var>, <var>N</var>, <var>L</var>, and <var>R</var>. Here, <var>p</var> and <var>q</var> satisfy <var>1.01 \\leq \\frac{p}{q}</var>.</p>\n<p>Consider sorting all positive integers not greater than <var>N</var> in ascending lexicographical order of their base-<var>\\frac{p}{q}</var> expansions. Find the <var>L</var>-th, <var>(L+1)</var>-th, <var>\\ldots</var>, <var>R</var>-th positive integers in this list.</p>\n<p>As usual, decimal notations are used in the input and output of positive integers.</p>\n<details> <summary>What is lexicographical order on sequences?</summary>\n\n<p>\nA sequence <var>A = (A_1, \\ldots, A_{|A|})</var> is said to be <strong>lexicographically smaller</strong> than <var>B = (B_1, \\ldots, B_{|B|})</var> when 1. or 2. below is satisfied. Here, <var>|A|</var> and <var>|B|</var> denote the lengths of <var>A</var> and <var>B</var>, respectively.\n</p>\n\n<ol>\n<li><var>|A|&lt;|B|</var> and <var>(A_{1},\\ldots,A_{|A|}) = (B_1,\\ldots,B_{|A|})</var>. </li>\n<li>There is an integer <var>1\\leq i\\leq \\min\\{|A|,|B|\\}</var> that satisfies both of the following.\n<ul>\n<li><var>(A_{1},\\ldots,A_{i-1}) = (B_1,\\ldots,B_{i-1})</var>. </li>\n<li><var>A_i &lt; B_i</var>. </li>\n</ul>\n</li></ol>\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1\\leq p, q \\leq 10^9</var></li>\n<li><var>\\gcd(p,q) = 1</var></li>\n<li><var>1.01 \\leq \\frac{p}{q}</var></li>\n<li><var>1\\leq N\\leq 10^{18}</var></li>\n<li><var>1\\leq L\\leq R\\leq N</var></li>\n<li><var>R - L + 1\\leq 3\\times 10^5</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>p</var> <var>q</var> <var>N</var> <var>L</var> <var>R</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>R-L+1</var> lines. The <var>i</var>-th line should contain the <var>(L + i - 1)</var>-th positive integer in the list of all positive integers not greater than <var>N</var> sorted in ascending lexicographical order of their base-<var>\\frac{p}{q}</var> expansions.</p>\n<p>Use decimal notations to print positive integers.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 1 9 1 9\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>1\n3\n9\n4\n5\n2\n6\n7\n8\n</pre>\n<p>The base-<var>3</var> expansions of the positive integers not greater than <var>9</var> are as follows.</p>\n<pre>1: (1),        2: (2),        3: (1, 0),\n4: (1, 1),     5: (1, 2),     6: (2, 0),\n7: (2, 1),     8: (2, 2),     9: (1, 0, 0).\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 2 9 1 9\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>1\n2\n3\n4\n6\n9\n7\n8\n5\n</pre>\n<p>The base-<var>\\frac32</var> expansions of the positive integers not greater than <var>9</var> are as follows.</p>\n<pre>1: (1),        2: (2),        3: (2, 0),     \n4: (2, 1),     5: (2, 2),     6: (2, 1, 0),  \n7: (2, 1, 1),  8: (2, 1, 2),  9: (2, 1, 0, 0).\n</pre>\n<p>One can see that the base-<var>\\frac32</var> expansion of <var>6</var> is <var>(2,1,0)</var>, for instance, from <var>2\\cdot \\bigl(\\frac32\\bigr)^2 + 1\\cdot \\frac32 + 0\\cdot 1 = 6</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>3 2 9 3 8\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>3\n4\n6\n9\n7\n8\n</pre>\n<p>This is the <var>3</var>-rd through <var>8</var>-th lines of the output to Sample Input 2.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>10 9 1000000000000000000 123456789123456789 123456789123456799\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>806324968563249278\n806324968563249279\n725692471706924344\n725692471706924345\n725692471706924346\n725692471706924347\n725692471706924348\n725692471706924349\n653123224536231907\n653123224536231908\n653123224536231909\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc149/tasks/arc149_f"}