{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1000</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3>\n<p>AtCoder 国は東西に並んでいる <var>L+1</var> 個の島から成り、これらは西から順に <var>0</var> から <var>L</var> までの番号が付けられています。\n島々は航空路線で結ばれており、下図のように各 <var>1 \\leq i \\leq L</var> について、島 <var>i-1</var> と島 <var>i</var> を双方向に結ぶ航空路線があります。\nここで、各航空路線は A 社または J 社が所有しており、島 <var>i-1</var> と島 <var>i</var> を結ぶ路線は <var>S_i</var> 社が所有しています。</p>\n<p style=\"text-align: center;\"><img style=\"max-width: 100%;\" alt=\" \" src=\"https://img.atcoder.jp/arc177/dacd06e6239af911b67dfbb502b35bcd.png\"></p>\n<p>また、AtCoder 国には <var>N</var> 人の住民がおり、それぞれ <var>1</var> から <var>N</var> までの番号が付けられています。\n住民 <var>i</var> は現在島 <var>X_i</var> にいます。</p>\n<p>さらに、各住民はいずれか一方の航空会社の<strong>優待券</strong>を持っており、具体的には、住民 <var>i</var> は <var>C_i</var> 社の優待券を持っています。\n優待券を持っている会社の航空路線は<strong>何度でも</strong>無料で乗ることができますが、そうでない会社の航空路線に乗るには、<var>1</var> 回当たり <var>1</var> コインを支払う必要があります。</p>\n<p>今、島 <var>0</var> に宝箱があります。これから AtCoder 国の住民で協力して、首都である島 <var>L</var> に宝箱を運びたいです。\n最小で合計何コインで目的を達成できるかを求めてください。</p>\n<p>なお、住民同士で宝箱の受け渡しをすることはできますが、優待券の受け渡しはできないものとします。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3>\n<ul>\n<li><var>1 \\leq L \\leq 6 \\times 10^4</var></li>\n<li><var>1 \\leq N \\leq 6 \\times 10^4</var></li>\n<li><var>S_i \\ (1 \\leq i \\leq L)</var> は <code>A</code> または <code>J</code></li>\n<li><var>0 \\leq X_i \\leq L \\ (1 \\leq i \\leq N)</var></li>\n<li><var>C_i \\ (1 \\leq i \\leq N)</var> は <code>A</code> または <code>J</code></li>\n<li><var>L, N, X_i</var> は整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3>\n<p>入力は以下の形式で標準入力から与えられます。  </p>\n<pre><var>L</var> <var>N</var>\n<var>S_1</var><var>S_2</var><var>\\cdots</var><var>S_L</var>\n<var>X_1</var> <var>C_1</var>\n<var>X_2</var> <var>C_2</var>\n <var>\\vdots</var>\n<var>X_N</var> <var>C_N</var>\n</pre>\n<p>入力の <var>2</var> 行目は長さ <var>L</var> の文字列として与えられることに注意してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3>\n<p>答えを出力してください。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 3\nAAJJ\n3 A\n1 J\n1 J\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2\n</pre>\n<p>以下のような手順を選択すると、合計 <var>2</var> コインで島 <var>4</var> に宝箱を運ぶことができます。</p>\n<ol>\n<li>住民 <var>1</var> が島 <var>3</var> から島 <var>2</var> へ移動する。優待券の対象ではないので <var>1</var> コインを支払う。</li>\n<li>住民 <var>1</var> が島 <var>2</var> から島 <var>1</var> へ移動する。優待券の対象なのでコインを支払う必要はない。</li>\n<li>住民 <var>1</var> が島 <var>1</var> から島 <var>0</var> へ移動する。優待券の対象なのでコインを支払う必要はない。</li>\n<li>住民 <var>1</var> が宝箱を持つ。</li>\n<li>住民 <var>1</var> が宝箱を持った状態で、島 <var>0</var> から島 <var>1</var> へ移動する。優待券の対象なのでコインを支払う必要はない。</li>\n<li>住民 <var>1</var> が住民 <var>2</var> に宝箱を渡す。</li>\n<li>住民 <var>2</var> が宝箱を持った状態で、島 <var>1</var> から島 <var>2</var> へ移動する。優待券の対象ではないので <var>1</var> コインを支払う。</li>\n<li>住民 <var>2</var> が宝箱を持った状態で、島 <var>2</var> から島 <var>3</var> へ移動する。優待券の対象なのでコインを支払う必要はない。</li>\n<li>住民 <var>2</var> が宝箱を持った状態で、島 <var>3</var> から島 <var>4</var> へ移動する。優待券の対象なのでコインを支払う必要はない。</li>\n</ol>\n<p style=\"text-align: center;\"><img style=\"max-width: 100%;\" alt=\" \" src=\"https://img.atcoder.jp/arc177/362e9b56e8e71232a449db9eee2897d8.png\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>8 3\nJJAAJJAJ\n2 A\n6 A\n8 J\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>6\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>8 6\nJJAAJJAJ\n2 A\n6 A\n8 J\n8 J\n8 J\n8 J\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>4\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score: <var>1000</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3>\n<p>The Republic of AtCoder consists of <var>L+1</var> islands aligned east-west, numbered <var>0</var> to <var>L</var> from west to east.\nThe islands are connected by air routes, where for each <var>1 \\leq i \\leq L</var>, there is a bidirectional air route between islands <var>i-1</var> and <var>i</var>, as shown in the figure below.\nEach air route is owned by company A or company J, and the route between islands <var>i-1</var> and <var>i</var> is owned by company <var>S_i</var>.</p>\n<p style=\"text-align: center;\"><img style=\"max-width: 100%;\" alt=\" \" src=\"https://img.atcoder.jp/arc177/dacd06e6239af911b67dfbb502b35bcd.png\"></p>\n<p>The nation has <var>N</var> residents, numbered <var>1</var> to <var>N</var>.\nResident <var>i</var> is currently on island <var>X_i</var>.</p>\n<p>Each resident has a <strong>coupon</strong> of one of the companies. Specifically, resident <var>i</var> has a coupon of company <var>C_i</var>.\nWith a coupon, a resident can take that company's routes for free <strong>any number of times</strong>, but taking a route of the other company costs <var>1</var> coin per trip.</p>\n<p>Now, there is a treasure chest on island <var>0</var>. The residents want to cooperate to carry it to the capital, which is on island <var>L</var>.\nDetermine the minimum total number of coins required to achieve this goal.</p>\n<p>The residents can pass the treasure chest to each other, but not their coupons.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3>\n<ul>\n<li><var>1 \\leq L \\leq 6 \\times 10^4</var></li>\n<li><var>1 \\leq N \\leq 6 \\times 10^4</var></li>\n<li><var>S_i \\ (1 \\leq i \\leq L)</var> is <code>A</code> or <code>J</code>.</li>\n<li><var>0 \\leq X_i \\leq L \\ (1 \\leq i \\leq N)</var></li>\n<li><var>C_i \\ (1 \\leq i \\leq N)</var> is <code>A</code> or <code>J</code>.</li>\n<li><var>L</var>, <var>N</var>, and <var>X_i</var> are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3>\n<p>The input is given from Standard Input in the following format:</p>\n<pre><var>L</var> <var>N</var>\n<var>S_1</var><var>S_2</var><var>\\cdots</var><var>S_L</var>\n<var>X_1</var> <var>C_1</var>\n<var>X_2</var> <var>C_2</var>\n <var>\\vdots</var>\n<var>X_N</var> <var>C_N</var>\n</pre>\n<p>Note that the second line is given as a string of length <var>L</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3>\n<p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 3\nAAJJ\n3 A\n1 J\n1 J\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2\n</pre>\n<p>The following procedure carries the treasure chest to island <var>4</var> for a total of <var>2</var> coins.</p>\n<ol>\n<li>Resident <var>1</var> moves from island <var>3</var> to island <var>2</var>. The route is not covered by the coupon, so <var>1</var> coin is paid.</li>\n<li>Resident <var>1</var> moves from island <var>2</var> to island <var>1</var>. The route is covered by the coupon, so no coin is needed.</li>\n<li>Resident <var>1</var> moves from island <var>1</var> to island <var>0</var>. The route is covered by the coupon, so no coin is needed.</li>\n<li>Resident <var>1</var> picks up the treasure chest.</li>\n<li>Resident <var>1</var>, carrying the treasure chest, moves from island <var>0</var> to island <var>1</var>. The route is covered by the coupon, so no coin is needed.</li>\n<li>Resident <var>1</var> passes the treasure chest to resident <var>2</var>.</li>\n<li>Resident <var>2</var>, carrying the treasure chest, moves from island <var>1</var> to island <var>2</var>. The route is not covered by the coupon, so <var>1</var> coin is paid.</li>\n<li>Resident <var>2</var>, carrying the treasure chest, moves from island <var>2</var> to island <var>3</var>. The route is covered by the coupon, so no coin is needed.</li>\n<li>Resident <var>2</var>, carrying the treasure chest, moves from island <var>3</var> to island <var>4</var>. The route is covered by the coupon, so no coin is needed.</li>\n</ol>\n<p style=\"text-align: center;\"><img style=\"max-width: 100%;\" alt=\" \" src=\"https://img.atcoder.jp/arc177/9545d9fbdd7defc8d56f84380765a3d7.png\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>8 3\nJJAAJJAJ\n2 A\n6 A\n8 J\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>6\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>8 6\nJJAAJJAJ\n2 A\n6 A\n8 J\n8 J\n8 J\n8 J\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>4\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc177/tasks/arc177_f"}