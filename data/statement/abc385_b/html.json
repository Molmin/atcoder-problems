{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>200</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>縦 <var>H</var> 行横 <var>W</var> 列のマス目があります。上から <var>i</var> 行目、左から <var>j</var> 列目のマスをマス <var>(i,j)</var> と表します。</p>\n<p>マス <var>(i,j)</var> は <var>S_{i,j}</var> が <code>#</code> のとき通行不可能、<code>.</code> のとき通行可能であり家が建っていない、<code>@</code> のとき通行可能であり家が建っていることを表します。</p>\n<p>最初、マス <var>(X,Y)</var> にサンタクロースがいます。サンタクロースは文字列 <var>T</var> に従って以下の行動を行います。</p>\n<ul>\n<li>文字列 <var>T</var> の長さを <var>|T|</var> とする。<var>i=1,2,\\ldots,|T|</var> の順に以下のように移動する。<ul>\n<li>現在サンタクロースがいるマスを <var>(x,y)</var> とする。<ul>\n<li><var>T_i</var> が <code>U</code> かつマス <var>(x-1,y)</var> が通行可能ならマス <var>(x-1,y)</var> に移動する。</li>\n<li><var>T_i</var> が <code>D</code> かつマス <var>(x+1,y)</var> が通行可能ならマス <var>(x+1,y)</var> に移動する。</li>\n<li><var>T_i</var> が <code>L</code> かつマス <var>(x,y-1)</var> が通行可能ならマス <var>(x,y-1)</var> に移動する。</li>\n<li><var>T_i</var> が <code>R</code> かつマス <var>(x,y+1)</var> が通行可能ならマス <var>(x,y+1)</var> に移動する。</li>\n<li>それ以外の場合、マス <var>(x,y)</var> に留まる。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>行動を終えたあとにサンタクロースがいるマスと、行動により通過または到達した家の数を求めてください。ただし、同じ家を複数回通過または到達してもそれらは重複して数えません。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>3 \\leq H,W \\leq 100</var></li>\n<li><var>1 \\leq X \\leq H</var></li>\n<li><var>1 \\leq Y \\leq W</var></li>\n<li>与えられる数値は全て整数である</li>\n<li><var>S_{i,j}</var> は <code>#</code>, <code>.</code>, <code>@</code> のいずれか</li>\n<li>全ての <var>1 \\leq i \\leq H</var> について <var>S_{i,1},S_{i,W}</var> は <code>#</code></li>\n<li>全ての <var>1 \\leq j \\leq W</var> について <var>S_{1,j},S_{H,j}</var> は <code>#</code></li>\n<li><var>S_{X,Y}=</var> <code>.</code></li>\n<li><var>T</var> は <code>U</code>, <code>D</code>, <code>L</code>, <code>R</code> のいずれかからなる長さ <var>1</var> 以上 <var>10^4</var> 以下の文字列</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>H</var> <var>W</var> <var>X</var> <var>Y</var>\n<var>S_{1,1}S_{1,2}\\ldots S_{1,W}</var>\n<var>\\dots</var>\n<var>S_{H,1}S_{H,2}\\ldots S_{H,W}</var>\n<var>T</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>行動を終えたあとサンタクロースがいるマスを <var>(X,Y)</var>、行動により通過または到達した家の数を <var>C</var> とするとき、<var>X,Y,C</var> をこの順に空白区切りで出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>5 5 3 4\n#####\n#...#\n#.@.#\n#..@#\n#####\nLLLDRUU\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2 3 1\n</pre>\n<p>サンタクロースは以下のように行動します。</p>\n<p><img alt=\"図\" src=\"https://img.atcoder.jp/abc385/27dd50f7d27c6bcf335889bfe36fc341.png\"></p>\n<ul>\n<li><var>T_1=</var> <code>L</code> なのでマス <var>(3,4)</var> からマス <var>(3,3)</var> に移動する。これにより家を通過する。</li>\n<li><var>T_2=</var> <code>L</code> なのでマス <var>(3,3)</var> からマス <var>(3,2)</var> に移動する。</li>\n<li><var>T_3=</var> <code>L</code> だがマス <var>(3,1)</var> は通行不可能なので、マス <var>(3,2)</var> に留まる。</li>\n<li><var>T_4=</var> <code>D</code> なのでマス <var>(3,2)</var> からマス <var>(4,2)</var> に移動する。</li>\n<li><var>T_5=</var> <code>R</code> なのでマス <var>(4,2)</var> からマス <var>(4,3)</var> に移動する。</li>\n<li><var>T_6=</var> <code>U</code> なのでマス <var>(4,3)</var> からマス <var>(3,3)</var> に移動する。これにより家を通過するが、この家はすでに通過したことがある家である。</li>\n<li><var>T_7=</var> <code>U</code> なのでマス <var>(3,3)</var> からマス <var>(2,3)</var> に移動する。</li>\n</ul>\n<p>行動により通過または到達した家の数は <var>1</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>6 13 4 6\n#############\n#@@@@@@@@@@@#\n#@@@@@@@@@@@#\n#@@@@.@@@@@@#\n#@@@@@@@@@@@#\n#############\nUURUURLRLUUDDURDURRR\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>3 11 11\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>12 35 7 10\n###################################\n#.................................#\n#..........@......................#\n#......@................@.........#\n#.............##............@.....#\n#...##........##....##............#\n#...##........##....##.......##...#\n#....##......##......##....##.....#\n#....##......##......##..##.......#\n#.....#######.........###.........#\n#.................................#\n###################################\nLRURRRUUDDULUDUUDLRLRDRRLULRRUDLDRU\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>4 14 1\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>200</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There is a grid with <var>H</var> rows and <var>W</var> columns. Let <var>(i,j)</var> denote the cell at the <var>i</var>-th row from the top and the <var>j</var>-th column from the left.</p>\n<p>If <var>S_{i,j}</var> is <code>#</code>, the cell <var>(i,j)</var> is impassable; if it is <code>.</code>, the cell is passable and contains no house; if it is <code>@</code>, the cell is passable and contains a house.</p>\n<p>Initially, Santa Claus is in cell <var>(X,Y)</var>. He will act according to the string <var>T</var> as follows.</p>\n<ul>\n<li>Let <var>|T|</var> be the length of the string <var>T</var>. For <var>i=1,2,\\ldots,|T|</var>, he moves as follows.<ul>\n<li>Let <var>(x,y)</var> be the cell he is currently in.<ul>\n<li>If <var>T_i</var> is <code>U</code> and cell <var>(x-1,y)</var> is passable, move to cell <var>(x-1,y)</var>.</li>\n<li>If <var>T_i</var> is <code>D</code> and cell <var>(x+1,y)</var> is passable, move to cell <var>(x+1,y)</var>.</li>\n<li>If <var>T_i</var> is <code>L</code> and cell <var>(x,y-1)</var> is passable, move to cell <var>(x,y-1)</var>.</li>\n<li>If <var>T_i</var> is <code>R</code> and cell <var>(x,y+1)</var> is passable, move to cell <var>(x,y+1)</var>.</li>\n<li>Otherwise, stay in cell <var>(x,y)</var>.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Find the cell where he is after completing all actions, and the number of distinct houses that he passed through or arrived at during his actions. If the same house is passed multiple times, it is only counted once.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>3 \\leq H,W \\leq 100</var></li>\n<li><var>1 \\leq X \\leq H</var></li>\n<li><var>1 \\leq Y \\leq W</var></li>\n<li>All given numbers are integers.</li>\n<li>Each <var>S_{i,j}</var> is one of <code>#</code>, <code>.</code>, <code>@</code>.</li>\n<li><var>S_{i,1}</var> and <var>S_{i,W}</var> are <code>#</code> for every <var>1 \\leq i \\leq H</var>.</li>\n<li><var>S_{1,j}</var> and <var>S_{H,j}</var> are <code>#</code> for every <var>1 \\leq j \\leq W</var>.</li>\n<li><var>S_{X,Y}=</var> <code>.</code></li>\n<li><var>T</var> is a string of length at least <var>1</var> and at most <var>10^4</var>, consisting of <code>U</code>, <code>D</code>, <code>L</code>, <code>R</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The Input is given from Standard Input in the following format:</p>\n<pre><var>H</var> <var>W</var> <var>X</var> <var>Y</var>\n<var>S_{1,1}S_{1,2}\\ldots S_{1,W}</var>\n<var>\\dots</var>\n<var>S_{H,1}S_{H,2}\\ldots S_{H,W}</var>\n<var>T</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Let <var>(X,Y)</var> be the cell where he is after completing all actions, and <var>C</var> be the number of distinct houses he passed through or arrived at during his actions. Print <var>X,Y,C</var> in this order separated by spaces.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>5 5 3 4\n#####\n#...#\n#.@.#\n#..@#\n#####\nLLLDRUU\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2 3 1\n</pre>\n<p>Santa Claus behaves as follows:</p>\n<p><img alt=\"Figure\" src=\"https://img.atcoder.jp/abc385/27dd50f7d27c6bcf335889bfe36fc341.png\"></p>\n<ul>\n<li><var>T_1=</var> <code>L</code>, so he moves from <var>(3,4)</var> to <var>(3,3)</var>. A house is passed.</li>\n<li><var>T_2=</var> <code>L</code>, so he moves from <var>(3,3)</var> to <var>(3,2)</var>.</li>\n<li><var>T_3=</var> <code>L</code>, but cell <var>(3,1)</var> is impassable, so he stays at <var>(3,2)</var>.</li>\n<li><var>T_4=</var> <code>D</code>, so he moves from <var>(3,2)</var> to <var>(4,2)</var>.</li>\n<li><var>T_5=</var> <code>R</code>, so he moves from <var>(4,2)</var> to <var>(4,3)</var>.</li>\n<li><var>T_6=</var> <code>U</code>, so he moves from <var>(4,3)</var> to <var>(3,3)</var>. A house is passed, but it has already been passed.</li>\n<li><var>T_7=</var> <code>U</code>, so he moves from <var>(3,3)</var> to <var>(2,3)</var>.</li>\n</ul>\n<p>The number of houses he passed or arrived during his actions is <var>1</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>6 13 4 6\n#############\n#@@@@@@@@@@@#\n#@@@@@@@@@@@#\n#@@@@.@@@@@@#\n#@@@@@@@@@@@#\n#############\nUURUURLRLUUDDURDURRR\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>3 11 11\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>12 35 7 10\n###################################\n#.................................#\n#..........@......................#\n#......@................@.........#\n#.............##............@.....#\n#...##........##....##............#\n#...##........##....##.......##...#\n#....##......##......##....##.....#\n#....##......##......##..##.......#\n#.....#######.........###.........#\n#.................................#\n###################################\nLRURRRUUDDULUDUUDLRLRDRRLULRRUDLDRU\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>4 14 1\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc385/tasks/abc385_b"}