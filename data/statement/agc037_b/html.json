{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>800</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>色のついたボールが <var>3N</var> 個あり、それぞれには <var>1</var> から <var>3N</var> の番号がついています。\n各ボールの色は長さ <var>3N</var> の文字列 <var>S</var> によって表されており、ボール <var>i</var> の色は <var>S_i</var> が <code>R</code> のとき赤色、<code>G</code> のとき緑色、<code>B</code> のとき青色です。\n赤色のボール、緑色のボール、青色のボールはそれぞれ <var>N</var> 個ずつあります。</p>\n<p>高橋君はこの <var>3N</var> 個のボールを、各人が赤、青、緑のボールを <var>1</var> つずつ割り当てられるよう、<var>N</var> 人の人に分配することにしました。\nただし、ボールをもらう人たちはできるだけ近い番号のボールが欲しいので、高橋君はさらに以下の条件をみたすように分配することにしました。</p>\n<ul>\n<li><var>j</var> 番目の人が受け取ったボールの番号を小さい順に <var>a_j &lt; b_j &lt; c_j</var> とする。</li>\n<li>このとき <var>\\sum_j (c_j-a_j)</var> ができるだけ小さくなるように分配する。</li>\n</ul>\n<p>高橋君がボールを分配する方法は何通りあるか求めてください。 答えは非常に大きくなることがあるので、<var>998244353</var> で割ったあまりを求めてください。\nただし、<var>2</var> つのボールの分配方法が異なるとは、ある人が存在して、その人が受け取ったボールの集合が異なることを指します。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 ≦ N ≦ 10^5</var></li>\n<li><var>|S|=3N</var></li>\n<li><var>S</var> は <code>R</code>, <code>G</code>, <code>B</code> のみからなり、それぞれ <var>N</var> 回ずつ <var>S</var> に登場する</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>S</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>高橋君のボールの分配方法が何通りあるかを <var>998244353</var> で割ったあまりを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\nRRRGGGBBB\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>216\n</pre>\n\n<p>例えば以下のようにボールを分配したとき、<var>\\sum_j (c_j-a_j)</var> の値が <var>18</var> となり最小となります。</p>\n<ul>\n<li><var>1</var> 番目の人にボール <var>1,5,9</var> を渡す。</li>\n<li><var>2</var> 番目の人にボール <var>2,4,8</var> を渡す。</li>\n<li><var>3</var> 番目の人にボール <var>3,6,7</var> を渡す。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5\nBBRGRRGRGGRBBGB\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>960\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>800</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have <var>3N</var> colored balls with IDs from <var>1</var> to <var>3N</var>.\nA string <var>S</var> of length <var>3N</var> represents the colors of the balls. The color of Ball <var>i</var> is red if <var>S_i</var> is <code>R</code>, green if <var>S_i</var> is <code>G</code>, and blue if <var>S_i</var> is <code>B</code>. There are <var>N</var> red balls, <var>N</var> green balls, and <var>N</var> blue balls.</p>\n<p>Takahashi will distribute these <var>3N</var> balls to <var>N</var> people so that each person gets one red ball, one blue ball, and one green ball.\nThe people want balls with IDs close to each other, so he will additionally satisfy the following condition:</p>\n<ul>\n<li>Let <var>a_j &lt; b_j &lt; c_j</var> be the IDs of the balls received by the <var>j</var>-th person in ascending order.</li>\n<li>Then, <var>\\sum_j (c_j-a_j)</var> should be as small as possible.</li>\n</ul>\n<p>Find the number of ways in which Takahashi can distribute the balls. Since the answer can be enormous, compute it modulo <var>998244353</var>.\nWe consider two ways to distribute the balls different if and only if there is a person who receives different sets of balls.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 10^5</var></li>\n<li><var>|S|=3N</var></li>\n<li><var>S</var> consists of <code>R</code>, <code>G</code>, and <code>B</code>, and each of these characters occurs <var>N</var> times in <var>S</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>S</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the number of ways in which Takahashi can distribute the balls, modulo <var>998244353</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\nRRRGGGBBB\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>216\n</pre>\n\n<p>The minimum value of <var>\\sum_j (c_j-a_j)</var> is <var>18</var> when the balls are, for example, distributed as follows:</p>\n<ul>\n<li>The first person gets Ball <var>1</var>, <var>5</var>, and <var>9</var>.</li>\n<li>The second person gets Ball <var>2</var>, <var>4</var>, and <var>8</var>.</li>\n<li>The third person gets Ball <var>3</var>, <var>6</var>, and <var>7</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5\nBBRGRRGRGGRBBGB\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>960\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc037/tasks/agc037_b"}