{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1700</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>高橋君はお母さんからグリッドをもらいました。このグリッドは縦 <var>H</var> マス×横 <var>W</var> マスからなり、各マスは黒か白で塗られています。\n黒いマス全体は、縦横にひとつながりになっています。</p>\n<p>このグリッドの <var>i</var> 行 <var>j</var> 列 <var>(1 ≦ i ≦ H, 1 ≦ j ≦ W)</var> のマスの情報は、縦横に並んだ文字 <var>s_{ij}</var> であらわされ、\n<var>s_{ij}</var> が <code>#</code> のときこのマスが黒く、 <code>.</code> のとき白く塗られていることを表します。少なくともひとつのマスが黒く塗られています。</p>\n<p>レベル <var>0</var> のフラクタルとは黒いマスひとつからなる <var>1 × 1</var> のグリッドであり、\nレベル <var>k+1</var> のフラクタルとは、レベル <var>k</var> のフラクタルを、お母さんからもらったグリッドの全ての黒いマスに相当する位置に並べ、白いマスに相当する位置は白いマスで埋めたものを指します。</p>\n<p>お母さんからもらったグリッドの情報と整数 <var>K</var> が与えられるので、レベル <var>K</var> のフラクタルに黒いマスからなる連結成分がいくつあるかを <var>10^9+7</var> で割ったあまりを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 ≦ H,W ≦ 1000</var></li>\n<li><var>0 ≦ K ≦ 10^{18}</var></li>\n<li><var>s_{ij}</var> は <code>#</code> か <code>.</code> のいずれかである。</li>\n<li><code>#</code> のマス全体は縦横に連結である。</li>\n<li><code>#</code> のマスは少なくともひとつ存在する。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>H</var> <var>W</var> <var>K</var>\n<var>s_{11} .. s_{1W}</var>\n:\n<var>s_{H1} .. s_{HW}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>レベル <var>K</var> のフラクタルにある黒いマスからなる連結成分の個数を <var>10^9+7</var> で割ったあまりを一行に出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 3 3\n.#.\n###\n#.#\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>20\n</pre>\n\n<p>この入力例で作られるフラクタルは、以下のようなものです。この黒マスからなる連結成分の数は <var>20</var> なので、<var>20</var> を出力します。</p>\n<pre>.............#.............\n............###............\n............#.#............\n..........#..#..#..........\n.........#########.........\n.........#.##.##.#.........\n..........#.....#..........\n.........###...###.........\n.........#.#...#.#.........\n....#........#........#....\n...###......###......###...\n...#.#......#.#......#.#...\n.#..#..#..#..#..#..#..#..#.\n###########################\n#.##.##.##.##.##.##.##.##.#\n.#.....#..#.....#..#.....#.\n###...######...######...###\n#.#...#.##.#...#.##.#...#.#\n....#.................#....\n...###...............###...\n...#.#...............#.#...\n.#..#..#...........#..#..#.\n#########.........#########\n#.##.##.#.........#.##.##.#\n.#.....#...........#.....#.\n###...###.........###...###\n#.#...#.#.........#.#...#.#\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 3 3\n###\n#.#\n###\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>1\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>11 15 1000000000000000000\n.....#.........\n....###........\n....####.......\n...######......\n...#######.....\n..##.###.##....\n..##########...\n.###.....####..\n.####...######.\n###############\n#.##..##..##..#\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>301811921\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1700</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Snuke got a grid from his mother, as a birthday present. The grid has <var>H</var> rows and <var>W</var> columns. Each cell is painted black or white. All black cells are <em>4-connected</em>, that is, it is possible to traverse from any black cell to any other black cell by just visiting black cells, where it is only allowed to move horizontally or vertically.</p>\n<p>The color of the cell at the <var>i</var>-th row and <var>j</var>-th column <var>(1 ≦ i ≦ H, 1 ≦ j ≦ W)</var> is represented by a character <var>s_{ij}</var>. If <var>s_{ij}</var> is <code>#</code>, the cell is painted black. If <var>s_{ij}</var> is <code>.</code>, the cell is painted white. At least one cell is painted black.</p>\n<p>We will define <em>fractals</em> as follows.\nThe fractal of <em>level</em> <var>0</var> is a <var>1 × 1</var> grid with a black cell.\nThe fractal of level <var>k+1</var> is obtained by arranging smaller grids in <var>H</var> rows and <var>W</var> columns, following the pattern of the Snuke's grid.\nAt a position that corresponds to a black cell in the Snuke's grid, a copy of the fractal of level <var>k</var> is placed.\nAt a position that corresponds to a white cell in the Snuke's grid, a grid whose cells are all white, with the same dimensions as the fractal of level <var>k</var>, is placed.</p>\n<p>You are given the description of the Snuke's grid, and an integer <var>K</var>. Find the number of connected components of black cells in the fractal of level <var>K</var>, modulo <var>10^9+7</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 ≦ H,W ≦ 1000</var></li>\n<li><var>0 ≦ K ≦ 10^{18}</var></li>\n<li>Each <var>s_{ij}</var> is either <code>#</code> or <code>.</code>.</li>\n<li>All black cells in the given grid are 4-connected.</li>\n<li>There is at least one black cell in the given grid.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>H</var> <var>W</var> <var>K</var>\n<var>s_{11} .. s_{1W}</var>\n:\n<var>s_{H1} .. s_{HW}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the number of connected components of black cells in the fractal of level <var>K</var>, modulo <var>10^9+7</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 3 3\n.#.\n###\n#.#\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>20\n</pre>\n\n<p>The fractal of level <var>K=3</var> in this case is shown below. There are <var>20</var> connected components of black cells.</p>\n<pre>.............#.............\n............###............\n............#.#............\n..........#..#..#..........\n.........#########.........\n.........#.##.##.#.........\n..........#.....#..........\n.........###...###.........\n.........#.#...#.#.........\n....#........#........#....\n...###......###......###...\n...#.#......#.#......#.#...\n.#..#..#..#..#..#..#..#..#.\n###########################\n#.##.##.##.##.##.##.##.##.#\n.#.....#..#.....#..#.....#.\n###...######...######...###\n#.#...#.##.#...#.##.#...#.#\n....#.................#....\n...###...............###...\n...#.#...............#.#...\n.#..#..#...........#..#..#.\n#########.........#########\n#.##.##.#.........#.##.##.#\n.#.....#...........#.....#.\n###...###.........###...###\n#.#...#.#.........#.#...#.#\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 3 3\n###\n#.#\n###\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>1\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>11 15 1000000000000000000\n.....#.........\n....###........\n....####.......\n...######......\n...#######.....\n..##.###.##....\n..##########...\n.###.....####..\n.####...######.\n###############\n#.##..##..##..#\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>301811921\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc003/tasks/agc003_f"}