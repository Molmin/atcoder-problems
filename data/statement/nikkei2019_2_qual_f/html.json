{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1400</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>二次元平面上に正方形の形をした枠があり、その <var>4</var> 頂点の座標は <var>(0,0)</var>, <var>(N,0)</var>, <var>(0,N)</var>, <var>(N,N)</var> です。\nこの枠は鏡でできており、枠の辺（頂点を除く）に光が当たると入射角と反射角が等しくなるように光が反射します。\nただし、頂点に光が当たると、光は入射してきた向きと逆向きに反射します。</p>\n<p>ここで、枠の内部にある格子点 <var>(i,j)</var> (<var>0&lt;i,j&lt;N</var>) に対応する<strong>ライン</strong>を次のように定義します。</p>\n<ul>\n<li><var>(i,j)</var> から <var>(i-1,j-1)</var>, <var>(i-1,j+1)</var>, <var>(i+1,j-1)</var>, <var>(i+1,j+1)</var> への <var>4</var> 方向に光を発したときに、\n  光が通る軌跡を <var>(i,j)</var> のラインとする。</li>\n</ul>\n<div style=\"text-align: center;\">\n<img src=\"https://img.atcoder.jp/nikkei2019-2-qual/f82200c30253b6e06c6043a2c7668735.png\">\n<p>図: 格子点に対応するラインの例</p>\n</div>\n\n<p>枠の内部にある各格子点上には電球が <var>1</var> つずつあります。それぞれの電球に対してonとoffのいずれかの状態を定めたとき、\n以下の操作を繰り返して全ての電球をoffにできるならば、その電球の状態を<strong>きれい</strong>と呼ぶことにします。</p>\n<ul>\n<li>枠の内部にある格子点を <var>1</var> つ選び、そのライン上にある全ての電球のonとoffを切り替える。</li>\n</ul>\n<p>高橋君はいくつかの電球のonとoffの状態を決めましたが、いくつかの電球の状態はまだ決めていません。\nそれらのonとoffを定める方法であって、電球の状態がきれいになるような方法の数を <var>998244353</var> で割ったあまりを求めてください。\n格子点 <var>(i,j)</var> にある電球は <var>A_{i,j}=</var><code>o</code> のときon、<var>A_{i,j}=</var><code>x</code> のときoffであり、<var>A_{i,j}=</var><code>?</code> のとき状態がまだ決まっていません。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 ≦ N ≦ 1500</var></li>\n<li><var>A_{i,j}</var> は <code>o</code>, <code>x</code>, <code>?</code> のいずれか</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>A_{1,1}...A_{1,N-1}</var>\n<var>:</var>\n<var>A_{N-1,1}...A_{N-1,N-1}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4\no?o\n???\n?x?\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>1\n</pre>\n\n<p>以下のように各電球の状態を決めれば、電球の状態はきれいとなります。</p>\n<pre>oxo\nxox\noxo\n</pre>\n<p>例えば <var>(1,1)</var> のライン上にある電球のonとoffを切り替えると、\n<var>(1,1)</var>, <var>(1,3)</var>, <var>(2,2)</var>, <var>(3,1)</var>, <var>(3,3)</var> にある電球のonとoffが切り替わるので、\nすべての電球がoffになります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5\no?o?\n????\no?x?\n????\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>6\n?o???\n????o\n??x??\no????\n???o?\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>32\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>9\n????o??x\n?????x??\n??o?o???\n?o?x????\n???????x\nx?o?o???\n????????\nx?????x?\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>4\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1400</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>In a two-dimensional plane, there is a square frame whose vertices are at coordinates <var>(0,0)</var>, <var>(N,0)</var>, <var>(0,N)</var>, and <var>(N,N)</var>.\nThe frame is made of mirror glass. A ray of light striking an edge of the frame (but not a vertex) will be reflected so that the angle of incidence is equal to the angle of reflection.\nA ray of light striking a vertex of the frame will be reflected in the direction opposite to the direction it is coming from.</p>\n<p>We will define the <em>path</em> for a grid point (a point with integer coordinates) <var>(i,j)</var> (<var>0&lt;i,j&lt;N</var>) strictly within the frame, as follows:</p>\n<ul>\n<li>The path for <var>(i,j)</var> is the union of the trajectories of four rays of light emitted from <var>(i,j)</var> to <var>(i-1,j-1)</var>, <var>(i-1,j+1)</var>, <var>(i+1,j-1)</var>, and <var>(i+1,j+1)</var>.</li>\n</ul>\n<div style=\"text-align: center;\">\n<img src=\"https://img.atcoder.jp/nikkei2019-2-qual/f82200c30253b6e06c6043a2c7668735.png\">\n<p>Figure: an example of a path for a grid point</p>\n</div>\n\n<p>There is a light bulb at each grid point strictly within the frame. We will assign a state - ON or OFF - to each bulb. The state of the whole set of bulbs are called <em>beautiful</em> if it is possible to turn OFF all the bulbs by repeating the following operation:</p>\n<ul>\n<li>Choose a grid point strictly within the frame, and switch the states of all the bulbs on its path.</li>\n</ul>\n<p>Takahashi has set the states of some of the bulbs, but not for the remaining bulbs.\nFind the number of ways to set the states of the remaining bulbs so that the state of the whole set of bulbs is beautiful, modulo <var>998244353</var>.\nThe state of the bulb at the grid point <var>(i,j)</var> is set to be ON if <var>A_{i,j}=</var><code>o</code>, OFF if <var>A_{i,j}=</var><code>x</code>, and unset if <var>A_{i,j}=</var><code>?</code>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 1500</var></li>\n<li><var>A_{ij}</var> is <code>o</code>, <code>x</code>, or <code>?</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>A_{1,1}...A_{1,N-1}</var>\n<var>:</var>\n<var>A_{N-1,1}...A_{N-1,N-1}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4\no?o\n???\n?x?\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>1\n</pre>\n\n<p>The state of the whole set of bulbs will be beautiful if we set the state of each bulb as follows:</p>\n<pre>oxo\nxox\noxo\n</pre>\n<p>We can turn OFF all the bulbs by, for example, choosing the point <var>(1, 1)</var> and switching the states of the bulbs at <var>(1,1)</var>, <var>(1,3)</var>, <var>(2,2)</var>, <var>(3,1)</var>, and <var>(3,3)</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5\no?o?\n????\no?x?\n????\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>6\n?o???\n????o\n??x??\no????\n???o?\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>32\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>9\n????o??x\n?????x??\n??o?o???\n?o?x????\n???????x\nx?o?o???\n????????\nx?????x?\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>4\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/nikkei2019-2-qual/tasks/nikkei2019_2_qual_f"}