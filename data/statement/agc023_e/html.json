{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1700</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>すぬけ君は、長さ <var>N</var> の整数列 <var>A</var> を持っています。\nすぬけ君は、<var>(1, 2, ..., N)</var> の順列 <var>P</var> であって、次の条件を満たすものが好きです。</p>\n<ul>\n<li>全ての <var>i</var> ( <var>1 \\leq i \\leq N</var> ) について、<var>P_i \\leq A_i</var></li>\n</ul>\n<p>すぬけ君は、条件を満たすような順列の転倒数 ( ※ ) に興味を持ちました。\nすぬけ君のために、条件を満たすような全ての順列について転倒数を求め、その総和を求めてください。\nただし、答えは非常に大きくなることがあるので、<var>10^9 + 7</var> で割った余りを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>注釈</h3><p>ある長さ <var>N</var> の数列 <var>Z</var> の転倒数とは、整数 <var>i, j</var> ( <var>1 \\leq i &lt; j \\leq N</var> ) の組であって、<var>Z_i &gt; Z_j</var> を満たすものの個数を意味します。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq A_i \\leq N</var> ( <var>1 \\leq i \\leq N</var> )</li>\n<li>入力はすべて整数である。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>A_1</var> <var>A_2</var> <var>...</var> <var>A_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>条件を満たすすべての順列の転倒数の総和を <var>10^9 + 7</var> で割った余りを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n2 3 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>4\n</pre>\n\n<p>条件を満たす順列は <var>(1,2,3)</var>, <var>(1,3,2)</var>, <var>(2,1,3)</var>, <var>(2,3,1)</var> の <var>4</var> つです。\nそれぞれの転倒数は <var>0</var>, <var>1</var>, <var>1</var>, <var>2</var> なので、その総和である <var>4</var> を出力します。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>6\n4 2 5 1 6 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>7\n</pre>\n\n<p>条件を満たす順列は <var>(4,2,5,1,6,3)</var> のみです。\nこの順列の転倒数は <var>7</var> なので、<var>7</var> を出力します。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>5\n4 4 4 4 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>0\n</pre>\n\n<p>条件を満たす順列は <var>1</var> つもありません。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>30\n22 30 15 20 10 29 11 29 28 11 26 10 18 28 22 5 29 16 24 24 27 10 21 30 29 19 28 27 18 23\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>848414012\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1700</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Snuke has an integer sequence <var>A</var> whose length is <var>N</var>.\nHe likes permutations of <var>(1, 2, ..., N)</var>, <var>P</var>, that satisfy the following condition:</p>\n<ul>\n<li><var>P_i \\leq A_i</var> for all <var>i</var> ( <var>1 \\leq i \\leq N</var> ).</li>\n</ul>\n<p>Snuke is interested in the inversion numbers of such permutations.\nFind the sum of the inversion numbers over all permutations that satisfy the condition.\nSince this can be extremely large, compute the sum modulo <var>10^9+7</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Notes</h3><p>The <em>inversion number</em> of a sequence <var>Z</var> whose length <var>N</var> is the number of pairs of integers <var>i</var> and <var>j</var> ( <var>1 \\leq i &lt; j \\leq N</var> ) such that <var>Z_i &gt; Z_j</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq A_i \\leq N</var> ( <var>1 \\leq i \\leq N</var> )</li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>A_1</var> <var>A_2</var> <var>...</var> <var>A_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the sum of the inversion numbers over all permutations that satisfy the condition.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n2 3 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>4\n</pre>\n\n<p>There are four permutations that satisfy the condition: <var>(1,2,3)</var>, <var>(1,3,2)</var>, <var>(2,1,3)</var> and <var>(2,3,1)</var>.\nThe inversion numbers of these permutations are <var>0</var>, <var>1</var>, <var>1</var> and <var>2</var>, respectively, for a total of <var>4</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>6\n4 2 5 1 6 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>7\n</pre>\n\n<p>Only one permutation <var>(4,2,5,1,6,3)</var> satisfies the condition.\nThe inversion number of this permutation is <var>7</var>, so the answer is <var>7</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>5\n4 4 4 4 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>0\n</pre>\n\n<p>No permutation satisfies the condition.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>30\n22 30 15 20 10 29 11 29 28 11 26 10 18 28 22 5 29 16 24 24 27 10 21 30 29 19 28 27 18 23\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>848414012\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc023/tasks/agc023_e"}