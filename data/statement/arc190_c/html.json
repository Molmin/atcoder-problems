{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>800</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>H\\times W</var> のマス目があります．上から <var>h</var> 行目，左から <var>w</var> 列目のマスを <var>(h,w)</var> で表します．<var>(h,w)</var> には非負整数 <var>A_{h,w}</var> が書かれています．</p>\n<p>高橋君がはじめマス <var>(sh,sw)</var> におり，これからマス目に <var>Q</var> 回の変更を行います．<var>i</var> 回目の変更は文字 <var>d_i</var> （<var>d_i</var> は <code>L</code>, <code>R</code>, <code>U</code>, <code>D</code> のいずれか）と非負整数 <var>a_i</var> によって与えられ，これは高橋君が以下を行うことを意味します．</p>\n<ul>\n<li><var>d_i</var> の方向に <var>1</var> マス移動する．つまり，<var>d_i</var> が <code>L</code> ならば左，<var>d_i</var> が <code>R</code> ならば右，<var>d_i</var> が <code>U</code> ならば上，<var>d_i</var> が <code>D</code> ならば下方向に <var>1</var> マス移動する．その後，移動先のマスを <var>(h,w)</var> とするとき <var>A_{h,w}</var> を <var>a_i</var> に変更する．</li>\n</ul>\n<p>ただし，各変更において，高橋君が <var>d_i</var> 方向に <var>1</var> マス移動することが可能であることが保証されます．</p>\n<p>マス目の変更のたびに，以下の問題の答を出力してください．</p>\n<blockquote>\n<p>マスの列 <var>P=((h_1,w_1),\\ldots,(h_{M},w_{M}))</var> が以下の条件をすべて満たすとき，<var>P</var> は<strong>パス</strong>であるということにします．</p>\n<ul>\n<li><var>(h_1,w_1)=(1,1)</var>, <var>(h_{M},w_{M})=(H,W)</var>, <var>M=H+W-1</var>. </li>\n<li><var>1\\leq i \\leq M-1</var> を満たす任意の <var>i</var> に対して，<var>(h_{i+1},w_{i+1}) = (h_i+1,w_i)</var> または <var>(h_{i+1},w_{i+1}) = (h_i,w_i+1)</var> が成り立つ．</li>\n</ul>\n<p>パスは <var>\\binom{H+W-2}{H-1}</var> 個あります．パス <var>P=((h_1,w_1),\\ldots,(h_{M},w_{M}))</var> に対して <var>f(P) = \\prod_{1\\leq i\\leq M}A_{h_i,w_i}</var> と定めます．\nすべてのパス <var>P</var> に対する <var>f(P)</var> の総和を <var>998244353</var> で割った余りを出力してください．</p>\n</blockquote>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2\\leq H, W\\leq 200000</var></li>\n<li><var>HW\\leq 200000</var></li>\n<li><var>0\\leq A_{h,w} &lt; 998244353</var></li>\n<li><var>1\\leq Q\\leq 200000</var></li>\n<li><var>1\\leq sh\\leq H</var>, <var>1\\leq sw\\leq W</var></li>\n<li><var>0\\leq a_i &lt; 998244353</var></li>\n<li><var>H, W, A_{h,w}, Q, sh, sw, a_i</var> は整数</li>\n<li><var>d_i</var> は <code>L</code>, <code>R</code>, <code>U</code>, <code>D</code> のいずれか</li>\n<li>各変更において，高橋君が <var>d_i</var> 方向に <var>1</var> マス移動することが可能である</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられます．</p>\n<pre><var>H</var> <var>W</var>\n<var>A_{1,1}</var> <var>\\cdots</var> <var>A_{1,W}</var>\n<var>\\vdots</var>\n<var>A_{H,1}</var> <var>\\cdots</var> <var>A_{H,W}</var>\n<var>Q</var> <var>sh</var> <var>sw</var>\n<var>d_1</var> <var>a_1</var>\n<var>\\vdots</var>\n<var>d_Q</var> <var>a_Q</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>Q</var> 行出力してください．</p>\n<p><var>i</var> 行目には <var>i</var> 回目のマス目の変更の後に，すべてのパス <var>P</var> に対する <var>f(P)</var> の総和を <var>998244353</var> で割った余りを出力してください．</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2 3\n1 2 3\n4 5 6\n3 2 2\nU 7\nR 8\nL 9\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>456\n666\n822\n</pre>\n\n<ul>\n<li>はじめ高橋君は <var>(2,2)</var> に居ます．</li>\n<li>上方向に移動して，<var>A_{1,2}</var> を <var>7</var> に変更します．各パスに対する <var>f(P)</var> は次の通りです．<ul>\n<li><var>P=((1,1),(1,2),(1,3),(2,3))</var>: <var>f(P)=1\\times 7\\times 3\\times 6=126</var>. </li>\n<li><var>P=((1,1),(1,2),(2,2),(2,3))</var>: <var>f(P)=1\\times 7\\times 5\\times 6=210</var>. </li>\n<li><var>P=((1,1),(2,1),(2,2),(2,3))</var>: <var>f(P)=1\\times 4\\times 5\\times 6=120</var>. </li>\n</ul>\n</li>\n<li>右方向に移動して，<var>A_{1,3}</var> を <var>8</var> に変更します．各パスに対する <var>f(P)</var> は次の通りです．<ul>\n<li><var>P=((1,1),(1,2),(1,3),(2,3))</var>: <var>f(P)=1\\times 7\\times 8\\times 6=336</var>. </li>\n<li><var>P=((1,1),(1,2),(2,2),(2,3))</var>: <var>f(P)=1\\times 7\\times 5\\times 6=210</var>. </li>\n<li><var>P=((1,1),(2,1),(2,2),(2,3))</var>: <var>f(P)=1\\times 4\\times 5\\times 6=120</var>. </li>\n</ul>\n</li>\n<li>左方向に移動して，<var>A_{1,2}</var> を <var>9</var> に変更します．各パスに対する <var>f(P)</var> は次の通りです．<ul>\n<li><var>P=((1,1),(1,2),(1,3),(2,3))</var>: <var>f(P)=1\\times 9\\times 8\\times 6=432</var>. </li>\n<li><var>P=((1,1),(1,2),(2,2),(2,3))</var>: <var>f(P)=1\\times 9\\times 5\\times 6=270</var>. </li>\n<li><var>P=((1,1),(2,1),(2,2),(2,3))</var>: <var>f(P)=1\\times 4\\times 5\\times 6=120</var>. </li>\n</ul>\n</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5 4\n147015809 294958521 852121867 499798308\n790350368 404692331 645419803 290531806\n275766153 896286651 239187926 945049742\n340760022 236352314 926236110 223464913\n287023679 590772036 340282357 521075891\n6 3 1\nU 344644511\nR 45812235\nD 260083498\nR 781118585\nL 156297846\nL 411901560\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>299123226\n548055393\n810247224\n876210800\n773990840\n506814544\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>800</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There is an <var>H \\times W</var> grid. Let <var>(h,w)</var> denote the cell at the <var>h</var>-th row from the top and the <var>w</var>-th column from the left. A non-negative integer <var>A_{h,w}</var> is written in cell <var>(h,w)</var>.</p>\n<p>Takahashi starts at cell <var>(sh,sw)</var> and will perform <var>Q</var> changes to the grid. The <var>i</var>-th change is given by a character <var>d_i</var> (<var>d_i</var> is one of <code>L</code>, <code>R</code>, <code>U</code>, <code>D</code>) and a non-negative integer <var>a_i</var>, meaning Takahashi will do the following:</p>\n<ul>\n<li>Move one cell in the direction <var>d_i</var>. That is, if <var>d_i</var> is <code>L</code>, move left; if <code>R</code>, move right; if <code>U</code>, move up; if <code>D</code>, move down by one cell. Then, let the destination cell be <var>(h,w)</var>, and set <var>A_{h,w}</var> to <var>a_i</var>.</li>\n</ul>\n<p>It is guaranteed that in each change, he can move one cell in direction <var>d_i</var>.</p>\n<p>After each change, print the answer to the following problem:</p>\n<blockquote>\n<p>A sequence of cells <var>P = ((h_1,w_1), \\ldots, (h_{M},w_{M}))</var> is said to be a <strong>path</strong> if and only if it satisfies all of the following conditions:</p>\n<ul>\n<li><var>(h_1,w_1) = (1,1)</var>, <var>(h_{M},w_{M}) = (H,W)</var>, and <var>M = H + W - 1</var>.</li>\n<li>For every <var>i</var> with <var>1 \\leq i \\leq M-1</var>, either <var>(h_{i+1}, w_{i+1}) = (h_i + 1, w_i)</var> or <var>(h_{i+1}, w_{i+1}) = (h_i, w_i + 1)</var>.</li>\n</ul>\n<p>There are <var>\\binom{H+W-2}{H-1}</var> paths. For a path <var>P = ((h_1,w_1), \\ldots, (h_{M},w_{M}))</var>, define <var>f(P) = \\prod_{1\\leq i\\leq M}A_{h_i,w_i}</var>. Print the sum, modulo <var>998244353</var>, of <var>f(P)</var> over all paths <var>P</var>.</p>\n</blockquote>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq H, W \\leq 200000</var></li>\n<li><var>HW \\leq 200000</var></li>\n<li><var>0 \\leq A_{h,w} &lt; 998244353</var></li>\n<li><var>1 \\leq Q \\leq 200000</var></li>\n<li><var>1 \\leq sh \\leq H</var>, <var>1 \\leq sw \\leq W</var></li>\n<li><var>0 \\leq a_i &lt; 998244353</var></li>\n<li><var>H</var>, <var>W</var>, <var>A_{h,w}</var>, <var>Q</var>, <var>sh</var>, <var>sw</var>, and <var>a_i</var> are integers.</li>\n<li>Each <var>d_i</var> is <code>L</code>, <code>R</code>, <code>U</code>, or <code>D</code>.</li>\n<li>In each change, Takahashi can move one cell in the direction <var>d_i</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>H</var> <var>W</var>\n<var>A_{1,1}</var> <var>\\cdots</var> <var>A_{1,W}</var>\n<var>\\vdots</var>\n<var>A_{H,1}</var> <var>\\cdots</var> <var>A_{H,W}</var>\n<var>Q</var> <var>sh</var> <var>sw</var>\n<var>d_1</var> <var>a_1</var>\n<var>\\vdots</var>\n<var>d_Q</var> <var>a_Q</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>Q</var> lines.</p>\n<p>The <var>i</var>-th line should contain the sum, modulo <var>998244353</var>, of <var>f(P)</var> over all paths <var>P</var> after performing the <var>i</var>-th change to the grid. </p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2 3\n1 2 3\n4 5 6\n3 2 2\nU 7\nR 8\nL 9\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>456\n666\n822\n</pre>\n\n<ul>\n<li>Initially, Takahashi is at <var>(2,2)</var>.</li>\n<li>Move up, then set <var>A_{1,2}</var> to <var>7</var>. The value of <var>f(P)</var> for each path is:<ul>\n<li><var>P=((1,1),(1,2),(1,3),(2,3))</var>: <var>f(P)=1 \\times 7 \\times 3 \\times 6=126</var>.</li>\n<li><var>P=((1,1),(1,2),(2,2),(2,3))</var>: <var>f(P)=1 \\times 7 \\times 5 \\times 6=210</var>.</li>\n<li><var>P=((1,1),(2,1),(2,2),(2,3))</var>: <var>f(P)=1 \\times 4 \\times 5 \\times 6=120</var>.</li>\n</ul>\n</li>\n<li>Move right, then set <var>A_{1,3}</var> to <var>8</var>. The value of <var>f(P)</var> for each path is:<ul>\n<li><var>P=((1,1),(1,2),(1,3),(2,3))</var>: <var>f(P)=1 \\times 7 \\times 8 \\times 6=336</var>.</li>\n<li><var>P=((1,1),(1,2),(2,2),(2,3))</var>: <var>f(P)=1 \\times 7 \\times 5 \\times 6=210</var>.</li>\n<li><var>P=((1,1),(2,1),(2,2),(2,3))</var>: <var>f(P)=1 \\times 4 \\times 5 \\times 6=120</var>.</li>\n</ul>\n</li>\n<li>Move left, then set <var>A_{1,2}</var> to <var>9</var>. The value of <var>f(P)</var> for each path is:<ul>\n<li><var>P=((1,1),(1,2),(1,3),(2,3))</var>: <var>f(P)=1 \\times 9 \\times 8 \\times 6=432</var>.</li>\n<li><var>P=((1,1),(1,2),(2,2),(2,3))</var>: <var>f(P)=1 \\times 9 \\times 5 \\times 6=270</var>.</li>\n<li><var>P=((1,1),(2,1),(2,2),(2,3))</var>: <var>f(P)=1 \\times 4 \\times 5 \\times 6=120</var>.</li>\n</ul>\n</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5 4\n147015809 294958521 852121867 499798308\n790350368 404692331 645419803 290531806\n275766153 896286651 239187926 945049742\n340760022 236352314 926236110 223464913\n287023679 590772036 340282357 521075891\n6 3 1\nU 344644511\nR 45812235\nD 260083498\nR 781118585\nL 156297846\nL 411901560\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>299123226\n548055393\n810247224\n876210800\n773990840\n506814544\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc190/tasks/arc190_c"}