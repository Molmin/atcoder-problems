{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点: <var>800</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3>\n<p>AtCoder 鉄道には <var>N+1</var> 個の駅があり、駅には <var>0</var> から <var>N</var> までの番号が付けられています。ここではかつて、各 <var>i</var> <var>(0 \\leq i \\leq N-1)</var> に対して駅 <var>i</var> と駅 <var>i+1</var> の間を双方向に <var>1</var> 分で走行する <strong>普通列車</strong> のみが運行されていました。</p>\n<p>しかし、ある日鉄道会社は「光速派」と「準急派」の <var>2</var> つのグループに分裂し、駅 <var>0</var> と駅 <var>N</var> を除く各駅は光速派と準急派のうち片方が管理することになりました。駅 <var>j</var> <var>(1 \\leq j \\leq N-1)</var> を管理するグループは文字 <var>c_j</var> で表され、<code>A</code> は光速派が、<code>B</code> は準急派が管理すること、<code>?</code> はまだ決まっていないことを表します。駅 <var>0</var> と駅 <var>N</var> は重要な駅なので、両方が管理します。</p>\n<p>ここで、光速派と準急派は、普通列車に加えて新たに <var>2</var> 種類の鉄道路線を作ることにしました。</p>\n<blockquote>\n<p><strong>光速列車</strong>：光速派が管理する駅の番号を昇順に <var>a_0, a_1, \\dots, a_s</var> として、各 <var>k</var> に対して駅 <var>a_k</var> と駅 <var>a_{k+1}</var> の間を双方向に <var>1</var> 分で走行する。</p>\n<p><strong>準急列車</strong>：準急派が管理する駅の番号を昇順に <var>b_0, b_1, \\dots, b_t</var> として、各 <var>k</var> に対して駅 <var>b_k</var> と駅 <var>b_{k+1}</var> の間を双方向に <var>1</var> 分で走行する。</p>\n</blockquote>\n<p><code>?</code> の個数を <var>q</var> として、作られる鉄道路線は <var>2^q</var> 通り考えられます。その中で、<var>K</var> 分以内の乗車で駅 <var>0</var> から駅 <var>N</var> に行けるようになるものは何通りあるでしょうか？これを <var>10^9+7</var> で割った余りを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3>\n<ul>\n<li><var>2 \\leq N \\leq 4000</var></li>\n<li><var>1 \\leq K \\leq \\frac{N+1}{2}</var></li>\n<li><var>N, K</var> は整数</li>\n<li><var>c_1, c_2, \\dots, c_{N-1}</var> はそれぞれ <code>A</code>、<code>B</code>、<code>?</code> のいずれか</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3>\n<p>入力は以下の形式で標準入力から与えられます。  </p>\n<pre><var>N</var> <var>K</var>\n<var>c_1</var><var>c_2</var><var>\\cdots</var><var>c_{N-1}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3>\n<p>答えを <var>10^9+7</var> で割った余りを出力してください。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>8 3\nA??AB?B\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>4\n</pre>\n<p>ここでは <var>2^3 = 8</var> 通りの鉄道路線がありえますが、そのうち以下の <var>4</var> 通りについて、<var>3</var> 分以内の乗車で駅 <var>0</var> から駅 <var>8</var> に行くことが可能です。</p>\n<ul>\n<li>駅 <var>2, 3, 6</var> を光速派が管理する場合：駅 <var>0 \\rightarrow 5 \\rightarrow 7 \\rightarrow 8</var> と移動する（下図の #1 に対応）</li>\n<li>駅 <var>2, 3</var> を光速派が、駅 <var>6</var> を準急派が管理する場合：駅 <var>0 \\rightarrow 5 \\rightarrow 4 \\rightarrow 8</var> と移動する（下図の #2 に対応）</li>\n<li>駅 <var>2</var> を光速派が、駅 <var>3, 6</var> を準急派が管理する場合：駅 <var>0 \\rightarrow 3 \\rightarrow 4 \\rightarrow 8</var> と移動する（下図の #4 に対応）</li>\n<li>駅 <var>2, 3, 6</var> を準急派が管理する場合：駅 <var>0 \\rightarrow 1 \\rightarrow 4 \\rightarrow 8</var> と移動する（下図の #8 に対応）</li>\n</ul>\n<p>したがって、答えは <var>4</var> 通りとなります。これを図で表すと、以下のようになります。下図においては、赤色が光速派のみが管理する駅や光速列車の路線、青色が準急派のみが管理する駅や準急列車の路線を表すものとします。</p>\n<p><img alt=\" \" src=\"https://img.atcoder.jp/arc119/db3f88315c456535f7ce57116009c126.png\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>11 6\n???B??A???\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>256\n</pre>\n<p>ここでは、<var>2^8 = 256</var> 通りの組み合わせすべてについて、駅 <var>0</var> から駅 <var>11</var> まで <var>6</var> 分以内の乗車で行くことが可能です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>16 5\n?A?B?A?B?A?B?A?\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>10\n</pre>\n<p>以下の図に示される <var>10</var> 通りの組み合わせについて、駅 <var>0</var> から駅 <var>16</var> まで <var>5</var> 分以内の乗車で行くことが可能です。</p>\n<p><img alt=\" \" src=\"https://img.atcoder.jp/arc119/4b879e19b8c1cd7eac9d52eb0ea58e5c.png\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>119 15\n????????A?????????????????????????BA????????????????????????AB???????A???????????B?????????????????????????????A??????\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>313346281\n</pre>\n<p>条件を満たすものは <var>1623310324709451</var> 通りありますが、これを <var>10^9 + 7</var> で割った余りである <var>313346281</var> を出力してください。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score: <var>800</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3>\n<p>There are <var>N+1</var> stations along the AtCoder Line, numbered <var>0</var> through <var>N</var>. Formerly, it only had <strong>Local Trains</strong>, which run between Stations <var>i</var> and <var>i + 1</var> in one minute in either direction for each <var>i</var> <var>(0 \\leq i \\leq N-1)</var>.</p>\n<p>One day, however, the railway company broke into two groups, called <em>Ko-soku</em> (light speed) and <em>Jun-kyu</em> (semi express). They decided that each station other than Stations <var>0</var> and <var>N</var> should be administered by one of the groups. The group that administers Station <var>j</var> <var>(1 \\leq j \\leq N-1)</var> is represented by a character <var>c_j</var>: <code>A</code> means that Ko-soku administers the station, <code>B</code> means Jun-kyu administers the station, and <code>?</code> means it is undecided. Since Stations <var>0</var> and <var>N</var> are so important, both groups will administer them.</p>\n<p>Now, Ko-soku and Jun-kyu have decided to run two new types of trains, in addition to the local trains.</p>\n<blockquote>\n<p><strong>Ko-soku Trains:</strong> Let Stations <var>a_0, a_1, \\dots, a_s</var> be the stations administered by Ko-soku in ascending order. These trains run between Stations <var>a_k</var> and <var>a_{k+1}</var> in one minute in either direction for each <var>k</var>.</p>\n<p><strong>Jun-kyu Trains:</strong> Let Stations <var>b_0, b_1, \\dots, b_t</var> be the stations administered by Jun-kyu in ascending order. These trains run between Stations <var>b_k</var> and <var>b_{k+1}</var> in one minute in either direction for each <var>k</var>.</p>\n</blockquote>\n<p>There are <var>2^q</var> ways in which these trains run, where <var>q</var> is the number of <code>?</code>s. Among them, how many enables us to go from Station <var>0</var> to Station <var>N</var> in no more than <var>K</var> minutes' ride? Find this count modulo <var>(10^9+7)</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3>\n<ul>\n<li><var>2 \\leq N \\leq 4000</var></li>\n<li><var>1 \\leq K \\leq \\frac{N+1}{2}</var></li>\n<li><var>N</var> and <var>K</var> are integers.</li>\n<li>Each of <var>c_1, c_2, \\dots, c_{N-1}</var> is <code>A</code>, <code>B</code>, or <code>?</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3>\n<p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>K</var>\n<var>c_1</var><var>c_2</var><var>\\cdots</var><var>c_{N-1}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3>\n<p>Print the count modulo <var>(10^9+7)</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>8 3\nA??AB?B\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>4\n</pre>\n<p>Here, there are <var>2^3 = 8</var> possible ways in which the trains run. Among them, the following four enable us to go from Station <var>0</var> to Station <var>8</var> in no more than <var>3</var> minutes' ride.</p>\n<ul>\n<li>If Ko-soku administers Stations <var>2, 3, 6</var>, we can go Station <var>0 \\rightarrow 5 \\rightarrow 7 \\rightarrow 8</var>, as shown at #1 in the figure below.</li>\n<li>If Ko-soku administers Stations <var>2, 3</var> and Jun-kyu administers Station <var>6</var>, we can go Station <var>0 \\rightarrow 5 \\rightarrow 4 \\rightarrow 8</var>, as shown at #2 in the figure below.</li>\n<li>If Ko-soku administers Station <var>2</var> and Jun-kyu administers Stations <var>3, 6</var>, we can go Station <var>0 \\rightarrow 3 \\rightarrow 4 \\rightarrow 8</var>, as shown at #4 in the figure below.</li>\n<li>If Jun-kyu administers Stations <var>2, 3, 6</var>, we can go Station <var>0 \\rightarrow 1 \\rightarrow 4 \\rightarrow 8</var>, as shown at #8 in the figure below.</li>\n</ul>\n<p>Therefore, the answer is <var>4</var>. The figure below shows all the possible ways, where red stations and railways are administered only by Ko-soku, and blue stations and railways are administered only by Jun-kyu.</p>\n<p><img alt=\" \" src=\"https://img.atcoder.jp/arc119/db3f88315c456535f7ce57116009c126.png\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>11 6\n???B??A???\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>256\n</pre>\n<p>Here, all of the <var>2^8 = 256</var> ways enable us to go from Station <var>0</var> to Station <var>11</var> in no more than <var>6</var> minutes' ride.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>16 5\n?A?B?A?B?A?B?A?\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>10\n</pre>\n<p><var>10</var> ways shown in the figure below enable us to go from Station <var>0</var> to Station <var>16</var> in no more than <var>5</var> minutes' ride.</p>\n<p><img alt=\" \" src=\"https://img.atcoder.jp/arc119/4b879e19b8c1cd7eac9d52eb0ea58e5c.png\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>119 15\n????????A?????????????????????????BA????????????????????????AB???????A???????????B?????????????????????????????A??????\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>313346281\n</pre>\n<p>There are <var>1623310324709451</var> desirable ways. Print this count modulo <var>(10^9 + 7)</var>, that is, <var>313346281</var>.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc119/tasks/arc119_f"}