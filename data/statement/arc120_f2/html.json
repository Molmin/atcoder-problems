{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>800</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><strong>問題 F と問題 F2 は同じ問題ですが、制約と実行時間制限が異なります。</strong>  </p>\n<p>高橋君の倉庫には <var>N</var> 本のワインがあり、左右方向 <var>1</var> 列に並んでいます。左から <var>i</var> 番目のワインの美味しさは <var>A_i</var> です。<br>\n青木君は今からこの <var>N</var> 本のうち、ちょうど <var>K</var> 本を選んで盗みます。しかし、高橋君は注意深いので、以下の条件が満たされると盗まれたことに気付いてしまいます。  </p>\n<ul>\n<li>連続で並ぶ <var>D</var> 本のワインであって、そのうち <var>2</var> 本以上盗まれているようなものが存在する</li>\n</ul>\n<p>高橋君に気付かれないような全ての盗み方について、盗んだワインの美味しさの和を求め、それを足し合わせた値を求めてください。<br>\nなお、答えは非常に大きくなることがあるので、<var>998244353</var> で割った余りを出力してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\le D \\le N \\le 10^6</var></li>\n<li><var>1 \\le K \\le \\left\\lceil \\frac{N}{D} \\right\\rceil</var> （<var>\\left\\lceil x \\right\\rceil</var> は <var>x</var> 以上の最小の整数を表す）</li>\n<li><var>1 \\le A_i \\lt 998244353</var></li>\n<li>入力に含まれる値は全て整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>K</var> <var>D</var>\n<var>A_1</var> <var>A_2</var> <var>A_3</var> <var>\\dots</var> <var>A_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを <var>998244353</var> で割った余りを出力せよ。  </p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 2 2\n1 4 2 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>14\n</pre>\n\n<p>盗み方と盗んだワインの美味しさの和は以下の通りです。  </p>\n<ul>\n<li>左から <var>1</var> 本目のワインと <var>3</var> 本目のワインを盗んだ場合 : 美味しさの和は <var>1 + 2 = 3</var></li>\n<li>左から <var>1</var> 本目のワインと <var>4</var> 本目のワインを盗んだ場合 : 美味しさの和は <var>1 + 3 = 4</var></li>\n<li>左から <var>2</var> 本目のワインと <var>4</var> 本目のワインを盗んだ場合 : 美味しさの和は <var>4 + 3 = 7</var></li>\n</ul>\n<p>よって答えは <var>3 + 4 + 7 = 14</var> となります。  </p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5 2 3\n1 5 7 7 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>20\n</pre>\n\n<p>盗み方と盗んだワインの美味しさの和は以下の通りです。  </p>\n<ul>\n<li>左から <var>1</var> 本目のワインと <var>4</var> 本目のワインを盗んだ場合 : 美味しさの和は <var>1 + 7 = 8</var></li>\n<li>左から <var>1</var> 本目のワインと <var>5</var> 本目のワインを盗んだ場合 : 美味しさの和は <var>1 + 3 = 4</var></li>\n<li>左から <var>2</var> 本目のワインと <var>5</var> 本目のワインを盗んだ場合 : 美味しさの和は <var>5 + 3 = 8</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>18 4 4\n107367523 266126484 149762920 57456082 857431610 400422663 768881284 494753774 152155823 740238343 871191740 450057094 208762450 787961742 90197530 77329823 193815114 707323467\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>228955567\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>800</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p><strong>Problems F and F2 have the same Problem Statement but different Constraints and Time Limits.</strong></p>\n<p>There are <var>N</var> bottles of wine in Takahashi's cellar, arranged in a row from left to right.<br>\nThe tastiness of the <var>i</var>-th bottle from the left is <var>A_i</var>.<br>\nAoki will choose <var>K</var> bottles from these <var>N</var> and steal them. However, Takahashi is careful enough to notice the theft if the following condition is satisfied:</p>\n<ul>\n<li>There exist <var>D</var> consecutive bottles such that two or more of them are stolen.</li>\n</ul>\n<p>For every way of stealing bottles without getting noticed by Takahashi, find the total tastiness of the bottles stolen, and then find the sum of all those values.<br>\nSince the sum can be enormous, print it modulo <var>998244353</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\le D \\le N \\le 10^6</var></li>\n<li><var>1 \\le K \\le \\left\\lceil \\frac{N}{D} \\right\\rceil</var> (<var>\\left\\lceil x \\right\\rceil</var> represents the smallest integer not less than <var>x</var>.)</li>\n<li><var>1 \\le A_i \\lt 998244353</var></li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>K</var> <var>D</var>\n<var>A_1</var> <var>A_2</var> <var>A_3</var> <var>\\dots</var> <var>A_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the sum modulo <var>998244353</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 2 2\n1 4 2 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>14\n</pre>\n\n<p>The possible ways to steal bottles and the total tastiness for each of them are as follows:</p>\n<ul>\n<li>Steal the <var>1</var>-st and <var>3</var>-rd bottles from the left, for the total tastiness of <var>1 + 2 = 3</var>.</li>\n<li>Steal the <var>1</var>-st and <var>4</var>-th bottles from the left, for the total tastiness of <var>1 + 3 = 4</var>.</li>\n<li>Steal the <var>2</var>-nd and <var>4</var>-th bottles from the left, for the total tastiness of <var>4 + 3 = 7</var>.</li>\n</ul>\n<p>Thus, the answer is <var>3 + 4 + 7 = 14</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5 2 3\n1 5 7 7 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>20\n</pre>\n\n<p>The possible ways to steal bottles and the total tastiness for each of them are as follows:</p>\n<ul>\n<li>Steal the <var>1</var>-st and <var>4</var>-th bottles from the left, for the total tastiness of <var>1 + 7 = 8</var>.</li>\n<li>Steal the <var>1</var>-st and <var>5</var>-th bottles from the left, for the total tastiness of <var>1 + 3 = 4</var>.</li>\n<li>Steal the <var>2</var>-nd and <var>5</var>-th bottles from the left, for the total tastiness of <var>5 + 3 = 8</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>18 4 4\n107367523 266126484 149762920 57456082 857431610 400422663 768881284 494753774 152155823 740238343 871191740 450057094 208762450 787961742 90197530 77329823 193815114 707323467\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>228955567\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc120/tasks/arc120_f2"}