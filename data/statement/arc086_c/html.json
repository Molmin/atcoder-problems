{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1000</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>すぬけ君は <var>N+1</var> 頂点の根付き木を持っています。\nこの木の頂点には <var>0</var> から <var>N</var> までの番号がついており、頂点 <var>0</var> はこの木の根です。\n頂点 <var>i(1 \\leq i \\leq N)</var> の親は頂点 <var>p_i</var> です。</p>\n<p>すぬけ君はこの木の他に、空の箱とビー玉を使って遊んでいます。\nこの遊びはいくつかの頂点にビー玉をそれぞれ <var>1</var> つ置いたのち、以下の手順で進行します。</p>\n<ol>\n<li>頂点 <var>0</var> にビー玉が置かれているならば、そのビー玉を箱に移す。</li>\n<li>全てのビー玉を現在の頂点から親の頂点に(同時に)移す。</li>\n<li><var>2</var> つ以上のビー玉が置かれている頂点それぞれについて、その頂点に置かれているビー玉を全て取り除く。</li>\n<li>ビー玉が置かれている頂点が存在するならば手順 1 へ、そうでなければ遊びを終了する。</li>\n</ol>\n<p>ビー玉の置き方は <var>2^{N+1}</var> 通りあります。\nこれらそれぞれの場合について <strong>遊びが終了したときに箱に入っているビー玉</strong> の数を求め、その和を <var>{\\rm mod} 1,000,000,007</var> で求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N &lt; 2 \\times 10^{5}</var></li>\n<li><var>0 \\leq p_i &lt; i</var></li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>部分点</h3><ul>\n<li><var>400</var> 点分のデータセットでは <var>N &lt; 2000</var> が成立する</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>p_1</var> <var>p_2</var> <var>...</var> <var>p_{N}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2\n0 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>8\n</pre>\n\n<p>頂点 <var>1</var> と頂点 <var>2</var> のどちらにもビー玉を置いたとき、手順 <var>2</var> により頂点 <var>0</var> に複数のビー玉が置かれてしまいます。このとき、これらのビー玉は取り除かれるため箱に移動されることはありません。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5\n0 1 1 0 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>96\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>31\n0 1 0 2 4 0 4 1 6 4 3 9 7 3 7 2 15 6 12 10 12 16 5 3 20 1 25 20 23 24 23\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>730395550\n</pre>\n\n<p>答えを  <var>{ \\rm mod} 1,000,000,007</var> で求めてください。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1000</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Snuke has a rooted tree with <var>N+1</var> vertices.\nThe vertices are numbered <var>0</var> through <var>N</var>, and Vertex <var>0</var> is the root of the tree.\nThe parent of Vertex <var>i</var> <var>(1 \\leq i \\leq N)</var> is Vertex <var>p_i</var>.</p>\n<p>Besides this tree, Snuke also has an box which is initially empty and many marbles, and playing with them.\nThe play begins with placing one marble on some of the vertices, then proceeds as follows:</p>\n<ol>\n<li>If there is a marble on Vertex <var>0</var>, move the marble into the box.</li>\n<li>Move each marble from the vertex to its parent (all at once).</li>\n<li>For each vertex occupied by two or more marbles, remove all the marbles from the vertex.</li>\n<li>If there exists a vertex with some marbles, go to Step 1. Otherwise, end the play.</li>\n</ol>\n<p>There are <var>2^{N+1}</var> ways to place marbles on some of the vertices.\nFor each of them, find <strong>the number of marbles that will be in the box at the end of the play</strong>, and compute the sum of all those numbers modulo <var>1,000,000,007</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N &lt; 2 \\times 10^{5}</var></li>\n<li><var>0 \\leq p_i &lt; i</var></li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Partial Scores</h3><ul>\n<li>In the test set worth <var>400</var> points, <var>N &lt; 2{,}000</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>p_1</var> <var>p_2</var> <var>...</var> <var>p_{N}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2\n0 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>8\n</pre>\n\n<p>When we place a marble on both Vertex <var>1</var> and <var>2</var>, there will be multiple marbles on Vertex <var>0</var> by step 2. In such a case, these marbles will be removed instead of being moved to the box.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5\n0 1 1 0 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>96\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>31\n0 1 0 2 4 0 4 1 6 4 3 9 7 3 7 2 15 6 12 10 12 16 5 3 20 1 25 20 23 24 23\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>730395550\n</pre>\n\n<p>Be sure to compute the sum modulo <var>1,000,000,007</var>.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc086/tasks/arc086_c"}