{"html":{"ja":"<span class=\"lang-ja\">\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>二次元のマス目における一番左上のマスの座標を <var>(0, 0)</var> とし、そこから下方向に <var>i</var> マス、右方向に <var>j</var> マス進んだ先のマスの座標を <var>(i, j)</var> とする。</p>\n<p><var>N \\times N</var> マスの盤面がある。最初、盤面の各マス <var>(i, j)</var> に整数 <var>a_{i, j}</var> が設定されている。</p>\n<p><var>3 \\times 3</var> マスのスタンプが <var>M</var> 個ある。スタンプ <var>m</var> <var>(0 \\leq m \\leq M - 1)</var> の各マス <var>(i, j)</var> に整数 <var>s_{m,i,j}</var> が書かれている。</p>\n<p>あなたは以下の操作を <var>K</var> 回まで行うことができる。</p>\n<ul>\n<li>スタンプ <var>m</var> と盤面のマス <var>(p, q)</var> <var>(0 \\leq p, q \\leq N - 3)</var> を選択し、スタンプ <var>m</var> の座標 <var>(0, 0)</var> が盤面のマス <var>(p, q)</var> と合うようにスタンプを押す。この操作により、スタンプの各マス <var>(i, j)</var> <var>(0 \\leq i, j \\leq 2)</var> に対して、盤面のマス <var>(p + i, q + j)</var> の値に <var>s_{m,i,j}</var> が加算される。盤面からはみ出るようにスタンプを押したり、スタンプを回転させて使用したりすることはできない。</li>\n</ul>\n<p>同じスタンプを何度も使用したり、使わないスタンプがあったりしても構わない。同じ場所に何度もスタンプを押しても構わない。</p>\n<p>最終的な盤面の各マスの値を <var>998244353</var> で割った余りの総和を最大化して欲しい。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>得点</h3><p>全ての操作を終えた後、盤面のマス <var>(i, j)</var> に設定された整数を <var>b_{i, j}</var> としたとき、以下の得点が得られる。</p>\n<p>\\[\n\\sum_{i = 0}^{N - 1}{\\sum_{j = 0}^{N - 1}{(b_{i, j} \\bmod 998244353)}}\n\\]</p>\n<p>ここで、 <var>b_{i, j} \\bmod 998244353</var> は <var>b_{i, j}</var> を <var>998244353</var> で割った余りを表す。</p>\n<p>操作回数が <var>K</var> を超えた場合や、不正な操作を出力した場合は <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"不正解\">WA</span> と判定される。</p>\n<p>テストケースは全部で 150 個あり、各テストケースの得点の合計が提出の得点となる。\n一つ以上のテストケースで不正な出力や制限時間超過をした場合、提出全体の判定が <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"不正解\">WA</span> や <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"実行時間制限超過\">TLE</span> となる。\nコンテスト時間中に得た最高得点で最終順位が決定され、コンテスト終了後のシステムテストは行われない。 同じ得点を複数の参加者が得た場合、提出時刻に関わらず同じ順位となる。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var> <var>K</var>\n<var>a_{0, 0}</var> <var>\\cdots</var> <var>a_{0, N - 1}</var>\n<var>\\vdots</var>\n<var>a_{N - 1, 0}</var> <var>\\cdots</var> <var>a_{N - 1, N - 1}</var>\n<var>s_{0, 0, 0}</var> <var>s_{0, 0, 1}</var> <var>s_{0, 0, 2}</var>\n<var>s_{0, 1, 0}</var> <var>s_{0, 1, 1}</var> <var>s_{0, 1, 2}</var>\n<var>s_{0, 2, 0}</var> <var>s_{0, 2, 1}</var> <var>s_{0, 2, 2}</var>\n<var>\\vdots</var>\n<var>s_{M - 1, 0, 0}</var> <var>s_{M - 1, 0, 1}</var> <var>s_{M - 1, 0, 2}</var>\n<var>s_{M - 1, 1, 0}</var> <var>s_{M - 1, 1, 1}</var> <var>s_{M - 1, 1, 2}</var>\n<var>s_{M - 1, 2, 0}</var> <var>s_{M - 1, 2, 1}</var> <var>s_{M - 1, 2, 2}</var>\n</pre>\n\n<p>各値はそれぞれ以下の制約を満たす。</p>\n<ul>\n<li><var>N = 9</var></li>\n<li><var>M = 20</var></li>\n<li><var>K = 81</var></li>\n<li><var>0 \\leq a_{i, j} \\leq 998244352</var></li>\n<li><var>0 \\leq s_{m, i, j} \\leq 998244352</var></li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>スタンプを押した回数を <var>L</var> <var>(0 \\leq L \\leq K)</var>、 <var>l</var> 回目の操作で選択したスタンプと盤面のマスをそれぞれ <var>m_l</var> <var>(0 \\leq m_l \\leq M - 1)</var> 、 <var>(p_l, q_l)</var> <var>(0 \\leq p_l, q_l \\leq N - 3)</var> としたとき、以下の形式で標準出力に出力せよ。</p>\n<pre><var>L</var>\n<var>m_0</var> <var>p_0</var> <var>q_0</var>\n<var>m_1</var> <var>p_1</var> <var>q_1</var>\n<var>\\vdots</var>\n<var>m_{L - 1}</var> <var>p_{L - 1}</var> <var>q_{L - 1}</var>\n</pre>\n\n<p><a href=\"https://img.atcoder.jp/ahc032/e2weanqa.html?lang=ja&amp;seed=0&amp;output=sample\">例を見る</a></p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>入力生成方法</h3><p><var>L</var> 以上 <var>U</var> 以下の整数値を一様ランダムに生成する関数を <var>\\mathrm{rand}(L, U)</var> と表す。</p>\n<p>各 <var>a_{i, j}</var> と <var>s_{m, i, j}</var> は全て独立に、\n<var>a_{i, j} = \\mathrm{rand}(0, 998244352)</var>, <var>s_{m, i, j} = \\mathrm{rand}(0, 998244352)</var> により生成する。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>ツール(入力ジェネレータ・ビジュアライザ)</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc032/e2weanqa.html?lang=ja\">Web版</a>: ローカル版より高性能でアニメーション表示が可能です。</li>\n<li><a href=\"https://img.atcoder.jp/ahc032/e2weanqa.zip\">ローカル版</a>: 使用するには<a href=\"https://www.rust-lang.org/ja\">Rust言語</a>のコンパイル環境をご用意下さい。<ul>\n<li><a href=\"https://img.atcoder.jp/ahc032/e2weanqa_windows.zip\">Windows用のコンパイル済みバイナリ</a>: Rust言語の環境構築が面倒な方は代わりにこちらをご利用下さい。</li>\n</ul>\n</li>\n</ul>\n<p>コンテスト期間中に、ビジュアライズ結果の共有や、解法・考察に関する言及は禁止されています。ご注意下さい。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">9 20 81\n24323530 980293589 859258684 185499104 894688371 236405725 111530575 250271104 495624658\n769596495 264300425 88876278 146578260 565437828 737999180 725732147 57726456 323844609\n40096771 928203404 501627737 804865949 814572382 849529199 189832922 910184599 467494517\n962420139 432607222 59818053 858072870 914485919 446805915 138548911 345246064 245004268\n477044564 12166358 931360092 799278793 865992483 339109407 614502753 736626962 801948371\n281576446 640350568 771040910 823574138 350308411 930294372 585808288 700370699 426021090\n289960346 566527193 119082954 148354804 902944838 516738876 930961873 812731496 172242940\n921564237 662077279 49476329 593121834 377147282 862136854 791213996 686329230 7403815\n501340655 979965930 839183331 303883398 490179686 492481098 160122974 114672637 82049594\n975741402 918762324 476374754\n906657349 359110092 978536040\n84599745 368692094 744129488\n261705356 216870728 556481274\n317767465 457532475 532110106\n125703669 839188333 425571806\n291667039 37052662 1276219\n305291998 653050074 220563016\n332525785 400712871 520185762\n393148157 178758620 933441647\n205044518 579917402 498932315\n411369672 664953833 274696537\n654712800 802006144 682742340\n864455037 533661060 207561332\n605472509 577911453 942938903\n576270626 688256275 33493069\n481710779 902547317 817131623\n291465541 863597953 772086608\n417987422 136453150 615090472\n760882895 841541285 914039365\n359505208 780663578 774735965\n188919347 431579412 464452916\n854985721 70294202 663019966\n157776983 3557297 439447307\n621014939 759908222 932643321\n184225959 884108948 693640679\n361651737 846036661 975413204\n479224933 700946167 622558051\n495003914 325785117 513339213\n70238660 857642866 297571112\n374937799 48000646 849682071\n528095305 232520890 469018467\n952599070 610262715 232403912\n316958602 24859140 385411996\n304561106 853230688 859071983\n266806117 99442261 881952734\n708824083 752081152 915353520\n261135036 48934653 945657700\n255395109 742827901 445178710\n906120195 565840603 316740986\n736297599 447489530 680619574\n654670835 694926131 897183420\n958993686 813942152 196144122\n324334792 928014325 852381591\n194958307 642660824 128931372\n303306950 687790222 930130148\n591510740 614681348 113389792\n160195595 683240268 555351204\n218729338 196609467 724290289\n47413572 552092134 337674489\n410209863 549012244 186533965\n452647000 449090484 733453206\n106059177 888943736 940915649\n692940521 382797569 893532614\n52383100 783583840 634565824\n168433778 751831139 356971915\n870682287 872212766 75893565\n262231629 844472478 843213274\n499286296 502562654 725538734\n467780532 720085509 907848638\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">4\n0 1 6\n6 6 6\n18 6 1\n16 1 5\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>In a two-dimensional grid, let <var>(0, 0)</var> be the coordinates of the top-left square, and <var>(i, j)</var> be the coordinates of the square located <var>i</var> squares down and <var>j</var> squares to the right from there.</p>\n<p>There is an <var>N \\times N</var> square board.\nInitially, each square <var>(i, j)</var> on the board is assigned an integer <var>a_{i, j}</var>.</p>\n<p>There are <var>M</var> stamps, each with <var>3 \\times 3</var> squares. On stamp <var>m</var> <var>(0 \\leq m \\leq M - 1)</var>, an integer <var>s_{m,i,j}</var> is written in each square <var>(i, j)</var>.</p>\n<p>You can perform the following operation at most <var>K</var> times.</p>\n<ul>\n<li>Select a stamp <var>m</var> and a square <var>(p, q)</var> <var>(0 \\leq p, q \\leq N - 3)</var> on the board. Press the stamp in such a way that its coordinates <var>(0, 0)</var> align with the square <var>(p, q)</var> on the board.\nThis operation increases the value of the square <var>(p + i, q + j)</var> on the board by <var>s_{m,i,j}</var> for each square <var>(i, j)</var> <var>(0 \\leq i, j \\leq 2)</var> on the stamp.\nYou cannot press a stamp beyond the bounds of the board, nor can you rotate stamps.</li>\n</ul>\n<p>You can use the same stamp multiple times or have stamps that are not used at all. It is also acceptable to press stamps multiple times on the same square.</p>\n<p>Please maximize the sum of the remainders obtained by dividing the values of each square on the final board by <var>998244353</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Scoring</h3><p>After performing all the operations, let <var>b_{i, j}</var> be the integer assigned to the square <var>(i, j)</var> on the board.\nThen, you will obtain the following score.</p>\n<p>\\[\n\\sum_{i = 0}^{N - 1}{\\sum_{j = 0}^{N - 1}{(b_{i, j} \\bmod 998244353)}}\n\\]</p>\n<p>Here, <var>b_{i, j} \\bmod 998244353</var> represents the remainder obtained by dividing <var>b_{i, j}</var> by <var>998244353</var>.</p>\n<p>If the number of operations exceeds <var>K</var> or if you output an illegal operation, the submission will be judged as <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Wrong Answer\">WA</span>.</p>\n<p>There are <var>150</var> test cases, and the score of a submission is the total score for each test case.\nIf your submission produces an illegal output or exceeds the time limit for some test cases, the submission itself will be judged as <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Wrong Answer\">WA</span> or <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Time Limit Exceeded\">TLE</span>.\nThe highest score obtained during the contest will determine the final ranking, and there will be no system test after the contest.\nIf more than one participant gets the same score, they will be ranked in the same place regardless of the submission time.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>K</var>\n<var>a_{0, 0}</var> <var>\\cdots</var> <var>a_{0, N - 1}</var>\n<var>\\vdots</var>\n<var>a_{N - 1, 0}</var> <var>\\cdots</var> <var>a_{N - 1, N - 1}</var>\n<var>s_{0, 0, 0}</var> <var>s_{0, 0, 1}</var> <var>s_{0, 0, 2}</var>\n<var>s_{0, 1, 0}</var> <var>s_{0, 1, 1}</var> <var>s_{0, 1, 2}</var>\n<var>s_{0, 2, 0}</var> <var>s_{0, 2, 1}</var> <var>s_{0, 2, 2}</var>\n<var>\\vdots</var>\n<var>s_{M - 1, 0, 0}</var> <var>s_{M - 1, 0, 1}</var> <var>s_{M - 1, 0, 2}</var>\n<var>s_{M - 1, 1, 0}</var> <var>s_{M - 1, 1, 1}</var> <var>s_{M - 1, 1, 2}</var>\n<var>s_{M - 1, 2, 0}</var> <var>s_{M - 1, 2, 1}</var> <var>s_{M - 1, 2, 2}</var>\n</pre>\n\n<p>Each value satisfies the following constraints.</p>\n<ul>\n<li><var>N = 9</var></li>\n<li><var>M = 20</var></li>\n<li><var>K = 81</var></li>\n<li><var>0 \\leq a_{i, j} \\leq 998244352</var></li>\n<li><var>0 \\leq s_{m, i, j} \\leq 998244352</var></li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Let <var>L</var> <var>(0 \\leq L \\leq K)</var> be the number of operations, and <var>m_l</var> <var>(0 \\leq m_l \\leq M - 1)</var> and <var>(p_l, q_l)</var> <var>(0 \\leq p_l, q_l \\leq N - 3)</var> be the stamp and board square selected in the <var>l</var>-th operation, respectively. Then, output to Standard Output in the following format:</p>\n<pre><var>L</var>\n<var>m_0</var> <var>p_0</var> <var>q_0</var>\n<var>m_1</var> <var>p_1</var> <var>q_1</var>\n<var>\\vdots</var>\n<var>m_{L - 1}</var> <var>p_{L - 1}</var> <var>q_{L - 1}</var>\n</pre>\n\n<p><a href=\"https://img.atcoder.jp/ahc032/e2weanqa.html?lang=en&amp;seed=0&amp;output=sample\">Show example</a></p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Input Generation</h3><p>Let <var>\\mathrm{rand}(L,U)</var> be a function that generates a uniform random integer between <var>L</var> and <var>U</var>, inclusive.</p>\n<p>Each <var>a_{i, j}</var> and <var>s_{m, i, j}</var> are all independently generated by <var>a_{i, j} = \\mathrm{rand}(0, 998244352)</var> and <var>s_{m, i, j} = \\mathrm{rand}(0, 998244352)</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Tools (Input generator and visualizer)</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc032/e2weanqa.html?lang=en\">Web version</a>: This is more powerful than the local version providing animations.</li>\n<li><a href=\"https://img.atcoder.jp/ahc032/e2weanqa.zip\">Local version</a>: You need a compilation environment of <a href=\"https://www.rust-lang.org/\">Rust language</a>.<ul>\n<li><a href=\"https://img.atcoder.jp/ahc032/e2weanqa_windows.zip\">Pre-compiled binary for Windows</a>: If you are not familiar with the Rust language environment, please use this instead.</li>\n</ul>\n</li>\n</ul>\n<p>Please be aware that sharing visualization results or discussing solutions/ideas during the contest is prohibited.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">9 20 81\n24323530 980293589 859258684 185499104 894688371 236405725 111530575 250271104 495624658\n769596495 264300425 88876278 146578260 565437828 737999180 725732147 57726456 323844609\n40096771 928203404 501627737 804865949 814572382 849529199 189832922 910184599 467494517\n962420139 432607222 59818053 858072870 914485919 446805915 138548911 345246064 245004268\n477044564 12166358 931360092 799278793 865992483 339109407 614502753 736626962 801948371\n281576446 640350568 771040910 823574138 350308411 930294372 585808288 700370699 426021090\n289960346 566527193 119082954 148354804 902944838 516738876 930961873 812731496 172242940\n921564237 662077279 49476329 593121834 377147282 862136854 791213996 686329230 7403815\n501340655 979965930 839183331 303883398 490179686 492481098 160122974 114672637 82049594\n975741402 918762324 476374754\n906657349 359110092 978536040\n84599745 368692094 744129488\n261705356 216870728 556481274\n317767465 457532475 532110106\n125703669 839188333 425571806\n291667039 37052662 1276219\n305291998 653050074 220563016\n332525785 400712871 520185762\n393148157 178758620 933441647\n205044518 579917402 498932315\n411369672 664953833 274696537\n654712800 802006144 682742340\n864455037 533661060 207561332\n605472509 577911453 942938903\n576270626 688256275 33493069\n481710779 902547317 817131623\n291465541 863597953 772086608\n417987422 136453150 615090472\n760882895 841541285 914039365\n359505208 780663578 774735965\n188919347 431579412 464452916\n854985721 70294202 663019966\n157776983 3557297 439447307\n621014939 759908222 932643321\n184225959 884108948 693640679\n361651737 846036661 975413204\n479224933 700946167 622558051\n495003914 325785117 513339213\n70238660 857642866 297571112\n374937799 48000646 849682071\n528095305 232520890 469018467\n952599070 610262715 232403912\n316958602 24859140 385411996\n304561106 853230688 859071983\n266806117 99442261 881952734\n708824083 752081152 915353520\n261135036 48934653 945657700\n255395109 742827901 445178710\n906120195 565840603 316740986\n736297599 447489530 680619574\n654670835 694926131 897183420\n958993686 813942152 196144122\n324334792 928014325 852381591\n194958307 642660824 128931372\n303306950 687790222 930130148\n591510740 614681348 113389792\n160195595 683240268 555351204\n218729338 196609467 724290289\n47413572 552092134 337674489\n410209863 549012244 186533965\n452647000 449090484 733453206\n106059177 888943736 940915649\n692940521 382797569 893532614\n52383100 783583840 634565824\n168433778 751831139 356971915\n870682287 872212766 75893565\n262231629 844472478 843213274\n499286296 502562654 725538734\n467780532 720085509 907848638\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre style=\"max-height:200px;overflow-y:scroll\">4\n0 1 6\n6 6 6\n18 6 1\n16 1 5\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/ahc032/tasks/ahc032_a"}