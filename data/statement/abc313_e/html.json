{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><code>1</code> から <code>9</code> までの数字からなる文字列 <var>S</var> に対して、 <var>f(S)</var> を次の手順によって得られる文字列 <var>T</var> とします。(<var>S_i</var> は <var>S</var> の <var>i</var> 番目の文字を意味します)</p>\n<ul>\n<li>文字列 <var>T</var> がある。はじめ、<var>T</var> は空文字列である。</li>\n<li><var>i=1, 2, \\dots, |S| - 1</var> の順に次の操作を行う。 <ul>\n<li><var>S_{i+1}</var> を整数として解釈したときの値を <var>n</var> とする。<var>T</var> の末尾に <var>S_i</var> を <var>n</var> 個追加する。</li>\n</ul>\n</li>\n</ul>\n<p>例えば <var>S =</var> <code>313</code> のとき、以下の手順によって <var>f(S) =</var> <code>3111</code> に決まります。</p>\n<ul>\n<li>はじめ <var>T</var> は空文字列である。</li>\n<li><var>i=1</var> のとき <var>n = 1</var> である。<var>T</var> に <code>3</code> を <var>1</var> 個追加する。<var>T</var> は <code>3</code> になる。</li>\n<li><var>i=2</var> のとき <var>n = 3</var> である。<var>T</var> に <code>1</code> を <var>3</var> 個追加する。<var>T</var> は <code>3111</code> になる。</li>\n<li>操作を終了する。<var>T</var> として <code>3111</code> を得る。</li>\n</ul>\n<p><code>1</code> から <code>9</code> までの数字からなる長さ <var>N</var> の文字列 <var>S</var> が与えられます。<br>\nあなたは「<var>S</var> を <var>f(S)</var> に置き換える」という操作を <var>S</var> の長さが <var>1</var> になるまで繰り返します。<br>\n操作が終了するまでに行う操作を行う回数を <var>998244353</var> で割った余りを求めてください。ただし、操作が無限に続く場合は <code>-1</code> を出力してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq N \\leq 10^6</var></li>\n<li><var>S</var> は <code>1</code>, <code>2</code>, <code>3</code>, <code>4</code>, <code>5</code>, <code>6</code>, <code>7</code>, <code>8</code>, <code>9</code> からなる長さ <var>N</var> の文字列</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>S</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>操作が終了するまでに行う操作を行う回数を <var>998244353</var> で割った余りを出力せよ。ただし、操作が無限に続く場合は <code>-1</code> を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n313\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>4\n</pre>\n<p><var>S =</var> <code>313</code> の場合、操作を <var>4</var> 回行うと <var>S</var> の長さが <var>1</var> になります。</p>\n<ul>\n<li><var>f(S) =</var> <code>3111</code> である。<var>S</var> を <code>3111</code> に置き換える。</li>\n<li><var>f(S) =</var> <code>311</code> である。<var>S</var> を <code>311</code> に置き換える。</li>\n<li><var>f(S) =</var> <code>31</code> である。<var>S</var> を <code>31</code> に置き換える。</li>\n<li><var>f(S) =</var> <code>3</code> である。<var>S</var> を <code>3</code> に置き換える。</li>\n<li><var>S</var> の長さが <var>1</var> になったので操作を終了する。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>9\n123456789\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>-1\n</pre>\n<p><var>S =</var> <code>123456789</code> の場合、操作が無限に続きます。この場合は <code>-1</code> を出力してください。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>2\n11\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>For a string <var>S</var> consisting of digits from <code>1</code> through <code>9</code>, let <var>f(S)</var> be the string <var>T</var> obtained by the following procedure.  (<var>S_i</var> denotes the <var>i</var>-th character of <var>S</var>.)</p>\n<ul>\n<li>Let <var>T</var> be an initially empty string.</li>\n<li>For <var>i=1, 2, \\dots, |S| - 1</var>, perform the following operation:<ul>\n<li>Append <var>n</var> copies of <var>S_i</var> to the tail of <var>T</var>, where <var>n</var> is the value when <var>S_{i+1}</var> is interpreted as an integer.</li>\n</ul>\n</li>\n</ul>\n<p>For example, <var>S =</var> <code>313</code> yields <var>f(S) =</var> <code>3111</code> by the following steps.</p>\n<ul>\n<li><var>T</var> is initially empty.</li>\n<li>For <var>i=1</var>, we have <var>n = 1</var>.  Append one copy of <code>3</code> to <var>T</var>, which becomes <code>3</code>.</li>\n<li>For <var>i=2</var>, we have <var>n = 3</var>.  Append three copies of <code>1</code> to <var>T</var>, which becomes <code>3111</code>.</li>\n<li>Terminate the procedure.  We obtain <var>T =</var> <code>3111</code>.</li>\n</ul>\n<p>You are given a length-<var>N</var> string <var>S</var> consisting of digits from <code>1</code> through <code>9</code>.<br>\nYou repeat the following operation until the length of <var>S</var> becomes <var>1</var>: replace <var>S</var> with <var>f(S)</var>.<br>\nFind how many times, modulo <var>998244353</var>, you perform the operation until you complete it.  If you will repeat the operation indefinitely, print <code>-1</code> instead.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 10^6</var></li>\n<li><var>S</var> is a length-<var>N</var> string consisting of <code>1</code>, <code>2</code>, <code>3</code>, <code>4</code>, <code>5</code>, <code>6</code>, <code>7</code>, <code>8</code>, and <code>9</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>S</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the number of times, modulo <var>998244353</var>, that you perform the operation until you complete it.  If you will repeat the operation indefinitely, print <code>-1</code> instead.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n313\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>4\n</pre>\n<p>If <var>S =</var> <code>313</code>, the length of <var>S</var> be comes <var>1</var> after four operations.</p>\n<ul>\n<li>We have <var>f(S) =</var> <code>3111</code>.  Replace <var>S</var> with <code>3111</code>.</li>\n<li>We have <var>f(S) =</var> <code>311</code>.  Replace <var>S</var> with <code>311</code>.</li>\n<li>We have <var>f(S) =</var> <code>31</code>.  Replace <var>S</var> with <code>31</code>.</li>\n<li>We have <var>f(S) =</var> <code>3</code>.  Replace <var>S</var> with <code>3</code>.</li>\n<li>Now that the length of <var>S</var> is <var>1</var>, terminate the repetition.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>9\n123456789\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>-1\n</pre>\n<p>If <var>S =</var> <code>123456789</code>, you indefinitely repeat the operation.  In this case, <code>-1</code> should be printed.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>2\n11\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc313/tasks/abc313_e"}