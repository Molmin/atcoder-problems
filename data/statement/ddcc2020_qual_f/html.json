{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点: <var>900</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3>\n<p><var>2937</var> 年，DISCO は創業 <var>1000</var> 年を記念して新たな宇宙「DISCOSMOS」を作りました！  </p>\n<p>DISCOSMOS は <var>H \\times W</var> のマス目で表される宇宙です．上から <var>i</var> 番目，左から <var>j</var> 番目のマスを <var>(i, j)</var> <var>(1 \\leq i \\leq H, 1 \\leq j \\leq W)</var> で表します．  </p>\n<p>時刻 <var>0</var> に，各マスにロボットが <var>1</var> 台ずつ設置されます．各ロボットは以下の <var>3</var> 種類のいずれかです．</p>\n<ul>\n<li>停止型：常に停止している．</li>\n<li>右移動型：時刻 <var>t</var> に <var>(i, j)</var> に存在する場合，時刻 <var>t+1</var> には <var>(i, j+1)</var> に存在する．ただし，時刻 <var>t</var> に <var>(i, W)</var> に存在する場合は，時刻 <var>t+1</var> には <var>(i, 1)</var> に存在する．(ロボット同士が衝突することはない．)</li>\n<li>下移動型：時刻 <var>t</var> に <var>(i, j)</var> に存在する場合，時刻 <var>t+1</var> には <var>(i+1, j)</var> に存在する．ただし，時刻 <var>t</var> に <var>(H, j)</var> に存在する場合は，時刻 <var>t+1</var> には <var>(1, j)</var> に存在する．</li>\n</ul>\n<p>このようなロボットの設置方法は <var>3^{H \\times W}</var> 通り考えられます．そのうち，時刻 <var>0, T, 2T, 3T, 4T, \\dots</var> のいずれにおいても，全てのマスにロボットが <var>1</var> 台ずつ存在するような設置方法は何通りあるでしょうか？  </p>\n<p>ただし，答えは非常に大きくなる場合があるので，代わりにこれを <var>10^9 + 7</var> で割った余りを求めてください．  </p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3>\n<ul>\n<li><var>1 \\leq H \\leq 10^9</var></li>\n<li><var>1 \\leq W \\leq 10^9</var></li>\n<li><var>1 \\leq T \\leq 10^9</var></li>\n<li><var>H, W, T</var> はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3>\n<p>入力は以下の形式で標準入力から与えられます．  </p>\n<pre><var>H</var> <var>W</var> <var>T</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3>\n<p>条件を満たすロボットの設置方法の数を <var>10^9 + 7</var> で割った余りを出力してください．  </p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2 2 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>9\n</pre>\n\n<p>停止型を <code>.</code>，右移動型を <code>&gt;</code>，下移動型を <code>v</code> として，例えば次のような設定方法が条件を満たします．  </p>\n<pre>&gt;&gt;  ..  vv\n..  ..  vv\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>869 120 1001\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>672919729\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score: <var>900</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3>\n<p>In <var>2937</var>, DISCO creates a new universe called DISCOSMOS to celebrate its <var>1000</var>-th anniversary.</p>\n<p>DISCOSMOS can be described as an <var>H \\times W</var> grid. Let <var>(i, j)</var> <var>(1 \\leq i \\leq H, 1 \\leq j \\leq W)</var> denote the square at the <var>i</var>-th row from the top and the <var>j</var>-th column from the left.</p>\n<p>At time <var>0</var>, one robot will be placed onto each square. Each robot is one of the following three types:</p>\n<ul>\n<li>Type-H: Does not move at all.</li>\n<li>Type-R: If a robot of this type is in <var>(i, j)</var> at time <var>t</var>, it will be in <var>(i, j+1)</var> at time <var>t+1</var>. If it is in <var>(i, W)</var> at time <var>t</var>, however, it will be instead in <var>(i, 1)</var> at time <var>t+1</var>. (The robots do not collide with each other.)</li>\n<li>Type-D: If a robot of this type is in <var>(i, j)</var> at time <var>t</var>, it will be in <var>(i+1, j)</var> at time <var>t+1</var>. If it is in <var>(H, j)</var> at time <var>t</var>, however, it will be instead in <var>(1, j)</var> at time <var>t+1</var>.</li>\n</ul>\n<p>There are <var>3^{H \\times W}</var> possible ways to place these robots. In how many of them will every square be occupied by one robot at times <var>0, T, 2T, 3T, 4T</var>, and all subsequent multiples of <var>T</var>?</p>\n<p>Since the count can be enormous, compute it modulo <var>(10^9 + 7)</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3>\n<ul>\n<li><var>1 \\leq H \\leq 10^9</var></li>\n<li><var>1 \\leq W \\leq 10^9</var></li>\n<li><var>1 \\leq T \\leq 10^9</var></li>\n<li><var>H, W, T</var> are all integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3>\n<p>Input is given from Standard Input in the following format:</p>\n<pre><var>H</var> <var>W</var> <var>T</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3>\n<p>Print the number of ways to place the robots that satisfy the condition, modulo <var>(10^9 + 7)</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2 2 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>9\n</pre>\n\n<p>Shown below are some of the ways to place the robots that satisfy the condition, where <code>.</code>, <code>&gt;</code>, and <code>v</code> stand for Type-H, Type-R, and Type-D, respectively:</p>\n<pre>&gt;&gt;  ..  vv\n..  ..  vv\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>869 120 1001\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>672919729\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_f"}