{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1400</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>2N</var> 枚のカードと <var>N</var> 個の箱があります。\nカードには <var>1</var> から <var>2N</var> までの番号が付いており、箱には <var>1</var> から <var>N</var> までの番号が付いています。\nカードは各箱に <var>2</var> 枚ずつ入っています。箱 <var>i</var> にはカード <var>A_i</var> とカード <var>B_i</var> が入っています。</p>\n<p>この <var>N</var> 個の箱を一列に並べる方法であって、以下の条件を満たす並べ方の個数を <var>10^9+7</var> で割った余りを求めてください。</p>\n<ul>\n<li>箱を左から順に開けていき、入っている <var>2</var> 枚のカードを末尾に好きな順で並べていくことで、長さ <var>2N</var> のカードの列が得られる。左から <var>j</var> 番目のカードの番号を <var>P_j</var> とする。このとき、カードをうまく並べることで、数列 <var>P_1,P_2,\\ldots, P_{2N}</var> におけるピークの個数が <var>N-1</var> となる。</li>\n</ul>\n<p>ただし、数列 <var>P_1,P_2,\\ldots, P_{2N}</var> におけるピークとは、\n<var>2 \\leq j &lt; 2N</var> なる整数 <var>j</var> であって <var>P_{j-1} &lt; P_j</var> かつ <var>P_j &gt; P_{j+1}</var> となるものを指します。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 2\\times 10^5</var></li>\n<li><var>1 \\leq A_i, B_i \\leq 2N</var></li>\n<li><var>A_1,\\ldots,A_N,B_1,\\ldots,B_N</var> は相異なる。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>A_1</var> <var>B_1</var>\n<var>:</var>\n<var>A_N</var> <var>B_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n1 3\n2 4\n5 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>4\n</pre>\n\n<p>例えば、箱 <var>1,2,3</var> をこの順で並べたとき、\n以下のようにカードを並べることで、数列 <var>P</var> のピークの個数が <var>2</var> となります。</p>\n<ul>\n<li>まず箱 <var>1</var> に入っているカードをカード <var>1,3</var> の順で並べる。</li>\n<li>次に箱 <var>2</var> に入っているカードをカード <var>2,4</var> の順で末尾に並べる。</li>\n<li>最後に箱 <var>3</var> に入っているカードをカード <var>6,5</var> の順で末尾に並べる。</li>\n</ul>\n<p>このとき、数列 <var>P</var> は <var>(1,3,2,4,6,5)</var> となり <var>j=2,5</var> がピークとなります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>6\n5 8\n7 2\n1 3\n11 6\n4 12\n9 10\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>492\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>10\n20 15\n8 5\n6 7\n4 9\n13 1\n11 14\n10 17\n19 12\n3 16\n2 18\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1411200\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1400</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have <var>2N</var> cards and <var>N</var> boxes.\nThe cards are numbered <var>1</var> through <var>2N</var>, and the boxes are numbered <var>1</var> through <var>N</var>.\nEach box contains two cards; Box <var>i</var> contains Card <var>A_i</var> and Card <var>B_i</var>.</p>\n<p>Find, modulo <var>(10^9+7)</var>, the number of ways to arrange the <var>N</var> boxes in a row that satisfies the following condition.</p>\n<ul>\n<li>Consider getting a sequence of <var>2N</var> cards as follows: for each box, from left to right, open it and append the two cards in it to the end of the sequence in an order we like. In this way, it is possible to get a sequence <var>P_1,P_2,\\ldots, P_{2N}</var> with <var>N-1</var> peaks.</li>\n</ul>\n<p>Here, a peak in a sequence <var>P_1,P_2,\\ldots, P_{2N}</var> is an integer <var>j</var> satisfying <var>2 \\leq j &lt; 2N</var> such that <var>P_{j-1} &lt; P_j</var> and <var>P_j &gt; P_{j+1}</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 2\\times 10^5</var></li>\n<li><var>1 \\leq A_i, B_i \\leq 2N</var></li>\n<li><var>A_1,\\ldots,A_N,B_1,\\ldots,B_N</var> are pairwise distinct.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>A_1</var> <var>B_1</var>\n<var>:</var>\n<var>A_N</var> <var>B_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n1 3\n2 4\n5 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>4\n</pre>\n\n<p>For example, if we arrange Boxes <var>1, 2, 3</var> in this order, we can arrange the cards as follows to get a sequence <var>P</var> with <var>2</var> peaks:</p>\n<ul>\n<li>first, arrange the cards in Box <var>1</var> in the order <var>1, 3</var>;</li>\n<li>next, append the cards in Box <var>2</var> at the end in the order <var>2, 4</var>;</li>\n<li>lastly, append the cards in Box <var>3</var> at the end in the order <var>6, 5</var>.</li>\n</ul>\n<p>Here, we have <var>P=(1,3,2,4,6,5)</var> with peaks <var>j=2,5</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>6\n5 8\n7 2\n1 3\n11 6\n4 12\n9 10\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>492\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>10\n20 15\n8 5\n6 7\n4 9\n13 1\n11 14\n10 17\n19 12\n3 16\n2 18\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1411200\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc053/tasks/agc053_e"}