{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>550</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>長さ <var>N</var> の整数列 <var>A = (A_1, A_2, \\ldots, A_N)</var> が与えられます。</p>\n<p><var>A</var> に対して、<var>i = 1, 2, \\ldots, M</var> の順に下記の操作を行います。</p>\n<ul>\n<li>まず、<var>L_i</var> 以上 <var>R_i</var> 以下の整数を等確率でランダムに <var>1</var> 個を選び、それを <var>p</var> とおく。</li>\n<li>そして、<var>A_p</var> の値を整数 <var>X_i</var> に変更する。</li>\n</ul>\n<p>上記の手順を行った後の最終的な <var>A</var> における、<var>A_i</var> の期待値 <var>\\text{mod } 998244353</var> を、\n各 <var>i = 1, 2, \\ldots, N</var> について出力してください。</p>\n<details> <summary>期待値 <var>\\text{mod } 998244353</var> の定義</summary>\n\n<p>この問題で求める期待値は必ず有理数になることが証明できます。 また、この問題の制約下では、求める期待値を既約分数 <var>\\frac{y}{x}</var> で表したときに <var>x</var> が <var>998244353</var> で割り切れないことが保証されます。</p> <p>このとき <var>xz \\equiv y \\pmod{998244353}</var> を満たすような <var>0</var> 以上 <var>998244352</var> 以下の整数 <var>z</var> が一意に定まります。この <var>z</var> を答えてください。</p> </details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li>入力される値は全て整数</li>\n<li><var>1 \\leq N, M \\leq 2 \\times 10^5</var></li>\n<li><var>0 \\leq A_i \\leq 10^9</var></li>\n<li><var>1 \\leq L_i \\leq R_i \\leq N</var></li>\n<li><var>0 \\leq X_i \\leq 10^9</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>A_1</var> <var>A_2</var> <var>\\ldots</var> <var>A_N</var>\n<var>L_1</var> <var>R_1</var> <var>X_1</var>\n<var>L_2</var> <var>R_2</var> <var>X_2</var>\n<var>\\vdots</var>\n<var>L_M</var> <var>R_M</var> <var>X_M</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>各 <var>i = 1, 2, \\ldots, N</var> に対する最終的な <var>A_i</var> の期待値 <var>E_i</var> を、\n下記の形式の通りに空白区切りで出力せよ。</p>\n<pre><var>E_1</var> <var>E_2</var> <var>\\ldots</var> <var>E_N</var>\n</pre>\n\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>5 2\n3 1 4 1 5\n1 2 2\n2 4 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>499122179 1 665496238 665496236 5\n</pre>\n\n<p><var>A = (3, 1, 4, 1, 5)</var> である初期状態からはじめ、下記の通りに <var>2</var> 個の操作が行われます。</p>\n<ul>\n<li>まず、<var>1</var> 個目の操作で、<var>A_1</var> と <var>A_2</var> のどちらか一方が等確率でランダムに選ばれ、その値が <var>2</var> に変更されます。</li>\n<li>その後、<var>2</var> 個目の操作で、<var>A_2, A_3, A_4</var> のうちいずれか <var>1</var> 個が等確率でランダムに選ばれ、その値が <var>0</var> に変更されます。</li>\n</ul>\n<p>その結果、最終的な <var>A</var> の各要素の期待値は <var>(E_1, E_2, E_3, E_4, E_5) = (\\frac{5}{2}, 1, \\frac{8}{3}, \\frac{2}{3}, 5)</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>2 4\n1 2\n1 1 3\n2 2 4\n1 1 5\n2 2 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>5 6\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>20 20\n998769066 273215338 827984962 78974225 994243956 791478211 891861897 680427073 993663022 219733184 570206440 43712322 66791680 164318676 209536492 137458233 289158777 461179891 612373851 330908158\n12 18 769877494\n9 13 689822685\n6 13 180913148\n2 16 525285434\n2 14 98115570\n14 17 622616620\n8 12 476462455\n13 17 872412050\n14 15 564176146\n7 13 143650548\n2 5 180435257\n4 10 82903366\n1 2 643996562\n8 10 262860196\n10 14 624081934\n11 13 581257775\n9 19 381806138\n3 12 427930466\n6 19 18249485\n14 19 682428942\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>821382814 987210378 819486592 142238362 447960587 678128197 687469071 405316549 318941070 457450677 426617745 712263899 939619994 228431878 307695685 196179692 241456697 12668393 685902422 330908158\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>550</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given an integer sequence <var>A = (A_1, A_2, \\ldots, A_N)</var> of length <var>N</var>.</p>\n<p>We will perform the following operation on <var>A</var> for <var>i = 1, 2, \\ldots, M</var> in this order.</p>\n<ul>\n<li>First, choose an integer between <var>L_i</var> and <var>R_i</var>, inclusive, uniformly at random and denote it as <var>p</var>.</li>\n<li>Then, change the value of <var>A_p</var> to the integer <var>X_i</var>.</li>\n</ul>\n<p>For the final sequence <var>A</var> after the above procedure, print the expected value, modulo <var>998244353</var>, of <var>A_i</var> for each <var>i = 1, 2, \\ldots, N</var>.</p>\n<details> <summary>How to print expected values modulo <var>998244353</var></summary>\n\n<p>It can be proved that the expected values sought in this problem are always rational. Furthermore, the constraints of this problem guarantee that if each of those expected values is expressed as an irreducible fraction <var>\\frac{y}{x}</var>, then <var>x</var> is not divisible by <var>998244353</var>.</p> <p>Now, there is a unique integer <var>z</var> between <var>0</var> and <var>998244352</var>, inclusive, such that <var>xz \\equiv y \\pmod{998244353}</var>. Report this <var>z</var>.</p> </details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li>All input values are integers.</li>\n<li><var>1 \\leq N, M \\leq 2 \\times 10^5</var></li>\n<li><var>0 \\leq A_i \\leq 10^9</var></li>\n<li><var>1 \\leq L_i \\leq R_i \\leq N</var></li>\n<li><var>0 \\leq X_i \\leq 10^9</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>A_1</var> <var>A_2</var> <var>\\ldots</var> <var>A_N</var>\n<var>L_1</var> <var>R_1</var> <var>X_1</var>\n<var>L_2</var> <var>R_2</var> <var>X_2</var>\n<var>\\vdots</var>\n<var>L_M</var> <var>R_M</var> <var>X_M</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the expected values <var>E_i</var> of the final <var>A_i</var> for <var>i = 1, 2, \\ldots, N</var> in the format below, separated by spaces.</p>\n<pre><var>E_1</var> <var>E_2</var> <var>\\ldots</var> <var>E_N</var>\n</pre>\n\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>5 2\n3 1 4 1 5\n1 2 2\n2 4 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>499122179 1 665496238 665496236 5\n</pre>\n\n<p>We start from the initial state <var>A = (3, 1, 4, 1, 5)</var> and perform the following two operations.</p>\n<ul>\n<li>The first operation chooses <var>A_1</var> or <var>A_2</var> uniformly at random, and changes its value to <var>2</var>.</li>\n<li>Then, the second operation chooses one of <var>A_2, A_3, A_4</var> uniformly at random, and changes its value to <var>0</var>.</li>\n</ul>\n<p>As a result, the expected values of the elements in the final <var>A</var> are <var>(E_1, E_2, E_3, E_4, E_5) = (\\frac{5}{2}, 1, \\frac{8}{3}, \\frac{2}{3}, 5)</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>2 4\n1 2\n1 1 3\n2 2 4\n1 1 5\n2 2 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>5 6\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>20 20\n998769066 273215338 827984962 78974225 994243956 791478211 891861897 680427073 993663022 219733184 570206440 43712322 66791680 164318676 209536492 137458233 289158777 461179891 612373851 330908158\n12 18 769877494\n9 13 689822685\n6 13 180913148\n2 16 525285434\n2 14 98115570\n14 17 622616620\n8 12 476462455\n13 17 872412050\n14 15 564176146\n7 13 143650548\n2 5 180435257\n4 10 82903366\n1 2 643996562\n8 10 262860196\n10 14 624081934\n11 13 581257775\n9 19 381806138\n3 12 427930466\n6 19 18249485\n14 19 682428942\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>821382814 987210378 819486592 142238362 447960587 678128197 687469071 405316549 318941070 457450677 426617745 712263899 939619994 228431878 307695685 196179692 241456697 12668393 685902422 330908158\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc332/tasks/abc332_f"}