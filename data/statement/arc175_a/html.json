{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>400</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 人が円卓に座っており，各人は反時計回りに順に <var>1, \\ldots, N</var> と番号付けられています．各人はそれぞれ左右どちらか一方の利き手を持っています．</p>\n<p>円卓上には <var>1, \\ldots, N</var> と番号付けられた計 <var>N</var> 本のスプーンが，隣り合う二人の間に <var>1</var> 本ずつ置いてあります．各 <var>1 \\leq i \\leq N</var> について，人 <var>i</var> の左側，右側にはそれぞれスプーン <var>i</var>，スプーン <var>(i+1)</var> があります．ここで，スプーン <var>(N+1)</var> はスプーン <var>1</var> のことを指します．</p>\n<p><var>N = 4</var> での模式図を以下に示します．</p>\n<p><img src=\"https://img.atcoder.jp/arc175/b86aef99039c82389bf15f8df725a4c5.png\" class=\"img-responsive center-block\" style=\"max-width: 300px\"></p>\n<p><var>(1, \\dots, N)</var> の順列 <var>(P_1, \\dots, P_N)</var> が与えられます．<var>i=1,\\dots,N</var> の順に，人 <var>P_i</var> が以下のように行動します．</p>\n<ul>\n<li>自分の右側または左側にスプーンが残っているならば，そのうち <var>1</var> つを取る．\n<ul>\n<li>このとき自分の両側にスプーンが残っているならば，自分の利き手の側のスプーンを取る．</li>\n</ul>\n</li>\n<li>そうでないならば何もしない．</li>\n</ul>\n\n<p><code>L</code>, <code>R</code>, <code>?</code> からなる長さ <var>N</var> の文字列 <var>S</var> が与えられます．<var>N</var> 人の利き手の組み合わせは <var>2^N</var> 通りありますが，そのうち以下の条件を全て満たすような組み合わせの数を <var>998244353</var> で割った余りを求めてください．</p>\n<ul>\n<li><var>S</var> の <var>i</var> 番目の文字が <code>L</code> ならば，人 <var>i</var> は左利きである．</li>\n<li><var>S</var> の <var>i</var> 番目の文字が <code>R</code> ならば，人 <var>i</var> は右利きである．</li>\n<li>全員の行動が終了したとき，全員がスプーンを取っている．</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li>入力される数値は全て整数</li>\n<li><var>2 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>(P_1, \\dots, P_N)</var> は <var>(1, \\dots, N)</var> の順列</li>\n<li><var>S</var> は <code>L</code>, <code>R</code>, <code>?</code> からなる長さ <var>N</var> の文字列</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる．</p>\n<pre><var>N</var>\n<var>P_1</var> <var>\\dots</var> <var>P_N</var>\n<var>S</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを <var>1</var> 行に出力せよ．</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n1 2 3\nL??\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2\n</pre>\n\n<p>人 <var>1,2,3</var> がそれぞれ左利き，左利き，右利きのとき，以下のように行動が行われます．</p>\n<ul>\n<li>人 <var>1</var> が行動を開始する．人 <var>1</var> の両側にスプーンが残っているので，人 <var>1</var> の利き手と同じ左側のスプーン <var>1</var> を取る．</li>\n<li>人 <var>2</var> が行動を開始する．人 <var>2</var> の両側にスプーンが残っているので，人 <var>2</var> の利き手と同じ左側のスプーン <var>2</var> を取る．</li>\n<li>人 <var>3</var> が行動を開始する．人 <var>3</var> の右側にはスプーンが残っておらず，左側にはスプーン <var>3</var> が残っているので，スプーン <var>3</var> を取る．全員の行動が終了し，このとき全員がスプーンを取っている．</li>\n</ul>\n<p>この利き手の組み合わせは条件を満たします．他には人 <var>1,2,3</var> がそれぞれ左利き，左利き，左利きの場合も条件を満たします．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3\n1 3 2\nR?L\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n\n<p>条件を満たす利き手の組み合わせが存在しません．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>12\n6 2 9 3 1 4 11 5 12 10 7 8\n????????????\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>160\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score: <var>400</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p><var>N</var> people are sitting around a round table, and numbered <var>1</var> to <var>N</var> in a counterclockwise order. Each person has a dominant hand: left or right.</p>\n<p>There are <var>N</var> spoons numbered <var>1</var> to <var>N</var> on the round table, with one spoon placed between each pair of adjacent people. For each <var>1 \\leq i \\leq N</var>, to the left and right of person <var>i</var>, there are spoons <var>i</var> and <var>(i+1)</var>, respectively. Here, spoon <var>(N+1)</var> refers to spoon <var>1</var>.</p>\n<p>Below is a diagram for <var>N = 4</var>.</p>\n<p><img src=\"https://img.atcoder.jp/arc175/b86aef99039c82389bf15f8df725a4c5.png\" class=\"img-responsive center-block\" style=\"max-width: 300px\"></p>\n<p>You are given a permutation <var>(P_1, \\dots, P_N)</var> of <var>(1, \\dots, N)</var>. In the order <var>i=1,\\dots,N</var>, person <var>P_i</var> will act as follows:</p>\n<ul>\n<li>If there is a spoon remaining on left or right side, they will take one of them.<ul>\n<li>If there are spoons remaining on both sides, they will take the spoon on the side of their dominant hand.</li>\n</ul>\n</li>\n<li>Otherwise, they do nothing.</li>\n</ul>\n<p>You are also given a string <var>S</var> of length <var>N</var> consisting of <code>L</code>, <code>R</code>, and <code>?</code>. Among the <var>2^N</var> possible combinations of dominant hands, find how many satisfy all of the following conditions, modulo <var>998244353</var>:</p>\n<ul>\n<li>If the <var>i</var>-th character of <var>S</var> is <code>L</code>, person <var>i</var> is left-handed.</li>\n<li>If the <var>i</var>-th character of <var>S</var> is <code>R</code>, person <var>i</var> is right-handed.</li>\n<li>When everyone has finished acting, everyone has taken a spoon.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li>All input values are integers.</li>\n<li><var>2 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>(P_1, \\dots, P_N)</var> is a permutation of <var>(1, \\dots, N)</var>.</li>\n<li><var>S</var> is a string of length <var>N</var> consisting of <code>L</code>, <code>R</code>, and <code>?</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>P_1</var> <var>\\dots</var> <var>P_N</var>\n<var>S</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer in a single line.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n1 2 3\nL??\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2\n</pre>\n\n<p>When persons <var>1</var>, <var>2</var>, and <var>3</var> are left-handed, left-handed, and right-handed, respectively, the actions are performed as follows:</p>\n<ul>\n<li>Person <var>1</var> starts acting. There are spoons on both sides, so person <var>1</var> takes spoon <var>1</var> on the left side, which is the same as their dominant hand.</li>\n<li>Person <var>2</var> starts acting. There are spoons on both sides, so person <var>2</var> takes spoon <var>2</var> on the left side, which is the same as their dominant hand.</li>\n<li>Person <var>3</var> starts acting. There is no spoon on the right side, but spoon <var>3</var> is remaining on the left side, so they take spoon <var>3</var>. Everyone has finished acting and taken a spoon.</li>\n</ul>\n<p>This combination of dominant hands satisfies the conditions. Besides, the conditions are also satisfied when persons <var>1, 2, 3</var> are all left-handed.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3\n1 3 2\nR?L\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n\n<p>No combinations of dominant hands satisfy the conditions.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>12\n6 2 9 3 1 4 11 5 12 10 7 8\n????????????\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>160\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc175/tasks/arc175_a"}