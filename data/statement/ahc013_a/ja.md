## 問題文

                    

![](https://img.atcoder.jp/ahc013/d82f46552bdf5f406aaba84ec8a57d9d.gif)

                    

                        株式会社リクルートには $N$ 行 $N$ 列のグリッドで表されるサーバ室があります。<br>
                        サーバ室の上から $i$ 行目（ $0 \leq i \lt N$ ）、左から $j$ 列目（ $0 \leq j \lt N$ ）のセルを $(i, j)$ と表します。<br>
                        各セルには、コンピュータを最大1個まで置くことができます。<br>
                        また、サーバ室には $K$ 種類のコンピュータが $100$ 個ずつあります。<br>
                        既に $100 \times K$ 個のコンピュータが $100 \times K$ 個のセルに置かれていて、残りの $N^2 - 100 \times K$ 個のセルには何も置かれていません。
                    

                    

                        Xさんはコンピュータを何度か**移動**した後、コンピュータ同士をまっすぐなケーブルで**接続**します。<br>
                        **移動** と **接続** とは次のような操作を指します。
                        

- **移動**：動かしたいコンピュータを1個選び、上下左右の四方向に隣接するセルのどれかへ動かします。一度動かしたコンピュータを複数回動かすこともできます。次の条件をすべて満たす必要があります。
                                -   - 移動先として他のコンピュータが存在するセルを選ぶことはできない。
-   - コンピュータをサーバ室の外へ移動することはできない。
- **接続**：つなぎたいコンピュータを2個選び、それら同士をまっすぐなケーブルでつなぎます。次の条件をすべて満たす必要があります。
                                -   - 選んだ2個のコンピュータは同じ行か同じ列に存在し、間に他のコンピュータが存在しない。
-   - ケーブルは他のケーブルと交差しない。（あるコンピュータに複数の方向からケーブルを接続することは可能）
-   - 既にケーブルで直接つながっているコンピュータ同士を再び指定することはできない。
-   - あるコンピュータの接続先として、そのコンピュータ自身を指定することはできない。

                    

                    

                        コンピュータたちを**接続**することで**クラスタ**が作られます。<br>
                        あるコンピュータ $C_i$ から 別のコンピュータ $C_j$にケーブルを1回以上通ってたどり着くことができる場合に、またその場合に限り、 $C_i$ と $C_j$ は「同じ**クラスタ**に属する」とみなします。
                    

                    

                        Xさんは上手に**クラスタ**を作り、**サーバ室の処理性能**をなるべく上げたいです。<br>
                        **サーバ室の処理性能**は、**クラスタ**内に種類が同じコンピュータの組の数が多ければ多いほど上がります。<br>
                        一方で、**クラスタ**内に種類が異なるコンピュータの組の数が多ければ多いほど**サーバ室の処理性能**は下がってしまいます。<br>
                    

                    

                        厳密には、**サーバ室の処理性能**は、次のように計算されます。
                        

- サーバ室に置かれている $100 \times K$ 個のコンピュータを $C_0, C_1, \cdots, C_{100K-1}$ と表す。
- $0 \leq i \lt j \lt 100 \times K$ を満たす全ての整数の組 $(i, j)$ について、以下の点を計算したものの和を**サーバ室の処理性能**とする。
                                -   - $C_i$ と $C_j$ が同じ**クラスタ**に属していて、種類が同じ場合は $1$ 点
-   - $C_i$ と $C_j$ が同じ**クラスタ**に属していて、種類が異なる場合は $-1$ 点
-   - $C_i$ と $C_j$ が同じ**クラスタ**に属さない場合は $0$ 点

                    

                    

                        Xさんの体力は限られているため、**移動** を行う回数と **接続** を行う回数の和は $100 \times K$ 以下である必要があります。<br>
                        なるべく**サーバ室の処理性能**が大きくなるような**移動**と**接続**の仕方を見つけてください。
                    

                
            
            
                
                    

## 得点

                    

                        1つのテストケースでは、**サーバ室の処理性能**が $0$ 点より大きい場合はそれがそのまま得点となり、そうでない場合は $0$ 点となります。<br>
                    

                    

                        各テストケースの得点の合計が提出の得点となります。
                        暫定テストでは、一つ以上のテストケースで不正な出力や制限時間超過をした場合、提出全体の判定がWAやTLEとなります。
                        システムテストでは、不正な出力や制限時間超過をした場合、そのテストケースのみ $0$ 点となります。
                    

                    

### テストケース数

                    

- 暫定テスト: 50個
                            -   - 暫定テストでは、入力の制約を満たす $N$ および $K$ がランダムに選ばれます。
- システムテスト: 2000個
                            -   - システムテストでは、各 $N$ と $K$ の組（計100組）のデータが20個ずつ存在します。
-   - コンテスト終了後に [seeds.txt](https://img.atcoder.jp/ahc013/seeds.txt) (sha256=`0a50dccf4689292f69a36be0ea1a99767de055434b854f2b0bc7f1fd40f9033e`) を公開します。

                    

### 実行時間について

                    

                        実行時間には多少のブレが生じます。
                        また、システムテストでは同時に大量の実行を行うため、暫定テストに比べて数%程度実行時間が伸びる現象が確認されています。
                        そのため、実行時間制限ギリギリの提出がシステムテストでTLEとなる可能性があります。
                        プログラム内で時間を計測して処理を打ち切るか、実行時間に余裕を持たせるようお願いします。
                    

                
            
            

            
                
                    
                        

## 入力

                        

入力は以下の形式で標準入力から与えられます。

> \(\begin{array}{lll}
> 
>     N ~ K & & \\
> 
>     c_{ 0,0 } & \ldots & c_{ 0,N-1 } \\
> 
>     \vdots & \ddots & \vdots \\
> 
>     c_{ N-1,0 } & \ldots & c_{ N-1,N-1 }
> 
>   \end{array}\)

                        

                            1行目には2つの整数 $N$ と $K$ を含みます。続く $N$ 行のそれぞれには、長さ $N$ の文字列が1つ与えられます。
                            

- $N$ と $K$ はサーバ室の大きさとコンピュータの種類数を表す整数で、以下のいずれかを満たします。
                                    -   - $K=2$  かつ  $15 \leq N \leq 39$
-   - $K=3$  かつ  $18 \leq N \leq 42$
-   - $K=4$  かつ  $21 \leq N \leq 45$
-   - $K=5$  かつ  $24 \leq N \leq 48$
- $c_{ i,j }$ は セル $(i, j)$の初期状態を表す整数で、 $0 \leq c_{i,j} \leq K$ を満たします。
                                    -   - $c_{ i,j } = 0$ の場合、コンピュータが置かれていないことを表します。コンピュータが置かれていないセルは必ず $N^2 - 100 \times K$ 個であることが保証されます。
-   - $1 \leq c_{ i,j } \leq K$ の場合、種類が $c_{i,j}$ であるコンピュータが置かれていることを表します。各種コンピュータは必ず $100$ 個ずつ置かれていることが保証されます。

                        

                    
                

                
                    
                        

## 出力

                        

以下の形式で標準出力へ出力してください。

> \(
> 
> X \\
> 
> a_0 ~ b_0 ~ c_0 ~ d_0 \\
> 
> \vdots \\
> 
> a_{X-1} ~ b_{X-1} ~ c_{X-1} ~ d_{X-1} \\
> 
> Y \\
> 
> e_0 ~ f_0 ~ g_0 ~ h_0 \\
> 
> \vdots \\
> 
> e_{Y-1} ~ f_{Y-1} ~ g_{Y-1} ~ h_{Y-1}
> 
> \)

                        

                            1行目に、**移動**を行う回数を表す整数 $X$ を出力してください。<br>
                            続く $X$ 行には、**移動**の情報を表す4つの整数を**移動**を行う順に出力してください。<br>
                            $i$ 行目の整数 $a_i, b_i, c_i, d_i$ は、 $(a_i, b_i)$ に置かれているコンピュータを $(c_i, d_i)$ へ**移動**することを表します。
                        

                        

                            その後、**接続**を行う回数を表す整数 $Y$ を出力してください。<br>
                            続く $Y$ 行には、**接続**の情報を表す4つの整数を出力してください。<br>
                            $i$ 行目の整数 $e_i, f_i, g_i, h_i$ は、 $(e_i, f_i)$ に置かれているコンピュータ と $(g_i, h_i)$ に置かれているコンピュータを**接続**することを表します。
                        

                        

                            また、以下の制約をすべて満たす必要があります。満たさない場合はWAとなります。
                            

- $0 \leq X, \sim 0 \leq Y$
- $X + Y \leq 100 \times K$
- **移動**と**接続**は、問題文中に書かれている条件を満たしていること

                        

                        

                            解が複数出力された場合、一番 <font color="red">**最初**</font> のもののみが採点に用いられます。ビジュアライザでは複数出力された解の比較が可能です。
                        

                    
                

                
                    
                        

## 入力生成方法

                        

                            各ケースはテストケースジェネレータによって生成されています。<br>
                            テストケースジェネレータはページ下部のリンクより提供しています。<br>
                            テストケースジェネレータは以下の手順でケースを生成します。厳密には実装を見てください（必ずしも目を通す必要はありません）。<br>
                            

- $K$ は、seed値を4で割った余り + 2 により生成されます。seed値を調整することで特定の $K$ の値を持つ入力を生成できます。
- $N$ は、入力の条件を満たすものの中から一様ランダムに生成されます。
- $c_{i,j}$ は、入力の条件を満たすものの中から一様ランダムに生成されます。

                        

                    
                

                
                    
                        

## ツール

                        

- [Web版ビジュアライザ・入力ジェネレータ](https://img.atcoder.jp/ahc013/a42302b3af.html?lang=ja): アニメーション表示が可能です。
- [ローカル版ビジュアライザ・入力ジェネレータ](https://img.atcoder.jp/ahc013/a42302b3af.zip): 使用するには[Rust言語](https://www.rust-lang.org/ja)のコンパイル環境をご用意下さい。
- [サンプルコード（C++, Python）](https://img.atcoder.jp/ahc013/4c1bf2fcb4366d2f8b77ed1f53aeaf16.zip): そのまま提出もできるサンプルの解答です。次の処理を実装しています。
                                -   1. ランダムな**移動**を何度か行う
-   2. それぞれのコンピュータから、右と下に向かって、同じ種類のコンピュータに**接続**できるならする
-   3. スコアを計算し、標準エラー出力に出力する

                        

                            <font color="red">**コンテスト終了までビジュアライズ結果の共有は禁止されています。ご注意下さい。**</font>
                        

                    
                
            

            
            
                
                    

## 入力例 1 <span class="btn btn-default btn-sm btn-copy" tabindex="0" data-toggle="tooltip" data-trigger="manual" title="" data-target="pre-sample0" data-original-title="Copied!">Copy</span>

                    Copy
```plain
5 2
10000
00000
00200
00000
00111
```
                    この入力は説明用のものなので、入力の制約を満たさないことに注意してください。
                
            

            
                
                    

## 出力例 1 <span class="btn btn-default btn-sm btn-copy" tabindex="0" data-toggle="tooltip" data-trigger="manual" title="" data-target="pre-sample1" data-original-title="Copied!">Copy</span>

                    Copy
```plain
2
0 0 0 1
0 1 0 2
4
0 2 2 2
2 2 4 2
4 2 4 3
4 3 4 4
```
                    

- $(0,0)$ にあるコンピュータを2回連続で**移動**し、 $(0,2)$ へ動かします。
- すべてのコンピュータを**接続**します。
- この時の**サーバ室の処理性能**は2となります。
                            -   - すべてのコンピュータからなる**クラスタ**が1つあり、種類1のコンピュータが4個、種類2のコンピュータが1個で構成されています。
-   - **クラスタ**内に種類1同士のコンピュータの組は ${4 \choose 2} = 6$ つあり、種類1と種類2のコンピュータの組は $4 \times 1 = 4$つあるので、 $6 - 4 = 2$ が **サーバ室の処理性能** となります。

                
            

            
                
                    

## 入力例 2 <span class="btn btn-default btn-sm btn-copy" tabindex="0" data-toggle="tooltip" data-trigger="manual" title="" data-target="pre-sample2" data-original-title="Copied!">Copy</span>

                    Copy
```plain
33 3
200000020020030300300012000000200
000000000333000000002200002030201
000100010000003200020000031001010
000023200000000000202300010000030
000010000023000300310300003000010
100010030001000032100000000103000
000000030100030300000000002000000
100000000120200000000000001001000
120030000200000000001001032000302
000000020003033020000013020002301
030000301300000000020200002003000
002000000020000000030103002000100
331210020020020000200200200103000
000202320000003000000000001000000
000010010030000303120001200000001
103000022010000313000000000000003
000012000010000001000000030000030
002000200003010100000002332000000
000003023000230020000003030000130
010000020001202302210002102030000
000003000000100002002000002002000
010003000200200000010030103000212
001000300000300000130020000003120
000000320300200100300000030002200
000000100003000000020100000300000
010000130110030200200100000110000
000231100000113000102000201003010
000000100030100230000000021000030
300103010000010100100300001022000
201021000001001000020000002000333
000002030300000000030000103100300
020000110320030200012100001030300
000100000010000000020001220030021
```
                    このケースは、テストケースジェネレータを seed=`1` で実行すると生成されます。出力例は省略します。