{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>1</var> から <var>N</var> までの番号が付けられた <var>N</var> 個の部品と <var>M</var> 本のケーブルを使って電気回路を作ろうとしています。\nこれらの部品には赤い端子と青い端子がそれぞれ合計で <var>M</var> 個ずつ存在し、<var>i</var> 個目の赤い端子は部品 <var>R_i</var> に、<var>i</var> 個目の青い端子は部品 <var>B_i</var> についています。\n各ケーブルは赤い端子 <var>1</var> つと青い端子 <var>1</var> つを繋ぎます。\n特に、同じ部品についた <var>2</var> つの端子を繋ぐことも許されます。\nまた、<var>1</var> つの端子に対して <var>2</var> 本以上のケーブルを繋げることはできません。\nしたがって、<var>M</var> 本のケーブルの繋ぎ方は全部で <var>M!</var> 通りあります（ケーブル同士は区別しないことに注意してください）。</p>\n<p>部品を頂点、ケーブルを辺としたグラフとしてこの回路を見たときの連結成分数を <var>s</var> とします。\n<var>M</var> 本のケーブルの繋ぎ方を <var>M!</var> 通りからランダムに選ぶときの <var>s</var> の期待値を <var>\\text{mod } 998244353</var> で求めてください。</p>\n<details>\n<summary>期待値を <var>\\text{mod } 998244353</var> で求めるとは</summary>\n求める期待値は必ず有理数となることが証明できます。  \nまたこの問題の制約下では、その値を互いに素な <var>2</var> つの整数 <var>P</var>, <var>Q</var> を用いて <var>\\frac{P}{Q}</var> と表したとき、<var>R \\times Q \\equiv P\\pmod{998244353}</var> かつ <var>0 \\leq R \\lt 998244353</var> を満たす整数 <var>R</var> がただ一つ存在することが証明できます。\nこの <var>R</var> を求めてください。\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1\\leq N \\leq 17</var></li>\n<li><var>1 \\leq M \\leq 10^5</var></li>\n<li><var>1 \\leq R_i, B_i \\leq N</var></li>\n<li>入力は全て整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>R_1</var> <var>R_2</var> <var>\\dots</var> <var>R_M</var>\n<var>B_1</var> <var>B_2</var> <var>\\dots</var> <var>B_M</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>s</var> の期待値を <var>\\text{mod } 998244353</var> で出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 2\n1 2\n3 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>499122178\n</pre>\n\n<p><var>i</var> 個目の赤い端子と <var>j</var> 個目の青い端子をケーブルで繋ぐことを <var>(i, j)</var> と表記します。</p>\n<ul>\n<li><var>(1,1), (2,2)</var> の場合：<var>\\lbrace 1,3 \\rbrace</var> と <var>\\lbrace 2 \\rbrace</var> という <var>2</var> つの連結成分ができるので、<var>s=2</var> です。</li>\n<li><var>(1,2), (2,1)</var> の場合：全体が <var>1</var> つの連結成分になるので、<var>s=1</var> です。</li>\n</ul>\n<p>よって、<var>s</var> の期待値は <var>\\frac{3}{2} \\equiv 499122178 \\pmod {998244353}</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>17 5\n1 1 1 1 1\n1 1 1 1 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>17\n</pre>\n\n<p>どのように繋いでも <var>s=N</var> になります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>8 10\n2 4 7 1 7 6 1 4 8 1\n5 1 5 2 5 8 4 6 1 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>608849831\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are creating an electrical circuit using <var>N</var> parts numbered <var>1</var> to <var>N</var> and <var>M</var> cables. \nThese parts have a total of <var>M</var> red terminals and <var>M</var> blue terminals, with the <var>i</var>-th red terminal attached to part <var>R_i</var> and the <var>i</var>-th blue terminal attached to part <var>B_i</var>. \nEach cable connects one red terminal and one blue terminal. \nIn particular, it is allowed to connect two terminals attached to the same part.\nYou cannot connect two or more cables to a terminal. \nTherefore, there are <var>M!</var> ways in total to connect the <var>M</var> cables (the cables are not distinguished from each other).</p>\n<p>Let <var>s</var> be the number of connected components when seeing this circuit as a graph with parts as vertices and cables as edges. \nFind the expected value, modulo <var>998244353</var>, of <var>s</var> when randomly choosing the way to connect the <var>M</var> cables out of the <var>M!</var> ways.</p>\n<details>\n<summary>What does it mean to find an expected value modulo <var>998244353</var>?</summary>\nIt can be proved that the sought expected value is always a rational number.  \nAlso, under the constraints of this problem, it can be proved that when this value is expressed as <var>\\frac{P}{Q}</var> using two coprime integers <var>P</var> and <var>Q</var>, there is exactly one integer <var>R</var> that satisfies <var>R \\times Q \\equiv P\\pmod{998244353}</var> and <var>0 \\leq R \\lt 998244353</var>.\nFind this <var>R</var>.\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1\\leq N \\leq 17</var></li>\n<li><var>1 \\leq M \\leq 10^5</var></li>\n<li><var>1 \\leq R_i, B_i \\leq N</var></li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>R_1</var> <var>R_2</var> <var>\\dots</var> <var>R_M</var>\n<var>B_1</var> <var>B_2</var> <var>\\dots</var> <var>B_M</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the expected value of <var>s</var>, modulo <var>998244353</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 2\n1 2\n3 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>499122178\n</pre>\n\n<p>Let <var>(i, j)</var> denote the action of connecting the <var>i</var>-th red terminal and the <var>j</var>-th blue terminal with a cable.</p>\n<ul>\n<li>For <var>(1,1), (2,2)</var>: There will be two connected components, <var>\\lbrace 1,3 \\rbrace</var> and <var>\\lbrace 2 \\rbrace</var>, so <var>s=2</var>.</li>\n<li>For <var>(1,2), (2,1)</var>: The whole graph constitutes one connected component, so <var>s=1</var>.</li>\n</ul>\n<p>Thus, the expected value of <var>s</var> is <var>\\frac{3}{2} \\equiv 499122178 \\pmod {998244353}</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>17 5\n1 1 1 1 1\n1 1 1 1 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>17\n</pre>\n\n<p><var>s=N</var> no matter how you connect the cables.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>8 10\n2 4 7 1 7 6 1 4 8 1\n5 1 5 2 5 8 4 6 1 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>608849831\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc321/tasks/abc321_g"}