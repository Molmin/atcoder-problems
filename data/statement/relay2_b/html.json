{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>100</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題</h3><p>整数 <var>N</var> が与えられます。下図のような、無限に伸びる完全 <var>N</var> 分木を考えます。</p>\n<div style=\"text-align: center;\">\n<img src=\"https://img.atcoder.jp/relay2/c76baa50b0acf28062688597724a54b9.png\">\n<p>図: <var>N = 3</var> の場合の無限に伸びる完全 <var>N</var> 分木</p>\n</div>\n\n<p>図で示されているように、各頂点には重複しない正の整数の番号が付いており、どの正の整数に対してもそれを頂点番号として持つ頂点が存在します。木の根の頂点番号は <var>1</var> です。その他の頂点には、上の段にある頂点ほど小さな番号が付けられています。同じ段にある頂点には、左に位置するほど小さな番号が付けられています。</p>\n<p>この木に関して、以下の形式の <var>Q</var> 個の問いに答えてください。<var>i</var> 番目の問い <var>(1 ≤ i ≤ Q)</var> は次の通りです。</p>\n<ul>\n<li>頂点 <var>v_i</var> と <var>w_i</var> の最近共通祖先（注釈を参照）の頂点番号を求めよ。</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>注釈</h3><ul>\n<li>根付き木において、頂点 <var>v</var> と <var>w</var> の <em>最近共通祖先</em> とは、頂点 <var>v</var> と <var>w</var> のいずれの祖先でもある頂点のうち、最も根から遠いもののことです。ここで、頂点の祖先にはその頂点自身も含まれるものとします。例えば、問題文中で図示された木において、頂点 <var>5</var> と <var>7</var> の最近共通祖先は頂点 <var>2</var>、頂点 <var>8</var> と <var>11</var> の最近共通祖先は頂点 <var>1</var>、頂点 <var>3</var> と <var>9</var> の最近共通祖先は頂点 <var>3</var> です。</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 ≤ N ≤ 10^9</var></li>\n<li><var>1 ≤ Q ≤ 10^5</var></li>\n<li><var>1 ≤ v_i &lt; w_i ≤ 10^9</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>Q</var>\n<var>v_1</var> <var>w_1</var>\n<var>:</var>\n<var>v_Q</var> <var>w_Q</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>Q</var> 行出力せよ。<var>i</var> 行目 <var>(1 ≤ i ≤ Q)</var> に頂点 <var>v_i</var> と <var>w_i</var> の最近共通祖先の頂点番号を出力すること。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 3\n5 7\n8 11\n3 9\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2\n1\n3\n</pre>\n\n<p>このケースでの問いは、注釈セクションで示した例に対応します。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>100000 2\n1 2\n3 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>1\n1\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>100</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given an integer <var>N</var>. Consider an infinite <var>N</var>-ary tree as shown below:</p>\n<div style=\"text-align: center;\">\n<img src=\"https://img.atcoder.jp/relay2/c76baa50b0acf28062688597724a54b9.png\">\n<p>Figure: an infinite <var>N</var>-ary tree for the case <var>N = 3</var></p>\n</div>\n\n<p>As shown in the figure, each vertex is indexed with a unique positive integer, and for every positive integer there is a vertex indexed with it. The root of the tree has the index <var>1</var>. For the remaining vertices, vertices in the upper row have smaller indices than those in the lower row. Among the vertices in the same row, a vertex that is more to the left has a smaller index.</p>\n<p>Regarding this tree, process <var>Q</var> queries. The <var>i</var>-th query is as follows:</p>\n<ul>\n<li>Find the index of the lowest common ancestor (see Notes) of Vertex <var>v_i</var> and <var>w_i</var>.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Notes</h3><ul>\n<li>In a rooted tree, the <em>lowest common ancestor</em> (LCA) of Vertex <var>v</var> and <var>w</var> is the farthest vertex from the root that is an ancestor of both Vertex <var>v</var> and <var>w</var>. Here, a vertex is considered to be an ancestor of itself. For example, in the tree shown in Problem Statement, the LCA of Vertex <var>5</var> and <var>7</var> is Vertex <var>2</var>, the LCA of Vertex <var>8</var> and <var>11</var> is Vertex <var>1</var>, and the LCA of Vertex <var>3</var> and <var>9</var> is Vertex <var>3</var>.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 ≤ N ≤ 10^9</var></li>\n<li><var>1 ≤ Q ≤ 10^5</var></li>\n<li><var>1 ≤ v_i &lt; w_i ≤ 10^9</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>Q</var>\n<var>v_1</var> <var>w_1</var>\n<var>:</var>\n<var>v_Q</var> <var>w_Q</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>Q</var> lines. The <var>i</var>-th line <var>(1 ≤ i ≤ Q)</var> must contain the index of the lowest common ancestor of Vertex <var>v_i</var> and <var>w_i</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 3\n5 7\n8 11\n3 9\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2\n1\n3\n</pre>\n\n<p>The queries in this case correspond to the examples shown in Notes.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>100000 2\n1 2\n3 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>1\n1\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/cf17-relay-open/tasks/relay2_b"}