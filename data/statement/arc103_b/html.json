{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>すぬけ君の工場では，次のような特徴を持つ <strong>ロボットアーム</strong> を導入することになりました：</p>\n<ul>\n<li>ロボットアームは，<var>m</var> 個の <strong>腕</strong> と <var>m+1</var> 個の <strong>関節</strong> からなる．腕には <var>1</var>, <var>2</var>, ..., <var>m</var> で，関節には <var>0</var>, <var>1</var>, ..., <var>m</var> で番号が付けられている．腕 <var>i</var> は関節 <var>i-1</var> と関節 <var>i</var> をつなぐ．腕 <var>i</var> の長さは <var>d_i</var> である．</li>\n<li>各腕には，それぞれ独立に <strong>モード</strong> を指定することができる．モードは <code>L</code>, <code>R</code>, <code>D</code>, <code>U</code> のいずれかであり，腕のモードはその腕の向きを指定する．工場を座標平面とみなすと，関節 <var>i</var> の座標 <var>(x_i, y_i)</var> は次のように定まる：<ul>\n<li><var>(x_0, y_0) = (0, 0)</var>．</li>\n<li>腕 <var>i</var> のモードが <code>L</code> のとき，<var>(x_i, y_i) = (x_{i-1} - d_{i}, y_{i-1})</var>．</li>\n<li>腕 <var>i</var> のモードが <code>R</code> のとき，<var>(x_i, y_i) = (x_{i-1} + d_{i}, y_{i-1})</var>．</li>\n<li>腕 <var>i</var> のモードが <code>D</code> のとき，<var>(x_i, y_i) = (x_{i-1}, y_{i-1} - d_{i})</var>．</li>\n<li>腕 <var>i</var> のモードが <code>U</code> のとき，<var>(x_i, y_i) = (x_{i-1}, y_{i-1} + d_{i})</var>．</li>\n</ul>\n</li>\n</ul>\n<p>すぬけ君は，腕のモードをうまく指定することにより，<var>N</var> 個の点 <var>(X_1, Y_1), (X_2, Y_2), ..., (X_N, Y_N)</var> のいずれにもロボットアームの関節 <var>m</var> をちょうど一致させられるようなロボットアームを導入したいです．\nこのようなことは可能でしょうか？\n可能ならば，条件を満たすロボットアームおよび，各点 <var>(X_j, Y_j)</var> にそのロボットアームの関節 <var>m</var> を到達させるためのモードの指定方法を求めてください．</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li>入力はすべて整数である</li>\n<li><var>1 \\leq N \\leq 1000</var></li>\n<li><var>-10^9 \\leq X_i \\leq 10^9</var></li>\n<li><var>-10^9 \\leq Y_i \\leq 10^9</var></li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>部分点</h3><ul>\n<li><var>300</var> 点分のテストケースでは，<var>-10 \\leq X_i \\leq 10</var> および <var>-10 \\leq Y_i \\leq 10</var> が成り立つ．</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる．</p>\n<pre><var>N</var>\n<var>X_1</var> <var>Y_1</var>\n<var>X_2</var> <var>Y_2</var>\n<var>:</var>\n<var>X_N</var> <var>Y_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>条件を満たすことが可能なら，次の形式で出力せよ．不可能な場合は <code>-1</code> を出力せよ．</p>\n<pre><var>m</var>\n<var>d_1</var> <var>d_2</var> <var>...</var> <var>d_m</var>\n<var>w_1</var>\n<var>w_2</var>\n<var>:</var>\n<var>w_N</var>\n</pre>\n\n<p><var>m</var> および <var>d_i</var> はロボットアームの情報を表す．それぞれの変数の意味は問題文を参照せよ．\nここで，<var>1 \\leq m \\leq 40</var>, <var>1 \\leq d_i \\leq 10^{12}</var> かつ <var>m, d_i</var> はすべて整数でなければならない．</p>\n<p><var>w_j</var> は <var>m</var> 文字からなる文字列であり，点 <var>(X_j, Y_j)</var> にロボットアームの関節 <var>m</var> を到達させる方法を表す．\n<var>w_j</var> の <var>i</var> 文字目は <code>L</code>, <code>R</code>, <code>D</code>, <code>U</code> のいずれかの文字であり，腕 <var>i</var> のモードを表す．</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n-1 0\n0 3\n2 -1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2\n1 2\nRL\nUU\nDR\n</pre>\n\n<p>それぞれの <var>(X_j, Y_j)</var> にロボットアームの関節 <var>m</var> を到達させる方法において，各関節の位置は次のようになります．</p>\n<ul>\n<li><var>(X_1, Y_1) = (-1, 0)</var> に到達させる方法では，まず関節 <var>0</var> の位置は <var>(x_0, y_0) = (0, 0)</var> です．腕 <var>1</var> のモードが <code>R</code> なので，関節 <var>1</var> の位置は <var>(x_1, y_1) = (1, 0)</var> です．腕 <var>2</var> のモードが <code>L</code> なので，関節 <var>m=2</var> の位置は <var>(x_2, y_2) = (-1, 0)</var> です．</li>\n<li><var>(X_2, Y_2) = (0, 3)</var> に到達させる方法では，<var>(x_0, y_0) = (0, 0), (x_1, y_1) = (0, 1), (x_2, y_2) = (0, 3)</var> です．</li>\n<li><var>(X_3, Y_3) = (2, -1)</var> に到達させる方法では，<var>(x_0, y_0) = (0, 0), (x_1, y_1) = (0, -1), (x_2, y_2) = (2, -1)</var> です．</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5\n0 0\n1 0\n2 0\n3 0\n4 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>-1\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>2\n1 1\n1 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>2\n1 1\nRU\nUR\n</pre>\n\n<p><var>(X_j, Y_j)</var> の中に同じ点が含まれることもあります．</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>3\n-7 -3\n7 3\n-3 -7\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>5\n3 1 4 1 5\nLRDUL\nRDULR\nDULRD\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Snuke is introducing a <strong>robot arm</strong> with the following properties to his factory:</p>\n<ul>\n<li>The robot arm consists of <var>m</var> <strong>sections</strong> and <var>m+1</var> <strong>joints</strong>. The sections are numbered <var>1</var>, <var>2</var>, ..., <var>m</var>, and the joints are numbered <var>0</var>, <var>1</var>, ..., <var>m</var>. Section <var>i</var> connects Joint <var>i-1</var> and Joint <var>i</var>. The length of Section <var>i</var> is <var>d_i</var>.</li>\n<li>For each section, its <strong>mode</strong> can be specified individually. There are four modes: <code>L</code>, <code>R</code>, <code>D</code> and <code>U</code>. The mode of a section decides the direction of that section. If we consider the factory as a coordinate plane, the position of Joint <var>i</var> will be determined as follows (we denote its coordinates as <var>(x_i, y_i)</var>):<ul>\n<li><var>(x_0, y_0) = (0, 0)</var>.</li>\n<li>If the mode of Section <var>i</var> is <code>L</code>, <var>(x_{i}, y_{i}) = (x_{i-1} - d_{i}, y_{i-1})</var>.</li>\n<li>If the mode of Section <var>i</var> is <code>R</code>, <var>(x_{i}, y_{i}) = (x_{i-1} + d_{i}, y_{i-1})</var>.</li>\n<li>If the mode of Section <var>i</var> is <code>D</code>, <var>(x_{i}, y_{i}) = (x_{i-1}, y_{i-1} - d_{i})</var>.</li>\n<li>If the mode of Section <var>i</var> is <code>U</code>, <var>(x_{i}, y_{i}) = (x_{i-1}, y_{i-1} + d_{i})</var>.</li>\n</ul>\n</li>\n</ul>\n<p>Snuke would like to introduce a robot arm so that the position of Joint <var>m</var> can be matched with all of the <var>N</var> points <var>(X_1, Y_1), (X_2, Y_2), ..., (X_N, Y_N)</var> by properly specifying the modes of the sections.\nIs this possible?\nIf so, find such a robot arm and how to bring Joint <var>m</var> to each point <var>(X_j, Y_j)</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li>All values in input are integers.</li>\n<li><var>1 \\leq N \\leq 1000</var></li>\n<li><var>-10^9 \\leq X_i \\leq 10^9</var></li>\n<li><var>-10^9 \\leq Y_i \\leq 10^9</var></li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Partial Score</h3><ul>\n<li>In the test cases worth <var>300</var> points, <var>-10 \\leq X_i \\leq 10</var> and <var>-10 \\leq Y_i \\leq 10</var> hold.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>X_1</var> <var>Y_1</var>\n<var>X_2</var> <var>Y_2</var>\n<var>:</var>\n<var>X_N</var> <var>Y_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>If the condition can be satisfied, follow the following format. If the condition cannot be satisfied, print <code>-1</code>.</p>\n<pre><var>m</var>\n<var>d_1</var> <var>d_2</var> <var>...</var> <var>d_m</var>\n<var>w_1</var>\n<var>w_2</var>\n<var>:</var>\n<var>w_N</var>\n</pre>\n\n<p><var>m</var> and <var>d_i</var> are the configurations of the robot arm. Refer to the problem statement for what each of them means.\nHere, <var>1 \\leq m \\leq 40</var> and <var>1 \\leq d_i \\leq 10^{12}</var> must hold. Also, <var>m</var> and <var>d_i</var> must all be integers.</p>\n<p><var>w_j</var> is a string of length <var>m</var> that represents the way to bring Joint <var>m</var> of the robot arm to point <var>(X_j, Y_j)</var>.\nThe <var>i</var>-th character of <var>w_j</var> should be one of the letters <code>L</code>, <code>R</code>, <code>D</code> and <code>U</code>, representing the mode of Section <var>i</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n-1 0\n0 3\n2 -1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2\n1 2\nRL\nUU\nDR\n</pre>\n\n<p>In the given way to bring Joint <var>m</var> of the robot arm to each <var>(X_j, Y_j)</var>, the positions of the joints will be as follows:</p>\n<ul>\n<li>To <var>(X_1, Y_1) = (-1, 0)</var>: First, the position of Joint <var>0</var> is <var>(x_0, y_0) = (0, 0)</var>. As the mode of Section <var>1</var> is <code>R</code>, the position of Joint <var>1</var> is <var>(x_1, y_1) = (1, 0)</var>. Then, as the mode of Section <var>2</var> is <code>L</code>, the position of Joint <var>2</var> is <var>(x_2, y_2) = (-1, 0)</var>.</li>\n<li>To <var>(X_2, Y_2) = (0, 3)</var>: <var>(x_0, y_0) = (0, 0), (x_1, y_1) = (0, 1), (x_2, y_2) = (0, 3)</var>.</li>\n<li>To <var>(X_3, Y_3) = (2, -1)</var>: <var>(x_0, y_0) = (0, 0), (x_1, y_1) = (0, -1), (x_2, y_2) = (2, -1)</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5\n0 0\n1 0\n2 0\n3 0\n4 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>-1\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>2\n1 1\n1 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>2\n1 1\nRU\nUR\n</pre>\n\n<p>There may be duplicated points among <var>(X_j, Y_j)</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>3\n-7 -3\n7 3\n-3 -7\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>5\n3 1 4 1 5\nLRDUL\nRDULR\nDULRD\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc111/tasks/arc103_b"}