{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>425</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>2次元平面上の <var>N</var> 点 <var>(X_1,Y_1),\\ldots,(X_N,Y_N)</var> に家が建っています。</p>\n<p>最初、点 <var>(S_x,S_y)</var> にサンタクロースがいます。サンタクロースは列 <var>(D_1,C_1),\\ldots,(D_M,C_M)</var> に従って以下の行動を行います。</p>\n<ul>\n<li><var>i=1,2,\\ldots,M</var> の順に以下のように移動する。<ul>\n<li>現在サンタクロースがいる点を <var>(x,y)</var> とする。<ul>\n<li><var>D_i</var> が <code>U</code> なら、<var>(x,y)</var> から <var>(x,y+C_i)</var> に直線で移動する。</li>\n<li><var>D_i</var> が <code>D</code> なら、<var>(x,y)</var> から <var>(x,y-C_i)</var> に直線で移動する。</li>\n<li><var>D_i</var> が <code>L</code> なら、<var>(x,y)</var> から <var>(x-C_i,y)</var> に直線で移動する。</li>\n<li><var>D_i</var> が <code>R</code> なら、<var>(x,y)</var> から <var>(x+C_i,y)</var> に直線で移動する。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>行動を終えたあとにサンタクロースがいる点と、行動により通過または到達した家の数を求めてください。ただし、同じ家を複数回通過または到達してもそれらは重複して数えません。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 2\\times 10^5</var></li>\n<li><var>1 \\leq M \\leq 2\\times 10^5</var></li>\n<li><var>-10^9 \\leq X_i,Y_i \\leq 10^9</var></li>\n<li><var>(X_i,Y_i)</var> は相異なる</li>\n<li><var>-10^9 \\leq S_x,S_y \\leq 10^9</var></li>\n<li><var>(S_x,S_y)</var> に家は建っていない</li>\n<li><var>D_i</var> は <code>U</code>, <code>D</code>, <code>L</code>, <code>R</code> のいずれかである</li>\n<li><var>1 \\leq C_i \\leq 10^9</var></li>\n<li>与えられる数値は全て整数である</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var> <var>S_x</var> <var>S_y</var>\n<var>X_1</var> <var>Y_1</var>\n<var>\\vdots</var>\n<var>X_N</var> <var>Y_N</var>\n<var>D_1</var> <var>C_1</var>\n<var>\\vdots</var>\n<var>D_M</var> <var>C_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>行動を終えたあとサンタクロースがいる点を <var>(X,Y)</var>、行動により通過または到達した家の数を <var>C</var> とするとき、<var>X,Y,C</var> をこの順に空白区切りで出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 4 3 2\n2 2\n3 3\n2 1\nL 2\nD 1\nR 1\nU 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2 3 2\n</pre>\n<p>サンタクロースは以下のように行動します。</p>\n<p><img alt=\"図\" src=\"https://img.atcoder.jp/abc385/f3d0f313d3b20c135af60ca6eb04900d.png\"></p>\n<ul>\n<li><var>D_1=</var> <code>L</code> なので <var>(3,2)</var> から <var>(3-2,2)</var> に直線で移動する。このとき <var>(2,2)</var> に建っている家を通過する。</li>\n<li><var>D_2=</var> <code>D</code> なので <var>(1,2)</var> から <var>(1,2-1)</var> に直線で移動する。</li>\n<li><var>D_3=</var> <code>R</code> なので <var>(1,1)</var> から <var>(1+1,1)</var> に直線で移動する。このとき <var>(2,1)</var> に建っている家を通過する。</li>\n<li><var>D_4=</var> <code>U</code> なので <var>(2,1)</var> から <var>(2,1+2)</var> に直線で移動する。このとき <var>(2,2)</var> に建っている家を通過するが、この家はすでに通過したことがある家である。</li>\n</ul>\n<p>行動により通過または到達した家の数は <var>2</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>1 3 0 0\n1 1\nR 1000000000\nR 1000000000\nR 1000000000\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>3000000000 0 0\n</pre>\n<p>オーバーフローに注意してください。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>425</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>N</var> houses at points <var>(X_1,Y_1),\\ldots,(X_N,Y_N)</var> on a two-dimensional plane.</p>\n<p>Initially, Santa Claus is at point <var>(S_x,S_y)</var>. He will act according to the sequence <var>(D_1,C_1),\\ldots,(D_M,C_M)</var> as follows:</p>\n<ul>\n<li>For <var>i=1,2,\\ldots,M</var> in order, he moves as follows:<ul>\n<li>Let <var>(x,y)</var> be the point where he currently is.<ul>\n<li>If <var>D_i</var> is <code>U</code>, move in a straight line from <var>(x,y)</var> to <var>(x,y+C_i)</var>.</li>\n<li>If <var>D_i</var> is <code>D</code>, move in a straight line from <var>(x,y)</var> to <var>(x,y-C_i)</var>.</li>\n<li>If <var>D_i</var> is <code>L</code>, move in a straight line from <var>(x,y)</var> to <var>(x-C_i,y)</var>.</li>\n<li>If <var>D_i</var> is <code>R</code>, move in a straight line from <var>(x,y)</var> to <var>(x+C_i,y)</var>.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Find the point where he is after completing all actions, and the number of distinct houses he passed through or arrived at during his actions. If the same house is passed multiple times, it is only counted once.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 2\\times 10^5</var></li>\n<li><var>1 \\leq M \\leq 2\\times 10^5</var></li>\n<li><var>-10^9 \\leq X_i,Y_i \\leq 10^9</var></li>\n<li>The pairs <var>(X_i,Y_i)</var> are distinct.</li>\n<li><var>-10^9 \\leq S_x,S_y \\leq 10^9</var></li>\n<li>There is no house at <var>(S_x,S_y)</var>.</li>\n<li>Each <var>D_i</var> is one of <code>U</code>, <code>D</code>, <code>L</code>, <code>R</code>.</li>\n<li><var>1 \\leq C_i \\leq 10^9</var></li>\n<li>All input numbers are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>S_x</var> <var>S_y</var>\n<var>X_1</var> <var>Y_1</var>\n<var>\\vdots</var>\n<var>X_N</var> <var>Y_N</var>\n<var>D_1</var> <var>C_1</var>\n<var>\\vdots</var>\n<var>D_M</var> <var>C_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Let <var>(X,Y)</var> be the point where he is after completing all actions, and <var>C</var> be the number of distinct houses passed through or arrived at. Print <var>X,Y,C</var> in this order separated by spaces.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 4 3 2\n2 2\n3 3\n2 1\nL 2\nD 1\nR 1\nU 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2 3 2\n</pre>\n<p>Santa Claus behaves as follows:</p>\n<p><img alt=\"Figure\" src=\"https://img.atcoder.jp/abc385/f3d0f313d3b20c135af60ca6eb04900d.png\"></p>\n<ul>\n<li><var>D_1=</var> <code>L</code>, so he moves from <var>(3,2)</var> to <var>(3-2,2)</var> in a straight line. During this, he passes through the house at <var>(2,2)</var>.</li>\n<li><var>D_2=</var> <code>D</code>, so he moves from <var>(1,2)</var> to <var>(1,2-1)</var> in a straight line.</li>\n<li><var>D_3=</var> <code>R</code>, so he moves from <var>(1,1)</var> to <var>(1+1,1)</var> in a straight line. During this, he passes through the house at <var>(2,1)</var>.</li>\n<li><var>D_4=</var> <code>U</code>, so he moves from <var>(2,1)</var> to <var>(2,1+2)</var> in a straight line. During this, he passes through the house at <var>(2,2)</var>, but it has already been passed.</li>\n</ul>\n<p>The number of houses he passed or arrived during his actions is <var>2</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>1 3 0 0\n1 1\nR 1000000000\nR 1000000000\nR 1000000000\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>3000000000 0 0\n</pre>\n<p>Be careful with overflow.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc385/tasks/abc385_d"}