{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>700</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>長さ <var>N</var> の整数列 <var>A=(A_1,A_2,\\cdots,A_N)</var> が与えられます．\n以下の <var>Q</var> 個のクエリに答えてください．</p>\n<ul>\n<li><var>i</var> 番目のクエリ: 整数 <var>L_i,R_i</var> が与えられる．\n<var>B=(A_{L_i},A_{L_i+1},\\cdots,A_{R_i})</var> に対して次の問題を解け．<ul>\n<li><var>B</var> を <var>3</var> つの非空な連続部分列に分割する．各連続部分列についてその要素の最大値を求める．これらの値の総和としてあり得る最小値を求めよ．\nなお，問題の制約から <var>B</var> の長さは <var>3</var> 以上になるため，<var>3</var> つの非空な連続部分列に分割する方法は必ず <var>1</var> つ以上存在する．</li>\n</ul>\n</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>3 \\leq N \\leq 250000</var></li>\n<li><var>1 \\leq Q \\leq 250000</var></li>\n<li><var>1 \\leq A_i \\leq 10^8</var></li>\n<li><var>1 \\leq L_i \\leq R_i \\leq N</var></li>\n<li><var>R_i-L_i \\geq 2</var></li>\n<li>入力される値はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる．</p>\n<pre><var>N</var> <var>Q</var>\n<var>A_1</var> <var>A_2</var> <var>\\cdots</var> <var>A_N</var>\n<var>L_1</var> <var>R_1</var>\n<var>L_2</var> <var>R_2</var>\n<var>\\vdots</var>\n<var>L_Q</var> <var>R_Q</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>Q</var> 行出力せよ．<var>i</var> 行目には <var>i</var> 番目のクエリに対する答えを出力せよ．</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>7 5\n4 3 1 1 4 5 2\n1 7\n2 4\n3 5\n1 5\n4 7\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>10\n5\n6\n9\n8\n</pre>\n<p><var>1</var> つめのクエリについて説明します．\n<var>B=(4,3,1,1,4,5,2)</var> です．\nこれを <var>(4,3),(1,1),(4,5,2)</var> と分解すると，各連続部分列の最大値は <var>4,1,5</var> となり，その総和は <var>10</var> になります．\nこの総和が <var>10</var> より小さくなる方法は存在しないので，このクエリの答えは <var>10</var> になります．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>10 15\n8 3 8 10 1 5 3 1 6 4\n4 6\n2 5\n6 9\n8 10\n2 9\n4 10\n1 5\n1 8\n1 3\n4 8\n1 10\n2 10\n6 10\n2 6\n2 6\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>16\n14\n12\n11\n17\n17\n19\n14\n19\n14\n17\n17\n12\n16\n16\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>700</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given an integer sequence <var>A=(A_1,A_2,\\cdots,A_N)</var> of length <var>N</var>.\nAnswer the following <var>Q</var> queries.</p>\n<ul>\n<li>The <var>i</var>-th query: You are given integers <var>L_i</var> and <var>R_i</var>.\nSolve the following problem for <var>B=(A_{L_i},A_{L_i+1},\\cdots,A_{R_i})</var>.<ul>\n<li>Divide <var>B</var> into three non-empty contiguous subsequences. For each contiguous subsequence, let us find the maximum value of its elements. Find the minimum possible sum of these maximum values.\nHere, the constraints of the problem force the length of <var>B</var> to be at least <var>3</var>, so there is always at least one way to divide it into three non-empty contiguous subsequences.</li>\n</ul>\n</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>3 \\leq N \\leq 250000</var></li>\n<li><var>1 \\leq Q \\leq 250000</var></li>\n<li><var>1 \\leq A_i \\leq 10^8</var></li>\n<li><var>1 \\leq L_i \\leq R_i \\leq N</var></li>\n<li><var>R_i - L_i \\geq 2</var></li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>Q</var>\n<var>A_1</var> <var>A_2</var> <var>\\cdots</var> <var>A_N</var>\n<var>L_1</var> <var>R_1</var>\n<var>L_2</var> <var>R_2</var>\n<var>\\vdots</var>\n<var>L_Q</var> <var>R_Q</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>Q</var> lines. The <var>i</var>-th line should contain the answer to the <var>i</var>-th query.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>7 5\n4 3 1 1 4 5 2\n1 7\n2 4\n3 5\n1 5\n4 7\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>10\n5\n6\n9\n8\n</pre>\n<p>Let us explain the first query.\nWe have <var>B=(4,3,1,1,4,5,2)</var>.\nIf you divide it into <var>(4,3),(1,1),(4,5,2)</var>, the maximum values of the contiguous subsequences are <var>4,1,5</var>, respectively, and their sum is <var>10</var>.\nThere is no way to make this sum smaller, so the answer to this query is <var>10</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>10 15\n8 3 8 10 1 5 3 1 6 4\n4 6\n2 5\n6 9\n8 10\n2 9\n4 10\n1 5\n1 8\n1 3\n4 8\n1 10\n2 10\n6 10\n2 6\n2 6\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>16\n14\n12\n11\n17\n17\n19\n14\n19\n14\n17\n17\n12\n16\n16\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc180/tasks/arc180_d"}