{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>800</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>正整数 <var>h,w</var> に対し, 縦の辺の長さが <var>h</var>, 横の辺の長さが <var>w</var> であるような長方形を <var>(h,w)</var> と表すことにします. なお, 本問では長方形を回転する操作は考えず, <var>h\\neq w</var> のとき長方形 <var>(h,w)</var> と長方形 <var>(w,h)</var> は異なるものとして扱います.</p>\n<p>長方形の列 <var>((h_1,w_1),(h_2,w_2),\\dots ,(h_n,w_n))</var> が <strong>長方形生成列</strong> であるとは, 次の手順が成功するような方法が存在することを言います.</p>\n<ul>\n<li>長方形 <var>X</var> を <var>(h_1,w_1)</var> とする. 以下では, 各時点での長方形 <var>X</var> の縦の辺の長さと横の辺の長さをそれぞれ <var>H,W</var> と表す.</li>\n<li><var>i=2,3,\\dots ,n</var> の順に次のいずれか一方の操作を行う. いずれも行うことができないとき手順は失敗とし, 手順を終了する.<ul>\n<li><var>X</var> の縦の辺の長さが <var>h_i</var> に等しいとき, <var>X</var> に長方形 <var>(h_i,w_i)</var> を横向きに結合する. 正確には, その時点で <var>H=h_i</var> のとき <var>X</var> を長方形 <var>(H,W+w_i)</var> に置き換える.</li>\n<li><var>X</var> の横の辺の長さが <var>w_i</var> に等しいとき, <var>X</var> に長方形 <var>(h_i,w_i)</var> を縦向きに結合する. 正確には, その時点で <var>W=w_i</var> のとき <var>X</var> を長方形 <var>(H+h_i,W)</var> に置き換える.</li>\n</ul>\n</li>\n<li>上記の一連の操作が失敗しなかった場合は手順は成功とし, 手順を終了する.</li>\n</ul>\n<hr>\n<p><var>N</var> 個の長方形が与えられます. <var>i</var> 番目の長方形は, 縦の辺の長さが <var>H_i</var>, 横の辺の長さが <var>W_i</var> の長方形です.</p>\n<p><var>1\\le l\\le r\\le N</var> を満たす正整数の組 <var>(l,r)</var> であって次の条件を満たすものの個数を求めてください.</p>\n<ul>\n<li>長方形の列 <var>((H_l,W_l),(H_{l+1},W_{l+1}),\\dots ,(H_r,W_r))</var> が長方形生成列である.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1\\leq N\\leq 3\\times 10^5</var></li>\n<li><var>1 \\leq H_i,W_i \\leq 10^6</var></li>\n<li>入力される値はすべて整数.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる．</p>\n<pre><var>N</var>\n<var>H_1</var> <var>W_1</var>\n<var>H_2</var> <var>W_2</var>\n<var>\\vdots</var>\n<var>H_N</var> <var>W_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4\n1 2\n1 3\n2 3\n3 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>7\n</pre>\n<p>条件を満たす <var>(l,r)</var> は <var>(1,1),(1,2),(2,2),(2,3),(2,4),(3,3),(4,4)</var> の <var>7</var> つです.</p>\n<p>例えば, <var>(l,r)=(2,4)</var> については, 結合を縦向き <var>\\to</var> 横向きの順に行うと手順が成功します.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5\n2 1\n2 1\n1 2\n3 2\n1 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>10\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>1\n1000000 1000000\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>10\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>55\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>800</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>For positive integers <var>h</var> and <var>w</var>, let <var>(h,w)</var> denote a rectangle with height <var>h</var> and width <var>w</var>. In this problem, we do not consider rotating the rectangles, and the rectangles <var>(h,w)</var> and <var>(w,h)</var> are distinguished when <var>h \\neq w</var>.</p>\n<p>A sequence of rectangles <var>((h_1,w_1),(h_2,w_2),\\dots ,(h_n,w_n))</var> is called a <strong>rectangle generation sequence</strong> if there exists a method that successfully follows the steps below:</p>\n<ul>\n<li>Let the rectangle <var>X</var> be <var>(h_1,w_1)</var>. Hereafter, let <var>H</var> and <var>W</var> respectively denote the height and width of the rectangle <var>X</var> at each step.</li>\n<li>For <var>i=2,3,\\dots ,n</var>, perform one of the following operations. If neither can be performed, the procedure unsuccessfully terminates.<ul>\n<li>If the height of <var>X</var> is equal to <var>h_i</var>, attach the rectangle <var>(h_i,w_i)</var> horizontally to <var>X</var>. Formally, if <var>H=h_i</var> at that time, replace <var>X</var> with the rectangle <var>(H,W+w_i)</var>.</li>\n<li>If the width of <var>X</var> is equal to <var>w_i</var>, attach the rectangle <var>(h_i,w_i)</var> vertically to <var>X</var>. Formally, if <var>W=w_i</var> at that time, replace <var>X</var> with the rectangle <var>(H+h_i,W)</var>.</li>\n</ul>\n</li>\n<li>If the above series of operations does not fail, the procedure successfully terminates.</li>\n</ul>\n<hr>\n<p>You are given <var>N</var> rectangles. The <var>i</var>-th rectangle has a height of <var>H_i</var> and a width of <var>W_i</var>.</p>\n<p>Find the number of pairs of positive integers <var>(l,r)</var> that satisfy <var>1 \\le l \\le r \\le N</var> and the following condition:</p>\n<ul>\n<li>The sequence of rectangles <var>((H_l,W_l),(H_{l+1},W_{l+1}),\\dots ,(H_r,W_r))</var> is a rectangle generation sequence.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 3 \\times 10^5</var></li>\n<li><var>1 \\leq H_i, W_i \\leq 10^6</var></li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>H_1</var> <var>W_1</var>\n<var>H_2</var> <var>W_2</var>\n<var>\\vdots</var>\n<var>H_N</var> <var>W_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4\n1 2\n1 3\n2 3\n3 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>7\n</pre>\n<p>The pairs <var>(l,r)</var> that satisfy the condition are <var>(1,1),(1,2),(2,2),(2,3),(2,4),(3,3),(4,4)</var>; there are seven.</p>\n<p>For example, for <var>(l,r)=(2,4)</var>, the procedure succeeds if the first attachment is done vertically and the second is done horizontally.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5\n2 1\n2 1\n1 2\n3 2\n1 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>10\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>1\n1000000 1000000\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>10\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>55\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc179/tasks/arc179_e"}