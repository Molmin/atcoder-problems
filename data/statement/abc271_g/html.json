{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>高橋君は自身が運営しているWebサイトにアクセスカウンターを設置することにしました。<br>\n彼のWebサイトに対して発生するアクセスの様子は以下のように記述されます。</p>\n<ul>\n<li><var>i=0,1,2,\\ldots,23</var> に対し、毎日 <var>i</var> 時ちょうどにアクセスが発生する可能性がある。<ul>\n<li><var>c_i=</var><code>T</code> の場合、高橋君が <var>X</var> パーセントの確率でアクセスする。</li>\n<li><var>c_i=</var><code>A</code> の場合、青木君が <var>Y</var> パーセントの確率でアクセスする。</li>\n<li>高橋君や青木君がアクセスするかどうかは毎回独立に決まる。</li>\n</ul>\n</li>\n<li>これ以外のアクセスは発生しない。</li>\n</ul>\n<p>また、高橋君はアクセスカウンターを設置してから <var>N</var> 回目のアクセスが自身によるものではない方が好ましいと考えています。  </p>\n<p>高橋君がアクセスカウンターを設置したのがある日の<strong> <var>0</var> 時直前</strong>の時、設置してから <var>N</var> 回目のアクセスが青木君によるものになる確率を <var>\\mod 998244353</var> で求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>注記</h3><p>求める確率は必ず有限値かつ有理数となることが証明できます。また、この問題の制約下では、その値を互いに素な <var>2</var> つの整数 <var>P</var>, <var>Q</var> を用いて <var>\\frac{P}{Q}</var> と表したとき、<var>R \\times Q \\equiv P\\pmod{998244353}</var> かつ <var>0 \\leq R \\lt 998244353</var> を満たす整数 <var>R</var> がただ一つ存在することが証明できます。この <var>R</var> を求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 10^{18}</var></li>\n<li><var>1 \\leq X,Y \\leq 99</var></li>\n<li><var>c_i</var> は <code>T</code> または <code>A</code></li>\n<li><var>N,X,Y</var> は整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>X</var> <var>Y</var>\n<var>c_0 c_1 \\ldots c_{23}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>1 50 50\nATATATATATATATATATATATAT\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>665496236\n</pre>\n<p>高橋君がアクセスカウンターを設置してから <var>1</var> 回目のアクセスが青木君によるものになる確率は <var>\\frac{2}{3}</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>271 95 1\nTTTTTTTTTTTTTTTTTTTTTTTT\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n<p>青木君によるアクセスが存在しません。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>10000000000000000 62 20\nATAATTATATTTAAAATATTATAT\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>744124544\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Takahashi has decided to put a web counter on his webpage.<br>\nThe accesses to his webpage are described as follows:</p>\n<ul>\n<li>For <var>i=0,1,2,\\ldots,23</var>, there is a possible access at <var>i</var> o'clock every day:<ul>\n<li>If <var>c_i=</var><code>T</code>, Takahashi accesses the webpage with a probability of <var>X</var> percent.</li>\n<li>If <var>c_i=</var><code>A</code>, Aoki accesses the webpage with a probability of <var>Y</var> percent.</li>\n<li>Whether or not Takahashi or Aoki accesses the webpage is determined independently every time.</li>\n</ul>\n</li>\n<li>There is no other access.</li>\n</ul>\n<p>Also, Takahashi believes it is preferable that the <var>N</var>-th access since the counter is put is not made by Takahashi himself.  </p>\n<p>If Takahashi puts the counter <strong>right before <var>0</var> o'clock</strong> of one day, find the probability, modulo <var>998244353</var>, that the <var>N</var>-th access is made by Aoki.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Notes</h3><p>We can prove that the sought probability is always a finite rational number.  Moreover, under the constraints of this problem, when the value is represented as <var>\\frac{P}{Q}</var> with two coprime integers <var>P</var> and <var>Q</var>, we can prove that there is a unique integer <var>R</var> such that <var>R \\times Q \\equiv P\\pmod{998244353}</var> and <var>0 \\leq R \\lt 998244353</var>.  Find this <var>R</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 10^{18}</var></li>\n<li><var>1 \\leq X,Y \\leq 99</var></li>\n<li><var>c_i</var> is <code>T</code> or <code>A</code>.</li>\n<li><var>N</var>, <var>X</var>, and <var>Y</var> are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>X</var> <var>Y</var>\n<var>c_0 c_1 \\ldots c_{23}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>1 50 50\nATATATATATATATATATATATAT\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>665496236\n</pre>\n<p>The <var>1</var>-st access since Takahashi puts the web counter is made by Aoki with a probability of <var>\\frac{2}{3}</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>271 95 1\nTTTTTTTTTTTTTTTTTTTTTTTT\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n<p>There is no access by Aoki.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>10000000000000000 62 20\nATAATTATATTTAAAATATTATAT\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>744124544\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc271/tasks/abc271_g"}