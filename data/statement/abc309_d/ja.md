配点 : $400$ 点

## 問題文

$N_1+N_2$ 頂点 $M$ 辺の無向グラフがあります。$i=1,2,\ldots,M$ に対し、$i$ 番目の辺は頂点 $a_i$ と頂点 $b_i$ を結びます。<br>
また、以下を満たすことが保障されます。

- $1 \leq u,v \leq N_1$ を満たす整数 $u,v$ に対し、頂点 $u$ と頂点 $v$ は連結
- $N_1+1 \leq u,v \leq N_1+N_2$ を満たす整数 $u,v$ に対し、頂点 $u$ と頂点 $v$ は連結
- 頂点 $1$ と頂点 $N_1+N_2$ は非連結

次の操作をちょうど $1$ 回行います。

- $1 \leq u \leq N_1$ を満たす整数 $u$ と $N_1+1 \leq v \leq N_1+N_2$ を満たす整数 $v$ を選び、頂点 $u$ と頂点 $v$ を結ぶ辺を追加する

操作後のグラフにおいて、頂点 $1$ と頂点 $N_1+N_2$ は必ず連結であることが示せます。そこで、頂点 $1$ と頂点 $N_1+N_2$ を結ぶ経路の長さ(辺の本数)の最小値を $d$ とします。  

操作で追加する辺を適切に選んだ時にありえる $d$ の最大値を求めてください。

連結とは？
無向グラフの頂点 $u,v$ が連結であるとは、頂点 $u$ と頂点 $v$ を結ぶ経路が存在することをいいます。

## 制約

- $1 \leq N_1,N_2 \leq 1.5 \times 10^5$
- $0 \leq M \leq 3 \times 10^5$
- $1 \leq a_i \leq b_i \leq N_1+N_2$
- $i \neq j$ ならば $(a_i,b_i) \neq (a_j,b_j)$
- $1 \leq u,v \leq N_1$ を満たす整数 $u,v$ に対し、頂点 $u$ と頂点 $v$ は連結
- $N_1+1 \leq u,v \leq N_1+N_2$ を満たす整数 $u,v$ に対し、頂点 $u$ と頂点 $v$ は連結
- 頂点 $1$ と頂点 $N_1+N_2$ は非連結
- 入力はすべて整数

## 入力

入力は以下の形式で標準入力から与えられる。

> $N_1$ $N_2$ $M$
> 
> $a_1$ $b_1$
> 
> $\vdots$
> 
> $a_M$ $b_M$

## 出力

答えを出力せよ。

```input1
3 4 6
1 2
2 3
4 5
4 6
1 3
6 7
```

```output1
5
```

$u=2,v=5$ として操作することで $d=5$ と出来ます。これが最大値です。

![](https://img.atcoder.jp/abc309/a64d8034b08cfa7d1f655767cc164653.png)

```input2
7 5 20
10 11
4 5
10 12
1 2
1 5
5 6
2 4
3 5
9 10
2 5
1 4
11 12
9 12
8 9
5 7
3 7
3 6
3 4
8 12
9 11
```

```output2
4
```