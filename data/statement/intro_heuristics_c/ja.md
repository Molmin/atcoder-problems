(まずは問題Aを先に読んでください。この問題を解くことで得られる得点は1点です。順位にはほぼ影響しません。)

## 入門者向けガイド

出来るだけ良い解を求めるための非常に強力な手法の一つが「局所探索法」です。
この手法では、闇雲に一から解を探すのではなく、既に見つけた解を少し変化させることで、より良い解に出来ないかを試します。
解が良くなっていれば更新し、悪くなってしまったら元に戻します。
この操作を繰り返し反復することで、時間をかけて徐々に解の質を高めていきます。
疑似コードで表すと以下のようになります。

```plain
solution = 初期解(ランダム生成や、貪欲法など他の手法で求めたものを利用)
while 時間のある限り:
    solution を(ランダムに)少し変形
    if 変形前より解が悪化:
        solution を変形前の状態に戻す
```

例えばこの問題の場合、変形操作として「日付 $d$ とコンテストタイプ $q$ をランダムに選び、$d$ 日目に開催するコンテストをタイプ $q$ に変更する」というものを考えることが出来ます。
疑似コードで表すと以下のようになります。

```plain
t[1..D] = 初期解(ランダム生成や、貪欲法で求めたものを利用)
while 時間のある限り:
    d と q をランダムに選ぶ。
    old = t[d] # 後で戻せるように元の値を記憶しておく
    t[d] = q
    if 変形前より解が悪化:
        t[d] = old
```

局所探索法を用いる上で最も重要なことは、どのように変形を行うかの設計です。

1. 変化させる量が小さすぎるとすぐに行き止まり(局所最適解)に陥ってしまい、逆に、変化させる量が大きすぎると闇雲に探す状態に近くなって、改善できる確率が低くなってしまう。
2. 反復回数を増やすために、変形後のスコアが高速に計算出来ることが望ましい。

この問題Cでは特に2番目の点に挑戦します。
変形後のスコアはもちろん一からスコア計算を行うことで計算が可能ですが、変化のあった部分だけに着目して変形前からの差分を計算することで、より高速に行うことができる可能性があります。
逆に、そのような高速化が出来ないということは部分的な変更がスコア計算の大部分に影響を与えているということであり、変形操作の見直しが必要であったり、そもそも局所探索には向いていない問題である可能性が高まります。
さて、高速な差分計算に挑戦してみましょう。
ABCやARCなどで培ったアルゴリズムやデータ構造の力を発揮するチャンスです。

今回のような最適解ではなく出来るだけ良い解を求めるタイプのコンテストでは、バグのあるプログラムを提出しても不正解とはならないため、バグに気づくのが遅れる可能性があります。
バグの早期発見のために、複雑な処理を実装した箇所に対しては単体テストをしておくのも一つの手です。
例えばスコアの差分計算を行う場合は、この問題Cのような形で、一からスコアを計算した場合と一致することをテストしておくと良いでしょう。

## 問題文

$D$ 日分のコンテストの日程と、$M$ 回の日程の変更クエリが与えられます。
$i$ 番目のクエリでは整数 $d_i$ と $q_i$ が与えられるので、$d_i$ 日目に行うコンテストのタイプを $q_i$ に変更し、変更後の日程における最終的な満足度を出力してください。
注意: 変更はクエリ後も継続します。つまり $i$ 番目のクエリは $(i-1)$ 番目のクエリでの変更後の日程に対して適用します。

## 入力

入力は問題Aの入力の末尾に問題Aの出力とクエリの情報が続く形で与えられる。

> $D$
> 
> $c_1$ $c_2$ $\cdots$ $c_{26}$
> 
> $s_{1,1}$ $s_{1,2}$ $\cdots$ $s_{1,26}$
> 
> $\vdots$
> 
> $s_{D,1}$ $s_{D,2}$ $\cdots$ $s_{D,26}$
> 
> $t_1$
> 
> $t_2$
> 
> $\vdots$
> 
> $t_D$
> 
> $M$
> 
> $d_1$ $q_1$
> 
> $d_2$ $q_2$
> 
> $\vdots$
> 
> $d_M$ $q_M$

- 問題Aの入力に該当する部分の制約及び生成方法は問題Aのものと同じである。
- 問題Aの出力に該当する部分は、各 $d$ について $1\leq t_d \leq 26$ を満たし、範囲内から一様ランダムに生成される。
- クエリ数 $M$ は $1\leq M\leq 10^5$ を満たす整数値。
- 各 $d_i$ は $1\leq d_i\leq D$ を満たす整数値で、範囲内から一様ランダムに生成される。
- 各 $q_i$ は $1\leq q_i\leq 26$ を満たす整数値で、クエリ時点での日程における $d_i$ 日目のコンテストのタイプと異なる 25 個の値の中から一様ランダムに生成される。

## 出力

$i$ 番目のクエリを処理した後の日程における最終的な満足度を $v_i$ としたとき、以下のフォーマットで出力せよ。

> $v_1$
> 
> $v_2$
> 
> $\vdots$
> 
> $v_M$

```input1
5
86 90 69 51 2 96 71 47 88 34 45 46 89 34 31 38 97 84 41 80 14 4 50 83 7 82
19771 12979 18912 10432 10544 12928 13403 3047 10527 9740 8100 92 2856 14730 1396 15905 6534 4650 11469 3628 8433 2994 10899 16396 18355 11424
6674 17707 13855 16407 12232 2886 11908 1705 5000 1537 10440 10711 4917 10770 17272 15364 19277 18094 3929 3705 7169 6159 18683 15410 9092 4570
6878 4239 19925 1799 375 9563 3445 5658 19857 11401 6997 6498 19933 3848 2426 2146 19745 16880 17773 18359 3921 14172 16730 11157 5439 256
8633 15862 15303 10749 18499 7792 10317 5901 9395 11433 3514 3959 5202 19850 19469 9790 5653 784 18500 10552 17975 16615 7852 197 8471 7452
19855 17918 7990 10572 4333 438 9140 9104 12622 4985 12319 4028 19922 12132 16259 17476 2976 547 19195 19830 16285 4806 4471 9457 2864 2192
1
17
13
14
13
5
1 7
4 11
3 4
5 24
4 19
```

```output1
72882
56634
38425
27930
42884
```

注意: この入出力例は問題仕様の確認用の小さいもので、制約 $D=365$ を満たしておらず、実際にテストケースとして与えられることはない。

## 次のステップ

問題Aに戻って局所探索法による解答を実装をしてみましょう。
この問題の場合、「日付 $d$ とコンテストタイプ $q$ をランダムに選び、$d$ 日目に開催するコンテストをタイプ $q$ に変更する」という変形操作は実はあまり良くありません。
なぜ良くないかを考え、別の変形操作に改良してみましょう。
局所探索法の改良版として、悪化する変形を確率的に受け入れることで優れた解に到達しやすくした「焼きなまし法」がよく用いられます。
他の変形操作の例と焼きなまし法やその他の局所探索法についてはコンテスト終了後の解説を参照してください。