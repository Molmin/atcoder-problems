{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>頂点 <var>1</var> を根とした <var>N</var> 頂点の根付き木があります。頂点には <var>1,2,\\ldots,N</var> の番号がついています。</p>\n<p>根から始めて深さ優先探索を行い、行きがけ順で頂点番号を記録したところ、順に <var>P_1,P_2,\\ldots,P_N</var> となりました。 <br>\nただし、深さ優先探索では、現在の頂点に複数の子がある場合、まだ探索していない頂点のうち最も番号が小さい頂点へ移動することとします。</p>\n<details><summary>行きがけ順とは</summary><div>\n\n根から始めて次の手順を繰り返して根付き木上の頂点を列挙します。\n\n<li> 現在いる頂点 <var>u</var> をまだ記録していなければ記録する。 </li>\n<li> その後、<var>u</var> の子のうち、まだ探索していないものがあればその頂点に移動する。 </li>\n<li> そうでない時、<var>u</var> が根であれば探索を終了する。そうでなければ、<var>u</var> の親に移動する。 </li>\n\nこの時、列挙された頂点を順に並べたものが行きがけ順です。\n\n</div></details>\n\n<p>条件をみたす根付き木として考えられるものの数を <var>998244353</var> で割った余りを求めてください。<br>\nただし、ある <var>2</var> つの「頂点 <var>1</var> を根とした <var>N</var> 頂点の根付き木」が異なるとは、ある根以外の頂点が存在して、その親が異なる事を言います。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq N \\leq 500</var></li>\n<li><var>1 \\leq P_i\\leq N</var></li>\n<li><var>P_1=1</var></li>\n<li><var>P_i</var> はすべて異なる</li>\n<li>入力は全て整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>P_1</var> <var>P_2</var> <var>\\ldots</var> <var>P_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>条件をみたす根付き木として考えられるものの数を <var>998244353</var> で割った余りを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4\n1 2 4 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>3\n</pre>\n<p>条件をみたす根付き木としては次の <var>3</var> 通りが考えられます。よって、 <var>3</var> を出力します。</p>\n<p><img src=\"https://img.atcoder.jp/abc252/554e2b202029960276be7564aaa0576b.png\" width=\"400\" height=\"200\"></p>\n<p>また、次のような木は考えられません。頂点 <var>2</var> の子の頂点のうち、番号の小さい頂点 <var>3</var> が頂点 <var>4</var> より先に探索され、\nこのときの行きがけ順は <var>1,2,3,4</var> となるからです。</p>\n<p><img src=\"https://img.atcoder.jp/abc252/a6f35bb1addccc64564d36b812669d55.png\" width=\"140\" height=\"200\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>8\n1 2 3 5 6 7 8 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>202\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There is a rooted tree with <var>N</var> vertices called Vertex <var>1</var>, <var>2</var>, <var>\\ldots</var>, <var>N</var>, rooted at Vertex <var>1</var>.</p>\n<p>We performed a depth-first search starting at the root and obtained a preorder traversal of the tree: <var>P_1, P_2, \\ldots, P_N</var>.<br>\nDuring the search, when the current vertex had multiple children, we chose the unvisited vertex with the smallest index.</p>\n<details><summary>What is a preorder traversal?</summary><div>\n\nWe start at the root and repeat the following procedure to list the vertices of the tree.\n\n<li> If the current vertex <var>u</var> is not recorded yet, record it. </li>\n<li> Then, if <var>u</var> has an unvisited vertex, go to that vertex.</li>\n<li> Otherwise, terminate if <var>u</var> is the root, and go to the parent of <var>u</var> if it is not. </li>\n\nThe list of vertices in the order they are recorded here is the preorder traversal of the tree.\n\n</div></details>\n\n<p>Find the number of rooted trees consistent with the preorder traversal, modulo <var>998244353</var>.<br>\nTwo rooted trees (with <var>N</var> vertices and rooted at Vertex <var>1</var>) are considered different when there is a non-root vertex whose parent is different in the two trees.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 500</var></li>\n<li><var>1 \\leq P_i\\leq N</var></li>\n<li><var>P_1=1</var></li>\n<li>All <var>P_i</var> are distinct.</li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>P_1</var> <var>P_2</var> <var>\\ldots</var> <var>P_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the number of rooted trees consistent with the preorder traversal, modulo <var>998244353</var>.  </p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4\n1 2 4 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>3\n</pre>\n<p>The rooted trees consistent with the preorder traversal are the three shown below, so the answer is <var>3</var>.</p>\n<p><img src=\"https://img.atcoder.jp/abc252/554e2b202029960276be7564aaa0576b.png\" width=\"400\" height=\"200\"></p>\n<p>Note that the tree below does not count. This is because, among the children of Vertex <var>2</var>, we visit Vertex <var>3</var> before visiting Vertex <var>4</var>, resulting in the preorder traversal <var>1,2,3,4</var>.</p>\n<p><img src=\"https://img.atcoder.jp/abc252/a6f35bb1addccc64564d36b812669d55.png\" width=\"140\" height=\"200\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>8\n1 2 3 5 6 7 8 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>202\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc252/tasks/abc252_g"}