{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 人の人と <var>K</var> 個の国があり、それぞれ\n人 <var>1</var>, 人 <var>2</var>, <var>\\ldots</var>, 人 <var>N</var> および国 <var>1</var>, 国 <var>2</var>, <var>\\ldots</var>, 国 <var>K</var> と番号が付いています。 \nそれぞれの人はちょうど <var>1</var> つの国に属しており、人 <var>i</var> は国 <var>A_i</var> に属しています。\nまた、<var>L</var> 人の人気者がおり、具体的には人 <var>B_1</var>, 人 <var>B_2</var>, <var>\\ldots</var>, 人 <var>B_L</var> が人気者です。\n最初、<var>N</var> 人のうちどの <var>2</var> 人も友達ではありません。</p>\n<p>神様である高橋君は、<var>M</var> 個の <var>2</var> 人組のペアについて、コストを支払うことで互いに友達にすることができます。\n具体的には <var>1\\leq i\\leq M</var> について、コスト <var>C_i</var> を支払うことで人 <var>U_i</var> と人 <var>V_i</var> を互いに友達にすることができます。</p>\n<p>ここで、各 <var>1\\leq i\\leq N</var> について、次の問題を解いてください。</p>\n<blockquote>\n<p>高橋君は、人 <var>i</var> を、人 <var>i</var> の属する国とは異なる国に属する人気者と間接的に友達にすることは可能か？\n可能ならば、それを達成するのに必要なコストの総和の最小値を求めよ。\nただし、人 <var>s</var> と人 <var>t</var> が間接的に友達であるとは、ある非負整数 <var>n</var> と人の列 <var>(u_0, u_1, \\ldots , u_n)</var> が存在し, \n<var>u_0=s</var>, <var>u_n=t</var> かつ <var>0\\leq i &lt; n</var> について、人 <var>u_i</var> と 人 <var>u_{i+1}</var> が互いに友達であることをさす。</p>\n</blockquote>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq N \\leq 10^5</var></li>\n<li><var>1 \\leq M \\leq 10^5</var></li>\n<li><var>1 \\leq K \\leq 10^5</var></li>\n<li><var>1 \\leq L \\leq N</var></li>\n<li><var>1 \\leq A_i \\leq K</var></li>\n<li><var>1 \\leq B_1&lt;B_2&lt;\\cdots&lt;B_L\\leq N</var></li>\n<li><var>1\\leq C_i\\leq 10^9</var></li>\n<li><var>1\\leq U_i&lt;V_i\\leq N</var></li>\n<li><var>i \\neq j</var> ならば <var>(U_i, V_i)\\neq (U_j,V_j)</var></li>\n<li>入力は全て整数である。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var> <var>K</var> <var>L</var>\n<var>A_1</var> <var>A_2</var> <var>\\cdots</var> <var>A_N</var>\n<var>B_1</var> <var>B_2</var> <var>\\cdots</var> <var>B_L</var>\n<var>U_1</var> <var>V_1</var> <var>C_1</var>\n<var>U_2</var> <var>V_2</var> <var>C_2</var>\n<var>\\vdots</var>\n<var>U_M</var> <var>V_M</var> <var>C_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>X_i</var> を、人 <var>i</var> を異なる国に属する人気者と間接的に友達にすることが不可能ならば <var>-1</var>、\nそうでないならば、達成するのに必要な最小コストの値として定義する。\n<var>X_1,X_2,\\ldots ,X_N</var> を空白区切りで一行に出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 4 2 2\n1 1 2 2\n2 3\n1 2 15\n2 3 30\n3 4 40\n1 4 10\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>45 30 30 25\n</pre>\n<p>人 <var>1</var>, 人 <var>2</var>, 人 <var>3</var>, 人 <var>4</var> はそれぞれ国 <var>1</var>, 国 <var>1</var>, 国 <var>2</var>, 国 <var>2</var> に属しており、人気者は人 <var>2</var>, 人 <var>3</var> の <var>2</var> 名です。このとき、  </p>\n<ul>\n<li>人 <var>1</var> と異なる国に属する人気者は人 <var>3</var> のみです。人 <var>1</var> と 人 <var>3</var> を間接的に友達にするには、それぞれコスト <var>15,30</var> を払って人 <var>1</var> と人 <var>2</var>, 人 <var>2</var> と人 <var>3</var> を友達にした時がかかるコストが最小で、このとき <var>15+30=45</var> となります。</li>\n<li>人 <var>2</var> と異なる国に属する人気者は人 <var>3</var> のみです。コスト <var>30</var> を払って人 <var>2</var> と人 <var>3</var> を友達にした時が最小となります。</li>\n<li>人 <var>3</var> と異なる国に属する人気者は人 <var>2</var> のみです。コスト <var>30</var> を払って人 <var>2</var> と人 <var>3</var> を友達にした時が最小となります。</li>\n<li>人 <var>4</var> と異なる国に属する人気者は人 <var>2</var> のみです。人 <var>4</var> と 人 <var>2</var> を間接的に友達にするには、それぞれコスト <var>15,10</var> を払って人 <var>1</var> と人 <var>2</var>, 人 <var>1</var> と人 <var>4</var> を友達にした時がかかるコストが最小で、このとき <var>15+10=25</var> となります。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 1 3 1\n1 2 3\n1\n1 2 1000000000\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>-1 1000000000 -1\n</pre>\n<p>人 <var>1</var> にとって自身は間接的な友達といえますが、異なる国に属していないため、\n「異なる国に属する人気者」の条件をみたす相手はいないことに注意してください。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>N</var> people and <var>K</var> nations, labeled as Person <var>1</var>, Person <var>2</var>, <var>\\ldots</var>, Person <var>N</var> and Nation <var>1</var>, Nation <var>2</var>, <var>\\ldots</var>, Nation <var>K</var>, respectively.<br>\nEach person belongs to exactly one nation: Person <var>i</var> belongs to Nation <var>A_i</var>.\nAdditionally, there are <var>L</var> popular people among them: Person <var>B_1</var>, Person <var>B_2</var>, <var>\\ldots</var>, Person <var>B_L</var> are popular.\nInitially, no two of the <var>N</var> people are friends.</p>\n<p>For <var>M</var> pairs of people, Takahashi, a God, can make them friends by paying a certain cost: for each <var>1\\leq i\\leq M</var>, he can pay the cost of <var>C_i</var> to make Person <var>U_i</var> and Person <var>V_i</var> friends.</p>\n<p>Now, for each <var>1\\leq i\\leq N</var>, solve the following problem.</p>\n<blockquote>\n<p>Can Takahashi make Person <var>i</var> an indirect friend of a popular person belonging to a nation different from that of Person <var>i</var>?\nIf he can do so, find the minimum total cost needed.\nHere, Person <var>s</var> is said to be an indirect friend of Person <var>t</var> when there exists a non-negative integer <var>n</var> and a sequence of people <var>(u_0, u_1, \\ldots, u_n)</var>\nsuch that <var>u_0=s</var>, <var>u_n=t</var>, and Person <var>u_i</var> and Person <var>u_{i+1}</var> are friends for each <var>0\\leq i &lt; n</var>.</p>\n</blockquote>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 10^5</var></li>\n<li><var>1 \\leq M \\leq 10^5</var></li>\n<li><var>1 \\leq K \\leq 10^5</var></li>\n<li><var>1 \\leq L \\leq N</var></li>\n<li><var>1 \\leq A_i \\leq K</var></li>\n<li><var>1 \\leq B_1&lt;B_2&lt;\\cdots&lt;B_L\\leq N</var></li>\n<li><var>1\\leq C_i\\leq 10^9</var></li>\n<li><var>1\\leq U_i&lt;V_i\\leq N</var></li>\n<li><var>(U_i, V_i)\\neq (U_j,V_j)</var> if <var>i \\neq j</var>.</li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>K</var> <var>L</var>\n<var>A_1</var> <var>A_2</var> <var>\\cdots</var> <var>A_N</var>\n<var>B_1</var> <var>B_2</var> <var>\\cdots</var> <var>B_L</var>\n<var>U_1</var> <var>V_1</var> <var>C_1</var>\n<var>U_2</var> <var>V_2</var> <var>C_2</var>\n<var>\\vdots</var>\n<var>U_M</var> <var>V_M</var> <var>C_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Let <var>X_i</var> defined as follows: <var>X_i</var> is <var>-1</var> if it is impossible to make Person <var>i</var> an indirect friend of a popular person belonging to a nation different from that of Person <var>i</var>; otherwise, <var>X_i</var> is the minimum total cost needed to do so.\nPrint <var>X_1, X_2, \\ldots, X_N</var> in one line, with spaces in between.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 4 2 2\n1 1 2 2\n2 3\n1 2 15\n2 3 30\n3 4 40\n1 4 10\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>45 30 30 25\n</pre>\n<p>Person <var>1</var>, <var>2</var>, <var>3</var>, <var>4</var> belong to Nation <var>1</var>, <var>1</var>, <var>2</var>, <var>2</var>, respectively, and there are two popular people: Person <var>2</var> and <var>3</var>. Here,</p>\n<ul>\n<li>For Person <var>1</var>, the only popular person belonging to a different nation is Person <var>3</var>. To make them indirect friends with the minimum cost, we should pay the cost of <var>15</var> to make Person <var>1</var> and <var>2</var> friends and pay <var>30</var> to make Person <var>2</var> and <var>3</var> friends, for a total of <var>15+30=45</var>.</li>\n<li>For Person <var>2</var>, the only popular person belonging to a different nation is Person <var>3</var>. The minimum cost is achieved by making Person <var>2</var> and <var>3</var> friends by paying <var>30</var>.</li>\n<li>For Person <var>3</var>, the only popular person belonging to a different nation is Person <var>2</var>. The minimum cost is achieved by making Person <var>2</var> and <var>3</var> friends by paying <var>30</var>.</li>\n<li>For Person <var>4</var>, the only popular person belonging to a different nation is Person <var>2</var>. To make them indirect friends with the minimum cost, we should pay the cost of <var>15</var> to make Person <var>1</var> and <var>2</var> friends and pay <var>10</var> to make Person <var>1</var> and <var>4</var> friends, for a total of <var>15+10=25</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 1 3 1\n1 2 3\n1\n1 2 1000000000\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>-1 1000000000 -1\n</pre>\n<p>Note that, for Person <var>1</var>, Person <var>1</var> itself is indeed an indirect friend, but it does not belong to a different nation, so there is no popular person belonging to a different nation.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc245/tasks/abc245_g"}