{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>700</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>正整数 <var>N, M, K</var> が与えられます．正整数列 <var>A = (A_0, \\ldots, A_{N-1})</var> に対する次の操作を考えます．</p>\n<ul>\n<li><var>k=0, 1, \\ldots, K-1</var> の順に次を行う．<ul>\n<li><var>A_{k\\bmod N}, A_{(k+1)\\bmod N}, \\ldots, A_{(k+M-1)\\bmod N}</var> を昇順にソートする．つまり <var>A_{k\\bmod N}, A_{(k+1)\\bmod N}, \\ldots, A_{(k+M-1)\\bmod N}</var> を小さい方から順に並べたものを <var>(x_0, \\ldots, x_{M-1})</var> とするとき，各 <var>0\\leq j &lt; M</var> に対して <var>A_{(k+j)\\bmod N}</var> を <var>x_j</var> に置き換える．</li>\n</ul>\n</li>\n</ul>\n<p><var>1</var> 以上 <var>N</var> 以下の整数からなる順列 <var>B = (B_0, \\ldots, B_{N-1})</var> が与えられます．正整数列 <var>A</var> であって，上記の操作を行った結果が <var>B</var> と一致するものの個数を <var>998244353</var> で割った余りを答えてください．</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2\\leq N\\leq 3\\times 10^5</var></li>\n<li><var>2\\leq M\\leq N</var></li>\n<li><var>1\\leq K\\leq 10^9</var></li>\n<li><var>1\\leq B_i\\leq N</var></li>\n<li><var>i\\neq j</var> ならば <var>B_i\\neq B_j</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられます．</p>\n<pre><var>N</var> <var>M</var> <var>K</var>\n<var>B_0</var> <var>\\ldots</var> <var>B_{N-1}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>正整数列 <var>A</var> であって，操作を行った結果が <var>B</var> と一致するものの個数を <var>998244353</var> で割った余りを出力してください．</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>6 3 5\n6 4 2 3 1 5\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>18\n</pre>\n<p>例えば <var>A = (4,1,5,6,2,3)</var> が条件を満たします．この <var>A</var> に対して，操作は次のように進行します．</p>\n<ul>\n<li><var>k=0</var> に対する操作により，<var>A</var> は <var>(1,4,5,6,2,3)</var> になる．</li>\n<li><var>k=1</var> に対する操作により，<var>A</var> は <var>(1,4,5,6,2,3)</var> になる．</li>\n<li><var>k=2</var> に対する操作により，<var>A</var> は <var>(1,4,2,5,6,3)</var> になる．</li>\n<li><var>k=3</var> に対する操作により，<var>A</var> は <var>(1,4,2,3,5,6)</var> になる．</li>\n<li><var>k=4</var> に対する操作により，<var>A</var> は <var>(6,4,2,3,1,5)</var> になり，<var>B</var> に一致する．</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>6 3 5\n6 5 4 3 2 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n<p>条件を満たす <var>A</var> は存在しません．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>20 20 149\n13 14 15 16 17 18 19 20 1 2 3 4 5 6 7 8 9 10 11 12\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>401576539\n</pre>\n<p><var>1</var> 以上 <var>20</var> 以下の整数からなる順列がすべて条件を満たします．</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>700</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given positive integers <var>N</var>, <var>M</var>, and <var>K</var>. Consider the following operation on a sequence of positive integers <var>A = (A_0, \\ldots, A_{N-1})</var>.</p>\n<ul>\n<li>Do the following for <var>k=0, 1, \\ldots, K-1</var> in this order.<ul>\n<li>Sort <var>A_{k\\bmod N}, A_{(k+1)\\bmod N}, \\ldots, A_{(k+M-1)\\bmod N}</var> in ascending order. That is, replace <var>A_{(k+j)\\bmod N}</var> with <var>x_j</var> for each <var>0\\leq j &lt; M</var>, where <var>(x_0, \\ldots, x_{M-1})</var> is the result of sorting <var>A_{k\\bmod N}, A_{(k+1)\\bmod N}, \\ldots, A_{(k+M-1)\\bmod N}</var> in ascending order.</li>\n</ul>\n</li>\n</ul>\n<p>You are given a permutation <var>B = (B_0, \\ldots, B_{N-1})</var> of the integers from <var>1</var> through <var>N</var>. Find the number of sequences <var>A</var> of positive integers that will equal <var>B</var> after performing the operation above, modulo <var>998244353</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2\\leq N\\leq 3\\times 10^5</var></li>\n<li><var>2\\leq M\\leq N</var></li>\n<li><var>1\\leq K\\leq 10^9</var></li>\n<li><var>1\\leq B_i\\leq N</var></li>\n<li><var>B_i\\neq B_j</var> if <var>i\\neq j</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>K</var>\n<var>B_0</var> <var>\\ldots</var> <var>B_{N-1}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Print</h3><p>Print the number of sequences <var>A</var> of positive integers that will equal <var>B</var> after performing the operation, modulo <var>998244353</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>6 3 5\n6 4 2 3 1 5\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>18\n</pre>\n<p>For instance, <var>A = (4,1,5,6,2,3)</var> satisfies the condition. On this <var>A</var>, the operation will proceed as follows.</p>\n<ul>\n<li>The action for <var>k=0</var> changes <var>A</var> to <var>(1,4,5,6,2,3)</var>.</li>\n<li>The action for <var>k=1</var> changes <var>A</var> to <var>(1,4,5,6,2,3)</var>.</li>\n<li>The action for <var>k=2</var> changes <var>A</var> to <var>(1,4,2,5,6,3)</var>.</li>\n<li>The action for <var>k=3</var> changes <var>A</var> to <var>(1,4,2,3,5,6)</var>.</li>\n<li>The action for <var>k=4</var> changes <var>A</var> to <var>(6,4,2,3,1,5)</var>, which equals <var>B</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>6 3 5\n6 5 4 3 2 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n<p>No sequence <var>A</var> satisfies the condition.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>20 20 149\n13 14 15 16 17 18 19 20 1 2 3 4 5 6 7 8 9 10 11 12\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>401576539\n</pre>\n<p>All permutations of the integers from <var>1</var> through <var>20</var> satisfy the condition.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc149/tasks/arc149_e"}