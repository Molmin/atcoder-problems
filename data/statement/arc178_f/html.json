{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1000</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>正の整数 <var>N, M, K</var> と、長さ <var>M</var> の非負整数列 <var>A=(A_{0}, A_{1},\\dots A_{M-1})</var> が与えられます。ここで、<var>2^{N - 1}\\leq K &lt; 2^{N}</var> が成り立ちます。</p>\n<p>入力において、<var>K</var> は <var>2</var> 進法表記で <var>N</var> 桁の数として与えられ、その他の整数は <var>10</var> 進法表記で与えられます。</p>\n<p>また、<var>A</var> は入力では直接与えられず、<var>i=0,1,\\dots ,M - 1</var> について、<var>A_{i}=\\sum_{j=0}^{L_{i}-1} 2^{X_{i,j}}</var> となるような、長さ <var>L_{i}</var> の整数列 <var>X_{i}=(X_{i,0},X_{i,1},\\dots ,X_{i,L_{i}-1})</var> が与えられます。ここで、<var>0\\leq X_{i,0}&lt;X_{i,1}&lt;\\cdots &lt;X_{i,L_{i}-1}&lt;N</var> が成り立ちます。</p>\n<p>以下のように定義される、長さ <var>MK</var> の数列 <var>B=(B_{0},B_{1},\\dots ,B_{MK-1})</var> の転倒数を <var>998244353</var> で割ったあまりを求めてください。</p>\n<ul>\n<li>任意の <var>0</var> 以上 <var>K</var> 未満の整数 <var>a</var> と 任意の <var>0</var> 以上 <var>M</var> 未満の整数 <var>b</var> に対して以下が成り立つ。<ul>\n<li><var>B_{aM+b}</var> は <var>\\operatorname{popcount}(a\\operatorname{AND}A_{b})</var> を <var>2</var> で割ったあまりに等しい。</li>\n</ul>\n</li>\n</ul>\n<details>\n<summary><var>\\operatorname{AND}</var> とは？</summary>\n<p>整数 <var>A, B</var> のビット単位 <var>\\operatorname{AND}</var>、<var>A\\ \\operatorname{AND}\\ B</var> は以下のように定義されます。</p>\n<ul>\n<li><var>A\\ \\operatorname{AND}\\ B</var> を二進表記した際の <var>2^k</var> (<var>k \\geq 0</var>) の位の数は、<var>A, B</var> を二進表記した際の <var>2^k</var> の位の数のうち両方が <var>1</var> であれば <var>1</var>、そうでなければ <var>0</var> である。</li>\n</ul>\n<p>例えば、<var>3\\ \\operatorname{AND}\\ 5 = 1</var> となります (二進表記すると: <var>011\\ \\operatorname{AND}\\ 101 = 001</var>)。 \n一般に <var>k</var> 個の整数 <var>p_1, p_2, p_3, \\dots, p_k</var> のビット単位 <var>\\operatorname{AND}</var> は <var>(\\dots ((p_1\\ \\operatorname{AND}\\ p_2)\\ \\operatorname{AND}\\ p_3)\\ \\operatorname{AND}\\ \\dots\\ \\operatorname{AND}\\ p_k)</var> と定義され、これは <var>p_1, p_2, p_3, \\dots p_k</var> の順番によらないことが証明できます。  </p>\n</details>\n<details>\n<summary><var>\\operatorname{popcount}</var>とは？</summary>\n<p>非負整数 <var>x</var> について <var>\\operatorname{popcount}(x)</var> とは、<var>x</var> を <var>2</var> 進法で表記したときの <var>1</var> の個数です。 より厳密には、非負整数 <var>x</var> について <var>\\displaystyle x=\\sum _ {i=0} ^ \\infty b _ i2 ^ i\\ (b _ i\\in\\lbrace0,1\\rbrace)</var> が成り立っているとき <var>\\displaystyle\\operatorname{popcount}(x)=\\sum _ {i=0} ^ \\infty b _ i</var> です。\n例えば、<var>13</var> を <var>2</var> 進法で表記すると <code>1101</code> なので、 <var>\\operatorname{popcount}(13)=3</var> となります。</p>\n</details>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1\\leq N\\leq 2\\times 10 ^ {5}</var></li>\n<li><var>1\\leq M\\leq 2\\times 10 ^ {5}</var></li>\n<li><var>2^{N-1}\\leq K&lt; 2^{N}</var></li>\n<li><var>0\\leq L_{i}\\leq N</var></li>\n<li><var>\\sum L_{i}\\leq 2\\times 10 ^ {5}</var></li>\n<li><var>0\\leq X_{i,0}&lt;X_{i,1}&lt;\\cdots&lt;X_{i,L_{i}-1}&lt;N</var></li>\n<li>入力は全て整数</li>\n<li><var>K</var> は <var>2</var> 進法表記で与えられる。</li>\n<li><var>K</var> を除く数は <var>10</var> 進法表記で与えられる。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられます。</p>\n<pre><var>N</var> <var>M</var>\n<var>K</var>\n<var>L_{0}</var> <var>X_{0,0}</var> <var>X_{0,1}</var> <var>\\cdots</var> <var>X_{0,L_{0}-1}</var>\n<var>L_{1}</var> <var>X_{1,0}</var> <var>X_{1,1}</var> <var>\\cdots</var> <var>X_{1,L_{1}-1}</var>\n<var>\\vdots</var>\n<var>L_{M-1}</var> <var>X_{M-1,0}</var> <var>X_{M-1,1}</var> <var>\\cdots</var> <var>X_{M-1,L_{M-1}-1}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力してください。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2 4\n11\n1 0\n2 0 1\n0\n1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>9\n</pre>\n<p><var>A=(1, 3, 0, 2), B = (0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1)</var> となります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 3\n101\n2 1 2\n2 0 1\n1 0\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>23\n</pre>\n<p><var>A = (6, 3, 1), B = (0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0)</var> となります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>16 7\n1101010000100110\n11 0 1 2 3 7 10 11 12 13 14 15\n7 4 6 8 10 11 12 13\n6 0 1 6 8 10 12\n8 0 3 5 6 10 11 12 13\n10 0 1 2 3 4 5 6 8 12 13\n9 3 4 5 6 8 9 11 14 15\n8 0 4 7 9 10 11 13 14\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>97754354\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>92 4\n10101100101111111111011101111111101011001011111110011110111111101111111110100111100010111011\n23 1 2 5 13 14 20 28 32 34 39 52 56 59 60 62 64 67 69 71 78 84 87 91\n20 15 17 22 28 36 40 43 47 52 53 57 67 72 77 78 81 87 89 90 91\n23 7 8 9 10 11 13 16 19 22 23 30 33 42 49 51 52 58 64 71 73 76 79 83\n22 1 13 19 26 27 28 29 35 39 40 41 46 55 60 62 64 67 74 79 82 89 90\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>291412708\n</pre>\n<p><var>998244353</var> で割ったあまりを求めてください。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1000</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given positive integers <var>N</var>, <var>M</var>, and <var>K</var>, and a sequence of <var>M</var> non-negative integers <var>A = (A_{0}, A_{1}, \\dots, A_{M-1})</var>. Here, <var>2^{N - 1} \\leq K &lt; 2^{N}</var> holds.</p>\n<p>In the input, <var>K</var> is given as an <var>N</var>-digit number in binary notation, while the other integers are given in decimal notation.</p>\n<p>Additionally, <var>A</var> is not given directly in the input. Instead, for each <var>i = 0, 1, \\dots, M - 1</var>, you are given a sequence of <var>L_i</var> integers <var>X_{i} = (X_{i,0}, X_{i,1}, \\dots, X_{i,L_{i}-1})</var> such that <var>A_{i} = \\sum_{j=0}^{L_{i}-1} 2^{X_{i,j}}</var>. Here, <var>0 \\leq X_{i,0} &lt; X_{i,1} &lt; \\cdots &lt; X_{i,L_{i}-1} &lt; N</var> holds.</p>\n<p>Find the inversion number, modulo <var>998244353</var>, of the sequence <var>B = (B_{0}, B_{1}, \\dots, B_{MK-1})</var> defined as follows.</p>\n<ul>\n<li>For any integer <var>a</var> such that <var>0 \\leq a &lt; K</var> and any integer <var>b</var> such that <var>0 \\leq b &lt; M</var>, the following holds:<ul>\n<li><var>B_{aM+b}</var> is equal to the remainder when <var>\\operatorname{popcount}(a \\operatorname{AND} A_{b})</var> is divided by <var>2</var>.</li>\n</ul>\n</li>\n</ul>\n<details>\n<summary>What is <var>\\operatorname{AND}</var>?</summary>\n<p>The bitwise <var>\\operatorname{AND}</var> of integers <var>A</var> and <var>B</var>, denoted as <var>A \\operatorname{AND} B</var>, is defined as follows:</p>\n<ul>\n<li>In the binary representation of <var>A \\operatorname{AND} B</var>, the digit at the <var>2^k</var> (<var>k \\geq 0</var>) place is <var>1</var> if and only if the digits at the <var>2^k</var> place in the binary representations of both <var>A</var> and <var>B</var> are <var>1</var>; otherwise, it is <var>0</var>.</li>\n</ul>\n<p>For example, <var>3 \\operatorname{AND} 5 = 1</var> (in binary: <var>011 \\operatorname{AND} 101 = 001</var>). \nGenerally, the bitwise <var>\\operatorname{AND}</var> of <var>k</var> integers <var>p_1, p_2, p_3, \\dots, p_k</var> is defined as <var>(\\dots ((p_1 \\operatorname{AND} p_2) \\operatorname{AND} p_3) \\operatorname{AND} \\dots \\operatorname{AND} p_k)</var>, and it can be proved that this is independent of the order of <var>p_1, p_2, p_3, \\dots, p_k</var>.</p>\n</details>\n<details>\n<summary>What is <var>\\operatorname{popcount}</var>?</summary>\n<p>For a non-negative integer <var>x</var>, <var>\\operatorname{popcount}(x)</var> is the number of <var>1</var>s in the binary representation of <var>x</var>. More precisely, for a non-negative integer <var>x</var> such that <var>\\displaystyle x = \\sum_{i=0}^{\\infty} b_i 2^i\\ (b_i \\in {0, 1})</var>, it holds that <var>\\displaystyle \\operatorname{popcount}(x) = \\sum_{i=0}^{\\infty} b_i</var>.\nFor example, <var>13</var> is <code>1101</code> in binary, so <var>\\operatorname{popcount}(13) = 3</var>.</p>\n</details>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq M \\leq 2 \\times 10^5</var></li>\n<li><var>2^{N-1} \\leq K &lt; 2^{N}</var></li>\n<li><var>0 \\leq L_{i} \\leq N</var></li>\n<li><var>\\sum L_{i} \\leq 2 \\times 10^5</var></li>\n<li><var>0 \\leq X_{i,0} &lt; X_{i,1} &lt; \\cdots &lt; X_{i,L_{i}-1} &lt; N</var></li>\n<li>All input values are integers.</li>\n<li><var>K</var> is given in binary notation.</li>\n<li>All numbers except <var>K</var> are given in decimal notation.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>K</var>\n<var>L_{0}</var> <var>X_{0,0}</var> <var>X_{0,1}</var> <var>\\cdots</var> <var>X_{0,L_{0}-1}</var>\n<var>L_{1}</var> <var>X_{1,0}</var> <var>X_{1,1}</var> <var>\\cdots</var> <var>X_{1,L_{1}-1}</var>\n<var>\\vdots</var>\n<var>L_{M-1}</var> <var>X_{M-1,0}</var> <var>X_{M-1,1}</var> <var>\\cdots</var> <var>X_{M-1,L_{M-1}-1}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2 4\n11\n1 0\n2 0 1\n0\n1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>9\n</pre>\n<p><var>A = (1, 3, 0, 2), B = (0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1)</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 3\n101\n2 1 2\n2 0 1\n1 0\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>23\n</pre>\n<p><var>A = (6, 3, 1), B = (0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0)</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>16 7\n1101010000100110\n11 0 1 2 3 7 10 11 12 13 14 15\n7 4 6 8 10 11 12 13\n6 0 1 6 8 10 12\n8 0 3 5 6 10 11 12 13\n10 0 1 2 3 4 5 6 8 12 13\n9 3 4 5 6 8 9 11 14 15\n8 0 4 7 9 10 11 13 14\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>97754354\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>92 4\n10101100101111111111011101111111101011001011111110011110111111101111111110100111100010111011\n23 1 2 5 13 14 20 28 32 34 39 52 56 59 60 62 64 67 69 71 78 84 87 91\n20 15 17 22 28 36 40 43 47 52 53 57 67 72 77 78 81 87 89 90 91\n23 7 8 9 10 11 13 16 19 22 23 30 33 42 49 51 52 58 64 71 73 76 79 83\n22 1 13 19 26 27 28 29 35 39 40 41 46 55 60 62 64 67 74 79 82 89 90\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>291412708\n</pre>\n<p>Find the number modulo <var>998244353</var>.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc178/tasks/arc178_f"}