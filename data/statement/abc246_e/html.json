{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>500</var> 点</p>\n<p><b>コンテスト開催当時はメモリ制限が2GBでしたが、ジャッジ環境が異なるため、現在はメモリ制限を1GBに設定しております。なお、このメモリ制限でもAC出来ることは確認しています。</b></p>\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>ここに、 <var>N \\times N</var> のチェス盤があります。このチェス盤の上から <var>i</var> 行目、左から <var>j</var> 列目にあるマスをマス <var>(i,j)</var> と呼びます。<br>\nチェス盤の情報は <var>N</var> 個の文字列 <var>S_i</var> として与えられます。<br>\n文字列 <var>S_i</var> の <var>j</var> 文字目である <var>S_{i,j}</var> には、以下の情報が含まれています。</p>\n<ul>\n<li><var>S_{i,j}=</var> <code>.</code> のとき マス <var>(i,j)</var> には何も置かれていない。</li>\n<li><var>S_{i,j}=</var> <code>#</code> のとき マス <var>(i,j)</var> には白のポーンが <var>1</var> つ置かれている。このポーンを動かしたり取り除いたりすることはできない。</li>\n</ul>\n<p>この盤面のマス <var>(A_x,A_y)</var> に、白のビショップを <var>1</var> つ置きました。<br>\nこの白のビショップをチェスのルール (注記参照) に従ってマス <var>(A_x,A_y)</var> からマス <var>(B_x,B_y)</var> に移動させるために必要な最小の手数を求めてください。<br>\nただし、移動できない場合は代わりに <code>-1</code> を出力してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>注記</h3>\n<p>マス <var>(i,j)</var> に置かれている白の <a href=\"https://ja.wikipedia.org/wiki/%E3%83%93%E3%82%B7%E3%83%A7%E3%83%83%E3%83%97\">ビショップ</a> は、 <var>1</var> 手で以下のルールに従って移動することができます。</p>\n<ul>\n<li>\n<p>各正整数 <var>d</var> について、以下の条件を全て満たせばマス <var>(i+d,j+d)</var> に移動できる。</p>\n<ul>\n<li>マス <var>(i+d,j+d)</var> が盤内に存在する</li>\n<li>全ての正整数 <var>l \\le d</var> について、 <var>(i+l,j+l)</var> に白のポーンがない</li>\n</ul>\n</li>\n<li>\n<p>各正整数 <var>d</var> について、以下の条件を全て満たせばマス <var>(i+d,j-d)</var> に移動できる。</p>\n<ul>\n<li>マス <var>(i+d,j-d)</var> が盤内に存在する</li>\n<li>全ての正整数 <var>l \\le d</var> について、 <var>(i+l,j-l)</var> に白のポーンがない</li>\n</ul>\n</li>\n<li>\n<p>各正整数 <var>d</var> について、以下の条件を全て満たせばマス <var>(i-d,j+d)</var> に移動できる。</p>\n<ul>\n<li>マス <var>(i-d,j+d)</var> が盤内に存在する</li>\n<li>全ての正整数 <var>l \\le d</var> について、 <var>(i-l,j+l)</var> に白のポーンがない</li>\n</ul>\n</li>\n<li>\n<p>各正整数 <var>d</var> について、以下の条件を全て満たせばマス <var>(i-d,j-d)</var> に移動できる。</p>\n<ul>\n<li>マス <var>(i-d,j-d)</var> が盤内に存在する</li>\n<li>全ての正整数 <var>l \\le d</var> について、 <var>(i-l,j-l)</var> に白のポーンがない</li>\n</ul>\n</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\le N \\le 1500</var></li>\n<li><var>1 \\le A_x,A_y \\le N</var></li>\n<li><var>1 \\le B_x,B_y \\le N</var></li>\n<li><var>(A_x,A_y) \\neq (B_x,B_y)</var></li>\n<li><var>S_i</var> は <code>.</code> および <code>#</code> からなる <var>N</var> 文字の文字列</li>\n<li><var>S_{A_x,A_y}=</var> <code>.</code></li>\n<li><var>S_{B_x,B_y}=</var> <code>.</code></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>A_x</var> <var>A_y</var>\n<var>B_x</var> <var>B_y</var>\n<var>S_1</var>\n<var>S_2</var>\n<var>\\vdots</var>\n<var>S_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>5\n1 3\n3 5\n....#\n...#.\n.....\n.#...\n#....\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>3\n</pre>\n<p>以下のように移動させることで <var>3</var> 手でビショップを <var>(1,3)</var> から <var>(3,5)</var> まで移動させることができます。 <var>2</var> 手以内でビショップを <var>(1,3)</var> から <var>(3,5)</var> まで移動させることはできません。</p>\n<ul>\n<li><var>(1,3) \\rightarrow (2,2) \\rightarrow (4,4) \\rightarrow (3,5)</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>4\n3 2\n4 2\n....\n....\n....\n....\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>-1\n</pre>\n<p>どのようにビショップを動かしても <var>(3,2)</var> から <var>(4,2)</var> に移動させることはできません。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>18\n18 1\n1 18\n..................\n.####.............\n.#..#..####.......\n.####..#..#..####.\n.#..#..###...#....\n.#..#..#..#..#....\n.......####..#....\n.............####.\n..................\n..................\n.####.............\n....#..#..#.......\n.####..#..#..####.\n.#.....####..#....\n.####.....#..####.\n..........#..#..#.\n.............####.\n..................\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>9\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>500</var> points</p>\n<p><b>During the time of the contest, the memory limit was set to 2GB. However, due to a change in the judging environment, the memory limit has now been set to 1GB. Please note that it has been confirmed that solutions can still achieve an Acceptable Completion (AC) within this memory limit.</b></p>\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have an <var>N \\times N</var> chessboard. Let <var>(i, j)</var> denote the square at the <var>i</var>-th row from the top and <var>j</var>-th column from the left of this board.<br>\nThe board is described by <var>N</var> strings <var>S_i</var>.<br>\nThe <var>j</var>-th character of the string <var>S_i</var>, <var>S_{i,j}</var>, means the following.</p>\n<ul>\n<li>If <var>S_{i,j}=</var> <code>.</code>, the square <var>(i, j)</var> is empty.</li>\n<li>If <var>S_{i,j}=</var> <code>#</code>, the square <var>(i, j)</var> is occupied by a white pawn, which cannot be moved or removed.</li>\n</ul>\n<p>We have put a white bishop on the square <var>(A_x, A_y)</var>.<br>\nFind the minimum number of moves needed to move this bishop from <var>(A_x, A_y)</var> to <var>(B_x, B_y)</var> according to the rules of chess (see Notes).<br>\nIf it cannot be moved to <var>(B_x, B_y)</var>, report <code>-1</code> instead.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Notes</h3>\n<p>A white <a href=\"https://en.wikipedia.org/wiki/Bishop_(chess)\">bishop</a> on the square <var>(i, j)</var> can go to the following positions in one move.</p>\n<ul>\n<li>\n<p>For each positive integer <var>d</var>, it can go to <var>(i+d,j+d)</var> if all of the conditions are satisfied.</p>\n<ul>\n<li>The square <var>(i+d,j+d)</var> exists in the board.</li>\n<li>For every positive integer <var>l \\le d</var>, <var>(i+l,j+l)</var> is not occupied by a white pawn.</li>\n</ul>\n</li>\n<li>\n<p>For each positive integer <var>d</var>, it can go to <var>(i+d,j-d)</var> if all of the conditions are satisfied.</p>\n<ul>\n<li>The square <var>(i+d,j-d)</var> exists in the board.</li>\n<li>For every positive integer <var>l \\le d</var>, <var>(i+l,j-l)</var> is not occupied by a white pawn.</li>\n</ul>\n</li>\n<li>\n<p>For each positive integer <var>d</var>, it can go to <var>(i-d,j+d)</var> if all of the conditions are satisfied.</p>\n<ul>\n<li>The square <var>(i-d,j+d)</var> exists in the board.</li>\n<li>For every positive integer <var>l \\le d</var>, <var>(i-l,j+l)</var> is not occupied by a white pawn.</li>\n</ul>\n</li>\n<li>\n<p>For each positive integer <var>d</var>, it can go to <var>(i-d,j-d)</var> if all of the conditions are satisfied.</p>\n<ul>\n<li>The square <var>(i-d,j-d)</var> exists in the board.</li>\n<li>For every positive integer <var>l \\le d</var>, <var>(i-l,j-l)</var> is not occupied by a white pawn.</li>\n</ul>\n</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\le N \\le 1500</var></li>\n<li><var>1 \\le A_x,A_y \\le N</var></li>\n<li><var>1 \\le B_x,B_y \\le N</var></li>\n<li><var>(A_x,A_y) \\neq (B_x,B_y)</var></li>\n<li><var>S_i</var> is a string of length <var>N</var> consisting of <code>.</code> and <code>#</code>.</li>\n<li><var>S_{A_x,A_y}=</var> <code>.</code></li>\n<li><var>S_{B_x,B_y}=</var> <code>.</code></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>A_x</var> <var>A_y</var>\n<var>B_x</var> <var>B_y</var>\n<var>S_1</var>\n<var>S_2</var>\n<var>\\vdots</var>\n<var>S_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>5\n1 3\n3 5\n....#\n...#.\n.....\n.#...\n#....\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>3\n</pre>\n<p>We can move the bishop from <var>(1,3)</var> to <var>(3,5)</var> in three moves as follows, but not in two or fewer moves.</p>\n<ul>\n<li><var>(1,3) \\rightarrow (2,2) \\rightarrow (4,4) \\rightarrow (3,5)</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>4\n3 2\n4 2\n....\n....\n....\n....\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>-1\n</pre>\n<p>There is no way to move the bishop from <var>(3,2)</var> to <var>(4,2)</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>18\n18 1\n1 18\n..................\n.####.............\n.#..#..####.......\n.####..#..#..####.\n.#..#..###...#....\n.#..#..#..#..#....\n.......####..#....\n.............####.\n..................\n..................\n.####.............\n....#..#..#.......\n.####..#..#..####.\n.#.....####..#....\n.####.....#..####.\n..........#..#..#.\n.............####.\n..................\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>9\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc246/tasks/abc246_e"}