{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>550</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><strong>注：この問題は B 問題とほぼ同じ設定です。本文中で太字で示されている部分および制約のみが異なります。</strong></p>\n<p>あなたはあるリングを両手で握っています。\nこのリングは <var>N\\ (N\\geq 3)</var> 個のパーツ <var>1,2,\\dots,N</var> によって構成されており、パーツ <var>i</var> とパーツ <var>i+1</var> (<var>1\\leq i\\leq N-1</var>)、およびパーツ <var>1</var> とパーツ <var>N</var> がそれぞれ隣接しています。</p>\n<p>最初、左手はパーツ <var>1</var> を、右手はパーツ <var>2</var> を握っています。\nあなたは、<var>1</var> 回の <em>操作</em> で以下のことを行えます。</p>\n<ul>\n<li>片方の手を、今握っているパーツに隣接するいずれかのパーツに移動する。ただし、移動先にもう一方の手がない場合に限る。</li>\n</ul>\n<p>以下の図は、初期状態およびそこから行える操作と行えない操作の例を示したもので、リングの各パーツに書き込まれた数はそのパーツの番号を、L と書かれた丸は左手を、R と書かれた丸は右手を示しています。</p>\n<p><img src=\"https://img.atcoder.jp/abc376/bb6691e1c7281e4794b3fd94b256ba66.png\" class=\"center-block\" height=\"400\"></p>\n<p>あなたは今から与えられる <var>Q</var> 個の指示に順番に従う必要があります。\n<var>i\\ (1\\leq i\\leq Q)</var> 個目の指示は文字 <var>H_i</var> および整数 <var>T_i</var> によって表され、その意味は以下の通りです：</p>\n<ul>\n<li>操作を何回か（<var>0</var> 回でもよい）行うことで、<var>H_i</var> が <code>L</code> ならば左手、<code>R</code> ならば右手が、パーツ <var>T_i</var> を握っている状態にする。\n  このとき、<var>H_i</var> によって指定された手ではない方の手を <strong>動かしてもよい</strong>。</li>\n</ul>\n<p><strong>なお、本問題の設定および制約の下では、どのような指示も達成可能なことが証明できます。</strong></p>\n<p>すべての指示に従うために必要な操作回数の合計の最小値を求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>3\\leq N \\leq 3000</var></li>\n<li><var>1\\leq Q \\leq 3000</var></li>\n<li><var>H_i</var> は <code>L</code> または <code>R</code></li>\n<li><var>1\\leq T_i\\leq N</var></li>\n<li><var>N,Q,T_i</var> は整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>Q</var>\n<var>H_1</var> <var>T_1</var>\n<var>H_2</var> <var>T_2</var>\n<var>\\vdots</var>\n<var>H_Q</var> <var>T_Q</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>すべての指示に従うために必要な操作回数の合計の最小値を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>6 3\nR 4\nL 5\nR 5\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>6\n</pre>\n<p><img src=\"https://img.atcoder.jp/abc376/d9baddfa26f7a1ccd163cbd8ad01fde4.png\" class=\"center-block\" height=\"200\"></p>\n<p>以下のように操作を行うことで、<var>Q</var> 個の指示すべてに順番に従うことができます。</p>\n<ol>\n<li>右手をパーツ <var>2\\rightarrow 3\\rightarrow 4</var> と移動させることで、<var>1</var> 番目の指示に従う。</li>\n<li>左手をパーツ <var>1\\rightarrow 6\\rightarrow 5</var> と移動させることで、<var>2</var> 番目の指示に従う。</li>\n<li>左手をパーツ <var>5\\rightarrow 6</var> と移動させたのち、右手をパーツ <var>4\\rightarrow 5</var> と移動させることで、<var>3</var> 番目の指示に従う。</li>\n</ol>\n<p>このとき行う操作回数の合計は <var>2+2+1+1=6</var> であり、これが最小です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>100 2\nL 1\nR 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n<p>操作を <var>1</var> 度も行わずに指示に従うことができる場合もあります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>30 8\nR 23\nR 26\nR 29\nL 20\nR 29\nR 19\nL 7\nL 16\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>58\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>550</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p><strong>Note: This problem has almost the same setting as Problem B. Only the parts in bold in the main text and constraints differ.</strong></p>\n<p>You are holding a ring with both hands.\nThis ring consists of <var>N\\ (N \\geq 3)</var> parts numbered <var>1,2,\\dots,N</var>, where parts <var>i</var> and <var>i+1</var> (<var>1 \\leq i \\leq N-1</var>) are adjacent, and parts <var>1</var> and <var>N</var> are also adjacent.</p>\n<p>Initially, your left hand is holding part <var>1</var>, and your right hand is holding part <var>2</var>.\nIn one <em>operation</em>, you can do the following:</p>\n<ul>\n<li>Move one of your hands to an adjacent part of the part it is currently holding. However, you can do this only if the other hand is not on the destination part.</li>\n</ul>\n<p>The following figure shows the initial state and examples of operations that can and cannot be made from there. The number written on each part of the ring represents the part number, and the circles labeled L and R represent your left and right hands, respectively.</p>\n<p><img src=\"https://img.atcoder.jp/abc376/bb6691e1c7281e4794b3fd94b256ba66.png\" class=\"center-block\" height=\"400\"></p>\n<p>You need to follow <var>Q</var> instructions given to you in order.\nThe <var>i</var>-th (<var>1 \\leq i \\leq Q</var>) instruction is represented by a character <var>H_i</var> and an integer <var>T_i</var>, meaning the following:</p>\n<ul>\n<li>Perform some number of operations (possibly zero) so that your left hand (if <var>H_i</var> is <code>L</code>) or your right hand (if <var>H_i</var> is <code>R</code>) is holding part <var>T_i</var>.\n  Here, you <strong>may</strong> move the other hand not specified by <var>H_i</var>.</li>\n</ul>\n<p><strong>Under the settings and constraints of this problem, it can be proved that any instructions are achievable.</strong></p>\n<p>Find the minimum total number of operations required to follow all the instructions.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>3\\leq N \\leq 3000</var></li>\n<li><var>1\\leq Q \\leq 3000</var></li>\n<li><var>H_i</var> is <code>L</code> or <code>R</code>.</li>\n<li><var>1 \\leq T_i \\leq N</var></li>\n<li><var>N</var>, <var>Q</var>, and <var>T_i</var> are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>Q</var>\n<var>H_1</var> <var>T_1</var>\n<var>H_2</var> <var>T_2</var>\n<var>\\vdots</var>\n<var>H_Q</var> <var>T_Q</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the minimum total number of operations required to follow all the instructions.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>6 3\nR 4\nL 5\nR 5\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>6\n</pre>\n<p><img src=\"https://img.atcoder.jp/abc376/d9baddfa26f7a1ccd163cbd8ad01fde4.png\" class=\"center-block\" height=\"200\"></p>\n<p>By performing the following operations, you can follow all <var>Q</var> instructions in order.</p>\n<ol>\n<li>Move your right hand as part <var>2 \\rightarrow 3 \\rightarrow 4</var> to follow the first instruction.</li>\n<li>Move your left hand as part <var>1 \\rightarrow 6 \\rightarrow 5</var> to follow the second instruction.</li>\n<li>Move your left hand as part <var>5 \\rightarrow 6</var>, then move your right hand as part <var>4 \\rightarrow 5</var> to follow the third instruction.</li>\n</ol>\n<p>In this case, the total number of operations is <var>2+2+1+1=6</var>, which is the minimum.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>100 2\nL 1\nR 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n<p>There are cases where you can follow the instructions without performing any operations.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>30 8\nR 23\nR 26\nR 29\nL 20\nR 29\nR 19\nL 7\nL 16\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>58\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc376/tasks/abc376_f"}