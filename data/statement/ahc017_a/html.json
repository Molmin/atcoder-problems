{"html":{"ja":"<span class=\"lang-ja\">\n\n<div class=\"part\">\n<section>\n<h3>ストーリー</h3><p>高橋市は老朽化した道路の補修工事を計画している。\n高橋市の道路網は、交差点を頂点としてその間の道路を辺とした平面無向グラフとして表現できる。\n工事中の道路は通行止めとなるため、目的地に移動するには遠回りする必要が生じ、市民の不満が溜まってしまう。\n一日あたりに同時に工事できる辺数の上限と、全ての工事を終えるまでの日数の上限が決まっているので、出来るだけ不満が少なくなるように、各辺を何日目に工事するかの計画を立てて欲しい。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>辺に重みの付いた <var>N</var> 頂点の無向平面グラフが与えられるので、<var>D</var> 日間で各辺をちょうど1回ずつ工事したい。\n各辺の工事は <var>1</var> 日で完了し、同じ日に最大で <var>K</var> 本の辺を同時に工事することが出来る。</p>\n<p>工事中でない辺は両方向に通行可能で、辺の重みはその辺上を移動するのにかかる移動距離を表す。\nどの辺も工事を行っていない状態における、頂点 <var>i</var> から頂点 <var>j</var> への最短距離を <var>d(i,j)</var> とする。\n元のグラフから <var>k</var> 日目に工事する辺を取り除いたグラフにおける、頂点 <var>i</var> から頂点 <var>j</var> への最短距離を <var>d_k(i,j)</var> とする。\nただし、<var>i</var> から <var>j</var> へ到達不能な場合は、<var>d_k(i,j)=10^9</var> とする。\nこのとき、<var>k</var> 日目の工事に対する不満度 <var>f_k</var> は、以下のようにランダムな異なる二点間の最短距離の増加量の期待値として定義される。\n\\[\n    f_k = \\frac{\\sum_{i\\neq j}(d_k(i,j)-d(i,j))}{N(N-1)}\n\\]</p>\n<p>工事全体に対する不満度は、各日の不満度の平均を用いて\n\\[\n    \\mathrm{round}\\left(10^3\\times \\frac{1}{D}\\sum_{k=1}^D f_k\\right)\n\\]\nと定義される。\n工事全体に対する不満度が出来るだけ低くなるような工事計画を求めよ。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>得点</h3><p>各テストケース毎に、<var>\\mathrm{round}(10^9\\times \\frac{全参加者中の最小不満度}{自身の不満度})</var> の<font color=\"red\"><strong>相対評価スコア</strong></font>が得られ、その和が提出の得点となる。</p>\n<p>最終順位はコンテスト終了後に実施されるより多くの入力に対するシステムテストにおける得点で決定される。\n暫定テスト、システムテストともに、一部のテストケースで不正な出力や制限時間超過をした場合、そのテストケースの相対評価スコアは0点となり、そのテストケースにおいては「全参加者中の最小不満度」の計算から除外される。\nシステムテストは<font color=\"red\"><strong> <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"\" data-original-title=\"コンパイルエラー\">CE</span> 以外の結果を得た一番最後の提出</strong></font>に対してのみ行われるため、最終的に提出する解答を間違えないよう注意せよ。</p>\n<h4>テストケース数</h4>\n<ul>\n<li>暫定テスト: 50個</li>\n<li>システムテスト: 2000個、コンテスト終了後に<a href=\"https://img.atcoder.jp/ahc017/seeds.txt\">seeds.txt</a> (sha256=0522b6c3da4e413908209488368988ebce3b3809c0d9278dc9adaf804896fa23) を公開</li>\n</ul>\n<h4>相対評価システムについて</h4>\n<p>暫定テスト、システムテストともに、<span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"\" data-original-title=\"コンパイルエラー\">CE</span> 以外の結果を得た一番最後の提出のみが順位表に反映される。\n相対評価スコアの計算に用いられる各テストケース毎の全参加者中の最小不満度の算出においても、順位表に反映されている最終提出のみが用いられる。</p>\n<p>順位表に表示されているスコアは相対評価スコアであり、新規提出があるたびに、相対評価スコアが再計算される。\n一方、提出一覧から確認出来る各提出のスコアは各テストケース毎の不満度をそのまま足し合わせたものであり、相対評価スコアは表示されない。\n最新以外の提出の、現在の順位表における相対評価スコアを知るためには、再提出が必要である。\n不正な出力や制限時間超過をした場合、提出一覧から確認出来るスコアは0となるが、順位表には正解したテストケースに対する相対スコアの和が表示されている。</p>\n<h4>実行時間について</h4>\n<p>実行時間には多少のブレが生じます。\nまた、システムテストでは同時に大量の実行を行うため、暫定テストに比べて数%程度実行時間が伸びる現象が確認されています。\nそのため、実行時間制限ギリギリの提出がシステムテストで<span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"実行時間制限超過\">TLE</span>となる可能性があります。\nプログラム内で時間を計測して処理を打ち切るか、実行時間に余裕を持たせるようお願いします。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var> <var>D</var> <var>K</var>\n<var>u_1</var> <var>v_1</var> <var>w_1</var>\n<var>\\vdots</var>\n<var>u_M</var> <var>v_M</var> <var>w_M</var>\n<var>x_1</var> <var>y_1</var>\n<var>\\vdots</var>\n<var>x_N</var> <var>y_N</var>\n</pre>\n\n<ul>\n<li><var>N</var>、<var>M</var>、<var>D</var>、<var>K</var> はそれぞれ、グラフの頂点数、辺数、日数、一日に工事可能な辺数の上限を表す整数値であり、<var>500\\leq N\\leq 1000, 500\\leq M\\leq 3000, 5\\leq D\\leq 30, \\mathrm{ceil}(M/D)&lt; K\\leq 2\\cdot\\mathrm{ceil}(M/D)</var> を満たす。</li>\n<li><var>(u_i,v_i,w_i)</var> は <var>i</var> 番目の辺が頂点 <var>u_i</var> と <var>v_i</var> を重み <var>w_i</var> で結んでいることを表し、<var>1\\leq u_i&lt;v_i\\leq N</var>、<var>1\\leq w_i\\leq 10^6</var> を満たす整数値である。各頂点の次数は2以上であることが保証されている。</li>\n<li><var>(x_i, y_i)</var> は <var>i</var> 番目の頂点の座標を表し、<var>0\\leq x_i,y_i\\leq 1000</var> を満たす整数値である。グラフの生成とビジュアライズに使用されており、不要であれば読み込まなくても構わない。</li>\n<li>与えられるグラフは <a href=\"https://ja.wikipedia.org/wiki/K-%E8%BE%BA%E9%80%A3%E7%B5%90%E3%82%B0%E3%83%A9%E3%83%95\">2-辺連結</a> な平面グラフであり、頂点 <var>i</var> を座標 <var>(x_i, y_i)</var> に配置し、各辺を両端点を結ぶ線分として描画した時、どの二辺も端点以外に共通点を持たないことが保証されている。</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>i</var> 番目の辺を <var>r_i (1\\leq r_i\\leq D)</var> 日目に工事するとしたとき、以下の形式で標準出力に出力せよ。</p>\n<pre><var>r_1</var> <var>r_2</var> <var>\\cdots</var> <var>r_M</var>\n</pre>\n\n<p><a href=\"https://img.atcoder.jp/ahc017/a7a9e57e.html?lang=ja&amp;seed=0&amp;output=10+8+4+8+10+11+3+5+9+7+11+10+10+5+11+2+10+9+7+2+11+4+7+8+6+3+1+10+2+8+6+9+3+6+4+4+4+9+11+2+4+6+3+2+6+2+11+7+7+9+6+9+3+6+4+5+1+7+4+1+5+4+5+7+8+9+9+11+3+5+6+4+8+9+2+8+10+5+9+9+4+2+7+1+10+5+9+8+7+4+3+7+5+8+5+11+5+3+3+4+6+7+6+1+5+7+11+4+4+4+1+10+2+5+11+9+8+1+1+5+6+5+3+6+2+8+9+7+5+7+8+11+1+11+5+7+1+9+10+2+9+8+4+8+2+10+10+7+1+5+7+9+1+2+7+4+6+9+8+4+3+11+6+2+11+10+7+8+11+7+9+10+10+8+3+10+8+5+8+10+6+5+2+8+8+7+9+3+7+4+11+11+11+10+5+4+5+9+6+10+4+1+6+9+11+7+9+1+7+7+11+2+6+8+9+2+3+11+2+5+5+11+4+6+11+1+7+7+4+10+11+10+11+9+6+5+9+8+9+7+11+8+8+10+11+5+9+9+8+2+2+11+10+1+10+5+8+3+3+9+5+1+10+1+6+6+5+9+7+7+4+7+3+7+1+10+7+4+1+6+9+8+8+4+11+2+3+11+11+9+8+5+8+8+4+10+8+10+8+4+7+5+7+10+5+3+7+2+2+3+9+3+3+10+2+5+2+11+11+7+3+4+7+10+4+11+3+1+11+3+5+2+5+6+6+9+10+10+2+1+1+4+11+1+7+9+5+11+3+8+6+9+2+9+3+3+4+9+6+4+9+7+7+11+6+2+8+7+7+10+6+10+6+5+2+3+2+6+2+9+11+10+9+9+10+4+11+6+2+2+9+7+5+11+9+1+1+1+10+1+1+5+10+6+1+8+4+3+10+2+3+3+1+7+5+8+10+4+4+6+5+11+5+4+8+2+7+5+2+11+8+7+10+3+4+8+10+8+1+7+6+8+6+8+3+11+2+5+1+4+7+4+10+6+6+9+3+11+1+3+11+6+9+4+9+10+3+6+8+11+10+1+10+6+4+11+8+4+1+6+5+10+1+2+3+2+9+5+3+6+7+7+6+8+4+6+7+10+9+6+2+4+9+2+4+7+8+11+9+9+3+5+11+6+1+5+6+6+10+5+3+3+10+8+10+11+5+3+11+3+8+3+10+8+5+2+11+3+1+5+5+2+4+5+5+1+4+3+6+2+1+5+5+5+8+1+7+8+8+5+11+7+4+6+9+6+1+2+9+1+4+1+1+10+6+8+6+5+11+10+9+8+1+4+4+5+2+8+2+4+10+9+8+7+1+11+5+5+10+2+1+5+2+9+11+9+9+2+9+7+4+8+10+1+1+7+11+1+10+3+7+11+7+4+9+10+1+7+8+9+5+2+5+7+1+8+9+9+10+5+10+11+5+5+4+9+6+9+2+7+3+2+9+5+9+7+1+5+4+1+6+4+5+4+3+7+2+9+3+11+7+4+6+5+2+3+9+6+6+1+8+6+6+4+11+4+7+2+2+6+7+10+4+6+5+2+3+3+2+2+5+1+11+3+6+4+3+9+7+8+2+10+1+8+3+6+9+1+2+2+1+4+7+2+10+4+6+4+3+10+1+1+4+1+9+9+5+3+8+11+11+7+6+7+9+5+2+11+3+9+6+5+3+5+2+1+11+10+5+11+3+10+8+11+7+9+2+4+6+11+6+10+3+1+2+8+2+5+10+10+8+9+7+11+4+9+1+3+10+5+2+3+7+7+1+6+9+7+7+10+2+7+3+4+6+2+4+3+10+2+5+3+2+1+11+10+3+6+8+7+6+5+4+7+3+3+7+4+2+10+5+3+1+7+3+6+5+6+1+2+5+10+3+11+1+11+5+1+4+11+3+2+4+2+3+2+5+3+9+2+4+3+1+9+10+8+1+7+2+3+1+9+7+1+5+6+10+8+6+6+2+9+6+7+3+1+3+8+4+2+6+7+2+2+7+10+5+1+7+5+8+6+1+11+3+4+3+1+3+4+9+11+10+1+11+9+11+3+8+3+1+11+5+4+2+5+4+2+10+8+7+1+7+7+2+11+1+8+10+6+7+11+9+4+1+10+5+8+3+5+9+10+8+9+11+5+1+3+8+6+3+8+10+8+6+4+10+11+3+3+7+2+1+7+8+6+11+10+1+10+7+11+6+10+8+6+6+3+7+5+3+4+5+6+1+11+11+3+2+8+8+11+3+10+1+3+3+7+4+11+7+10+3+6+10+4+6+6+1+4+10+1+8+11+5+1+2+8+7+6+10+1+11+1+11+1+3+5+5+7+5+11+1+8+5+7+1+6+5+2+8+2+8+1+3+8+6+11+1+7+3+7+3+8+7+2+1+5+5+8+8+8+11+10+6+6+7+11+8+4+9+2+3+6+5+5+10+3+10+2+5+8+9+9+9+4+5+6+8+6+9+9+3+3+6+2+5+8+5+9+7+1+4+5+3+2+9+2+11+3+5+10+8+5+6+9+8+2+3+3+1+6+10+7+11+4+10+9+11+9+8+6+8+7+4+6+3+7+10+6+2+3+9+3+10+11+5+9+5+2+4+2+3+8+5+11+9+3+8+7+8+5+2+2+10+8+10+9+6+3+11+6+7+10+5+11+3+10+1+5+10+11+3+2+7+10+10+6+9+11+2+8+9+8+5+8+9+8+11+1+2+2+7+5+9+2+8+10+11+8+1+1+6+1+9+2+3+11+6+2+10+3+7+8+1+5+10+1+4+2+3+2+1+4+9+10+2+5+9+11+4+1+9+10+1+7+11+11+9+8+7+7+6+2+9+2+8+10+2+8+3+5+10+2+2+3+8+5+8+2+7+2+7+4+5+8+6+9+3+5+8+9+7+6+9+5+6+6+3+3+2+1+9+3+6+10+6+2+7+4+8+2+7+8+4+1+4+10+4+5+7+11+1+8+11+3+2+8+11+1+5+10+10+6+7+3+8+5+8+10+10+4+8+4+10+11+8+5+8+5+6+9+3+9+1+11+5+6+3+9+7+10+5+8+9+10+4+7+3+5+7+6+2+7+1+9+4+1+5+4+4+7+11+4+5+11+6+4+10+11+7+5+2+3+9+2+11+5+11+9+5+4+3+1+5+9+11+8+11+10+6+7+10+8+7+6+4+2+6+9+4+11+9+11+11+4+10+4+5+2+5+5+9+2+5+5+8+2+1+5+4+2+2+1+2+8+9+1+8+5+4+1+6+4+4+5+5+11+10+8+10+8+5+3+7+10+8+6+4+5+1+2+3+9+10+7+7+10+7+9+2+4+7+2+2+5+8+2+11+4+5+3+5+4+7+2+1+9+6+7+2+8+9+6+3+3+5+4+5+3+6+3+7+8+11+2+6+4+4+8+9+6+10+8+11+2+2+10+3+2+9+4+8+9+4+10+1+3+7+1+6+8+4+3+10+11+10+2+10+10+1+10+4+5+11+3+9+9+10+6+1+1+9+2+6+2+11+3+2+5+7+8+9+4+6+3+9+2+4+5+2+9+6+5+4+4+9+2+6+9+4+7+1+2+6+8+7+7+3+1+1+11+9+2+1+4+11+10+11+1+9+11+1+8+9+1+3+8+10+9+11+6+1+8+11+1+7+7+1+4+10+11+1+5+7+10+8+11+8+4+1+9+6+5+3+6+4+6+10+1+9+10+10+9+4+3+9+6+6+11+9+10+11+8+6+10+3+3+6+9+1+2+11+10+9+6+10+10+7+11+7+11+9+9+8+6+11+10+10+6+1+11+6+11+8+4+10+2+4+10+4+5+4+5+6+3+3+11+1+1+1+4+1+2+6+1+9+9+7+5+3+6+10+10+3+9+9+4+3+7+5+6+4+11+8+1+5+1+9+2+5+11+8+6+4+5+4+9+5+2+1+7+11+5+3+4+9+1+11+11+10+10+3+9+8+4+4+11+8+9+3+3+4+1+3+5+10+9+6+2+8+2+11+2+9+3+7+7+2+7+3+2+6+11+7+7+11+2+10+5+5+6+7+10+6+9+9+4+10+7+7+8+1+11+8+6+3+8+10+7+7+7+1+11+2+2+3+4+7+4+8+9+7+6+8+4+6+6+10+3+7+6+2+10+8+11+7+10+4+10+6+8+4+8+11+10+4+9+2+2+4+6+7+4+6+10+11+2+6+10+7+3+4+6+11+4+8+4+1+7+9+9+8+5+2+6+4+7+10+4+5+1+1+3+1+3+6+3+1+1+9+11+8+3+6+1+1+3+5+2+5+4+4+4+3+11+1+2+3+5+6+1+7+1+10+2+7+3+2+4+4+11+8+6+2+3+10+1+7+3+3+7+11+7+2+4+10+4+2+10+7+2+4+5+9+4+11+6+9+8+8+6+11+3+5+8+2+10+4+5+11+2+11+11+10+11+3+9+9+9+9+1+5+11+4+1+6+7+11+8+6+3+8+9+6+11+11+6+10+1+11+5+3+7+6+2+4+8+7+4+6+7+10+7+6+6+3+5+1+7+8+4+11+9+7+8+6+3+11+10+5+9+2+3+7+7+3+11+9+7+7+7+1+7+7+1+1+3+11+9+6+11+3+9+3+6+3+8+10+9+1+2+10+6+10+8+1+7+3+3+6+8+1+7+4+4+3+8+1+4+4+11+3+5+11+8+11+10+1+1+8+2+5+9+11+9+1+4+10+4+6+5+8+5+4+3+9+6+6+5+8+7+1+10+6+8+1+1+8+2+9+4+1+5+1+11+11+8+2+1+9+1+3+2+4+1+11+1+2+10+6+2+1+3+8+1+6+4+8+4+9+2+1+8+11+2+8+10+5+10+6+5+4+8+9+1+3+8+2+11+8+5+2+7+6+9+1+11+4+2+7+10+7+2+3+10+8+1+4+8+7+4+10+7+11+5+1+5+4+11+2+5+3+9+9+8+7+4+11+1+11+7+6+4+6+7+9+2+4+6+10+11+7+9+9+2+7+4+5+11+10+2+1+10+10+9+9+9+5+11+1+3+10+10+7+5+11+1+10+4+3+3+3+11+8+11+4+5+8+9+8+1+6+11+6+2+6+8+3+4+8+6+4+2+2+10+10%0D%0A\">例を見る</a></p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>入力生成方法</h3><p></p><details>\n<var>L</var> 以上 <var>U</var> 以下の整数値を一様ランダムに生成する関数を <var>\\mathrm{rand}(L,U)</var> で表す。<p></p>\n<h4>グラフの生成</h4>\n<p>頂点数 <var>N</var> を <var>N=\\mathrm{rand}(500,1000)</var> により生成する。\n中心 <var>(500,500)</var>、半径 <var>500</var> の円に含まれる格子点からランダムに点を一つずつ、合計 <var>N</var> 個選んで <var>(x_1,y_1),\\cdots,(x_N,y_N)</var> とする。\nただし、既に選んだ点とのユークリッド距離が <var>10</var> 以下の場合は選び直す。\nこれらの点を頂点集合 <var>V</var> とする平面グラフ <var>(V,E)</var> を以下のように作成する。</p>\n<p>まず、<a href=\"https://ja.wikipedia.org/wiki/%E3%83%89%E3%83%AD%E3%83%8D%E3%83%BC%E5%9B%B3\">ドロネー三角形分割</a>を計算し、三角形分割の辺を <var>E</var> とする。\n<var>0</var> 以上 <var>0.75</var> 未満の実数 <var>p</var> をランダムに生成する。\n各辺 <var>e\\in E</var> についてランダムな順に、\n「両端点の次数が共に <var>4</var> 以上であるならば確率 <var>p</var> で <var>E</var> から <var>e</var> を取り除く」という操作を行う。\n全ての辺について処理を終えた後、操作後に残った <var>E</var> に対してグラフ <var>(V,E)</var> が 2-辺連結でないならば、<var>E</var> を元に戻して <var>p</var> の生成からやり直す。\n各辺 <var>(u,v)</var> の重みは、<var>\\mathrm{round}(10^3\\times \\sqrt{(x_u-x_v)^2+(y_u-y_v)^2})</var> により決定する。</p>\n<h4>D, K の生成</h4>\n<p><var>D=\\mathrm{rand}(5, 30)</var> と生成する。\n<var>K'=\\mathrm{ceil}(M/D)</var> とし、<var>K=\\mathrm{rand}(K'+1,2K')</var> と生成する。</p>\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>ツール(入力ジェネレータ・ビジュアライザ)</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc017/a7a9e57e.html?lang=ja\">Web版</a>: Chromeにて動作確認をしております。Firefoxではスコアが表示されません。</li>\n<li><a href=\"https://img.atcoder.jp/ahc017/a7a9e57e.zip\">ローカル版</a>: 使用するには<a href=\"https://www.rust-lang.org/ja\">Rust言語</a>のコンパイル環境をご用意下さい。<ul>\n<li><a href=\"https://img.atcoder.jp/ahc017/a7a9e57e_windows.zip\">Windows用のコンパイル済みバイナリ</a>: Rust言語の環境構築が面倒な方は代わりにこちらをご利用下さい。</li>\n</ul>\n</li>\n</ul>\n<p><font color=\"red\">\nコンテスト期間中に、ビジュアライズ結果の共有や、解法・考察に関する言及は禁止されています。ご注意下さい。\n</font></p></section>\n</div>\n</div>\n</span>","en":"<span class=\"lang-en\">\n\n<div class=\"part\">\n<section>\n<h3>Story</h3><p>Takahashi City is planning to repair its dilapidated roads.\nThe city's road network can be represented as a planar undirected graph with intersections as vertices and the roads between them as edges.\nBecause roads under repair are closed to traffic, citizens must take detours to reach their destinations, causing frustration.\nGiven the maximum number of edges that can be repaired per day and the maximum number of days to complete all the repairs, please plan which edges to repair on which day so as to cause as little frustration as possible.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Given an edge-weighted undirected planar graph with <var>N</var> vertices, we want to perform repair work on each edge exactly once in <var>D</var> days.\nWe can complete the repair work on each edge in a single day, and at most <var>K</var> edges can be repaired simultaneously on the same day.</p>\n<p>Edges that are not under repair work are passable in both directions, and the weight of an edge represents the distance it takes to move on that edge.\nLet <var>d(i,j)</var> be the shortest distance from vertex <var>i</var> to vertex <var>j</var> in the original graph.\nLet <var>d_k(i,j)</var> be the shortest distance from vertex <var>i</var> to vertex <var>j</var> in the graph obtained by removing the edges to be repaired on day <var>k</var> from the original graph.\nIf <var>j</var> is unreachable from <var>i</var>, we define <var>d_k(i,j)=10^9</var>.\nThe frustration level <var>f_k</var> for the repair work on day <var>k</var> is defined as the expected increase in the shortest distance between two different vertices, as follows.\n\\[\n    f_k = \\frac{\\sum_{i\\neq j}(d_k(i,j)-d(i,j))}{N(N-1)}\n\\]</p>\n<p>Using the average of the frustration levels for each day, the frustration level for the whole repair work is defined as\n\\[\n    \\mathrm{round}\\left(10^3\\times \\frac{1}{D}\\sum_{k=1}^D f_k\\right)\n\\]\nFind a repair schedule that causes as little frustration as possible.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Scoring</h3><p>For each test case, we compute the <font color=\"red\"><strong>relative score</strong></font> <var>\\mathrm{round}(10^9\\times \\frac{\\mathrm{MIN}}{\\mathrm{YOUR}})</var>, where YOUR is your frustration level and MIN is the lowest frustration level among all competitors obtained on that test case. The score of the submission is the sum of the relative scores.</p>\n<p>The final ranking will be determined by the system test with more inputs which will be run after the contest is over.\nIn both the provisional/system test, if your submission produces illegal output or exceeds the time limit for some test cases, only the score for those test cases will be zero, and your submission will be excluded from the MIN calculation for those test cases.</p>\n<p>The system test will be performed only for <font color=\"red\"><strong>the last submission which received a result other than <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"\" data-original-title=\"Compilation Error\">CE</span> </strong></font>.\nBe careful not to make a mistake in the final submission.</p>\n<h4>Number of test cases</h4>\n<ul>\n<li>Provisional test: 50</li>\n<li>System test: 2000. We will publish <a href=\"https://img.atcoder.jp/ahc017/seeds.txt\">seeds.txt</a> (sha256=0522b6c3da4e413908209488368988ebce3b3809c0d9278dc9adaf804896fa23) after the contest is over.</li>\n</ul>\n<h4>About Relative Evaluation System</h4>\n<p>In both the provisional/system test, the standings will be calculated using only the last submission which received a result other than <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"\" data-original-title=\"Compilation Error\">CE</span>.\nOnly the last submissions are used to calculate the MIN for each test case when calculating the relative scores.</p>\n<p>The scores shown in the standings are relative, and whenever a new submission arrives, all relative scores are recalculated.\nOn the other hand, the score for each submission shown on the submissions page is the sum of the frustration levels for each test case, and the relative scores are not shown.\nIn order to know the relative score of submission other than the latest one in the current standings, you need to resubmit it.\nIf your submission produces illegal output or exceeds the time limit for some test cases, the score shown on the submissions page will be 0, but the standings show the sum of the relative scores for the test cases that were answered correctly.</p>\n<h4>About execution time</h4>\n<p>Execution time may vary slightly from run to run.\nIn addition, since system tests simultaneously perform a large number of executions, it has been observed that execution time increases by several percent compared to provisional tests.\nFor these reasons, submissions that are very close to the time limit may result in <span class=\"label label-warning\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Time Limit Exceeded\">TLE</span> in the system test.\nPlease measure the execution time in your program to terminate the process, or have enough margin in the execution time.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>D</var> <var>K</var>\n<var>u_1</var> <var>v_1</var> <var>w_1</var>\n<var>\\vdots</var>\n<var>u_M</var> <var>v_M</var> <var>w_M</var>\n<var>x_1</var> <var>y_1</var>\n<var>\\vdots</var>\n<var>x_N</var> <var>y_N</var>\n</pre>\n\n<ul>\n<li><var>N</var>, <var>M</var>, <var>D</var>, and <var>K</var> are integers representing the number of vertices, the number of edges, the maximum number of days, and the maximum number of edges that can be repaired per day, respectively. These satisfy <var>500\\leq N\\leq 1000</var>, <var>500\\leq M\\leq 3000</var>, <var>5\\leq D\\leq 30</var>, and <var>\\mathrm{ceil}(M/D)&lt; K\\leq 2\\cdot\\mathrm{ceil}(M/D)</var>.</li>\n<li><var>u_i</var>, <var>v_i</var>, and <var>w_i</var> are integers satisfying <var>1\\leq u_i&lt;v_i\\leq N</var> and <var>1\\leq w_i\\leq 10^6</var>, and indicate that the <var>i</var>-th edge connects vertices <var>u_i</var> and <var>v_i</var> with weight <var>w_i</var>. The degree of each vertex is guaranteed to be at least 2.</li>\n<li><var>(x_i, y_i)</var> represents the coordinates of the <var>i</var>-th vertex, which are integers satisfying <var>0\\leq x_i,y_i\\leq 1000</var>. These are used to generate and visualize the graph, and you may skip reading them if you don't need them.</li>\n<li>It is guaranteed that the given graph is a <a href=\"https://en.wikipedia.org/wiki/K-edge-connected_graph\">2-edge connected</a> planar graph such that if vertex <var>i</var> is placed at coordinates <var>(x_i, y_i)</var> and the edges are drawn as line segments connecting the endpoints, every pair of edges has no common points other than the endpoints.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Let <var>r_i (1\\leq r_i\\leq D)</var> be the day on which the <var>i</var>-th edge is to be repaired.\nThen, output to Standard Output in the following format.</p>\n<pre><var>r_1</var> <var>r_2</var> <var>\\cdots</var> <var>r_M</var>\n</pre>\n\n<p><a href=\"https://img.atcoder.jp/ahc017/a7a9e57e.html?lang=en&amp;seed=0&amp;output=10+8+4+8+10+11+3+5+9+7+11+10+10+5+11+2+10+9+7+2+11+4+7+8+6+3+1+10+2+8+6+9+3+6+4+4+4+9+11+2+4+6+3+2+6+2+11+7+7+9+6+9+3+6+4+5+1+7+4+1+5+4+5+7+8+9+9+11+3+5+6+4+8+9+2+8+10+5+9+9+4+2+7+1+10+5+9+8+7+4+3+7+5+8+5+11+5+3+3+4+6+7+6+1+5+7+11+4+4+4+1+10+2+5+11+9+8+1+1+5+6+5+3+6+2+8+9+7+5+7+8+11+1+11+5+7+1+9+10+2+9+8+4+8+2+10+10+7+1+5+7+9+1+2+7+4+6+9+8+4+3+11+6+2+11+10+7+8+11+7+9+10+10+8+3+10+8+5+8+10+6+5+2+8+8+7+9+3+7+4+11+11+11+10+5+4+5+9+6+10+4+1+6+9+11+7+9+1+7+7+11+2+6+8+9+2+3+11+2+5+5+11+4+6+11+1+7+7+4+10+11+10+11+9+6+5+9+8+9+7+11+8+8+10+11+5+9+9+8+2+2+11+10+1+10+5+8+3+3+9+5+1+10+1+6+6+5+9+7+7+4+7+3+7+1+10+7+4+1+6+9+8+8+4+11+2+3+11+11+9+8+5+8+8+4+10+8+10+8+4+7+5+7+10+5+3+7+2+2+3+9+3+3+10+2+5+2+11+11+7+3+4+7+10+4+11+3+1+11+3+5+2+5+6+6+9+10+10+2+1+1+4+11+1+7+9+5+11+3+8+6+9+2+9+3+3+4+9+6+4+9+7+7+11+6+2+8+7+7+10+6+10+6+5+2+3+2+6+2+9+11+10+9+9+10+4+11+6+2+2+9+7+5+11+9+1+1+1+10+1+1+5+10+6+1+8+4+3+10+2+3+3+1+7+5+8+10+4+4+6+5+11+5+4+8+2+7+5+2+11+8+7+10+3+4+8+10+8+1+7+6+8+6+8+3+11+2+5+1+4+7+4+10+6+6+9+3+11+1+3+11+6+9+4+9+10+3+6+8+11+10+1+10+6+4+11+8+4+1+6+5+10+1+2+3+2+9+5+3+6+7+7+6+8+4+6+7+10+9+6+2+4+9+2+4+7+8+11+9+9+3+5+11+6+1+5+6+6+10+5+3+3+10+8+10+11+5+3+11+3+8+3+10+8+5+2+11+3+1+5+5+2+4+5+5+1+4+3+6+2+1+5+5+5+8+1+7+8+8+5+11+7+4+6+9+6+1+2+9+1+4+1+1+10+6+8+6+5+11+10+9+8+1+4+4+5+2+8+2+4+10+9+8+7+1+11+5+5+10+2+1+5+2+9+11+9+9+2+9+7+4+8+10+1+1+7+11+1+10+3+7+11+7+4+9+10+1+7+8+9+5+2+5+7+1+8+9+9+10+5+10+11+5+5+4+9+6+9+2+7+3+2+9+5+9+7+1+5+4+1+6+4+5+4+3+7+2+9+3+11+7+4+6+5+2+3+9+6+6+1+8+6+6+4+11+4+7+2+2+6+7+10+4+6+5+2+3+3+2+2+5+1+11+3+6+4+3+9+7+8+2+10+1+8+3+6+9+1+2+2+1+4+7+2+10+4+6+4+3+10+1+1+4+1+9+9+5+3+8+11+11+7+6+7+9+5+2+11+3+9+6+5+3+5+2+1+11+10+5+11+3+10+8+11+7+9+2+4+6+11+6+10+3+1+2+8+2+5+10+10+8+9+7+11+4+9+1+3+10+5+2+3+7+7+1+6+9+7+7+10+2+7+3+4+6+2+4+3+10+2+5+3+2+1+11+10+3+6+8+7+6+5+4+7+3+3+7+4+2+10+5+3+1+7+3+6+5+6+1+2+5+10+3+11+1+11+5+1+4+11+3+2+4+2+3+2+5+3+9+2+4+3+1+9+10+8+1+7+2+3+1+9+7+1+5+6+10+8+6+6+2+9+6+7+3+1+3+8+4+2+6+7+2+2+7+10+5+1+7+5+8+6+1+11+3+4+3+1+3+4+9+11+10+1+11+9+11+3+8+3+1+11+5+4+2+5+4+2+10+8+7+1+7+7+2+11+1+8+10+6+7+11+9+4+1+10+5+8+3+5+9+10+8+9+11+5+1+3+8+6+3+8+10+8+6+4+10+11+3+3+7+2+1+7+8+6+11+10+1+10+7+11+6+10+8+6+6+3+7+5+3+4+5+6+1+11+11+3+2+8+8+11+3+10+1+3+3+7+4+11+7+10+3+6+10+4+6+6+1+4+10+1+8+11+5+1+2+8+7+6+10+1+11+1+11+1+3+5+5+7+5+11+1+8+5+7+1+6+5+2+8+2+8+1+3+8+6+11+1+7+3+7+3+8+7+2+1+5+5+8+8+8+11+10+6+6+7+11+8+4+9+2+3+6+5+5+10+3+10+2+5+8+9+9+9+4+5+6+8+6+9+9+3+3+6+2+5+8+5+9+7+1+4+5+3+2+9+2+11+3+5+10+8+5+6+9+8+2+3+3+1+6+10+7+11+4+10+9+11+9+8+6+8+7+4+6+3+7+10+6+2+3+9+3+10+11+5+9+5+2+4+2+3+8+5+11+9+3+8+7+8+5+2+2+10+8+10+9+6+3+11+6+7+10+5+11+3+10+1+5+10+11+3+2+7+10+10+6+9+11+2+8+9+8+5+8+9+8+11+1+2+2+7+5+9+2+8+10+11+8+1+1+6+1+9+2+3+11+6+2+10+3+7+8+1+5+10+1+4+2+3+2+1+4+9+10+2+5+9+11+4+1+9+10+1+7+11+11+9+8+7+7+6+2+9+2+8+10+2+8+3+5+10+2+2+3+8+5+8+2+7+2+7+4+5+8+6+9+3+5+8+9+7+6+9+5+6+6+3+3+2+1+9+3+6+10+6+2+7+4+8+2+7+8+4+1+4+10+4+5+7+11+1+8+11+3+2+8+11+1+5+10+10+6+7+3+8+5+8+10+10+4+8+4+10+11+8+5+8+5+6+9+3+9+1+11+5+6+3+9+7+10+5+8+9+10+4+7+3+5+7+6+2+7+1+9+4+1+5+4+4+7+11+4+5+11+6+4+10+11+7+5+2+3+9+2+11+5+11+9+5+4+3+1+5+9+11+8+11+10+6+7+10+8+7+6+4+2+6+9+4+11+9+11+11+4+10+4+5+2+5+5+9+2+5+5+8+2+1+5+4+2+2+1+2+8+9+1+8+5+4+1+6+4+4+5+5+11+10+8+10+8+5+3+7+10+8+6+4+5+1+2+3+9+10+7+7+10+7+9+2+4+7+2+2+5+8+2+11+4+5+3+5+4+7+2+1+9+6+7+2+8+9+6+3+3+5+4+5+3+6+3+7+8+11+2+6+4+4+8+9+6+10+8+11+2+2+10+3+2+9+4+8+9+4+10+1+3+7+1+6+8+4+3+10+11+10+2+10+10+1+10+4+5+11+3+9+9+10+6+1+1+9+2+6+2+11+3+2+5+7+8+9+4+6+3+9+2+4+5+2+9+6+5+4+4+9+2+6+9+4+7+1+2+6+8+7+7+3+1+1+11+9+2+1+4+11+10+11+1+9+11+1+8+9+1+3+8+10+9+11+6+1+8+11+1+7+7+1+4+10+11+1+5+7+10+8+11+8+4+1+9+6+5+3+6+4+6+10+1+9+10+10+9+4+3+9+6+6+11+9+10+11+8+6+10+3+3+6+9+1+2+11+10+9+6+10+10+7+11+7+11+9+9+8+6+11+10+10+6+1+11+6+11+8+4+10+2+4+10+4+5+4+5+6+3+3+11+1+1+1+4+1+2+6+1+9+9+7+5+3+6+10+10+3+9+9+4+3+7+5+6+4+11+8+1+5+1+9+2+5+11+8+6+4+5+4+9+5+2+1+7+11+5+3+4+9+1+11+11+10+10+3+9+8+4+4+11+8+9+3+3+4+1+3+5+10+9+6+2+8+2+11+2+9+3+7+7+2+7+3+2+6+11+7+7+11+2+10+5+5+6+7+10+6+9+9+4+10+7+7+8+1+11+8+6+3+8+10+7+7+7+1+11+2+2+3+4+7+4+8+9+7+6+8+4+6+6+10+3+7+6+2+10+8+11+7+10+4+10+6+8+4+8+11+10+4+9+2+2+4+6+7+4+6+10+11+2+6+10+7+3+4+6+11+4+8+4+1+7+9+9+8+5+2+6+4+7+10+4+5+1+1+3+1+3+6+3+1+1+9+11+8+3+6+1+1+3+5+2+5+4+4+4+3+11+1+2+3+5+6+1+7+1+10+2+7+3+2+4+4+11+8+6+2+3+10+1+7+3+3+7+11+7+2+4+10+4+2+10+7+2+4+5+9+4+11+6+9+8+8+6+11+3+5+8+2+10+4+5+11+2+11+11+10+11+3+9+9+9+9+1+5+11+4+1+6+7+11+8+6+3+8+9+6+11+11+6+10+1+11+5+3+7+6+2+4+8+7+4+6+7+10+7+6+6+3+5+1+7+8+4+11+9+7+8+6+3+11+10+5+9+2+3+7+7+3+11+9+7+7+7+1+7+7+1+1+3+11+9+6+11+3+9+3+6+3+8+10+9+1+2+10+6+10+8+1+7+3+3+6+8+1+7+4+4+3+8+1+4+4+11+3+5+11+8+11+10+1+1+8+2+5+9+11+9+1+4+10+4+6+5+8+5+4+3+9+6+6+5+8+7+1+10+6+8+1+1+8+2+9+4+1+5+1+11+11+8+2+1+9+1+3+2+4+1+11+1+2+10+6+2+1+3+8+1+6+4+8+4+9+2+1+8+11+2+8+10+5+10+6+5+4+8+9+1+3+8+2+11+8+5+2+7+6+9+1+11+4+2+7+10+7+2+3+10+8+1+4+8+7+4+10+7+11+5+1+5+4+11+2+5+3+9+9+8+7+4+11+1+11+7+6+4+6+7+9+2+4+6+10+11+7+9+9+2+7+4+5+11+10+2+1+10+10+9+9+9+5+11+1+3+10+10+7+5+11+1+10+4+3+3+3+11+8+11+4+5+8+9+8+1+6+11+6+2+6+8+3+4+8+6+4+2+2+10+10%0D%0A\">Show example</a></p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Input Generation</h3><p></p><details>\nLet <var>\\mathrm{rand}(L,U)</var> be a function that generates a uniform random integer between <var>L</var> and <var>U</var>, inclusive.<p></p>\n<h4>Generation of the graph</h4>\n<p>The number of vertices <var>N</var> is generated by <var>N=\\mathrm{rand}(500,1000)</var>.\nRandomly select <var>N</var> points <var>(x_1,y_1),\\cdots,(x_N,y_N)</var> from the lattice points contained in a circle with center <var>(500,500)</var> and radius <var>500</var>.\nIf the Euclidean distance between <var>(x_i,y_i)</var> and an already selected point <var>(x_j,y_j)</var> (<var>j&lt;i</var>) is less than or equal to <var>10</var>, we select <var>(x_i,y_i)</var> again.\nA planar graph <var>(V,E)</var> with these points as vertex set <var>V</var> is constructed as follows.</p>\n<p>First, compute <a href=\"https://en.wikipedia.org/wiki/Delaunay_triangulation\">Delaunay triangulation</a> and set <var>E</var> as the set of edges of the triangulation.\nGenerate a random real value <var>p</var> between <var>0</var> and <var>0.75</var>.\nFor each edge <var>e\\in E</var> in random order, perform the following operation: remove <var>e</var> from <var>E</var> with probability <var>p</var> if the degree of both endpoints are at least <var>4</var>.\nAfter completing the process for all edges, if the graph <var>(V,E)</var> is not 2-edge connected, then we restore <var>E</var> and we redo the process from generating <var>p</var>.\nThe weight of each edge <var>(u,v)</var> is determined by <var>\\mathrm{round}(10^3\\times \\sqrt{(x_u-x_v)^2+(y_u-y_v)^2})</var>.</p>\n<h4>Generation of D and K</h4>\n<p><var>D</var> is generated by <var>\\mathrm{rand}(5, 30)</var>.\nLet <var>K'=\\mathrm{ceil}(M/D)</var>.\n<var>K</var> is generated by <var>\\mathrm{rand}(K'+1,2K')</var>.</p>\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Tools (Input generator and visualizer)</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc017/a7a9e57e.html?lang=en\">Web version</a>: Chrome is recommended. Firefox will not display the score.</li>\n<li><a href=\"https://img.atcoder.jp/ahc017/a7a9e57e.zip\">Local version</a>: You need a compilation environment of <a href=\"https://www.rust-lang.org/\">Rust language</a>.<ul>\n<li><a href=\"https://img.atcoder.jp/ahc017/a7a9e57e_windows.zip\">Pre-compiled binary for Windows</a>: If you are not familiar with the Rust language environment, please use this instead.</li>\n</ul>\n</li>\n</ul>\n<p><font color=\"red\">\nPlease be aware that sharing visualization results or discussing solutions/ideas during the contest is prohibited.\n</font></p></section>\n</div>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/ahc017/tasks/ahc017_a"}