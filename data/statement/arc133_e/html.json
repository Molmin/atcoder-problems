{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>800</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>整数 <var>N,M,V,A</var> が与えられます．\n次のような操作を考えます．</p>\n<ul>\n<li><var>1</var> 以上 <var>V</var> 以下の整数からなる長さ <var>N</var> の整数列 <var>x=(x_1,x_2,\\cdots,x_N)</var> を選ぶ．</li>\n<li><var>1</var> 以上 <var>V</var> 以下の整数からなる長さ <var>M</var> の整数列 <var>y=(y_1,y_2,\\cdots,y_M)</var> を選ぶ．</li>\n<li>変数 <var>a</var> を用意する．最初，<var>a=A</var> とする．</li>\n<li><var>i=0,1,\\cdots,N \\times M-1</var> に対して，以下の動作を行う．<ul>\n<li><var>a</var> の値を，<var>a,x_{(i \\bmod N)+1},y_{(i \\bmod M)+1}</var> の中央値で置き換える．</li>\n</ul>\n</li>\n<li>最終的な <var>a</var> の値を出力する．</li>\n</ul>\n<p>整数列 <var>x,y</var> としてありうるものをすべて試したとき，操作によって出力される値の総和を <var>998244353</var> で割った余りを求めてください．</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N,M \\leq 200000</var></li>\n<li><var>1 \\leq A \\leq V \\leq 200000</var></li>\n<li>入力される値はすべて整数である</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる．</p>\n<pre><var>N</var> <var>M</var> <var>V</var> <var>A</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ．</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2 1 2 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>11\n</pre>\n\n<p>例えば，<var>x=(1,2),y=(2)</var> の時，操作の様子は以下のようになります．</p>\n<ul>\n<li><var>a=1</var> と初期化する．</li>\n<li><var>i=1</var>: <var>a</var> の値を，<var>a(=1),x_1(=1),y_1(=2)</var> の中央値，すなわち <var>1</var> で置き換える．</li>\n<li><var>i=2</var>: <var>a</var> の値を，<var>a(=1),x_2(=2),y_1(=2)</var> の中央値，すなわち <var>2</var> で置き換える．</li>\n<li><var>a(=2)</var> を出力．</li>\n</ul>\n<p>最終的に <var>2</var> が出力されるのは，<var>(x=(1,2),y=(2))</var>，<var>(x=(2,1),y=(2))</var>，<var>(x=(2,2),y=(2))</var> の <var>3</var> ケースで，それ以外の <var>5</var> ケースではすべて <var>1</var> が出力されます．\nよって求める答えは，<var>2 \\times 3 + 1\\times 5=11</var> です．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>2 2 5 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>2019\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>2100 2300 2201 2022\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>407723438\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>800</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Given are integers <var>N</var>, <var>M</var>, <var>V</var>, and <var>A</var>.\nConsider the following procedure.</p>\n<ul>\n<li>Choose a sequence of <var>N</var> integers between <var>1</var> and <var>V</var> (inclusive): <var>x=(x_1,x_2,\\cdots,x_N)</var>.</li>\n<li>Choose a sequence of <var>M</var> integers between <var>1</var> and <var>V</var> (inclusive): <var>y=(y_1,y_2,\\cdots,y_M)</var>.</li>\n<li>Let <var>a</var> be a variable and initialize it with <var>a=A</var>.</li>\n<li>For each <var>i=0,1,\\cdots,N \\times M-1</var>, do the following.<ul>\n<li>Replace the value of <var>a</var> with the median of <var>a,x_{(i \\bmod N)+1},y_{(i \\bmod M)+1}</var>.</li>\n</ul>\n</li>\n<li>Print the final value of <var>a</var>.</li>\n</ul>\n<p>Consider doing this procedure with every possible pair of sequences <var>x,y</var>. Find the sum of the values that will be printed, modulo <var>998244353</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N,M \\leq 200000</var></li>\n<li><var>1 \\leq A \\leq V \\leq 200000</var></li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>V</var> <var>A</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2 1 2 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>11\n</pre>\n\n<p>For example, when <var>x=(1,2),y=(2)</var>, the procedure goes as follows.</p>\n<ul>\n<li>Initialize <var>a</var> with <var>a=1</var>.</li>\n<li>For <var>i=1</var>: replace the value of <var>a</var> with the median of <var>a(=1),x_1(=1),y_1(=2)</var>, which is <var>1</var>.</li>\n<li>For <var>i=2</var>: replace the value of <var>a</var> with the median of <var>a(=1),x_2(=2),y_1(=2)</var>, which is <var>2</var>.</li>\n<li>Print <var>a(=2)</var>.</li>\n</ul>\n<p>There are three cases where <var>2</var> will be printed: <var>(x=(1,2),y=(2))</var>, <var>(x=(2,1),y=(2))</var>, <var>(x=(2,2),y=(2))</var>. In the other five cases, <var>1</var> will be printed.\nTherefore, the answer is <var>2 \\times 3 + 1\\times 5=11</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>2 2 5 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>2019\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>2100 2300 2201 2022\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>407723438\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc133/tasks/arc133_e"}