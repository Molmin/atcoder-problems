{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>550</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>部屋 <var>1</var>, 部屋 <var>2</var>, <var>\\ldots</var>, 部屋 <var>N</var> と番号づけられた <var>N</var> 個の部屋に人が <var>1</var> 人ずつ住んでおり、\nまた、いくつかの相異なる <var>2</var> つの部屋の間は通路によって結ばれています。\n通路は <var>M</var> 本あり、<var>i</var> 本目の通路は部屋 <var>U_i</var> と部屋 <var>V_i</var> を結んでおり、長さは <var>W_i</var> です。</p>\n<p>ある日(これを <var>0</var> 日目とします)の夜に、部屋 <var>A_1,A_2,\\ldots, A_K</var> に住んでいる <var>K</var> 人がウイルスに(新しく)感染してしまいました。\nさらにその後の <var>D</var> 日間で <var>i</var> 日目 <var>(1\\leq i\\leq D)</var> には次のように感染が広がりました。</p>\n<blockquote>\n<p><var>(i-1)</var> 日目の夜の時点で感染していた人は、<var>i</var> 日目の夜の時点でも感染していた。<br>\nそうでない人については、<var>(i-1)</var> 日目の夜の時点で感染していた人の住んでいる部屋のうちの少なくとも <var>1</var> つから 距離 <var>X_i</var> 以内の部屋に住んでいた時かつその時に限り、新しく感染した。\nここで、部屋 <var>P,Q</var> の間の距離は、部屋 <var>P</var> から 部屋 <var>Q</var> まで通路のみを使って移動する時に通る通路の長さの総和としてあり得る最小値として定義される。\nただし、部屋 <var>P</var> から 部屋 <var>Q</var> へ通路のみを使って移動する事ができない時、距離は <var>10^{100}</var> とする。</p>\n</blockquote>\n<p>各 <var>i</var> (<var>1\\leq i\\leq N</var>) について、部屋 <var>i</var> に住んでいる人がそれぞれ何日目の夜に(新しく)感染したか出力してください。ただし、<var>D</var> 日目の夜の時点で感染していない場合は <var>-1</var> を出力してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N\\leq 3\\times 10^5</var></li>\n<li><var>0 \\leq M\\leq 3\\times 10^5</var></li>\n<li><var>1 \\leq U_i &lt; V_i\\leq N</var></li>\n<li><var>(U_i,V_i)</var> はすべて異なる。</li>\n<li><var>1\\leq W_i\\leq 10^9</var> </li>\n<li><var>1 \\leq K\\leq N</var></li>\n<li><var>1\\leq A_1&lt;A_2&lt;\\cdots&lt;A_K\\leq N</var></li>\n<li><var>1 \\leq D\\leq 3\\times 10^5</var></li>\n<li><var>1\\leq X_i\\leq 10^9</var></li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>U_1</var> <var>V_1</var> <var>W_1</var>\n<var>U_2</var> <var>V_2</var> <var>W_2</var>\n<var>\\vdots</var>\n<var>U_M</var> <var>V_M</var> <var>W_M</var>\n<var>K</var>\n<var>A_1</var> <var>A_2</var> <var>\\ldots</var> <var>A_K</var>\n<var>D</var>\n<var>X_1</var> <var>X_2</var> <var>\\ldots</var> <var>X_D</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>N</var> 行出力せよ。<br>\n<var>i</var> 行目 <var>(1\\leq i\\leq N)</var> には、部屋 <var>i</var> に住んでいる人が何日目の夜に(新しく)感染したか出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 4\n1 2 2\n2 3 1\n2 4 3\n3 4 2\n1\n1\n2\n3 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>0\n1\n1\n2\n</pre>\n<p>次のように感染は広がります。</p>\n<ul>\n<li><var>0</var> 日目の夜、部屋 <var>1</var> に住んでいる人が感染する。</li>\n<li>部屋 <var>1</var> と部屋 <var>2,3,4</var> の間の距離はそれぞれ <var>2,3,5</var> である。よって、<var>X_1=3</var> であるから、<var>1</var> 日目の夜、部屋 <var>2,3</var> に住んでいる人が新しく感染する。</li>\n<li>部屋 <var>3</var> と部屋 <var>4</var> の間の距離は <var>2</var> である。よって、<var>X_2=3</var> であるから、<var>2</var> 日目の夜、部屋 <var>4</var> に住んでいる人も感染する。</li>\n</ul>\n<p>よって、部屋 <var>1,2,3,4</var> に住んでいる人はそれぞれ <var>0,1,1,2</var> 日目に新しく感染したため、<var>0,1,1,2</var> をこの順で各行に出力します。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>7 7\n1 2 2\n2 3 3\n3 4 1\n4 5 1\n5 6 3\n3 7 1\n4 7 1\n2\n1 6\n2\n2 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n1\n2\n-1\n2\n0\n-1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>5 1\n1 2 5\n2\n1 3\n3\n3 7 5\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>0\n2\n0\n-1\n-1\n</pre>\n<p>どの <var>2</var> つの部屋の間も通路のみを使って移動できるとは限らないことに注意してください。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>550</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>N</var> rooms numbered <var>1</var>, <var>2</var>, <var>\\ldots</var>, <var>N</var>, each with one person living in it, and <var>M</var> corridors connecting two different rooms. The <var>i</var>-th corridor connects room <var>U_i</var> and room <var>V_i</var> with a length of <var>W_i</var>.</p>\n<p>One day (we call this day <var>0</var>), the <var>K</var> people living in rooms <var>A_1, A_2, \\ldots, A_K</var> got (newly) infected with a virus. Furthermore, on the <var>i</var>-th of the following <var>D</var> days <var>(1\\leq i\\leq D)</var>, the infection spread as follows.</p>\n<blockquote>\n<p>People who were infected at the end of the night of day <var>(i-1)</var> remained infected at the end of the night of day <var>i</var>.<br>\nFor those who were not infected, they were newly infected if and only if they were living in a room within a distance of <var>X_i</var> from at least one room where an infected person was living at the end of the night of day <var>(i-1)</var>.\nHere, the distance between rooms <var>P</var> and <var>Q</var> is defined as the minimum possible sum of the lengths of the corridors when moving from room <var>P</var> to room <var>Q</var> using only corridors.\nIf it is impossible to move from room <var>P</var> to room <var>Q</var> using only corridors, the distance is set to <var>10^{100}</var>.</p>\n</blockquote>\n<p>For each <var>i</var> (<var>1\\leq i\\leq N</var>), print the day on which the person living in room <var>i</var> was newly infected. If they were not infected by the end of the night of day <var>D</var>, print <var>-1</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N\\leq 3\\times 10^5</var></li>\n<li><var>0 \\leq M\\leq 3\\times 10^5</var></li>\n<li><var>1 \\leq U_i &lt; V_i\\leq N</var></li>\n<li>All <var>(U_i,V_i)</var> are different.</li>\n<li><var>1\\leq W_i\\leq 10^9</var> </li>\n<li><var>1 \\leq K\\leq N</var></li>\n<li><var>1\\leq A_1&lt;A_2&lt;\\cdots&lt;A_K\\leq N</var></li>\n<li><var>1 \\leq D\\leq 3\\times 10^5</var></li>\n<li><var>1\\leq X_i\\leq 10^9</var></li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>U_1</var> <var>V_1</var> <var>W_1</var>\n<var>U_2</var> <var>V_2</var> <var>W_2</var>\n<var>\\vdots</var>\n<var>U_M</var> <var>V_M</var> <var>W_M</var>\n<var>K</var>\n<var>A_1</var> <var>A_2</var> <var>\\ldots</var> <var>A_K</var>\n<var>D</var>\n<var>X_1</var> <var>X_2</var> <var>\\ldots</var> <var>X_D</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>N</var> lines.<br>\nThe <var>i</var>-th line <var>(1\\leq i\\leq N)</var> should contain the day on which the person living in room <var>i</var> was newly infected.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 4\n1 2 2\n2 3 1\n2 4 3\n3 4 2\n1\n1\n2\n3 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>0\n1\n1\n2\n</pre>\n<p>The infection spreads as follows.</p>\n<ul>\n<li>On the night of day <var>0</var>, the person living in room <var>1</var> gets infected.</li>\n<li>The distances between room <var>1</var> and rooms <var>2,3,4</var> are <var>2,3,5</var>, respectively. Thus, since <var>X_1=3</var>, the people living in rooms <var>2</var> and <var>3</var> are newly infected on the night of day <var>1</var>.</li>\n<li>The distance between rooms <var>3</var> and <var>4</var> is <var>2</var>. Thus, since <var>X_2=3</var>, the person living in room <var>4</var> also gets infected on the night of day <var>2</var>.</li>\n</ul>\n<p>Therefore, the people living in rooms <var>1,2,3,4</var> were newly infected on days <var>0,1,1,2</var>, respectively, so print <var>0,1,1,2</var> in this order on separate lines.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>7 7\n1 2 2\n2 3 3\n3 4 1\n4 5 1\n5 6 3\n3 7 1\n4 7 1\n2\n1 6\n2\n2 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n1\n2\n-1\n2\n0\n-1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>5 1\n1 2 5\n2\n1 3\n3\n3 7 5\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>0\n2\n0\n-1\n-1\n</pre>\n<p>Note that it is not always possible to move between any two rooms using only corridors.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc307/tasks/abc307_f"}