{"html":{"ja":"<span class=\"lang-ja\">\n\n<div class=\"part\">\n<section>\n<h3> 目次 </h3>\n<p><a href=\"#gaiyou\"> 問題概要 </a><br>\n<a href=\"#time-space\"> タイムスケジュールと空間構造 </a><br>\n<a href=\"#nanogrid\"> ナノグリッド </a><br>\n<a href=\"#yojou\"> 電力需給 </a><br>\n<a href=\"#trans\"> 運搬依頼 </a><br>\n<a href=\"#ev\"> EV </a><br>\n<a href=\"#charge\"> ナノグリッドの蓄電池の充放電処理 </a><br>\n<a href=\"#scoring\"> 採点方法 </a><br>\n<a href=\"#problem\"> 問題文 B </a><br>\n<a href=\"#io-format1\"> 入出力形式1 </a><br>\n<a href=\"#io-format2\"> 入出力形式2 </a><br>\n<a href=\"#io-format3\"> 入出力形式3 </a><br>\n<a href=\"#constraints\"> 入出力制約 </a><br>\n<a href=\"#example\"> 入出力例 </a><br>\n<a href=\"#sample\"> サンプルコード B </a><br></p>\n<h2 id=\"gaiyou\"> 問題概要 </h2>\n\n<p>この問題では、点在するナノグリッド(発電、蓄電、消費が行われる)における電力が不足しないよう、複数台のEV(=電気自動車)を用いて蓄電量のバランスを保ちつつ、人やモノをある地点から別の地点まで効率よく運搬することを考える。EVは走行距離に応じて電気を消費するため、途中でナノグリッドから充電する必要がある。ナノグリッドでは太陽光や燃料エンジンによる発電、電力の消費およびEVとの充放電が行われており、それらにより時間変動する電力需給を蓄電池の充放電および必要があれば外部からの電力供給によりバランスしている。</p>\n<div style=\"text-align:center;\">\n<img src=\"https://img.atcoder.jp/hokudai-hitachi2020/f1c5f885f4bd8b6c214fc6ea2649ae10.png\">\n</div>\n\n<p><span style=\"color:red;font-weight:bold;\">本ページ下部からダウンロード可能なtoolkitには、ジャッジからのデータ読込などI/O周りを既に実装したサンプルコードを用意しています。また、EVの動作も\"all stay\", \"random walk\", \"複数同時運搬ありの輸送\"などサンプルとして幾つか実装済です。新しいアルゴリズムを実装する際も、strategy classを継承する形でEVの動作の記述に注力できるつくりになっています(詳しくはREADME.mdもご参照ください)。投稿の際、こちらをご活用いただいて構いません。</span></p>\n<h2 id=\"time-space\"> タイムスケジュールと空間構造 </h2>\n\n<ul>\n<li><strong>タイムスケジュール</strong>: 1つのテストケースは <var>1</var> 営業日分に相当する。時刻 <var>t</var> は <var>0</var> から <var>T_{\\max}</var> までの整数の値をとる。各テストケースで天候が <var>4</var> パターンのいずれかから <var>1</var> つランダムに割り当てられ、電力需給に影響を及ぼす。コンテスタントはテストケース開始時に全時刻分の予測電力需給の情報を受け取る。また各時刻 <var>t</var> において、各ナノグリッドの蓄電量と、時刻 <var>t</var> までに発生した未配達注文の情報と、前時刻 <var>t-1</var> における実際の電力需給、余剰で捨てた電力、外部からの供給電力を受け取る。これらの情報を基に、コンテスタントは時刻 <var>t</var> から <var>t+1</var> の間に実行するEVの動作(移動、充放電、運搬など) を決定する。</li>\n<li><strong>空間構造</strong>: 単純かつ無向であるグラフ <var>G = (V, E)</var> を考える。ここで <var>V</var> は頂点集合、<var>E</var> は辺集合である。EVの移動、充放電、及び人/モノの運搬は全てこのグラフ内で行われる。頂点のうち一定数はナノグリッドに対応する。また、辺は道路に対応し、各辺には正の整数で重み(距離)が定められている。地図を表すグラフは、後述のアルゴリズムによってランダムに生成される。</li>\n</ul>\n<details>\n<summary style=\"display:list-item\"> グラフ <var>G</var> の生成アルゴリズム </summary>\n\n全てのテストケースにおいてグラフ <var>G = (V, E)</var> は以下のアルゴリズムによって生成される。\n\n<ul>\n<li> <b>入力:</b><var>|V|</var>, <var>|E|</var>, <var>\\mathrm{MaxDegree}=5</var>(最大次数)</li>\n<li> <b>頂点の生成方法:</b>\n<ul>\n  <li> はじめに、<var>|V| = R^{2} + r</var> を満たす最大の非負整数<var>R</var> を見つける（ただし、<var>r</var> も非負整数とする）。</li>\n  <li> 次に、<var>0 \\leq x, y &lt; R</var> を満たす<var>xy</var>座標平面上の全ての格子点に対して、点 <var>(x, y)</var> をプロットする。</li>\n  <li> 各点の座標を <var>(x, y) \\leftarrow (x + dx, y + dy)</var> とずらす。ここで <var>dx, dy</var> は <var>dx, dy \\in [0, 1]</var> を満たす一様ランダムな実数である。つまり、移動後の座標は<var>(x + dx, y + dy)\\in [0,R] \\times [0,R]</var>を満たす。</li>\n  <li> 残りの <var>r</var> 個の点それぞれについて、座標 <var>(x', y')</var> (<var>0 \\leq x', y' \\leq R</var> の一様ランダムな実数) を定めてプロットする。</li>\n  <li> 各点に対して、<var>1</var>から<var>|V|</var>までの番号(ID)をランダムに割り振る。</li>\n</ul>\n</li>\n\n<li> <b>連結性の保証:</b>\n<ul>\n  <li> 生成した頂点集合 <var>u \\in V</var> に対して、完全グラフ <var>G_{\\text{comp}}</var> を生成する。各頂点ペア <var>u, v \\in V \\times V</var> に対する頂点間のユークリッド距離を、完全グラフにおける辺の重み <var>W_{u, v}</var> と定める。</li>\n  <li> 次に、完全グラフ <var>G_{\\text{comp}}</var> に対して、<a href=\"https://ja.wikipedia.org/wiki/%E5%85%A8%E5%9F%9F%E6%9C%A8#%E6%9C%80%E5%B0%8F%E5%85%A8%E5%9F%9F%E6%9C%A8\">最小全域木</a> を生成し、生成された <var>|V|-1</var> 本の辺を道路とする。これらの辺の重み <var>d_{u,v}</var> を <var>d_{u,v} \\leftarrow \\lceil 2 \\times W_{u, v} \\rceil </var>と定める。\n  </li>\n</ul>\n</li>\n\n<li> <b>残りの道路の作成方法:</b>\n<ul>\n  <li> 残りの <var>|E|-(|V|-1)</var> 本の道路は、次の手順で<var>1</var>本ずつ生成される。\n  <ul>\n    <li> <var>\\mathrm{cost}(u,v)</var>を更新する。 </li>\n    <li> グラフGの辺でつながっていない<var>u</var>, <var>v</var>のペアの内、<var>\\mathrm{cost(u,v)}</var>の最小を与えるペアをつなぐ辺<var>\\left\\{ u, v \\right\\}</var>をグラフGに加える。</li>\n    <li> 選ばれた辺の重み <var>d_{u,v}</var> を <var>d_{u,v} \\leftarrow \\lceil 2 \\times W_{u, v} \\rceil </var> と定める。</li>\n  </ul>\n  </li>\n  <li>\n  ここで <var>\\mathrm{cost}(u,v)</var> のベースは頂点間のユークリッド距離だが、低い次数の頂点が選ばれやすくなるように、また、できる限り道の交差を避けるため、斜め方向よりも縦横方向の道が選ばれやすくなるように <var>\\mathrm{cost}(u,v)</var> を定める。以下に <var>\\mathrm{cost}(u,v)</var> の計算方法の詳細を示す。\n  <ul>\n    <li> 各頂点 <var>u\\in V</var> の次数 <var>\\mathrm{degree}(u)</var> を計算する。次数 <var>\\mathrm{degree}(u)</var> は <var>u\\in V</var> をいずれかの端点に含むグラフ <var>G</var> の辺の本数である。</li>\n    <li> 各頂点 <var>u\\in V</var> の色を、頂点の初めの(ずらす前の)座標 <var>(x,y)</var> をもとに、下記のように定める。まずは <var>|V|</var> 個の頂点のうち、<var>R^{2}</var> 個の頂点に対し、\n    <ul>\n      <li> <var>x+y</var> が偶数の場合 : <var>\\mathrm{color}(u) = 0</var> </li>\n      <li> <var>x+y</var> が奇数の場合 : <var>\\mathrm{color}(u) = 1</var> </li>\n      <li> と定める。残りの <var>r</var> 個の頂点には、ランダムに<var>0</var>もしくは<var>1</var>の色を割り当てる。</li>\n    </ul>\n    </li>\n    <li> ファクター <var>f(u,v)</var> を以下のように定める:\n    <ul>\n      <li> <var>\\mathrm{color}(u)</var> と <var>\\mathrm{color}(v)</var> が同じ場合： <var>\\mathrm{f}(u,v) = 5</var> </li>\n      <li> <var>\\mathrm{color}(u)</var> と <var>\\mathrm{color}(v)</var> が異なる場合： <var>\\mathrm{f}(u,v) = 1</var> </li>\n    </ul>\n    </li>\n    <li> ファクター <var>g(u)</var> を以下のように定める:\n    <ul>\n      <li> <var>\\mathrm{degree}(u) \\lt \\mathrm{MaxDegree}</var> の場合: <var>g(u)=1</var> </li>\n      <li> <var>\\mathrm{degree}(u) \\geq \\mathrm{MaxDegree}</var> の場合: <var>g(u)=\\infty</var> </li>\n    </ul>\n    </li>\n    <li> <var>\\mathrm{cost}(u,v)</var> を以下のように計算する。：\n    <ul>\n      <li> <var>\\mathrm{cost}(u,v) = W_{u,v}\\times \\mathrm{degree}(u) \\times \\mathrm{degree}(v) \\times f(u,v) \\times g(u) \\times g(v)</var>. </li>\n    </ul>\n    </li>\n  </ul>\n  </li>\n</ul>\n</li>\n\n<li> <b> ナノグリッド頂点の選択方法: </b>\n  <ul>\n    <li>頂点集合 <var>u \\in V</var> の中から一様ランダムに <var>N_{\\mathrm{grid}}</var> 個の頂点を選択し、それらをナノグリッド頂点と定める。またナノグリッド頂点集合を <var>V_{\\mathrm{grid}}</var> と表す。</li>\n  </ul>\n</li>\n\n</ul>\n</details>\n\n<h2 id=\"nanogrid\"> ナノグリッド </h2>\n\n<p>ナノグリッドは発電設備、電力消費者、EVの充放電設備および蓄電池から構成され、以下の内部状態を持つ。</p>\n<ul>\n<li>\n<p><strong>頂点ID</strong>: 頂点 <var>u</var> のID. ただし、<var>u \\in V_{\\mathrm{grid}}</var> (<var>V_{\\mathrm{grid}}</var>: ナノグリッド頂点集合, (\"グラフ<var>G</var> の生成について\"を参照)) </p>\n</li>\n<li>\n<p><strong>蓄電量</strong>: ナノグリッド内の蓄電池に蓄えられた電気の量。初期値 <var>C_{\\mathrm{init}}^{\\mathrm{grid}}</var>。上限値 <var>C_{\\mathrm{max}}^{\\mathrm{grid}}</var> (初期値と上限値は全ナノグリッド共通)。各時刻 <var>t</var> で電力需給(=発電-消費)の値だけ増減する。また、EVと蓄電池の間の充放電によっても増減する(詳細は<b><a href=\"#charge\"> ナノグリッドの蓄電池の充放電処理 </a></b>参照)。増加分が上限値 <var>C_{\\mathrm{max}}^{\\mathrm{grid}}</var> を超える場合、次の時刻 <var>t+1</var> の蓄電量は上限値となり、超えた分の電気は捨てられる。逆に蓄電量が足りなくなった場合、不足分はナノグリッドの外部(系統電力)から供給され、不足分に比例してスコアは減点される(詳細は<b><a href=\"#scoring\">採点方法</a></b>参照)。</p>\n</li>\n<li>\n<p><strong>電力需給</strong>: 各時刻におけるナノグリッド内の発電量とEVへの充電及び蓄電池への蓄電量を除いた消費量の差であり、その各時刻における予測値が時系列データで各テストケース開始時にコンテスタントに与えられる。実際の電力状態はその予測値と確率的部分（ゆらぎ、ゲリラ豪雨or想定外の晴れ）の和になる(詳細は<b><a href=\"#yojou\">電力需給</a></b>参照)。</p>\n</li>\n<li>\n<p><strong>上限充放電速度</strong>: <var>V_{\\max}^{\\mathrm{grid}}</var>. ナノグリッド内の蓄電池への充放電速度の上限値(全ナノグリッド共通)</p>\n</li>\n</ul>\n<h2 id=\"yojou\"> 電力需給 </h2>\n\n<p>各時刻におけるナノグリッド内の発電量とEVへの充電及び蓄電池への蓄電量を除いた消費量の差である。</p>\n<ul>\n<li>\n<p><strong>電力需給のパターン</strong>: 1つのテストケースは <var>1</var> 営業日分(<var>0 \\leq t &lt; T_{\\max}</var>)に対応する。テストケース開始時に、その日の天候が晴(ゲリラ豪雨無し)、晴(ゲリラ豪雨有り)、雨(想定外の晴れ無し)、雨(想定外の晴れ有り)の <var>4</var> 種類から選ばれ、コンテスタントに通知される。天候によってナノグリッド内の発電量（太陽光発電）が変化するため、予測電力需給の <var>1</var> 営業日分の総和は晴れ(ゲリラ豪雨無し)の場合が最も多く、逆に雨(想定外の晴れ無し)の場合は最も少なくなる。各ナノグリッドには需要パターンの異なる <var>N_{\\mathrm{pattern}}</var> 種類の予測電力需給パターンから <var>1</var> つがランダムに割り当てられ、どのパターンが割り当てられたかはコンテスタントに通知される。また、予測電力需給の各時刻の値は、テストケース開始時にコンテスタントに通知される。</p>\n</li>\n<li>\n<p><strong>電力需給の値</strong>: 電力需給の値は予測電力需給と確率的な揺らぎ <var>\\delta</var> とゲリラ豪雨及び想定外の晴れによる変化量の和で表される。</p>\n<ul>\n<li><strong>予想電力需給</strong>: 時間 <var>0 \\leq t &lt; T_{\\max}</var> を <var>N_{\\mathrm{div}}</var> 等分の区間に分け、同一区間内で予測電力需給は一定とする。</li>\n<li><strong>確率的揺らぎ</strong>: 各時刻 <var>t</var> で予測電力需給に確率的な揺らぎ値 <var>\\delta</var> が加わる。<var>\\delta</var> は各時刻、各ナノグリッド独立に平均 <var>0</var>、分散 <var>\\sigma^{2}_{\\mathrm{ele}}</var> の正規分布から生成され、その値はコンテスタントには事前に通知されない。</li>\n<li><strong>ゲリラ豪雨</strong>: 天候が\"晴(ゲリラ豪雨有り)\"の場合、<var>N_{\\mathrm{div}}</var> つの各時間区間において <var>p_{\\mathrm{event}}</var> の確率でゲリラ豪雨が発生する。確率は時間区間ごと独立かつ一定である。ゲリラ豪雨が発生すると、その時間区間内の全時刻 <var>t</var> で、時間区間ごと独立且つランダムに選ばれた <var>15\\%</var>(端数切捨て)のナノグリッドの電力需給が <var>\\Delta_{\\mathrm{event}}</var> だけ減少する(太陽光による発電量が想定よりも大幅に減少する)。</li>\n<li><strong>想定外の晴れ</strong>: 天候が\"雨(想定外の晴れ有り)\"の場合、ゲリラ豪雨と同じ確率で想定外の晴れが発生する。想定外の晴れが発生すると、その時間区間内の全時刻 <var>t</var> で、時間区間ごと独立且つランダムに選ばれた <var>15\\%</var>(端数切捨て)のナノグリッドの電力需給が <var>\\Delta_{\\mathrm{event}}</var> だけ増加する(太陽光による発電量が想定よりも大幅に増加する)。<br>\nゲリラ豪雨及び想定外の晴れの発生タイミングは事前にコンテスタントには通知されない。最終的な電力需給の値は、予測電力需給 <var>+ \\delta \\pm \\Delta_{\\mathrm{event}}</var> となる。</li>\n</ul>\n</li>\n</ul>\n<div style=\"text-align:center;\">\n<img src=\"https://img.atcoder.jp/hokudai-hitachi2020/17ff7de7687b964a3d7c9a4912257abe.png\">\n</div>\n\n<h2 id=\"trans\"> 運搬依頼 </h2>\n\n<p>運搬依頼に基づき、EVは運搬物を出発地点でピックアップし目的地点まで運ぶ。\n依頼はオンラインで発生し、各運搬依頼は以下の内部状態を持つ。</p>\n<ul>\n<li>\n<p><strong>内部状態</strong>:</p>\n<ul>\n<li>運搬物ID <var>(1,...)</var></li>\n<li>発生時刻 <var>(0 \\leq t \\leq T_{\\mathrm{last}}(&lt;T_{\\max}))</var></li>\n<li>出発地頂点 (頂点ID: <var>1,...,|V|</var>)</li>\n<li>目的地頂点 (頂点ID: <var>1,...,|V|</var>, 但し出発地頂点とは異なる)</li>\n<li>状態 (<var>0</var>:未積載、<var>1</var>:運搬中)</li>\n</ul>\n</li>\n<li>\n<p><strong>発生確率と発生地点</strong>: <var>0 \\leq t \\leq T_{\\mathrm{last}}(&lt;T_{\\max})</var> を満たす各時刻 <var>t</var> において、確率 <var>p_{\\mathrm{trans}}^{\\mathrm{const}}</var> で新たな運搬依頼が <var>1</var> つ発生する。新たな運搬依頼の出発地頂点は全ての <var>|V|</var> 個の頂点から一様ランダムに選択され、目的地頂点は出発地頂点を除く <var>|V|-1</var> 個の頂点から一様ランダムに選択される。</p>\n</li>\n<li>\n<p><strong>未運搬のペナルティ</strong>: 時刻 <var>t=T_{\\max}</var> までに運搬が完了していない運搬依頼 <var>1</var> つにつき、ペナルティ <var>P^{\\mathrm{trans}}</var> がスコアから減点される(詳細は<b><a href=\"#scoring\">採点方法</a></b>参照)。</p>\n</li>\n</ul>\n<h2 id=\"ev\"> EV </h2>\n\n<p>コンテスタントは複数台のEVを操作し、ナノグリッド間の電力バランス調整や運搬を行う。</p>\n<ul>\n<li>\n<p><strong>台数</strong>: EVの台数は、テストケースの開始時に区間 <var>[N_{\\min}^{\\mathrm{EV}}, N_{\\max}^{\\mathrm{EV}}]</var> から一様ランダムに選ばれ、コンテスタントに通知される。</p>\n</li>\n<li>\n<p><strong>初期位置</strong>: テストケース開始時にナノグリッド含む全ての頂点からEV台数に等しい数の頂点をランダムに選び、EVは選ばれた各頂点に <var>1</var> 台ずつ配置される。</p>\n</li>\n<li>\n<p><strong>内部状態</strong>: 各EVは以下の内部状態を持つ</p>\n<ul>\n<li>ID <var>(0, 1,... , N^{\\mathrm{EV}}-1)</var></li>\n<li>蓄電量 <var>C^{\\mathrm{EV}}_{t}</var> (非負整数, 初期値は <var>C^{\\mathrm{EV}}_{t=0}</var>、上限値は <var>C^{\\mathrm{EV}}_{\\max}</var> で共に全EV共通)</li>\n<li>位置 (頂点上もしくは辺上)</li>\n<li>運搬物ID (EVに乗せている運搬物のID、同時に乗せられる運搬物の上限数は <var>N_{\\max}^{\\mathrm{trans}}</var> (全EV共通)）</li>\n<li>上限充放電速度 <var>V_{\\max}^{\\mathrm{EV}}</var> (EVの充放電速度の上限値 (全EV共通))</li>\n</ul>\n</li>\n<li>\n<p><strong>動作</strong>: コンテスタントは各時刻 <var>t</var> における各EVの動作を以下から選び、決定する。</p>\n<ul>\n<li><code>stay</code>: 移動せずその場にとどまる。この場合、EVの蓄電量は消費されない。(<var>C^{\\mathrm{EV}}_{t+1}-C^{\\mathrm{EV}}_{t}=0</var>)</li>\n<li>\n<p><code>move w</code>: 頂点 <var>w \\in V</var> の方向に向かって距離 <var>1</var> だけ進む。次の時刻のEVの蓄電量は <var>\\Delta^{\\mathrm{EV}}_{\\mathrm{move}}</var> だけ減少する。ただし、以下の条件を満たしており、且つ移動後のEVの蓄電量が負になる場合(<var>C^{\\mathrm{EV}}_{t} - \\Delta^{\\mathrm{EV}}_{\\mathrm{move}} &lt; 0</var>)、EVの蓄電量は減らず、<code>stay</code>が実行された場合と同じ挙動となる(その場に留まる)。</p>\n<ul>\n<li><code>move w</code> を選択するとき、<var>w</var> が以下の条件を満たさない場合、 <code>WA</code> (Wrong Answer) となる。<ul>\n<li><var>w</var> は <var>w \\in V</var> を満たす頂点である</li>\n<li>EVが頂点 <var>u \\in V</var> 上にいる場合、頂点対 <var>\\left\\{ u, w \\right\\}</var> がグラフの辺集合に含まれていなければならない。すなわち、<var>\\left\\{ u, w \\right\\} \\in E</var> でなければならない</li>\n<li>EVが辺 <var>\\left\\{ u, v \\right\\}</var> 上にいる場合、<var>w = u</var> または <var>w = v</var> でなければならない</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><code>pickup a</code>: 運搬物ID <var>a</var> の運搬物をEVに乗せる。pickupではEVの蓄電量は消費されない。なお、EVに積載された運搬物は、EVがその運搬物の目的地頂点に到達した際に自動的に降ろされる(コンテスタントが動作を指示する必要はない)。</p>\n<ul>\n<li><code>pickup a</code> を選択するとき、以下の条件を満たさない場合、 <code>WA</code> (Wrong Answer) となる。<ul>\n<li>EVは頂点 <var>u \\in V</var> に居る</li>\n<li>頂点 <var>u</var> を出発地点とする未処理の運搬集合に <var>a</var> が含まれる</li>\n<li>そのEVの(<var>a</var>を含めた)同時運搬数が上限 <var>N_{\\max}^{\\mathrm{trans}}</var> 以下となる</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><code>charge_from_grid</code> <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var>: ナノグリッド上でEVへ <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var> だけ充電する。そのとき次の時刻 <var>t+1</var> でのEVの蓄電量 <var>C^{\\mathrm{EV}}_{t+1}</var> は、<var>C^{\\mathrm{EV}}_{t+1} \\leftarrow C^{\\mathrm{EV}}_{t} + \\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var> となる。同一ナノグリッドから複数台のEVに同時に充電することも可能である。また、同一ナノグリッド上で同時に別のEVからナノグリッドへ放電<code>charge_to_grid</code>することも可能である(動作は後述)。</p>\n<ul>\n<li><code>charge_from_grid</code> <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var> を選択するとき、以下の条件を満たさない場合、<code>WA</code> (Wrong Answer) となる。<ul>\n<li>EVはナノグリッドの頂点 <var>u \\in V_{\\mathrm{grid}}</var> に居る</li>\n<li><var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var>は自然数である。</li>\n<li>EVの上限充放電速度を超えない: <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}} \\leq V_{\\max}^{\\mathrm{EV}}</var> </li>\n<li>充電後のEVの蓄電量が上限を超えない: <var>C^{\\mathrm{EV}}_{t} + \\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}} \\leq C^{\\mathrm{EV}}_{\\max}</var></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><code>charge_to_grid</code> <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var>: EVからナノグリッドへ <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var> だけ放電する。そのとき次の時刻 <var>t+1</var> でのEVの蓄電量 <var>C^{\\mathrm{EV}}_{t+1}</var> は、<var>C^{\\mathrm{EV}}_{t+1} \\leftarrow C^{\\mathrm{EV}}_{t} - \\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var> となる。同一ナノグリッドへ複数台のEVから同時に放電することも可能である。また、同時に同一ナノグリッド上で別のEVへ充電<code>charge_from_grid</code>することも可能である。</p>\n<ul>\n<li><code>charge_to_grid</code> <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var> を選択するとき、以下の条件を満たさない場合、<code>WA</code> (Wrong Answer) となる。<ul>\n<li>EVはナノグリッドの頂点 <var>u \\in V_{\\mathrm{grid}}</var> に居る</li>\n<li><var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var>は自然数である。</li>\n<li>EVの上限充放電速度を超えない: <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}} \\leq V_{\\max}^{\\mathrm{EV}}</var> </li>\n<li>放電後のEVの蓄電量が負にならない: <var>C^{\\mathrm{EV}}_{t} - \\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}} \\geq 0</var> </li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"charge\"> ナノグリッドの蓄電池の充放電処理 </h2>\n\n<p>各ナノグリッドにおいて、発電量、消費量及び接続したEVの充放電によって時々刻々とナノグリッドの蓄電量は増減する。本処理により、各時刻各ナノグリッド内の電力需給(=発電量-消費量)とEVの充放電量を足し合わせ、余剰があればナノグリッド内の蓄電池に充電し、逆に足りなければ蓄電池から放電する。余剰が多い場合、蓄電池の上限充電速度を超える分、もしくは上限蓄電容量を超える分の電気は捨て、不足電力が多い場合、蓄電池の上限放電速度を超える分、もしくは蓄電量が枯渇しても足りない分の電気は、ナノグリッド外(系統)から購入する。いずれの場合も、コンテスタントが指定したEVの充放電量の分だけ、次の時刻で必ず充放電される。<br><br>\n具体的には、各時刻 <var>t</var> において、次の時刻 <var>t+1</var> の各ナノグリッドの蓄電量を決定するため、以下の処理1～4が実行される。<br></p>\n<ul>\n<li>\n<p><strong>処理1</strong>: ナノグリッド内の時刻 <var>t</var> における電力収支 <var>\\Delta^{\\mathrm{grid}}_{\\mathrm{total}}</var> を計算する<br>\n<var>\\Delta^{\\mathrm{grid}}_{\\mathrm{total}} = \\Delta^{\\mathrm{grid}}_{\\mathrm{gen},t} - \\sum_{i \\in \\mathrm{all EV}} \\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}i}_{\\mathrm{charge},t} + \\sum_{i \\in \\mathrm{all EV}} \\Delta^{\\mathrm{EV}i \\rightarrow \\mathrm{grid}}_{\\mathrm{charge},t} </var> <br>\nここで、各変数は以下の通りである。\n    </p><ul>\n    <li> <var>\\Delta^{\\mathrm{grid}}_{\\mathrm{gen},t}</var>: 時刻 <var>t</var> における電力需給であり、予測電力需給 <var>\\Delta^{\\mathrm{grid,predict}}_{\\mathrm{gen},t}</var> と 確率的部分（ゆらぎ、ゲリラ豪雨or想定外の晴れ）の和である。ここで、予測電力需給の値はテストケースの開始時にコンテスタントに通知されるが、確率的部分は時刻 <var>t</var> ではコンテスタントに通知されないことに注意せよ(ただし次の時刻 <var>t+1</var> で <var>\\Delta^{\\mathrm{grid}}_{\\mathrm{gen},t}</var> がコンテスタントに通知される(詳しくは\"入出力形式2\"を参照))。</li>\n    <li> <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}i}_{\\mathrm{charge},t}</var>: ナノグリッドからEV<var>i</var>への充電量であり、コンテスタントが時刻 <var>t</var> で指定する。</li>\n    <li> <var>\\Delta^{\\mathrm{EV}i \\rightarrow \\mathrm{grid}}_{\\mathrm{charge},t}</var>: EV<var>i</var>からナノグリッドへの放電量であり、コンテスタントが時刻 <var>t</var> で指定する。</li>\n    </ul><p></p>\n</li>\n<li>\n<p><strong>処理2</strong>: 電力収支が大きい、つまり余剰電力が大きい場合の処理。<br>\n<var>\\Delta^{\\mathrm{grid}}_{\\mathrm{total}} \\geq \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{\\max}-C^{\\mathrm{grid}}_{t} \\right\\}</var> の場合、次の時刻 <var>t+1</var> のナノグリッドの蓄電量を以下のように定める。<br>\n<var>C^{\\mathrm{grid}}_{t+1} \\leftarrow C^{\\mathrm{grid}}_{t}+\\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{\\max}-C^{\\mathrm{grid}}_{t} \\right\\} </var><br>\nつまり、速度や上限蓄電量を超えた分の電気は蓄電池に充電されない(捨てられることになる)。<br></p>\n</li>\n<li>\n<p><strong>処理3</strong>: 電力収支が小さい、つまり不足電力が大きい場合の処理。<br>\n<var>\\Delta^{\\mathrm{grid}}_{\\mathrm{total}} &lt; - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{t} \\right\\}</var> の場合、次の時刻 <var>t+1</var> のナノグリッドの蓄電量を以下のように定める。<br>\n<var>C^{\\mathrm{grid}}_{t+1} \\leftarrow C^{\\mathrm{grid}}_{t} - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{t} \\right\\} </var><br>\nまた、上記では、ナノグリッド内の電力不足分：<br>\n<var>- \\Delta^{\\mathrm{grid}}_{\\mathrm{total}} - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{t} \\right\\}(&gt;0)</var><br>\nをナノグリッド外(系統電力など)から購入する。そのため、不足分に比例してスコアが減点される(詳細は<b><a href=\"#scoring\">採点方法</a></b>参照)。<br></p>\n</li>\n<li>\n<p><strong>処理4</strong>: 電力収支が適度な大きさの場合の処理。<br>\n処理2及び処理3が共に実行されない場合、電力収支の分だけ次の時刻 <var>t+1</var> のナノグリッドの蓄電量を増減させる。<br>\n<var>C^{\\mathrm{grid}}_{t+1} \\leftarrow C^{\\mathrm{grid}}_{t} + \\Delta^{\\mathrm{grid}}_{\\mathrm{total}}</var><br></p>\n</li>\n</ul>\n<div style=\"text-align:center;\">\n<img src=\"https://img.atcoder.jp/hokudai-hitachi2020/21815e8b4102e7b828b2537a0dc95065.png\">\n</div>\n\n<h2 id=\"scoring\"> 採点方法 </h2>\n\n<p>この問題では、与えられた <var>1</var> つのテストケースに対して、<var>N_{\\mathrm{solution}}</var> 回解を求め(つまり時刻 <var>0 \\leq t &lt; T_{\\max}</var> の間のEVの制御を <var>N_{\\mathrm{solution}}</var> 回繰り返す)、以下の式に基づき、各解における運搬スコア(<var>S_{\\mathrm{trans}}^{(1)},...,S_{\\mathrm{trans}}^{(N_{\\mathrm{solution}})}</var>)及び電力スコア(<var>S_{\\mathrm{ele}}^{(1)},...,S_{\\mathrm{ele}}^{(N_{\\mathrm{solution}})}</var>)を計算する。<b>なお、<var>N_{\\mathrm{solution}}</var> 回の試行間で運搬の発生時刻と出発目的地、及びゲリラ豪雨と想定外の晴れの発生タイミングは異なるものとする。その他の条件（グラフ形状、ナノグリッド頂点位置、EV台数、予測電力需給、運搬発生確率など）は <var>N_{\\mathrm{solution}}</var> 回の試行間で同一であるとする。</b></p>\n<ul>\n<li>\n<p><strong>運搬スコア</strong>: 運搬スコア <var>S_{\\mathrm{trans}}</var> は以下の式で計算する。<br>\n<var>S_{\\mathrm{trans}}=\\sum_{i \\in O_{\\mathrm{trans}}} \\left( T_{\\max} - T_{\\mathrm{wait},i} \\right) - \\sum_{i \\in \\overline{O_{\\mathrm{trans}}}} P_i^{\\mathrm{trans}}</var> <br>\nただし、<var>O_{\\mathrm{trans}}</var> は <var>T_{\\max}</var> までに完了した運搬依頼の集合、<var>\\overline{O_{\\mathrm{trans}}}</var> は <var>T_{\\max}</var> までに完了しなかった運搬依頼の集合、\n<var>T_{\\mathrm{wait},i}</var> は運搬依頼 <var>i</var> の待ち時間(=運搬完了時刻-発生時刻)であり、<var>P_i^{\\mathrm{trans}}</var> は <var>T_{\\max}</var> まで未完了の運搬依頼 <var>i</var> に対するペナルティである(依頼 <var>i</var> に依らずペナルティは定数 <var>P_i^{\\mathrm{trans}}=P^{\\mathrm{trans}}</var> である)。</p>\n</li>\n<li>\n<p><strong>電力スコア</strong>: 電力スコア <var>S_{\\mathrm{ele}}</var> は以下の式で計算する。<br>\n<var>S_{\\mathrm{ele}}=\\sum_{i=1}^{N_{\\mathrm{EV}}} C_{t=T_{\\max}}^{\\mathrm{EV}i} + \\sum_{i=1}^{N_{\\mathrm{grid}}} C_{t=T_{\\max}}^{\\mathrm{grid}i} - \\gamma \\sum_{t=0}^{T_{\\max}-1} \\sum_{i=1}^{N_{\\mathrm{grid}}} L_{i,t}</var><br>\nただし、第 <var>1</var> 項と第 <var>2</var> 項は <var>t=T_{\\max}</var> 時点での全EV及び全ナノグリッドの残り蓄電量であり、<var>\\gamma</var> は不足電力ペナルティ係数、<var>L_{i,t}</var> は時刻 <var>t</var> のナノグリッド <var>i</var> における不足電力であり、<a href=\"#charge\">ナノグリッドの蓄電池の充放電処理</a>の処理3が実行された場合 <var>L_{i,t} = - \\Delta^{\\mathrm{grid}}_{\\mathrm{total}} - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{t} \\right\\}(L_{i,t}&gt;0)</var> であり、処理3が実行されない場合は <var>L_{i,t}=0</var> である。</p>\n</li>\n<li>\n<p><strong>最終スコア</strong>: 上記の計算式に基づき、<var>N_{\\mathrm{solution}}</var> 組の(電力スコア, 運搬スコア)<var>\\left( =(S_{\\mathrm{ele}}^{(1)},S_{\\mathrm{trans}}^{(1)}),...,(S_{\\mathrm{ele}}^{(N_{\\mathrm{solution}})},S_{\\mathrm{trans}}^{(N_{\\mathrm{solution}})}) \\right)</var> を図のように電力スコア-運搬スコア平面にプロットする。<var>N_{\\mathrm{solution}}</var> 個の点と基準点 <var>(S_{\\mathrm{ele}}^{\\mathrm{ref}},S_{\\mathrm{trans}}^{\\mathrm{ref}})</var> から形成される図のような階段状の図形の面積を、そのテストケースにおける最終スコアとする。<b>ただし、上記計算式に基づく運搬、電力各々のスコアがそれぞれの基準スコアを下回る場合は、その計算スコアを基準スコアに等しくする(つまり計算スコア-基準スコアは負にならない)。</b>基準スコアの具体的な値は\"入出力制約\"を参照。</p>\n</li>\n<li>\n<p><strong>順位決定方法</strong>: コンテスト開催中の順位は <var>16</var> つのテストケースにおける最終スコアの合計値で決定する。<var>16</var> つのテストケースのうち、晴(ゲリラ豪雨無し)、晴(ゲリラ豪雨有り)、雨(想定外の晴れ無し)、雨(想定外の晴れ有り)の数はそれぞれ <var>6, 2, 6, 2</var> で固定である。<br>\nシステムテストは、ツールキットで開示済の <var>6(=N_\\mathrm{pattern} \\times 2(</var>晴,雨<var>))</var> パターンの予測電力需給パターンを用いた <var>160</var> 個のテストケースに加えて、未開示の <var>6(=N_\\mathrm{pattern} \\times 2(</var>晴,雨<var>))</var> パターンの予測電力需給パターンを用いた <var>40</var> 個のテストケースから成る、計 <var>200</var> 個のテストケースで実施します。なお、ゆらぎの平均・分散値や、ゲリラ豪雨及び想定外の晴れによる電力需給の変動幅、発生確率及び発生条件は同じです。<br>\n詳細な内訳は下記表をご覧ください* <br></p>\n</li>\n</ul>\n<table class=\"table table-bordered\">\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"right\">予測電力需給(開示済)</th>\n<th align=\"right\">予測電力需給(未開示)</th>\n<th align=\"right\">合計</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">晴(ゲリラ豪雨無)</td>\n<td align=\"right\">60</td>\n<td align=\"right\">15</td>\n<td align=\"right\">75</td>\n</tr>\n<tr>\n<td align=\"center\">晴(ゲリラ豪雨有)</td>\n<td align=\"right\">20</td>\n<td align=\"right\">5</td>\n<td align=\"right\">25</td>\n</tr>\n<tr>\n<td align=\"center\">雨(想定外の晴無)</td>\n<td align=\"right\">60</td>\n<td align=\"right\">15</td>\n<td align=\"right\">75</td>\n</tr>\n<tr>\n<td align=\"center\">雨(想定外の晴有)</td>\n<td align=\"right\">20</td>\n<td align=\"right\">5</td>\n<td align=\"right\">25</td>\n</tr>\n<tr>\n<td align=\"center\">合計</td>\n<td align=\"right\">160</td>\n<td align=\"right\">40</td>\n<td align=\"right\">200</td>\n</tr>\n</tbody>\n</table>\n<p>* 12/18にyuusanlondon様から頂いたご質問に対する回答から、システムテストの内容に一部変更が入ってしまい大変申し訳ありません。運営側で検討させて頂いた結果、上記の内容で最終順位を決定させて頂きたく、ご理解頂けますと幸いです。<br>\n(12/29追記) 未開示の予測電力需給パターンの生成法やジェネレーターを開示する予定はございません。\nただし、未開示のパターンでの電力スコアの満点（理想的な制御実行時の得点の上限）は、開示済のパターンの電力スコアの満点と同等の得点となるよう、作成予定です。</p>\n<div style=\"text-align:center;\">\n<img src=\"https://img.atcoder.jp/hokudai-hitachi2020/a47cf44afa6b790c920e2a5049c133fa.png\">\n</div>\n\n<h2 id=\"problem\"> 問題文 B </h2>\n\n<p>問題 B は問題 A と同様<span style=\"color:black; font-weight:bold;\">インタラクティブな</span>問題である。\n得点(Score)を最大化するように電力をマネジメントしながら効率よく運搬を行うアルゴリズムを作ることが問題 B のタスクである。\nContestantが高得点を獲得するためには、確率的に上下する電力需給に対して、蓄電池を持ちグラフ上を移動する電気自動車(EV)で効率よく運搬を行いながら、蓄電池を持つ頂点(ナノグリッド)の蓄電量を管理することが必要となる。また、電力スコア-運搬スコア平面上で広い領域をカバーできようように、複数の求解で運搬と電力のスコアバランスを調整することも重要である。\n作成するプログラムの得点判定の際は、コンテスタント側とジャッジ側が以下で示す流れに沿って処理を行う。</p>\n<table class=\"table table-bordered\">\n<thead>\n<tr>\n<th>繰り返し処理</th>\n<th>コンテスタント</th>\n<th>ジャッジ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td></td>\n<td>求解回数 <var>N_{\\mathrm{solution}}</var> を出力</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>グラフ <var>G</var> を出力</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>電力需給の情報を出力</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>ナノグリッドの情報を出力</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>EVの情報を出力</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>運搬の情報を出力</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>スコアの情報を出力</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>繰り返し処理(ターン)の回数 <var>T_\\mathrm{max}</var> を出力</td>\n</tr>\n<tr>\n<td><b>for</b> <var>i=1,...,N_{\\mathrm{solution}}</var> <b>do</b><br><span style=\"margin-left:30px;\"><b>for</b></span> <var>t=0,...,T_\\mathrm{max}-1</var> <b>do</b></td>\n<td>-</td>\n<td>-</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>時刻 <var>t</var> におけるEVとナノグリッドの状態 <var>\\mathrm{info}_t</var> を出力</td>\n</tr>\n<tr>\n<td></td>\n<td>各EVに対して制御コマンドを出力</td>\n<td></td>\n</tr>\n<tr>\n<td><span style=\"margin-left:30px;\"><b>end for</b></span></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>時刻 <var>t=T_\\mathrm{max}</var> におけるEVとナノグリッドの状態 <var>\\mathrm{info}_t</var> を出力</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>運搬スコア <var>S_{\\mathrm{trans}}</var> と電力スコア <var>S_{\\mathrm{ele}}</var> を出力</td>\n</tr>\n<tr>\n<td><b>end for</b></td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p>ジャッジによる求解回数、グラフ、電力需給、ナノグリッド、EV、運搬、スコア、ターン数に関する情報は、はじめに<var>1</var>回だけ出力される。<b>本問題では、<var>0 \\leq t \\lt T_\\mathrm{max}</var> の試行を <var>N_{\\mathrm{solution}}</var> 回繰り返すことに注意せよ。</b>各試行で <var>0 \\leq t \\lt T_\\mathrm{max}</var> を満たす整数 <var>t</var> において、表で示した順番通りに毎回行われる。<span style=\"color:black; font-weight:bold;\">なお、時刻 <var>t=T_\\mathrm{max}</var> における <var>\\mathrm{info}_t</var> 及びスコアは必ずコンテスタント側で読み出す必要がある(読み出さない場合TLEになる可能性がある)。</span></p>\n<h2 id=\"io-format1\"> 入出力形式1 </h2>\n\n<p>はじめに、求解回数、グラフ <var>G</var>、電力需給の情報、ナノグリッドの情報、EVの情報、運搬の情報、スコアの情報およびターン数が、以下の形式によりジャッジから標準入力に与えられる。<span style=\"color:black; font-weight:bold;\">なお、求解回数 <var>2</var> 回目以降の開始時は(下記条件は <var>1</var> 回目と共通のため)与えられないことに注意せよ。</span></p>\n<pre><var>N_{\\mathrm{solution}}</var>\n<var>|V|</var> <var>|E|</var>\n<var>u_1</var> <var>v_1</var> <var>d_1</var>\n:\n<var>u_{|E|}</var> <var>v_{|E|}</var> <var>d_{|E|}</var>\n<var>\\mathrm{DayType}</var>\n<var>N_\\mathrm{div}</var> <var>N_\\mathrm{pattern}</var> <var>\\sigma^{2}_{\\mathrm{ele}}</var> <var>p_{\\mathrm{event}}</var> <var>\\Delta_{\\mathrm{event}}</var>\n<var>\\mathrm{pw}_{1,1}^{\\mathrm{predict}}</var> <var>\\mathrm{pw}_{1,2}^{\\mathrm{predict}}</var> ... <var>\\mathrm{pw}_{1,N_\\mathrm{div}}^{\\mathrm{predict}}</var>\n:\n<var>\\mathrm{pw}_{N_\\mathrm{pattern},1}^{\\mathrm{predict}}</var> <var>\\mathrm{pw}_{N_\\mathrm{pattern},2}^{\\mathrm{predict}}</var> ... <var>\\mathrm{pw}_{N_\\mathrm{pattern},N_\\mathrm{div}}^{\\mathrm{predict}}</var>\n<var>N_\\mathrm{grid}</var> <var>C_{\\mathrm{init}}^{\\mathrm{grid}}</var> <var>C_{\\mathrm{max}}^{\\mathrm{grid}}</var> <var>V_{\\max}^{\\mathrm{grid}}</var>\n<var>x_1</var> <var>\\mathrm{pattern}_1</var> \n: \n<var>x_{N_\\mathrm{grid}}</var> <var>\\mathrm{pattern}_{N_\\mathrm{grid}}</var> \n<var>N_\\mathrm{EV}</var> <var>C_{\\mathrm{init}}^{\\mathrm{EV}}</var> <var>C_{\\mathrm{max}}^{\\mathrm{EV}}</var> <var>V_{\\max}^{\\mathrm{EV}}</var> <var>N_{\\max}^{\\mathrm{trans}}</var> <var>\\Delta_{\\mathrm{move}}^{\\mathrm{EV}}</var>\n<var>\\mathrm{pos}_1</var>\n:\n<var>\\mathrm{pos}_{N_\\mathrm{EV}}</var>\n<var>p_{\\mathrm{trans}}^{\\mathrm{const}}</var> <var>T_\\mathrm{last}</var>\n<var>P^{\\mathrm{trans}}</var> <var>\\gamma</var> <var>S_{\\mathrm{ele}}^{\\mathrm{ref}}</var> <var>S_{\\mathrm{trans}}^{\\mathrm{ref}}</var>\n<var>T_\\mathrm{max}</var>\n</pre>\n\n<ul>\n<li><var>1</var> 行目の <var>N_{\\mathrm{solution}}</var> はスコア計算のための求解回数である。</li>\n<li>続く <var>1</var> 行で、 <var>|V|</var> はグラフの頂点数、<var>|E|</var> はグラフの辺数が与えられる。</li>\n<li>続く <var>|E|</var> 行で、グラフの辺が与えられる。 <var>|E|</var> 行のうち <var>i</var> 行目は、頂点 <var>u_{i}</var> と <var>v_{i}</var> の間に距離 <var>d_i</var> の辺が存在することを表す。</li>\n<li>続く <var>1</var> 行で、天候タイプ <var>\\mathrm{DayType}</var> が与えられる。<var>\\mathrm{DayType}</var> は <var>0</var>: 晴(ゲリラ豪雨無し)、<var>1</var>: 晴(ゲリラ豪雨有り)、<var>2</var>: 雨(想定外の晴れ無し)、<var>3</var>: 雨(想定外の晴れ有り)のいずれかが与えられる。</li>\n<li>続く <var>1</var> 行で、予測電力需給が一定値となる区間の数 <var>N_\\mathrm{div}</var> と予測電力需給のパターン数 <var>N_\\mathrm{pattern}</var> と電力需給の分散 <var>\\sigma^{2}_{\\mathrm{ele}}</var> とゲリラ豪雨もしくは想定外の晴れの発生確率 <var>p_{\\mathrm{event}}</var> (天候タイプが <var>0</var> もしくは <var>2</var> の場合は <var>0.0</var> となる)とゲリラ豪雨もしくは想定外の晴れ発生時の電力需給の変化量 <var>\\Delta_{\\mathrm{event}}</var> が与えられる。</li>\n<li>続く <var>N_\\mathrm{pattern}</var> 行で各パターンの予測電力需給の値が与えられる。<var>i</var> 行目の <var>j</var> 番目の数値 <var>\\mathrm{pw}_{i,j}^{\\mathrm{predict}}</var> は、予測電力需給パターン <var>i</var> における時間区間 <var>j</var> 番目の予測電力需給の値を表す。</li>\n<li>続く <var>1</var> 行で、ナノグリッドの個数 <var>N_\\mathrm{grid}</var> とナノグリッドの時刻 <var>0</var> での蓄電量 <var>C_{\\mathrm{init}}^{\\mathrm{grid}}</var> と最大蓄電量 <var>C_{\\mathrm{max}}^{\\mathrm{grid}}</var> と蓄電池の上限充放電速度 <var>V_{\\max}^{\\mathrm{grid}}</var> が与えられる。</li>\n<li>続く <var>N_\\mathrm{grid}</var> 行でナノグリッドの情報が与えられる。<var>N_\\mathrm{grid}</var> 行のうち <var>i</var> 行目は、頂点 <var>x_i</var> 上に、予測電力需給パターン <var>\\mathrm{pattern}_i</var> のナノグリッドが存在することを表す。</li>\n<li>続く <var>1</var> 行で、EVの個数 <var>N_\\mathrm{EV}</var> とEVの時刻 <var>0</var> での蓄電量 <var>C_{\\mathrm{init}}^{\\mathrm{EV}}</var> と最大蓄電量 <var>C_{\\mathrm{max}}^{\\mathrm{EV}}</var> と蓄電池の上限充放電速度 <var>V_{\\max}^{\\mathrm{EV}}</var> と運搬物の積載上限数 <var>N_{\\max}^{\\mathrm{trans}}</var> と単位距離の移動に必要な電力 <var>\\Delta_{\\mathrm{move}}^{\\mathrm{EV}}</var> が与えられる。</li>\n<li>続く <var>N_\\mathrm{EV}</var> 行で、EVの位置が与えられる。<var>N_\\mathrm{EV}</var> 行のうち <var>i</var> 行目は、<var>i</var> 番目のEVが頂点 <var>\\mathrm{pos}_i</var> 上にあることを表す。</li>\n<li>続く <var>1</var> 行で、各時刻で運搬依頼が発生する確率 <var>p_{\\mathrm{trans}}^{\\mathrm{const}}</var> と運搬依頼が発生する最終時刻 <var>T_\\mathrm{last}</var> が与えられる。</li>\n<li>続く <var>1</var> 行で、未完了の運搬に対するペナルティ <var>P^{\\mathrm{trans}}</var> と不足電力ペナルティ係数 <var>\\gamma</var> と電力の基準スコア <var>S_{\\mathrm{ele}}^{\\mathrm{ref}}</var> と運搬の基準スコア <var>S_{\\mathrm{trans}}^{\\mathrm{ref}}</var> が与えられる。</li>\n<li>続く <var>1</var> 行で、あなたが行動するターン数 <var>T_{\\max}</var> が与えられる。</li>\n</ul>\n<h2 id=\"io-format2\"> 入出力形式2 </h2>\n\n<p>各時刻 <var>t</var> に、その時刻におけるEVとナノグリッドの状態 <var>\\mathrm{info}_t</var> が、以下の形式によりジャッジから標準入力に与えられる。</p>\n<pre><var>x_1</var> <var>y_1</var> <var>\\mathrm{pw}_{1}^{\\mathrm{actual},t-1}</var> <var>\\mathrm{pw}_{1}^{\\mathrm{excess},t-1}</var> <var>\\mathrm{pw}_{1}^{\\mathrm{buy},t-1}</var>\n:\n<var>x_{N_\\mathrm{grid}}</var> <var>y_{N_\\mathrm{grid}}</var> <var>\\mathrm{pw}_{N_\\mathrm{grid}}^{\\mathrm{actual},t-1}</var> <var>\\mathrm{pw}_{N_\\mathrm{grid}}^{\\mathrm{excess},t-1}</var> <var>\\mathrm{pw}_{N_\\mathrm{grid}}^{\\mathrm{buy},t-1}</var>\n<var>\\mathrm{carinfo}_1</var>\n:\n<var>\\mathrm{carinfo}_{N_\\mathrm{EV}}</var>\n<var>N_\\mathrm{order}</var>\n<var>\\mathrm{id}_1</var> <var>w_1</var> <var>z_1</var> <var>\\mathrm{state}_1</var> <var>\\mathrm{time}_1</var>\n...\n<var>\\mathrm{id}_{N_\\mathrm{order}}</var> <var>w_{N_\\mathrm{order}}</var> <var>z_{N_\\mathrm{order}}</var> <var>\\mathrm{state}_{N_\\mathrm{order}}</var> <var>\\mathrm{time}_{N_\\mathrm{order}}</var>\n</pre>\n\n<ul>\n<li>始めの <var>N_\\mathrm{grid}</var> 行のうち <var>i</var> 行目は、<var>x_i</var> 上に存在するナノグリッドの蓄電量が <var>y_i</var> であり、前時刻 <var>t-1</var> における実際の電力需給、余って捨てられた電気の量、電力不足で系統から購入した電気の量がそれぞれ <var>\\mathrm{pw}_{i}^{\\mathrm{actual},t-1}</var>、<var>\\mathrm{pw}_{i}^{\\mathrm{excess},t-1}</var>、<var>\\mathrm{pw}_{i}^{\\mathrm{buy},t-1}</var> であることを表す。ただし <var>t=0</var> においては、 <var>\\mathrm{pw}_{i}^{\\mathrm{actual},t-1}</var>、<var>\\mathrm{pw}_{i}^{\\mathrm{excess},t-1}</var>、<var>\\mathrm{pw}_{i}^{\\mathrm{buy},t-1}</var> はいずれも <var>0</var> が表示されるものとする。<br>\n補足: <var>\\mathrm{pw}_{i}^{\\mathrm{actual},t-1}</var>、<var>\\mathrm{pw}_{i}^{\\mathrm{excess},t-1}</var>、<var>\\mathrm{pw}_{i}^{\\mathrm{buy},t-1}</var>は、それぞれ <a href=\"#charge\"> ナノグリッドの蓄電池の充放電処理 </a>\"処理1\"の <var>\\Delta^{\\mathrm{grid}}_{\\mathrm{gen},t-1}</var>、\"処理2\"の\"速度や上限蓄電量を超えた分の電気\"<var>\\Delta^{\\mathrm{grid}}_{\\mathrm{total},t-1} - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{\\max}-C^{\\mathrm{grid}}_{t-1} \\right\\}</var>、\"処理3\"の\"電力不足分\" <var>- \\Delta^{\\mathrm{grid}}_{\\mathrm{total},t-1} - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{t-1} \\right\\}</var> に対応する。ただし、前時刻 <var>t-1</var> でそれぞれ\"処理2\"、\"処理3\"が実行されなかった場合、<var>\\mathrm{pw}_{i}^{\\mathrm{excess},t-1}</var> と <var>\\mathrm{pw}_{i}^{\\mathrm{buy},t-1}</var> はそれぞれ <var>0</var> となる。</li>\n<li>続く <var>N_\\mathrm{EV}</var> 項目はそれぞれ <var>4</var> 行からなり、そのうち <var>i</var> 項目目の <var>\\mathrm{carinfo}_i</var> は <var>i</var> 番目のEVの状態を表す。<var>\\mathrm{carinfo}_i</var> はそれぞれ後述の形式で与えられる。</li>\n<li>続く <var>1</var> 行は、未配達の注文の個数 <var>N_\\mathrm{order}</var> を表す。</li>\n<li>続く <var>N_\\mathrm{order}</var> 行のうち <var>i</var> 行目は、注文 <var>\\mathrm{id}_i</var> の出発地点が頂点 <var>w_i</var>、到着地点が頂点 <var>z_i</var>、状態が <var>\\mathrm{state}_i</var>、発生時刻が <var>\\mathrm{time}_i</var> であることを表す。状態について、<var>\\mathrm{state}_i=0</var> のときは注文 <var>\\mathrm{id}_i</var> がいまだどのEVにも積まれていないことを表し、<var>\\mathrm{state}_i=1</var> のときは注文 <var>i</var> がいずれかのEVに積まれているが配達が完了していないことを表す。</li>\n</ul>\n<p>また、<var>i</var> 番目のEVの状態を表す <var>\\mathrm{carinfo}_i</var> は、以下の形式で与えられる。</p>\n<pre><var>\\mathrm{charge}_i</var>\n<var>u_i</var> <var>v_i</var> <var>\\mathrm{dist\\_from}\\_u_i</var> <var>\\mathrm{dist\\_to}\\_v_i</var>\n<var>N_{\\mathrm{adj},i}</var> <var>a_{i,1}</var> <var>a_{i,2}</var> <var>\\ldots</var> <var>a_{i,N_\\mathrm{adj}}</var>\n<var>N_{\\mathrm{order},i}</var> <var>o_{i,1}</var> <var>o_{i,2}</var> <var>\\ldots</var> <var>o_{N_{\\mathrm{order}, i}}</var>\n</pre>\n\n<ul>\n<li>始めの <var>1</var> 行目は、 <var>i</var> 番目のEVの蓄電量が <var>\\mathrm{charge}_i</var> であることを表す。</li>\n<li>続く <var>2</var> 行目は、 <var>i</var> 番目のEVの位置を表す。<var>u_i \\ne v_i</var> ならば、<var>i</var> 番目のEVは頂点 <var>u_i</var> と 頂点<var>v_i</var> を結ぶ辺上に存在して頂点 <var>u_i</var> から <var>\\mathrm{dist\\_from}\\_u_i</var>、頂点 <var>v_i</var> から <var>\\mathrm{dist\\_to}\\_v_i</var> の距離にあることを表す。<var>u_i = v_i</var> ならば、<var>i</var> 番目のEVはちょうど頂点 <var>u_i</var> 上にあることを表し、<var>\\mathrm{dist\\_from}\\_u_i</var> と <var>\\mathrm{dist\\_to}\\_v_i</var> は共に <var>0</var> が出力される。</li>\n<li>続く <var>3</var> 行目は、動作<code>move</code>で <var>i</var> 番目のEVがその方向に移動可能な頂点が <var>N_{\\mathrm{adj},i}</var> 個存在し、それらが頂点 <var>a_{i,1}</var>、頂点 <var>a_{i,2}</var>、<var>\\ldots</var>、頂点 <var>a_{i,N_\\mathrm{adj}}</var> であることを表す。</li>\n<li>続く <var>4</var> 行目は、<var>i</var> 番目のEVが運搬中である注文が <var>N_{\\mathrm{order},i}</var> 個存在し、それらが注文<var>o_{i,1}</var>、注文 <var>o_{i,2}</var>、<var>\\ldots</var>、注文 <var>o_{N_{\\mathrm{order}, i}}</var> であることを表す。</li>\n</ul>\n<p>次に、コンテスタントは、時刻 <var>t</var> (<var>0 \\leq t \\lt T_{\\max}</var>) における各EVの動作 <var>\\mathrm{command}_i</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var> を標準出力に出力しなければならない。各動作は改行で区切られなくてはならず、また末尾に改行を出力する必要がある。</p>\n<pre><var>\\mathrm{command}_{1}</var>\n<var>\\mathrm{command}_{2}</var>\n:\n<var>\\mathrm{command}_{N_\\mathrm{EV}}</var>\n</pre>\n\n<p>ここで、<var>\\mathrm{command}</var> は以下の形式でなければならない。</p>\n<ul>\n<li><code>stay</code> を行う場合、<code>stay</code> と <var>1</var> 行で出力</li>\n<li><code>move w</code> を行う場合、<code>move w</code> と <var>1</var> 行で出力</li>\n<li><code>pickup a</code> を行う場合、<code>pickup a</code> と <var>1</var> 行で出力</li>\n<li><code>charge_from_grid</code> <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var> を行う場合、<code>charge_from_grid</code> <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var> と <var>1</var> 行で出力</li>\n<li><code>charge_to_grid</code> <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var> を行う場合、<code>charge_to_grid</code> <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var> と <var>1</var> 行で出力</li>\n</ul>\n<p>それぞれの動作には満たすべき条件が存在する(詳細は<a href=\"#ev\">EV</a>の\"動作\"の節を参照のこと)。それらの条件を満たさない場合の動作は未定義である。<br></p>\n<h2 id=\"io-format3\"> 入出力形式3 </h2>\n\n<p>コンテスタントが時刻 <var>t=T_\\mathrm{max}-1</var> における各EVの動作を標準出力に出力したのち、ジャッジから時刻 <var>t=T_\\mathrm{max}</var> におけるEVとナノグリッドの状態 <var>\\mathrm{info}_t</var> が標準入力に与えられる（<var>\\mathrm{info}_t</var> の形式は\"入出力形式2\"を参照）。引き続いて次の行にジャッジから以下の形式で運搬スコア <var>S_{\\mathrm{trans}}</var> と電力スコア <var>S_{\\mathrm{ele}}</var> が標準入力に与えられる。</p>\n<pre><var>S_{\\mathrm{trans}}</var> <var>S_{\\mathrm{ele}}</var>\n</pre>\n\n<h2 id=\"constraints\"> 入出力制約 </h2>\n\n<ul>\n<li>入力で与えられる数値のうち<b>\"[小数]\"</b>と記載されているものは小数で与えられ、その他のものは整数で与えられる。</li>\n</ul>\n<h4>初期化(入出力形式1)</h4>\n<ul>\n<li><var>N_{\\mathrm{solution}} = 5</var></li>\n<li><var>|V| = 225</var> </li>\n<li><var>1.5 |V| \\leq |E| \\leq  2 |V|</var> </li>\n<li><var>1 \\leq u_{i}, v_{i} \\leq |V|, u_i \\ne v_i</var> <var>(1 \\leq i \\leq |E|)</var></li>\n<li><var>1 \\leq d_i \\leq \\lceil 2\\sqrt{2|V|} \\rceil</var> <var>(1 \\leq i \\leq |E|)</var></li>\n<li>与えられるグラフは自己ループ・多重辺が存在せず、連結であることが保証される。</li>\n<li><var>\\mathrm{DayType} \\in \\left\\{ 0, 1, 2, 3 \\right\\}</var></li>\n<li><var>N_\\mathrm{div} = 20</var></li>\n<li><var>N_\\mathrm{pattern} = 3</var></li>\n<li><var>\\sigma^{2}_{\\mathrm{ele}} = 100</var></li>\n<li><var>p_{\\mathrm{event}} \\in \\left\\{ 0.0, 0.1 \\right\\}</var> <b>\"[小数]\"</b> </li>\n<li><var>\\Delta_{\\mathrm{event}} = 1000</var></li>\n<li><var>-1000 \\lt \\mathrm{pw}_{i,j}^{\\mathrm{predict}} \\lt 1000 (1 \\leq i \\leq N_\\mathrm{pattern}, 1 \\leq j \\leq N_\\mathrm{div})</var></li>\n<li><var>N_\\mathrm{grid} = 20</var></li>\n<li><var>C_{\\mathrm{init}}^{\\mathrm{grid}} = 25000</var></li>\n<li><var>C_{\\mathrm{max}}^{\\mathrm{grid}} = 50000</var></li>\n<li><var>V_{\\max}^{\\mathrm{grid}} = 800</var></li>\n<li><var>1 \\leq x_i \\leq |V|</var> <var>(i \\neq j</var> なら <var>x_i \\neq x_j, 1 \\leq i \\leq N_\\mathrm{grid})</var></li>\n<li><var>1 \\leq \\mathrm{pattern}_i \\leq N_\\mathrm{pattern}</var> <var>(1 \\leq i \\leq N_\\mathrm{grid})</var></li>\n<li><var>N_{\\min}^{\\mathrm{EV}} = 15</var></li>\n<li><var>N_{\\max}^{\\mathrm{EV}} = 25</var></li>\n<li><var>N_{\\min}^{\\mathrm{EV}} \\leq N_\\mathrm{EV} \\leq N_{\\max}^{\\mathrm{EV}}</var></li>\n<li><var>C_{\\mathrm{init}}^{\\mathrm{EV}} = 12500</var></li>\n<li><var>C_{\\mathrm{max}}^{\\mathrm{EV}} = 25000</var></li>\n<li><var>V_{\\max}^{\\mathrm{EV}} = 400</var></li>\n<li><var>N_{\\max}^{\\mathrm{trans}} = 4</var></li>\n<li><var>\\Delta_{\\mathrm{move}}^{\\mathrm{EV}} = 50</var></li>\n<li><var>1 \\leq \\mathrm{pos}_i \\leq |V| (1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>p_{\\mathrm{trans}}^{\\mathrm{const}} = 0.7</var>  <b>\"[小数]\"</b></li>\n<li><var>T_\\mathrm{last} = 900</var></li>\n<li><var>P^{\\mathrm{trans}} = 3000</var></li>\n<li><var>\\gamma = 2.0</var> <b>\"[小数]\"</b></li>\n<li><var>S_{\\mathrm{ele}}^{\\mathrm{ref}} = -1,500,000</var></li>\n<li><var>S_{\\mathrm{trans}}^{\\mathrm{ref}} = -1,900,000</var></li>\n<li><var>T_\\mathrm{max} = 1000</var></li>\n</ul>\n<h4>繰り返し処理(入出力形式2)</h4>\n<ul>\n<li><var>1 \\leq x_i \\leq |V|</var> <var>(i \\neq j</var> なら <var>x_i \\neq x_j, 1 \\leq i \\leq N_\\mathrm{grid})</var></li>\n<li><var>0 \\leq y_i \\leq C_{\\mathrm{max}}^{\\mathrm{grid}}</var> <var>(1 \\leq i \\leq N_\\mathrm{grid})</var></li>\n<li><var>-10000 \\lt \\mathrm{pw}_{i}^{\\mathrm{actual},j} \\lt 10000 (1 \\leq i \\leq N_\\mathrm{grid}, -1 \\leq j \\leq T_\\mathrm{max}-2)</var></li>\n<li><var>0 \\leq \\mathrm{pw}_{i}^{\\mathrm{excess},j} \\lt 10000, (1 \\leq i \\leq N_\\mathrm{grid}, -1 \\leq j \\leq T_\\mathrm{max}-2)</var></li>\n<li><var>0 \\leq \\mathrm{pw}_{i}^{\\mathrm{buy},j} \\lt 10000, (1 \\leq i \\leq N_\\mathrm{grid}, -1 \\leq j \\leq T_\\mathrm{max}-2)</var></li>\n<li><var>0 \\leq \\mathrm{charge}_i \\leq C_{\\mathrm{max}}^{\\mathrm{EV}}</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>1 \\leq u_i, v_i \\leq |V|</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>0 \\leq \\mathrm{dist\\_from}\\_u_i \\leq \\lceil 2\\sqrt{2|V|} \\rceil</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>0 \\leq \\mathrm{dist\\_to}\\_v_i \\leq \\lceil 2\\sqrt{2|V|} \\rceil</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>1 \\leq N_{\\mathrm{adj},i} \\leq 5(\\mathrm{MaxDegree})</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>1 \\leq a_{i,j} \\leq |V|</var> <var>(1 \\leq i \\leq N_\\mathrm{EV}, 1 \\leq j \\leq N_{\\mathrm{adj},i})</var></li>\n<li><var>0 \\leq N_{\\mathrm{order},i} \\leq N_{\\max}^{\\mathrm{trans}}</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>1 \\leq o_{i,j} \\leq T_\\mathrm{last}</var> <var>(1 \\leq i \\leq N_\\mathrm{EV}, 1 \\leq j \\leq N_{\\mathrm{order},i})</var></li>\n<li><var>0 \\leq N_\\mathrm{order} \\leq T_\\mathrm{last}</var></li>\n<li><var>1 \\leq \\mathrm{id}_i \\leq T_\\mathrm{last}</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n<li><var>1 \\leq w_i \\leq |V|</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n<li><var>1 \\leq z_i \\leq |V|</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n<li><var>w_i \\ne z_i</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n<li><var>\\mathrm{state}_i \\in \\left\\{ 0, 1 \\right\\}</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n<li><var>0 \\leq \\mathrm{time}_i \\leq T_\\mathrm{last}</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n</ul>\n<h4>スコア(入出力形式3)</h4>\n<ul>\n<li><var>S_{\\mathrm{trans}}</var> <b>\"[小数]\"</b></li>\n<li><var>S_{\\mathrm{ele}}</var> <b>\"[小数]\"</b></li>\n</ul>\n<h2 id=\"example\"> 入出力例 </h2>\n\n<p>注意: この例はわかりやすさのために小さなセットで入出力を説明したものである。そのためパラメータの値は\"入出力制約\"に書かれた値とは異なるが、入出力のフォーマット(入出力形式1,2及び3)とEVの動作、及び\"ナノグリッドの蓄電池の充放電処理\"に書かれた計算方法は実際と同じである。</p>\n<style>\n.pre-sample-inout {\n  margin: 0;\n}\n</style>\n\n<table class=\"table table-striped table-bordered\">\n    <tbody><tr>\n        <th>時刻</th>\n        <th>ジャッジ</th>\n        <th>コンテスタント</th>\n        <th>説明</th>\n    </tr>\n    <tr>\n        <td></td>\n        <td><pre>1\n4 4\n1 2 1\n2 3 2\n3 4 3\n4 1 1\n0\n2 2 1 0 10\n5 -2\n-4 4\n2 10 20 4\n1 1\n4 2\n2 5 10 2 2 1\n2\n4\n0.5 3\n3 0.5 -100 -100\n4\n</pre></td>\n        <td></td>\n        <td>はじめに、ジャッジ側からデータが与えられる。<br>\n            <var>1</var> 行目: 求解回数は <var>1</var> 回である。<br>\n            <var>2</var> 行目: 無向グラフ <var>G</var> は <var>|V| = 4</var> 個の頂点と <var>|E| = 4</var> 本の辺から構成される。<br>\n            次の <var>4</var> 行 (<var>3</var> - <var>6</var> 行目) は、グラフの辺に関する情報を表す。<br>\n            <var>3</var> 行目: 辺 <var>1</var> は頂点 <var>1</var> と頂点 <var>2</var> を結んでおり、長さは <var>1</var> である。<br>\n            <var>4</var> 行目: 辺 <var>2</var> は頂点 <var>2</var> と頂点 <var>3</var> を結んでおり、長さは <var>2</var> である。<br>\n            <var>5</var> 行目: 辺 <var>3</var> は頂点 <var>3</var> と頂点 <var>4</var> を結んでおり、長さは <var>3</var> である。<br>\n            <var>6</var> 行目: 辺 <var>4</var> は頂点 <var>4</var> と頂点 <var>1</var> を結んでおり、長さは <var>1</var> である。<br>\n            <var>7</var> 行目: 天候タイプは <var>0</var> \"晴(ゲリラ豪雨無し)\" である。<br>\n            <var>8</var> 行目: 予想電力需給が一定の時間区間の数は <var>2</var> 個、ナノグリッドの需要パターンは <var>2</var> 個、電力需給のゆらぎの分散は <var>1</var> 、ゲリラ豪雨の発生確率は <var>0</var>、ゲリラ豪雨発生時の電力需給の低下量は <var>10</var> である。<br>\n            次の <var>2</var> 行 (<var>9</var> - <var>10</var> 行目) は、予想電力需給に関する情報を表す。<br>\n            <var>9</var> 行目: 需要パターン <var>1</var> のナノグリッドの予想電力需給は <var>5</var> (時間区間 <var>1</var>)、<var>-2</var> (時間区間 <var>2</var>)である。<br>\n            <var>10</var> 行目: 需要パターン <var>2</var> のナノグリッドの予想電力需給は <var>-4</var> (時間区間 <var>1</var>)、<var>4</var> (時間区間 <var>2</var>)である。<br>\n            <var>11</var> 行目: グラフ <var>G</var> の頂点のうちナノグリッドがあるものは <var>N_\\mathrm{grid} = 2</var> 個、時刻 <var>t=0</var> におけるナノグリッドの蓄電量は <var>C_{\\mathrm{init}}^{\\mathrm{grid}} = 10</var>、最大蓄電量は <var>C_{\\mathrm{max}}^{\\mathrm{grid}} = 20</var>、上限充放電速度は <var>V_{\\max}^{\\mathrm{grid}} = 4</var> である。<br>\n            <var>12</var> 行目: ナノグリッド <var>1</var> は頂点 <var>1</var> 上にあり、需要パターンは <var>1</var> である。<br>\n            <var>13</var> 行目: ナノグリッド <var>2</var> は頂点 <var>4</var> 上にあり、需要パターンは <var>2</var> である。<br>\n            <var>14</var> 行目: あなたが動作させることができるEVの台数は <var>N_\\mathrm{EV} = 2</var> 台、時刻 <var>t=0</var> におけるEVの蓄電量は <var>C_{\\mathrm{init}}^{\\mathrm{EV}} = 5</var>、最大蓄電量は <var>C_{\\mathrm{max}}^{\\mathrm{EV}} = 10</var>、上限充放電速度は <var>V_{\\max}^{\\mathrm{EV}} = 2</var> 、同時に <var>1</var> 台のEVに積載可能な運搬物の上限数は <var>N_{\\max}^{\\mathrm{trans}} = 2</var>、単位時間のEVの移動で減少する蓄電量は <var>\\Delta_{\\mathrm{move}}^{\\mathrm{EV}} = 1</var> である。<br>\n            次の <var>2</var> 行 (<var>15</var> - <var>16</var> 行目) は時刻 <var>t=0</var> における各EVの位置を表す。<br>\n            <var>15</var> 行目: EV <var>1</var> は時刻 <var>t=0</var> で頂点 <var>2</var> 上にある。<br>\n            <var>16</var> 行目: EV <var>2</var> は時刻 <var>t=0</var> で頂点 <var>4</var> 上にある。<br>\n            <var>17</var> 行目: 各時刻で新しい運搬依頼が発生する確率は <var>p_{\\mathrm{trans}}^{\\mathrm{const}} = 0.5</var> であり、新しい運搬依頼が発生する最終時刻は <var>T_\\mathrm{last} = 3</var> である。<br>\n            <var>18</var> 行目: 最終時刻まで完了しない運搬依頼 <var>1</var> つあたり、<var>P^{\\mathrm{trans}} = 3</var> 点が減点される。ナノグリッドが外部から補充した単位電気量あたりの減点は <var>\\gamma = 0.5</var> 点である。電力スコアの基準スコアは <var>S_{\\mathrm{ele}}^{\\mathrm{ref}} = -100</var> 点であり、運搬スコアの基準スコアは <var>S_{\\mathrm{trans}}^{\\mathrm{ref}} = -100</var> 点である。<br>\n            <var>19</var> 行目: あなたが行動するターン数は <var>T_{\\max} = 4</var> である。\n        </td>\n    </tr>\n    <tr>\n        <td>0</td>\n        <td><pre>1 10 0 0 0\n4 10 0 0 0\n5\n2 2 0 0\n2 1 3\n0\n5\n4 4 0 0\n2 1 3\n0\n1\n1 1 4 0 0\n</pre></td>\n        <td><pre>move 1\ncharge_from_grid 2</pre></td>\n        <td>\n            次いで、ジャッジ側から時刻 <var>0</var> でのデータが与えられる。<br>\n            1 行目: 頂点 1 にあるナノグリッドの時刻 <var>0</var> での蓄電量は <var>10</var> である(時刻 <var>0</var> の場合、残りの <var>3</var> つの値は必ず <var>0</var> である)。<br>\n            2 行目: 頂点 4 にあるナノグリッドの時刻 <var>0</var> での蓄電量は <var>10</var> である(時刻 <var>0</var> の場合、残りの <var>3</var> つの値は必ず <var>0</var> である)。<br>\n            次の <var>4</var> 行 (<var>3</var> - <var>6</var> 行目) は、EV <var>1</var> の状態を表す。<br>\n            3 行目: EV <var>1</var> の時刻 <var>0</var> での蓄電量は <var>5</var> である。<br>\n            4 行目: EV <var>1</var> は時刻 <var>0</var> において頂点 <var>2</var> 上に位置する。<br>\n            5 行目: EV <var>1</var> が `move` コマンドでその方向に向かって移動可能な頂点は <var>N_{\\mathrm{adj},1} = 2</var> 個あり、頂点 <var>1</var> および頂点 <var>3</var> である。<br>\n            6 行目: EV <var>1</var> が 運搬中である注文は <var>N_{\\mathrm{order},i} = 0</var> 個である。<br>\n            次の <var>4</var> 行 (<var>7</var> - <var>10</var> 行目) は、EV <var>2</var> の状態を表す。<br>\n            7 行目: EV <var>2</var> の時刻 <var>0</var> での蓄電量は <var>5</var> である。<br>\n            8 行目: EV <var>2</var> は時刻 <var>0</var> において頂点 <var>4</var> 上に位置する。<br>\n            9 行目: EV <var>2</var> が `move` コマンドでその方向に向かって移動可能な頂点は <var>N_{\\mathrm{adj},2} = 2</var> 個あり、頂点 <var>1</var> および頂点 <var>3</var> である。<br>\n            10 行目: EV <var>2</var> が 運搬中である注文は <var>N_{\\mathrm{order},i} = 0</var> 個である。<br>\n            11 行目: 未配達の注文が <var>N_\\mathrm{order} = 1</var> 個存在する。<br>\n            12 行目: 注文 <var>1</var> は頂点 <var>1</var> から頂点 <var>4</var> への配達であり、どのEVにも積まれておらず、時刻 <var>0</var> に発生したものである。<br>\n            これに対するコンテスタントの出力は以下のとおりである。<br>\n            1 行目: EV <var>1</var> を頂点 <var>1</var> の方向へ移動させようとする。EV <var>1</var> の充電が <var>1</var> 消費されるが、蓄電量が <var>1</var> 以上であったため移動は成功する。頂点 <var>1</var> から頂点 <var>2</var> への辺の長さは <var>1</var> であるので、時刻 <var>1</var> に頂点 <var>2</var> へ移動することが可能である。<br>\n            2 行目: EV <var>2</var> はナノグリッドから <var>2</var> だけ充電する。EV <var>2</var> はナノグリッド上にあり、充電量はEV <var>2</var> の上限充放電速度 <var>2</var> を超えない。またEV <var>2</var> の充電後の蓄電量は最大蓄電量 <var>10</var> を超えない。したがって動作条件を満たすので、時刻 <var>1</var> に充電量を <var>7</var> に増やすことが可能である。\n        </td>\n    </tr>\n    <tr>\n        <td>1</td>\n        <td><pre>1 14 5 1 0\n4 6 -4 0 2\n4\n1 1 0 0\n2 2 4\n0\n7\n4 4 0 0\n2 1 3\n0\n1\n1 1 4 0 0</pre></td>\n        <td><pre>pickup 1\ncharge_from_grid 2</pre></td>\n        <td>\n            次いで、ジャッジ側から時刻 <var>1</var> でのデータが与えられる。<br>\n            1 行目: 頂点 1 にあるナノグリッドの時刻 <var>1</var> での蓄電量は <var>14</var> であり、前時刻 <var>t=0</var> における実際の電力需給、余って捨てられた電気の量、電力不足で系統から購入した電気の量がそれぞれ <var>5, 1, 0</var> である(ナノグリッドの上限充放電速度を超える分は捨てられる)。<br>\n            2 行目: 頂点 4 にあるナノグリッドの時刻 <var>1</var> での蓄電量は <var>6</var> であり、前時刻 <var>t=0</var> における実際の電力需給、余って捨てられた電気の量、電力不足で系統から購入した電気の量がそれぞれ <var>-4, 0, 2</var> である。<br>\n            次の <var>4</var> 行 (<var>3</var> - <var>6</var> 行目) は、EV <var>1</var> の状態を表す。<br>\n            3 行目: EV <var>1</var> の時刻 <var>1</var> での蓄電量は <var>4</var> である。<br>\n            4 行目: EV <var>1</var> は時刻 <var>1</var> において頂点 <var>1</var> 上に位置する。<br>\n            5 行目: EV <var>1</var> が `move` コマンドでその方向に向かって移動可能な頂点は <var>N_{\\mathrm{adj},1} = 2</var> 個あり、頂点 <var>2</var> および頂点 <var>4</var> である。<br>\n            6 行目: EV <var>1</var> が 運搬中である注文は <var>N_{\\mathrm{order},i} = 0</var> 個である。<br>\n            次の <var>4</var> 行 (<var>7</var> - <var>10</var> 行目) は、EV <var>2</var> の状態を表す。<br>\n            7 行目: EV <var>2</var> の時刻 <var>1</var> での蓄電量は <var>7</var> である。<br>\n            8 行目: EV <var>2</var> は時刻 <var>1</var> において頂点 <var>4</var> 上に位置する。<br>\n            9 行目: EV <var>2</var> が `move` コマンドでその方向に向かって移動可能な頂点は <var>N_{\\mathrm{adj},2} = 2</var> 個あり、頂点 <var>1</var> および頂点 <var>3</var> である。<br>\n            10 行目: EV <var>2</var> が 運搬中である注文は <var>N_{\\mathrm{order},i} = 0</var> 個である。<br>\n            11 行目: 未配達の注文が <var>N_\\mathrm{order} = 1</var> 個存在する。<br>\n            12 行目: 注文 <var>1</var> は頂点 <var>1</var> から頂点 <var>4</var> への配達であり、どのEVにも積まれておらず、時刻 <var>0</var> に発生したものである。<br>\n            これに対するコンテスタントの出力は以下のとおりである。<br>\n            1 行目: 頂点 <var>1</var> に位置するEV <var>1</var> に注文 <var>1</var> を積む。充電は消費されない。<br>\n            2 行目: EV <var>2</var> はナノグリッドから <var>2</var> だけ充電する。EV <var>2</var> はナノグリッド上にあり、充電量はEV <var>2</var> の上限充放電速度 <var>2</var> を超えない。またEV <var>2</var> の充電後の蓄電量は最大蓄電量 <var>10</var> を超えない。したがって動作条件を満たすので、時刻 <var>2</var> に充電量を <var>9</var> に増やすことが可能である。\n        </td>\n    </tr>\n    <tr>\n        <td>2</td>\n        <td><pre>1 18 5 1 0 \n4 2 -4 0 2\n4\n1 1 0 0\n2 2 4\n1 1\n9\n4 4 0 0\n2 1 3\n0\n2\n1 1 4 1 0\n2 4 1 0 2</pre></td>\n        <td><pre>move 4\npickup 2</pre></td>\n        <td>\n            次いで、ジャッジ側から時刻 <var>2</var> でのデータが与えられる。<br>\n            1 行目: 頂点 1 にあるナノグリッドの時刻 <var>2</var> での蓄電量は <var>18</var> であり、前時刻 <var>t=1</var> における実際の電力需給、余って捨てられた電気の量、電力不足で系統から購入した電気の量がそれぞれ <var>5, 1, 0</var> である。<br>\n            2 行目: 頂点 4 にあるナノグリッドの時刻 <var>2</var> での蓄電量は <var>2</var> であり、前時刻 <var>t=1</var> における実際の電力需給、余って捨てられた電気の量、電力不足で系統から購入した電気の量がそれぞれ <var>-4, 0, 2</var> である。<br>\n            次の <var>4</var> 行 (<var>3</var> - <var>6</var> 行目) は、EV <var>1</var> の状態を表す。<br>\n            3 行目: EV <var>1</var> の時刻 <var>2</var> での蓄電量は <var>4</var> である。<br>\n            4 行目: EV <var>1</var> は時刻 <var>2</var> において頂点 <var>1</var> 上に位置する。<br>\n            5 行目: EV <var>1</var> が `move` コマンドでその方向に向かって移動可能な頂点は <var>N_{\\mathrm{adj},1} = 2</var> 個あり、頂点 <var>2</var> および頂点 <var>4</var> である。<br>\n            6 行目: EV <var>1</var> が 運搬中である注文は <var>N_{\\mathrm{order},i} = 1</var> 個であり、注文 <var>1</var> を運搬中である。<br>\n            次の <var>4</var> 行 (<var>7</var> - <var>10</var> 行目) は、EV <var>2</var> の状態を表す。<br>\n            7 行目: EV <var>2</var> の時刻 <var>2</var> での蓄電量は <var>9</var> である。<br>\n            8 行目: EV <var>2</var> は時刻 <var>2</var> において頂点 <var>4</var> 上に位置する。<br>\n            9 行目: EV <var>2</var> が `move` コマンドでその方向に向かって移動可能な頂点は <var>N_{\\mathrm{adj},2} = 2</var> 個あり、頂点 <var>1</var> および頂点 <var>3</var> である。<br>\n            10 行目: EV <var>2</var> が 運搬中である注文は <var>N_{\\mathrm{order},i} = 0</var> 個である。<br>\n            11 行目: 未配達の注文が <var>N_\\mathrm{order} = 2</var> 個存在する。<br>\n            12 行目: 注文 <var>1</var> は頂点 <var>1</var> から頂点 <var>4</var> への配達であり、いずれかのEV(この場合はEV <var>1</var>)に積まれており、時刻 <var>0</var> に発生したものである。<br>\n            13 行目: 注文 <var>2</var> は頂点 <var>4</var> から頂点 <var>1</var> への配達であり、どのEVにも積まれておらず、時刻 <var>2</var> に発生したものである。<br>\n            これに対するコンテスタントの出力は以下のとおりである。<br>\n            1 行目: EV <var>1</var> を頂点 <var>4</var> の方向へ移動させようとする。EV <var>1</var> の充電が <var>1</var> 消費されるが、蓄電量が <var>1</var> 以上であったため移動は成功する。頂点 <var>1</var> から頂点 <var>4</var> への辺の長さは <var>1</var> であるので、時刻 <var>3</var> に頂点 <var>4</var> へ移動することが可能である。<br>\n            2 行目: 頂点 <var>4</var> に位置するEV <var>2</var> に注文 <var>2</var> を積む。充電は消費されない。\n        </td>\n    </tr>\n    <tr>\n        <td>3</td>\n        <td><pre>1 17 -1 0 0\n4 6 4 0 0\n3\n4 4 0 0\n2 1 3\n0\n9\n4 4 0 0\n2 1 3\n1 2\n1\n2 4 1 1 2</pre></td>\n        <td><pre>stay\nmove 1</pre></td>\n        <td>\n            次いで、ジャッジ側から時刻 <var>3</var> でのデータが与えられる。<br>\n            1 行目: 頂点 1 にあるナノグリッドの時刻 <var>3</var> での蓄電量は <var>17</var> であり、前時刻 <var>t=2</var> における実際の電力需給、余って捨てられた電気の量、電力不足で系統から購入した電気の量がそれぞれ <var>-1, 0, 0</var> である(電力需給の予測値は <var>-2</var> だがゆらぎにより実際の値は <var>-1</var> となった)。<br>\n            2 行目: 頂点 4 にあるナノグリッドの時刻 <var>3</var> での蓄電量は <var>6</var> であり、前時刻 <var>t=2</var> における実際の電力需給、余って捨てられた電気の量、電力不足で系統から購入した電気の量がそれぞれ <var>4, 0, 0</var> である。<br>\n            次の <var>4</var> 行 (<var>3</var> - <var>6</var> 行目) は、EV <var>1</var> の状態を表す。<br>\n            3 行目: EV <var>1</var> の時刻 <var>3</var> での蓄電量は <var>3</var> である。<br>\n            4 行目: EV <var>1</var> は時刻 <var>3</var> において頂点 <var>4</var> 上に位置する。<br>\n            5 行目: EV <var>1</var> が `move` コマンドでその方向に向かって移動可能な頂点は <var>N_{\\mathrm{adj},1} = 2</var> 個あり、頂点 <var>1</var> および頂点 <var>3</var> である。<br>\n            6 行目: EV <var>1</var> が 運搬中である注文は <var>N_{\\mathrm{order},i} = 0</var> 個である。前時刻まで積載していた注文 <var>1</var> は目的地頂点 <var>4</var> に到達したため、降ろされた。<br>\n            次の <var>4</var> 行 (<var>7</var> - <var>10</var> 行目) は、EV <var>2</var> の状態を表す。<br>\n            7 行目: EV <var>2</var> の時刻 <var>3</var> での蓄電量は <var>9</var> である。<br>\n            8 行目: EV <var>2</var> は時刻 <var>3</var> において頂点 <var>4</var> 上に位置する。<br>\n            9 行目: EV <var>2</var> が `move` コマンドでその方向に向かって移動可能な頂点は <var>N_{\\mathrm{adj},2} = 2</var> 個あり、頂点 <var>1</var> および頂点 <var>3</var> である。<br>\n            10 行目: EV <var>2</var> が 運搬中である注文は <var>N_{\\mathrm{order},i} = 1</var> 個であり、注文 <var>2</var> を運搬中である。<br>\n            11 行目: 未配達の注文が <var>N_\\mathrm{order} = 1</var> 個存在する。<br>\n            12 行目: 注文 <var>2</var> は頂点 <var>4</var> から頂点 <var>1</var> への配達であり、いずれかのEV(この場合はEV <var>2</var>)に積まれており、時刻 <var>2</var> に発生したものである。<br>\n            これに対するコンテスタントの出力は以下のとおりである。<br>\n            1 行目: EV <var>1</var> はその場にとどまる<br>\n            2 行目: EV <var>2</var> を頂点 <var>1</var> の方向へ移動させようとする。EV <var>1</var> の充電が <var>1</var> 消費されるが、蓄電量が <var>1</var> 以上であったため移動は成功する。頂点 <var>4</var> から頂点 <var>1</var> への辺の長さは <var>1</var> であるので、時刻 <var>4</var> に頂点 <var>1</var> へ移動することが可能である。また、積んでいる注文 <var>2</var> の到着地点は頂点 <var>1</var> であるので、その際に注文 <var>2</var> が完了する。\n        </td>\n    </tr>\n    <tr>\n        <td>4</td>\n        <td><pre>1 15 -2 0 0\n4 10 5 1 0\n3\n4 4 0 0\n2 1 3\n0\n8\n1 1 0 0\n2 2 4\n0\n0\n3.0 34.0</pre></td>\n        <td></td>\n        <td>\n            最後に、ジャッジ側から時刻 <var>4</var> でのデータが与えられる。<br>\n            1 行目: 頂点 1 にあるナノグリッドの時刻 <var>4</var> での蓄電量は <var>15</var> であり、前時刻 <var>t=3</var> における実際の電力需給、余って捨てられた電気の量、電力不足で系統から購入した電気の量がそれぞれ <var>-2, 0, 0</var> である。<br>\n            2 行目: 頂点 4 にあるナノグリッドの時刻 <var>4</var> での蓄電量は <var>10</var> であり、前時刻 <var>t=3</var> における実際の電力需給、余って捨てられた電気の量、電力不足で系統から購入した電気の量がそれぞれ <var>5, 1, 0</var> である(電力需給の予測値は <var>4</var> だがゆらぎにより実際の値は <var>5</var> となった)。<br>\n            次の <var>4</var> 行 (<var>3</var> - <var>6</var> 行目) は、EV <var>1</var> の状態を表す。<br>\n            3 行目: EV <var>1</var> の時刻 <var>4</var> での蓄電量は <var>3</var> である。<br>\n            4 行目: EV <var>1</var> は時刻 <var>4</var> において頂点 <var>4</var> 上に位置する。<br>\n            5 行目: EV <var>1</var> が `move` コマンドでその方向に向かって移動可能な頂点は <var>N_{\\mathrm{adj},1} = 2</var> 個あり、頂点 <var>1</var> および頂点 <var>3</var> である。<br>\n            6 行目: EV <var>1</var> が 運搬中である注文は <var>N_{\\mathrm{order},i} = 0</var> 個である。<br>\n            次の <var>4</var> 行 (<var>7</var> - <var>10</var> 行目) は、EV <var>2</var> の状態を表す。<br>\n            7 行目: EV <var>2</var> の時刻 <var>4</var> での蓄電量は <var>8</var> である。<br>\n            8 行目: EV <var>2</var> は時刻 <var>4</var> において頂点 <var>1</var> 上に位置する。<br>\n            9 行目: EV <var>2</var> が `move` コマンドでその方向に向かって移動可能な頂点は <var>N_{\\mathrm{adj},2} = 2</var> 個あり、頂点 <var>2</var> および頂点 <var>4</var> である。<br>\n            10 行目: EV <var>2</var> が 運搬中である注文は <var>N_{\\mathrm{order},i} = 0</var> 個である。前時刻まで積載していた注文 <var>2</var> は目的地頂点 <var>1</var> に到達したため、降ろされた。<br>\n            11 行目: 未配達の注文が <var>N_\\mathrm{order} = 0</var> 個存在する。<br>\n            次の <var>1</var> 行 (<var>12</var> 行目) は、運搬スコア及び電力スコアを表す。<br>\n            12 行目: 運搬スコアは <var>3</var>となり、電力スコアは<var>34.0</var>となる。<br>\n            計算方法: 運搬は <var>2</var> つ発生し、それぞれの待ち時間 <var>3</var>、<var>2</var> であり、未運搬は無いため、運搬スコアは <var>(4-3)+(4-2)-0=3.0</var> と計算される。電力は、EV <var>2</var> 台の最終時刻の蓄電量がそれぞれ <var>3</var>、<var>8</var> であり、ナノグリッド <var>2</var> 箇所の最終時刻の蓄電量がそれぞれ <var>15</var>、<var>10</var> であるため、総残電力は <var>36</var> となる。また、系統からの購入電力量が合計で <var>4</var> (頂点 <var>4</var> のナノグリッドが時刻 <var>0</var> と <var>1</var> でそれぞれ <var>2</var> ずつ購入)なので、電力スコアは <var>36-0.5 \\times 4=34.0</var> と計算される。\n        </td>\n    </tr>\n</tbody></table>\n\n<h2 id=\"sample\"> サンプルコード B </h2>\n\n<p>問題Bのツールキット一式は<a href=\"https://img.atcoder.jp/hokudai-hitachi2020/5ab74962545bbb200f633f2a6f1d9fb3.zip\">ここ</a>からダウンロードできます。<br>\nこのツールキットを用いて、手元の環境で入力サンプル(テストケース)の生成や、ジャッジの実行が可能です。また、ビギナー向けのサンプルコードも用意しています。<br>\n<b>小さなバグが見つかったため、ツールキットを修正しました(12/18)。</b><br>\n<b>windowsでも利用可能なツールキットを公開しました(Cygwin,WSLで動作確認済)。合わせて英語版のREADME(short ver.)も追加しました。また、辺数の制約に関するバグの修正をしています。(12/18)</b><br>\n<b>英語版のREADME(full ver.)を公開しました。また、日本語版のREADMEの細かな誤りを修正しました。(12/21)</b><br>\n<b>ジャッジシステムの修正(python等投稿対応)に合わせてツールキットを修正しました。また、Pythonのサンプルコードも同梱しました。使い方はREADMEを御覧ください。(1/6)</b><br>\n<b>ツールキットを修正しました(DEBUG_LEVELに関する修正など)。また、サンプルコードの微修正も行いました。(1/12)</b><br></p>\n<ul>\n<li>入力サンプルジェネレータ</li>\n<li>テスター</li>\n<li>ビキナー向けのサンプルコード</li>\n</ul></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n\n<div class=\"part\">\n<section>\n<h3> Table of contents </h3>\n<p><a href=\"#gaiyou_en\"> Problem Summary </a><br>\n<a href=\"#time-space_en\"> Time Schedules and Spatial Structures </a><br>\n<a href=\"#nanogrid_en\"> Constitution of a Nanogrid </a><br>\n<a href=\"#yojou_en\"> Energy Balance </a><br>\n<a href=\"#trans_en\"> Order Processing </a><br>\n<a href=\"#ev_en\"> EV Operation </a><br>\n<a href=\"#charge_en\"> Charge/Discharge to the Battery of a Nanogrid </a><br>\n<a href=\"#scoring_en\"> Scoring </a><br>\n<a href=\"#problem_en\"> Problem B </a><br>\n<a href=\"#io-format1_en\"> Input and Output Format 1 </a><br>\n<a href=\"#io-format2_en\"> Input and Output Format 2 </a><br>\n<a href=\"#io-format3_en\"> Input and Output Format 3 </a><br>\n<a href=\"#constraints_en\"> Constraints for Input and Output </a><br>\n<a href=\"#example_en\"> Example of Inputs and Outputs </a><br>\n<a href=\"#sample_en\"> Sample Code B </a><br></p>\n<h2 id=\"gaiyou_en\"> Problem Summary </h2>\n\n<p>In this problem, you operate multiple electric vehicles (EVs) so that you can transport customers and goods from one place to another place efficiently while protecting distributed nanogrids from overloading the electrical supply to EVs and providing additional power from EVs if there is a power shortage in the nanogrids. Since EVs consume electricity proportional to their distances traveled, they need to charge from nanogrids if necessary. Each nanogrid is equipped with a battery, a photovoltaic (PV) power system and a fuel engine. Power generation, consumption and charge/discharge to EVs occur in each nanogrid and their time-varying imbalance is compensated by charge/discharge from the battery and electrical supply from outside.</p>\n<div style=\"text-align:center;\">\n<img src=\"https://img.atcoder.jp/hokudai-hitachi2020/3bc0380fb6ad1edd65af67c71e1cb2f5.png\">\n</div>\n\n<p><span style=\"color:red;font-weight:bold;\">The toolkit, which can be downloaded from the bottom of this page, contains a sample of contestant code in which input/output such as reading data from the judge code has already been implemented. Also, regarding the operation of EV, \"all stay\", \"random walk\", and \"multiple transportation\" have been implemented as examples. When implementing a new algorithm, the sample is designed so that you can focus on describing the operation of EV by inheriting the strategy class. (See README.md for details.) You can use the sample when submitting your code.</span></p>\n<h2 id=\"time-space_en\"> Time Schedules and Spatial Structures </h2>\n\n<ul>\n<li><strong>Time Schedules</strong>: The total time length of each test case corresponds physically to one business day. The time variable <var>t</var> is supposed to be integer valued ranging from <var>0</var> to <var>T_{max}</var>. For each test case, one of the four different one day weather patterns is randomly assigned and the weather pattern affects the resulting time series of difference between generated and consumed powers (energy balance). In the beginning of each test case, each contestant gets a whole time series of predicted energy balance and, for each time <var>t</var>, each contestant gets the charged capacity of the battery for each nanogrid, the set of orders assigned so far, and the following values in the previous step: actual energy balance, excess amount of power discarded, and power supplied from the outside. Based on the information, each contestant is asked to decide how to operate multiple EVs in the next step for each time <var>t</var>.</li>\n<li><strong>Spatial Structures</strong>: Let <var>G = (V, E)</var> be a simple and undirected graph with the vertex set <var>V</var> and the edge set <var>E</var>, which represents a road network on which EV transportation and EV charge/discharge occur. Nanogrids are located on some of the vertices. An edge represents the road connecting its two endpoints and has a positive integer weight corresponding to the road distance. The graph is generated by the algorithm below.</li>\n</ul>\n<details>\n<summary style=\"display:list-item\"> Algorithm to generate the graph <var>G</var>  </summary>\n\nFor all test cases, the graph <var>G = (V, E)</var> is generated by the following algorithm.\n\n<ul>\n<li> <b>Input:</b><var>|V|</var>, <var>|E|</var>, <var>\\mathrm{MaxDegree}=5</var></li>\n<li> <b>Algorithm to generate the vertices:</b>\n<ul>\n  <li> Find the maximum non-negative integer <var>R</var> such that <var>|V| = R^{2} + r</var> holds for a non-negative integer <var>r</var>.</li>\n  <li> For each lattice point satisfying <var>0 \\leq x, y &lt; R</var> in the <var>xy</var> plane, plot a point <var>(x, y)</var>.</li>\n  <li> Shift each point such as <var>(x, y) \\leftarrow (x + dx, y + dy)</var> where <var>dx</var> and <var>dy</var> are random numbers sampled uniformly from the interval <var>[0, 1]</var>.</li>\n  <li> Remaining <var>r</var> points are plotted at <var>(x', y')</var> where <var>x'</var> and <var>y'</var> are random numbers sampled uniformly from the interval <var>[0, R]</var>.</li>\n  <li> Assign a separate ID ranging from <var>1</var> to <var>|V|</var> to each point and identify each point to the vertex having the assigned ID.</li>\n</ul>\n</li>\n\n<li> <b>Algorithm to generate the <var>|V|-1</var> edges and their weights to guarantee the connectivity of the resulting graph:</b>\n<ul>\n  <li> Generate the complete graph <var>G_{\\text{comp}}</var> with the vertex set <var>V</var>. For each pair of vertices <var>u, v \\in V</var>, assign the Euclidean distance between the points corresponding to <var>u</var> and <var>v</var> to the edge weight <var>W_{u,v}</var>.</li>\n  <li> Generate <a href=\"https://en.wikipedia.org/wiki/Minimum_spanning_tree\">the minimum spanning tree</a> for <var>G_{\\text{comp}}</var> and add <var>|V|-1</var> edges in the minimum spanning tree to the graph <var>G</var>. For each edge <var>\\left\\{ u, v \\right\\}</var>, assign <var>\\lceil 2 \\times W_{u, v} \\rceil </var> to the edge weight <var>d_{u,v}</var>.\n  </li>\n</ul>\n</li>\n\n<li> <b>Algorithm to generate the remaining <var>|E|-(|V|-1)</var> edges and their weights:</b>\n<ul>\n  <li> Remaining <var>|E|-(|V|-1)</var> edges are generated by the following algorithm.\n  <ul>\n    <li> Update <var>\\mathrm{cost}(u,v)</var> based on the algorithm below.</li>\n    <li> Find the pair of vertices <var>u</var> and <var>v</var> minimizing <var>\\mathrm{cost(u,v)}</var> among all the pairs of vertices not connected by the edges added to the graph <var>G</var> so far and add the edge <var>\\left\\{ u, v \\right\\}</var> connecting the pair to the graph <var>G</var>.</li>\n    <li> Assign <var> \\lceil 2 \\times W_{u, v} \\rceil </var> to the edge weight <var>d_{u,v}</var>.</li>\n  </ul>\n  </li>\n  <li>\n  Here <var>\\mathrm{cost}(u,v)</var> is basically determined by the Euclidean distance between the points corresponding to <var>u</var> and <var>v</var> but is biased so that a pair of vertices <var>u</var> and <var>v</var> one of whose degree is small and a pair of vertices lining up vertically and horizontally rather than diagonally are likely to be selected. Due to the bias, the resulting graph is expected to be close to a planer graph. In what follows, we show the algorithm to compute <var>\\mathrm{cost}(u,v)</var>.\n  <ul>\n    <li> Compute the degree <var>\\mathrm{degree}(u)</var> of the vertex <var>u\\in V</var>. The degree <var>\\mathrm{degree}(u)</var> of the vertex <var>u\\in V</var> is defined by the number of edges incident to the vertex.</li>\n    <li> Assign a color to each vertex <var>u\\in V</var> as follows: Colors of the first added <var>R^{2}</var> vertices are determined based on their original lattice points <var>(x,y)</var> based on the rule below. Colors of the remaining <var>r</var> vertices are randomly assigned to be <var>0</var> or <var>1</var>.\n    <ul>\n      <li> If <var>x+y</var> is even : <var>\\mathrm{color}(u) = 0</var> </li>\n      <li> If <var>x+y</var> is odd : <var>\\mathrm{color}(u) = 1</var> </li>\n    </ul>\n    </li>\n    <li> Bias factor <var>f(u,v)</var> is determined by the following rule:\n    <ul>\n      <li> If <var>\\mathrm{color}(u) = \\mathrm{color}(v)</var> ： <var>\\mathrm{f}(u,v) = 5</var> </li>\n      <li> If <var>\\mathrm{color}(u) \\neq \\mathrm{color}(v)</var> ： <var>\\mathrm{f}(u,v) = 1</var> </li>\n    </ul>\n    </li>\n    <li> Bias factor <var>g(u)</var> is determined by the following rule:\n    <ul>\n      <li> If <var>\\mathrm{degree}(u) \\lt \\mathrm{MaxDegree}</var> : <var>g(u)=1</var> </li>\n      <li> If <var>\\mathrm{degree}(u) \\geq \\mathrm{MaxDegree}</var> : <var>g(u)=\\infty</var> </li>\n    </ul>\n    </li>\n    <li> Compute <var>\\mathrm{cost}(u,v)</var> as follows：\n    <ul>\n      <li> <var>\\mathrm{cost}(u,v) = W_{u,v}\\times \\mathrm{degree}(u) \\times \\mathrm{degree}(v) \\times f(u,v) \\times g(u) \\times g(v)</var>. </li>\n    </ul>\n    </li>\n  </ul>\n  </li>\n</ul>\n</li>\n\n<li> <b> Algorithm to select vertices where nanogrids are located : </b>\n  <ul>\n    <li>Uniformly and randomly select <var>N_{\\mathrm{grid}}</var> distinct vertices from <var>V</var> and locate a nanogrid on each selected vertex. The set of the vertices on which nanogrids are located is denoted as <var>V_{\\mathrm{grid}}</var>.</li>\n  </ul>\n</li>\n\n</ul>\n</details>\n\n<h2 id=\"nanogrid_en\"> Constitution of a Nanogrid </h2>\n\n<p>Each nanogrid consists of a battery, a photovoltaic (PV) power system, a fuel engine, charging/discharging stations for EVs and power consumers and has the following attributes.</p>\n<ul>\n<li>\n<p><strong>Vertex ID</strong>: ID of the vertex <var>u</var> on which the nanogrid is located where <var>u \\in V_{\\mathrm{grid}}</var> (<var>V_{\\mathrm{grid}}</var>: the set of vertices on which nanogrids are located (See \"Algorithm to generate the graph <var>G</var>\".) )</p>\n</li>\n<li>\n<p><strong>Charged Capacity</strong>: The charged capacity of the battery in the nanogrid. Its initial value is <var>C_{\\mathrm{init}}^{\\mathrm{grid}}</var> and its maximum value is <var>C_{\\mathrm{max}}^{\\mathrm{grid}}</var>, which are the same for all the nanogrids. For each time <var>t</var>, the charged capacity changes by the difference between generated and consumed powers (energy balance) and it also changes by the difference between discharged and charged electricity to EVs (For the detail, see <b><a href=\"#charge_en\"> Charge/Discharge to the Battery of a Nanogrid </a></b>.). If the resulting charged capacity exceeds <var>C_{\\mathrm{max}}^{\\mathrm{grid}}</var> at the time <var>t</var>, the charged capacity is set to <var>C_{\\mathrm{max}}^{\\mathrm{grid}}</var> at the time <var>t+1</var> and the excess amount is discarded. Instead, if the resulting capacity is negative at the time <var>t</var>, the shortage is supplied from outside and the charged capacity is set to <var>0</var> at the time <var>t+1</var>. If the latter is the case, the score is deducted in proportion to the amount of shortage (For the detail, see <b><a href=\"#scoring_en\">Scoring</a></b>.)</p>\n</li>\n<li>\n<p><strong>Energy Balance</strong>: Difference between generated and consumed powers except for those for charging/discharging EVs for each time <var>t</var>. Its predicted value for each time <var>t</var> is provided to contestants in the beginning of each test case. Its actual value is sums of the predicted value and random value caused by stochastic fluctuation of the environment and sudden weather changes like downpour and sudden clear sky (For the detail, see <b><a href=\"#yojou_en\">Energy Balance</a></b> below.)</p>\n</li>\n<li>\n<p><strong>Maximum charging/discharging speed</strong>: The maximum speed of charging/discharging to the battery <var>V_{\\max}^{\\mathrm{grid}}</var>, which is the same for all the nanogrids.</p>\n</li>\n</ul>\n<h2 id=\"yojou_en\"> Energy Balance </h2>\n\n<p>Difference between generated and consumed powers except for those for charging/discharging EVs for each time <var>t</var>.</p>\n<ul>\n<li>\n<p><strong>Pattern of the time series of the energy balance</strong>: For each test case, one of the four different one day weather patterns, i.e., sunny with/without downpour and rainy with/without sudden clear sky is randomly assigned and is informed to each contestant in the beginning of the test case. For each nanogrid, one of the <var>N_{\\mathrm{pattern}}</var> different expected demand patterns is randomly assigned and is informed to each contestant in the beginning of each test case. A whole time series of predicted energy balance is provided to each contestant in the beginning of each test case. The amount of generated powers from the PV power system depends on the weather pattern and thus the sums of the predicted values of energy balance in one business day is largest for the weather pattern, sunny without downpour, and is smallest for the weather pattern, rainy without sudden clear sky.</p>\n</li>\n<li>\n<p><strong>The time series of the energy balance</strong>: The time series of the energy balance is sums of predicted one and stochastic fluctuation <var>\\delta</var> and the variation due to downpour and sudden clear sky.</p>\n<ul>\n<li>The total time interval <var>0 \\leq t &lt; T_{\\max}</var> is divided into <var>N_{\\mathrm{div}}</var> subintervals of equal length and predicted value of the energy balance is constant for each subdivided interval.</li>\n<li>For each time <var>t</var>, <var>\\delta</var> is sampled from the normal distribution with the mean <var>0</var> and the variance <var>\\sigma^{2}_{\\mathrm{ele}}</var>. The variance is informed to each contestant in the beginning of each test case but the value <var>\\delta</var> is not informed to each contestant in advance.</li>\n<li>Downpour: If the weather pattern is <var>1</var> (sunny with downpour), downpour occurs with a probability <var>p_{\\mathrm{event}}</var> for each of <var>N_{\\mathrm{div}}</var> subintervals. The probability is constant and independent for each subinterval. If the downpour occurs, the energy balance is subtracted by <var>\\Delta_{\\mathrm{event}}</var> for <var>15</var> percent of the nanogrids randomly and independently chosen for each subinterval because generated power from a photovoltaic (PV) power system decreases.</li>\n<li>Sudden clear sky: If the weather pattern is <var>3</var> (rainy with sudden clear sky), sudden clear sky occurs with the probability <var>p_{\\mathrm{event}}</var> for each of the <var>N_{\\mathrm{div}}</var> subintervals. If the sudden clear sky occurs, the energy balance is added by <var>\\Delta_{\\mathrm{event}}</var> for <var>15</var> percent of the nanogrids randomly and independently chosen for each subinterval because generated power from a photovoltaic (PV) power system increases.</li>\n</ul>\n</li>\n</ul>\n<p>In case of the weather patterns <var>1</var> and <var>3</var>, the timing for downpour or sudden clear sky is not informed to each contestant in advance.</p>\n<div style=\"text-align:center;\">\n<img src=\"https://img.atcoder.jp/hokudai-hitachi2020/19d2265b702a01ed70a6d1ee55639c40.png\">\n</div>\n\n<h2 id=\"trans_en\"> Order Processing </h2>\n\n<p>An order to transport goods from one vertex <var>u \\in V</var> to another vertex <var>v \\in V</var> is randomly generated based on the algorithm below for each time <var>t</var> and each contestant is asked to process the order by picking it up at the vertex <var>u</var> and delivering it to the vertex <var>v</var> by operating EVs. In what follows, we call <var>u</var> a starting vertex and <var>v</var> a destination vertex.</p>\n<ul>\n<li>\n<p><strong>Attributes for order</strong>:</p>\n<ul>\n<li>Order ID <var>(1,...)</var></li>\n<li>Load time <var>(0 \\leq t \\leq T_{\\mathrm{last}}(&lt;T_{\\max}))</var></li>\n<li>Starting vertex <var>(1,...,|V|)</var></li>\n<li>Destination vertex <var>(1,...,|V|)</var></li>\n<li>State (<var>0</var> if none of the EVs picks the order up and <var>1</var> if one of the EVs picked it up but it is not yet delivered.)</li>\n</ul>\n</li>\n<li>\n<p><strong>Algorithm to generate orders</strong>: For each time <var>t</var> satisfying <var>0 \\leq t \\leq T_{\\mathrm{last}}(&lt;T_{\\max})</var>, a new order is randomly generated with the probability <var>p_{\\mathrm{trans}}^{\\mathrm{const}}</var>. Its starting vertex is randomly selected from the vertex set <var>V</var> and its destination vertex is randomly selected from all the vertices except for the starting vertex.</p>\n</li>\n<li>\n<p><strong>Penalty for outstanding orders</strong>: For each outstanding order by <var>t=T_{\\max}</var>, a penalty <var>P^{\\mathrm{trans}}</var> is subtracted from the score for transportation (For the details, see <b><a href=\"#scoring_en\">Scoring</a></b>.).</p>\n</li>\n</ul>\n<h2 id=\"ev_en\"> EV Operation </h2>\n\n<p>Each contestant is asked to operate multiple electric vehicles (EVs) to transport customers and goods from one place to another place efficiently while protecting distributed nanogrids from overloading the electrical supply to EVs and providing additional power from EVs if there is a power shortage in the nanogrids.</p>\n<ul>\n<li>\n<p><strong>Number of EVs</strong>: The number of EVs <var>N^{\\mathrm{EV}}</var> is uniformly randomly selected from the interval <var>[N_{\\min}^{\\mathrm{EV}}, N_{\\max}^{\\mathrm{EV}}]</var> and is informed to each contestant in the beginning of each test case.</p>\n</li>\n<li>\n<p><strong>Initial Position of EVs</strong>: In the beginning of each test case, <var>N^{\\mathrm{EV}}</var> vertices are selected randomly and one EV is placed on each selected vertex.</p>\n</li>\n<li>\n<p><strong>Attributes for EV</strong>: Each EV has the following attributes:</p>\n<ul>\n<li>ID <var>(0, 1,... , N^{\\mathrm{EV}}-1)</var></li>\n<li>Charged capacity: <var>C^{\\mathrm{EV}}_{t}</var> non-negative integer valued, initialized to <var>C^{\\mathrm{EV}}_{t=0}</var>, and has the upper limit <var>C^{\\mathrm{EV}}_{\\max}</var> common for all the EVs</li>\n<li>Present location: either on a vertex or on an edge</li>\n<li>Order IDs located on each EV: The upper limit of number of orders located on each EV is <var>N_{\\max}^{\\mathrm{trans}}</var>, which is common for all the EVs.</li>\n<li>Maximum charging/discharging speed: <var>V_{\\max}^{\\mathrm{EV}}</var>, which is common for all the EVs.</li>\n</ul>\n</li>\n<li>\n<p><strong>Operation for EVs</strong>: For each time <var>t</var>, each contestant chooses one of the operations below for each EV:</p>\n<ul>\n<li><code>stay</code>: Let the EV stay in the same place. In this case, the EV does not consume electricity, i.e., <var>C^{\\mathrm{EV}}_{t+1}-C^{\\mathrm{EV}}_{t}=0</var>.</li>\n<li>\n<p><code>move w</code>: Let the EV move forward to the vertex <var>w \\in V</var> by the distance <var>1</var>. The charged capacity of the EV in the next step decreases by <var>\\Delta^{\\mathrm{EV}}_{\\mathrm{move}}</var> unless the resulting charged capacity is negative. If that is the case, the operation is rejected, the EV stays at the same position and its charged capacity does not change if the following conditions are satisfied.</p>\n<ul>\n<li>Suppose the operation <code>move w</code> is selected. Then, each contestant gets <code>WA</code> (Wrong Answer) if one of the conditions below are violated.<ul>\n<li><var>w \\in V</var></li>\n<li>Supposing the present position of the EV is on <var>u \\in V</var>, <var>\\left\\{ u, w \\right\\} \\in E</var> holds.</li>\n<li>Supposing the present position of the EV is on <var>\\left\\{ u, v \\right\\}</var>, <var>w = u</var> or <var>w = v</var> holds.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><code>pickup a</code>: Pick the order of ID <var>a</var> by EV. In this operation EV does not consume electricity (An order is automatically delivered when an EV carrying the order arrives at the destination vertex of the order).</p>\n<ul>\n<li>Suppose the operation <code>pickup a</code> is selected. Then, each contestant gets <code>WA</code> (Wrong Answer) if one of the conditions below are violated.<ul>\n<li>EV is on <var>u \\in V</var></li>\n<li>There is an order of ID <var>a</var> that has the starting vertex <var>u</var> and state <var>0</var>.</li>\n<li>The number of orders put on the EV is less than <var>N_{\\max}^{\\mathrm{trans}}</var>.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><code>charge_from_grid</code> <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var>: Charge the EV by <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var>. The charged capacity of the EV in the next step <var>C^{\\mathrm{EV}}_{t+1}</var> becomes <var>C^{\\mathrm{EV}}_{t+1} \\leftarrow C^{\\mathrm{EV}}_{t} + \\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge},t}</var>. It is possible to charge multiple EVs from a single nanogrid.</p>\n<ul>\n<li>Suppose the operation <code>charge_from_grid</code> is selected with <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var>. Then, each contestant gets   <code>WA</code> (Wrong Answer) if one of the conditions below is violated.<ul>\n<li>EV is on a vertex where a nanogrid is located <var>u \\in V_{\\mathrm{grid}}</var>.</li>\n<li><var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var> is a natural number.</li>\n<li>Charged amount for each EV does not exceed the maximum charge/discharge speed: <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}} \\leq V_{\\max}^{\\mathrm{EV}}</var></li>\n<li>The resulting charged capacity for each EV does not exceed the upper limit <var>C^{\\mathrm{EV}}_{\\max}</var>: <var>C^{\\mathrm{EV}}_{t} + \\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}} \\leq C^{\\mathrm{EV}}_{\\max}</var></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><code>charge_to_grid</code> <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var>: Charge a nanogrid from the EV by <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var>. The charged capacity of the EV in the next step <var>C^{\\mathrm{EV}}_{t+1}</var> becomes <var>C^{\\mathrm{EV}}_{t+1} \\leftarrow C^{\\mathrm{EV}}_{t} - \\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge},t}</var>. It is possible to charge a nanogrid from multiple EVs. It is also possible to charge EVs from a nanogrid and charge the nanogrid from other EVs simultaneously.</p>\n<ul>\n<li>Suppose the operation <code>charge_to_grid</code> is selected with <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var>. Then, each contestant gets <code>WA</code> (Wrong Answer) if one of the conditions below is violated.<ul>\n<li>EV is on a vertex where a nanogrid is located <var>u \\in V_{\\mathrm{grid}}</var>.</li>\n<li><var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var> is a natural number.</li>\n<li>Charged amount for each EV does not exceed the maximum charge/discharge speed: <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}} \\leq V_{\\max}^{\\mathrm{EV}}</var></li>\n<li>The resulting charged capacity for each EV is not negative: <var>C^{\\mathrm{EV}}_{t} - \\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}} \\geq 0</var> </li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"charge_en\"> Charge/Discharge to the Battery of a Nanogrid </h2>\n\n<p>For each nanogrid, the charged capacity of the battery varies in time depending on the difference between generated and consumed powers and the amount of charge/discharge to EVs. For each time <var>t</var>, sums of the difference between generated and consumed powers and gross difference between charged/discharged amounts to EVs from the nanogrid correspond to power excess or shortage in the nanogrid. If the power excess occurs, the battery is charged by the amount provided that the power excess does not exceed the maximum charge speed of the battery and the resulting charged capacity of the battery does not exceed its upper limit. If the power excess exceeds the maximum charge speed of the battery, the excess amount is discarded and the battery is charged by the maximum charge speed. If the resulting charged capacity of the battery exceeds its upper limit, the charged capacity is set to the upper limit at the next step and the excess amount is discarded. If the power shortage occurs instead, the power shortage is compensated by discharging the battery provided that the power shortage does not fall below the maximum discharge speed of the battery and the resulting charged capacity of the battery is not negative. If the power shortage falls below the maximum discharge speed of the battery, the power shortage is covered by discharging the battery by the maximum discharge speed and by power supplied from the outside. If the resulting charged capacity of the battery is negative, the charged capacity of the battery is set to zero in the next step and shortage is supplied from the outside. In all the cases, each EV is charged or discharged by the amount prescribed by each contestant. <br><br></p>\n<p>Algorithm to determine an amount of charge/discharge to the battery in the next step consists of the following 4 steps. <br></p>\n<ul>\n<li>\n<p><strong>Step 1</strong>: Compute the power excess or shortage in each nanogrid at time <var>t</var> <var>\\Delta^{\\mathrm{grid}}_{\\mathrm{total}}</var>.<br>\n<var>\\Delta^{\\mathrm{grid}}_{\\mathrm{total}} = \\Delta^{\\mathrm{grid}}_{\\mathrm{gen},t} - \\sum_{i \\in \\mathrm{all EV}} \\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}i}_{\\mathrm{charge},t} + \\sum_{i \\in \\mathrm{all EV}} \\Delta^{\\mathrm{EV}i \\rightarrow \\mathrm{grid}}_{\\mathrm{charge},t} </var> <br>\nHere, each variable is defined as follows.\n    </p><ul>\n    <li> <var>\\Delta^{\\mathrm{grid}}_{\\mathrm{gen},t}</var>: the difference between generated and consumed powers at the nanogrid at the time <var>t</var>, which is sums of predicted difference between generated and consumed powers <var>\\Delta^{\\mathrm{grid,predict}}_{\\mathrm{gen},t}</var>, a stochastic fluctuation <var>\\delta_{t}</var>, and the variation due to downpour and sudden clear sky. Note that the time series of predicted difference between generated and consumed powers is informed to each contestant in the beginning of each test case but the stochastic fluctuation is not informed until the time <var>t</var> (informed at the next time step <var>t+1</var>).</li>\n    <li> <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}i}_{\\mathrm{charge},t}</var>: Charged amount to the <var>i</var>-th EV from the nanogrid prescribed by the contestant at the time <var>t</var></li>\n    <li> <var>\\Delta^{\\mathrm{EV}i \\rightarrow \\mathrm{grid}}_{\\mathrm{charge},t}</var>: Charged amount to the nanogrid from the <var>i</var>-th EV prescribed by the contestant at the time <var>t</var></li>\n    </ul><p></p>\n</li>\n<li>\n<p><strong>Step 2</strong>: In case of <var>\\Delta^{\\mathrm{grid}}_{\\mathrm{total}} \\geq \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{\\max}-C^{\\mathrm{grid}}_{t} \\right\\}</var>,<br>\nThe charged capacity of the nanogrid at the time <var>t+1</var> is determined by the following equation: <br>\n<var>C^{\\mathrm{grid}}_{t+1} \\leftarrow C^{\\mathrm{grid}}_{t}+\\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{\\max}-C^{\\mathrm{grid}}_{t} \\right\\} </var><br>\nPhysically, this means if the power excess exceeds the maximum charge/discharge speed or the remaining capacity of the battery, the excess amount is discarded.<br></p>\n</li>\n<li>\n<p><strong>Step 3</strong>: In case of <var>\\Delta^{\\mathrm{grid}}_{\\mathrm{total}} &lt; - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{t} \\right\\}</var>,<br>\nThe charged capacity of the nanogrid at the time <var>t+1</var> is determined by the following equation: <br>\n<var>C^{\\mathrm{grid}}_{t+1} \\leftarrow C^{\\mathrm{grid}}_{t} - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{t} \\right\\} </var><br>\nIf the power shortage cannot be compensated by discharging the battery, the remaining shortage：<br>\n<var>L_t = - \\Delta^{\\mathrm{grid}}_{\\mathrm{total}} - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{t} \\right\\}(&gt;0)</var><br>\nis supplied from the outside. In this case, the score for electricity management is deducted in proportion to the supplied electricity with a factor <var>\\gamma</var>. (For the detail, see <b><a href=\"#scoring_en\">Scoring</a></b>.)。<br></p>\n</li>\n<li>\n<p><strong>Step 4</strong>: The other cases than the cases in step 2 and 3,<br>\nThe charged capacity of the nanogrid at the time <var>t+1</var> is determined by the following equation:<br>\n<var>C^{\\mathrm{grid}}_{t+1} \\leftarrow C^{\\mathrm{grid}}_{t} + \\Delta^{\\mathrm{grid}}_{\\mathrm{total}}</var><br></p>\n</li>\n</ul>\n<div style=\"text-align:center;\">\n<img src=\"https://img.atcoder.jp/hokudai-hitachi2020/cfe108108ceae39c0568f8d44033c6df.png\">\n</div>\n\n<h2 id=\"scoring_en\"> Scoring </h2>\n\n<p>In this problem, each contestant finds <var>N_{\\mathrm{solution}}</var> solutions of the problem and based on the equations below the score for transportation for each solution (<var>S_{\\mathrm{trans}}^{(1)},...,S_{\\mathrm{trans}}^{(N_{\\mathrm{solution}})}</var>) and the score for electricity management for each solution (<var>S_{\\mathrm{ele}}^{(1)},...,S_{\\mathrm{ele}}^{(N_{\\mathrm{solution}})}</var>) are computed. <span style=\"color:black; font-weight:bold;\">Note that generation timings for orders and their starting and destination vertices, and timings for downpour and sudden clear sky vary among <var>N_{\\mathrm{solution}}</var> trials. The others like the graph, the set of vertices where nanogrids are located, the number of EVs, the time series of predicted energy balance are the same for all <var>N_{\\mathrm{solution}}</var> trials.</span></p>\n<ul>\n<li>\n<p><strong>Score for Transportation</strong>: The score for transportation <var>S_{\\mathrm{trans}}</var> is computed by the following equation.<br>\n<var>S_{\\mathrm{trans}}=\\sum_{i \\in O_{\\mathrm{trans}}} \\left( T_{\\max} - T_{\\mathrm{wait},i} \\right) - \\sum_{i \\in \\overline{O_{\\mathrm{trans}}}} P_i^{\\mathrm{trans}}</var> <br>\nHere, <var>O_{\\mathrm{trans}}</var> is the set of all the orders processed by <var>T_{\\max}</var>, <var>\\overline{O_{\\mathrm{trans}}}</var> is the set of all the orders <b><i> not </i></b> processed by <var>T_{\\max}</var>, <var>T_{\\mathrm{wait},i}</var> is the time taken to process the <var>i</var>-th order (=[the time at which the order is delivered] - [the time at which the order is generated]), and <var>P_i^{\\mathrm{trans}}</var> is the penalty for the outstanding <var>i</var>-th order (the penalty does not depend on <var>i</var> and is a constant <var>P_i^{\\mathrm{trans}}=P^{\\mathrm{trans}}</var>).</p>\n</li>\n<li>\n<p><strong>Score for Electricity Management</strong>: The score for electricity management <var>S_{\\mathrm{ele}}</var> is computed by the following equation.<br>\n    <var>S_{\\mathrm{ele}}=\\sum_{i=1}^{N_{\\mathrm{EV}}} C_{t=T_{\\max}}^{\\mathrm{EV}i} + \\sum_{i=1}^{N_{\\mathrm{grid}}} C_{t=T_{\\max}}^{\\mathrm{grid}i} - \\gamma \\sum_{t=0}^{T_{\\max}-1} \\sum_{i=1}^{N_{\\mathrm{grid}}} L_{i,t}</var><br>\nHere, the first and the second terms in the equation are the charged capacity of all the EVs and nanogrid at the time <var>t=T_{\\max}</var>, respectively. <var>L_{i,t}</var> is power supplied from the outside at the <var>i</var>-th grid at the time <var>t</var> and <var>\\gamma</var> is a proportional constant of the penalty and <var>L_{i,t}</var>. The value of <var>L_{i,t}</var> is set to <var>L_{i,t} = - \\Delta^{\\mathrm{grid}}_{\\mathrm{total}} - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{t} \\right\\}(L_{i,t}&gt;0)</var> if the step 3 is executed in <a href=\"#charge_en\">Charge/Discharge to the Battery of a Nanogrid</a> and is set to <var>L_{i,t}=0</var> in the other cases.</p>\n</li>\n<li>\n<p><strong>Final Score</strong>: Based of the equations, <var>N_{\\mathrm{solution}}</var> pairs of the scores for transportation and electricity management <var>\\left( =(S_{\\mathrm{ele}}^{(1)},S_{\\mathrm{trans}}^{(1)}),...,(S_{\\mathrm{ele}}^{(N_{\\mathrm{solution}})},S_{\\mathrm{trans}}^{(N_{\\mathrm{solution}})}) \\right)</var> are plotted on the 2-dimensional plane as in the figure below. For a given reference point, the final score of each test case is determined by the area below. <span style=\"color:black; font-weight:bold;\">Here, if one of the scores is below those of the reference point, the score is set to the corresponding score of the reference point. By doing that the final score cannot be negative. For the concrete position of the reference point, see \"Constraints for Input and Output\"</span></p>\n</li>\n<li>\n<p><strong>Standings</strong>: During the contest the total score of a submission is determined by summing the final score of the submission with respect to 16 test cases. Among these test cases, the numbers of sunny without downpour, sunny with downpour, rainy without sudden clear sky, and rainy with sudden clear sky are fixed at 6, 2, 6, and 2, respectively.<br>\nAfter the contest a system test will be performed. To this end, the contestant's last submission will be scored by summing the final score of the submission on <var>200</var> previously unseen test cases.<br>\nPlease see the table below for a breakdown of the <var>200</var> test cases.</p>\n</li>\n</ul>\n<table class=\"table table-bordered\">\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"right\">Predicted energy balance (disclosed)</th>\n<th align=\"right\">Predicted energy balance (undisclosed)</th>\n<th align=\"right\">Total</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">Sunny without downpour</td>\n<td align=\"right\">60</td>\n<td align=\"right\">15</td>\n<td align=\"right\">75</td>\n</tr>\n<tr>\n<td align=\"center\">Sunny with downpour</td>\n<td align=\"right\">20</td>\n<td align=\"right\">5</td>\n<td align=\"right\">25</td>\n</tr>\n<tr>\n<td align=\"center\">Rainy without sudden clear sky</td>\n<td align=\"right\">60</td>\n<td align=\"right\">15</td>\n<td align=\"right\">75</td>\n</tr>\n<tr>\n<td align=\"center\">Rainy with sudden clear sky</td>\n<td align=\"right\">20</td>\n<td align=\"right\">5</td>\n<td align=\"right\">25</td>\n</tr>\n<tr>\n<td align=\"center\">Total</td>\n<td align=\"right\">160</td>\n<td align=\"right\">40</td>\n<td align=\"right\">200</td>\n</tr>\n</tbody>\n</table>\n<p>Of the <var>200</var> test cases, <var>160</var> use <var>6(=N_\\mathrm{pattern} \\times 2(</var>sunny, rainy<var>))</var> types of predicted energy balance already disclosed in the toolkit. The remaining <var>40</var> test cases use <var>6(=N_\\mathrm{pattern} \\times 2(</var>sunny, rainy<var>))</var> types of predicted energy balance that are not disclosed to the contestants. <var>\\Delta_{\\mathrm{event}}</var>, <var>p_{\\mathrm{event}}</var>, and percentage of nanogrids hit by downpour or sudden clear sky are all the same among <var>50(=25</var>[sunny with downpour]<var>+25</var>[rainy with sudden clear sky]<var>)</var> test cases.<br>\nWe are very sorry that the system test specifications have changed unlike the answer to the question received from Mr. yuusanlondon on December 18.\nAs a result of consideration, the organizers of the contest have determined to decide the final standings based on this specification. We appreciate your understanding.<br>\n(12/29 postscript) Generation method or generator for undisclosed predicted energy balance will not be released. Patterns of undisclosed predicted energy balance are generated so that the full score for Electricity Management using undisclosed predicted energy balance is comparable to that using disclosed predicted energy balance. (Note that the full score means the upper limit of the score by applying an ideal control  method.)</p>\n<div style=\"text-align:center;\">\n<img src=\"https://img.atcoder.jp/hokudai-hitachi2020/8aa102a5e94664d90d114918cf84a4ac.png\">\n</div>\n\n<h2 id=\"problem_en\"> Problem B </h2>\n\n<p>Problem B is an <span style=\"color:black; font-weight:bold;\">interactive problem</span> similar to problem A.\nEach contestant is asked to consider the trade-offs between transportation and electricity management and to find <var>N_{\\mathrm{solution}}</var> solutions for each test case so that each solution is as close as the trade-off curve and the whole solutions cover a broad range of the trade-off curve. Each contestant and a host machine (judge) interact with the following protocol.</p>\n<table class=\"table table-bordered\">\n<thead>\n<tr>\n<th>Iterative process</th>\n<th>Contestant</th>\n<th>Judge</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td></td>\n<td>Output <var>N_{\\mathrm{solution}}</var></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output <var>G</var></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output the weather <var>\\mathrm{DayType}</var></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output the information related to energy balance</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output the information about the nanogrid</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output the information about EV</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output the information about the transportation</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output the information about the score</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output <var>T_\\mathrm{max}</var></td>\n</tr>\n<tr>\n<td><b>for</b> <var>i=1,...,N_{\\mathrm{solution}}</var> <b>do</b><br><span style=\"margin-left:30px;\"><b>for</b></span> <var>t=0,...,T_\\mathrm{max}-1</var> <b>do</b></td>\n<td>-</td>\n<td>-</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output <var>\\mathrm{info}_t</var> (the status of EVs and nanogrids at the time <var>t</var>)</td>\n</tr>\n<tr>\n<td></td>\n<td>Output operations for each EV</td>\n<td></td>\n</tr>\n<tr>\n<td><span style=\"margin-left:30px;\"><b>end for</b></span></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output <var>\\mathrm{info}_t</var> (the status of EVs and nanogrids at the time <var>t=T_\\mathrm{max}</var>)</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Output score for transportation <var>S_{\\mathrm{trans}}</var> and score for electricity management <var>S_{\\mathrm{ele}}</var></td>\n</tr>\n<tr>\n<td><b>end for</b></td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p>The number of trials, the graph <var>G</var>, the weather <var>\\mathrm{DayType}</var>, the information related to energy balance, the nanogrid, EVs and its transportation, the score, <var>T_\\mathrm{max}</var> are outputted only once in the beginning of each test case. For each trial, contestants are supposed to interact with judges <var>T_\\mathrm{max}</var> times. <b>Note that <var>\\mathrm{info}_t</var> and the scores at the time <var>t=T_\\mathrm{max}</var> must be read by the contestant code (otherwise it may be TLE).</b></p>\n<h2 id=\"io-format1_en\"> Input and Output Format 1 </h2>\n\n<p>In the beginning of each test case, the number of trials, the graph <var>G</var>, the weather <var>\\mathrm{DayType}</var>, the information related to energy balance, the nanogrid, EVs and its transportation, the score, <var>T_\\mathrm{max}</var> is provided through the standard input. <span style=\"color:black; font-weight:bold;\">Note that the information is provided only once in the beginning of each test case since it is common for all trials.</span></p>\n<pre><var>N_{\\mathrm{solution}}</var>\n<var>|V|</var> <var>|E|</var>\n<var>u_1</var> <var>v_1</var> <var>d_1</var>\n:\n<var>u_{|E|}</var> <var>v_{|E|}</var> <var>d_{|E|}</var>\n<var>\\mathrm{DayType}</var>\n<var>N_\\mathrm{div}</var> <var>N_\\mathrm{pattern}</var> <var>\\sigma^{2}_{\\mathrm{ele}}</var> <var>p_{\\mathrm{event}}</var> <var>\\Delta_{\\mathrm{event}}</var>\n<var>\\mathrm{pw}_{1,1}^{\\mathrm{predict}}</var> <var>\\mathrm{pw}_{1,2}^{\\mathrm{predict}}</var> ... <var>\\mathrm{pw}_{1,N_\\mathrm{div}}^{\\mathrm{predict}}</var>\n:\n<var>\\mathrm{pw}_{N_\\mathrm{pattern},1}^{\\mathrm{predict}}</var> <var>\\mathrm{pw}_{N_\\mathrm{pattern},2}^{\\mathrm{predict}}</var> ... <var>\\mathrm{pw}_{N_\\mathrm{pattern},N_\\mathrm{div}}^{\\mathrm{predict}}</var>\n<var>N_\\mathrm{grid}</var> <var>C_{\\mathrm{init}}^{\\mathrm{grid}}</var> <var>C_{\\mathrm{max}}^{\\mathrm{grid}}</var> <var>V_{\\max}^{\\mathrm{grid}}</var>\n<var>x_1</var> <var>\\mathrm{pattern}_1</var> \n: \n<var>x_{N_\\mathrm{grid}}</var> <var>\\mathrm{pattern}_{N_\\mathrm{grid}}</var> \n<var>N_\\mathrm{EV}</var> <var>C_{\\mathrm{init}}^{\\mathrm{EV}}</var> <var>C_{\\mathrm{max}}^{\\mathrm{EV}}</var> <var>V_{\\max}^{\\mathrm{EV}}</var> <var>N_{\\max}^{\\mathrm{trans}}</var> <var>\\Delta_{\\mathrm{move}}^{\\mathrm{EV}}</var>\n<var>\\mathrm{pos}_1</var>\n:\n<var>\\mathrm{pos}_{N_\\mathrm{EV}}</var>\n<var>p_{\\mathrm{trans}}^{\\mathrm{const}}</var> <var>T_\\mathrm{last}</var>\n<var>P^{\\mathrm{trans}}</var> <var>\\gamma</var> <var>S_{\\mathrm{ele}}^{\\mathrm{ref}}</var> <var>S_{\\mathrm{trans}}^{\\mathrm{ref}}</var>\n<var>T_\\mathrm{max}</var>\n</pre>\n\n<ul>\n<li>In the <var>1</var>st line, <var>N_{\\mathrm{solution}}</var> is the number of trials for each test case.</li>\n<li>In the following line, the number of vertices <var>|V|</var> and the number of edges <var>|E|</var> of the graph <var>G</var> are provided.</li>\n<li>In the following <var>|E|</var> lines, the edges of the graph along with their weights are provided. The <var>i</var>-th line of the lines indicate that there exists an edge connecting <var>u_{i}</var> and <var>v_{i}</var> with the edge weight <var>d_i</var>.</li>\n<li>In the following <var>1</var> line, the weather pattern <var>\\mathrm{DayType}</var> is provided, which is either <var>\\mathrm{DayType}</var>  <var>0</var> (sunny without downpour), <var>1</var> (sunny with downpour), <var>2</var> (rainy without sudden clear sky), or <var>3</var> (rainy with sudden clear sky).</li>\n<li>In the following <var>1</var> line, the number of subintervals of equal length on which the predicted energy balance is constant <var>N_\\mathrm{div}</var>, the number of possible patterns of the time series of predicted energy balance <var>N_\\mathrm{pattern}</var>, the variance of the stochastic fluctuation of the difference <var>\\sigma^{2}_{\\mathrm{ele}}</var>, the probability of occurrences of downpour or sudden clear <var>p_{\\mathrm{event}}</var> (<var>p_{\\mathrm{event}}=0.0</var> in the case of <var>\\mathrm{DayType}=0</var> or <var>2</var>), and the variation of energy balance in case of downpour or sudden clear sky <var>\\Delta_{\\mathrm{event}}</var>.</li>\n<li>In the following <var>N_\\mathrm{pattern}</var> lines, the time series of predicted energy balance is provided. The <var>j</var>-th element in the <var>i</var>-th line of the lines (<var>\\mathrm{pw}_{i,j}^{\\mathrm{predict}}</var>) indicates the predicted energy balance of the <var>j</var>-th subinterval in case of the <var>i</var>-th pattern.</li>\n<li>In the following <var>1</var> line, the number of nanogrids <var>N_\\mathrm{grid}</var> and the initial value of the charged capacity of the battery for each nanogrid <var>C_{\\mathrm{init}}^{\\mathrm{grid}}</var> (<var>t=0</var>), the upper limit of the charged capacity of the battery <var>C_{\\mathrm{max}}^{\\mathrm{grid}}</var>, and the maximum charge/discharge speed of the battery <var>V_{\\max}^{\\mathrm{grid}}</var> is provided.</li>\n<li>In the following <var>N_\\mathrm{grid}</var> lines, the information about each nanogrid is provided. In the <var>N_\\mathrm{grid}</var> lines, the <var>i</var>-th line indicates that a nanogrid is located on the vertex <var>x_i</var> whose pattern of the time series of predicted energy balance is <var>\\mathrm{pattern}_i</var>.</li>\n<li>In the following <var>1</var> line, the number of EVs <var>N_\\mathrm{EV}</var>, their initial charged capacity <var>C_{\\mathrm{init}}^{\\mathrm{EV}}</var>, their maximum charged capacity <var>C_{\\mathrm{max}}^{\\mathrm{EV}}</var>, and their maximum charge/discharge speed <var>V_{\\max}^{\\mathrm{EV}}</var>, the maximum number orders each EV can carry on <var>N_{\\max}^{\\mathrm{trans}}</var>, and the amount of electricity necessary for each EV to travel in a unit distance <var>\\Delta_{\\mathrm{move}}^{\\mathrm{EV}}</var>.</li>\n<li>In the following <var>N_\\mathrm{EV}</var> lines, the position of each EV is provided. In the <var>N_\\mathrm{EV}</var> line, the <var>i</var>-th line indicates that the <var>i</var>-th EV is located on the vertex <var>\\mathrm{pos}_i</var>.</li>\n<li>In the following <var>1</var> line, the probability that a new order is generated <var>p_{\\mathrm{trans}}^{\\mathrm{const}}</var> and the last time when a new order can be generated <var>T_\\mathrm{last}</var>.</li>\n<li>In the following <var>1</var> line, the penalty for the outstanding order <var>P^{\\mathrm{trans}}</var>, the proportional constant <var>\\gamma</var> for the penalty of getting power supply from outside, the reference score of electricity management <var>S_{\\mathrm{ele}}^{\\mathrm{ref}}</var>, and for transportation <var>S_{\\mathrm{trans}}^{\\mathrm{ref}}</var> are provided. </li>\n<li>In the last line, the total time step for each trial of each test case <var>T_{\\max}</var> is provided.</li>\n</ul>\n<h2 id=\"io-format2_en\"> Input and Output Format 2 </h2>\n\n<p>For each time <var>t</var>, contestants get the status of EVs and nanogrids <var>\\mathrm{info}_t</var> from the standard input.</p>\n<pre><var>x_1</var> <var>y_1</var> <var>\\mathrm{pw}_{1}^{\\mathrm{actual},t-1}</var> <var>\\mathrm{pw}_{1}^{\\mathrm{excess},t-1}</var> <var>\\mathrm{pw}_{1}^{\\mathrm{buy},t-1}</var>\n:\n<var>x_{N_\\mathrm{grid}}</var> <var>y_{N_\\mathrm{grid}}</var> <var>\\mathrm{pw}_{N_\\mathrm{grid}}^{\\mathrm{actual},t-1}</var> <var>\\mathrm{pw}_{N_\\mathrm{grid}}^{\\mathrm{excess},t-1}</var> <var>\\mathrm{pw}_{N_\\mathrm{grid}}^{\\mathrm{buy},t-1}</var>\n<var>\\mathrm{carinfo}_1</var>\n:\n<var>\\mathrm{carinfo}_{N_\\mathrm{EV}}</var>\n<var>N_\\mathrm{order}</var>\n<var>\\mathrm{id}_1</var> <var>w_1</var> <var>z_1</var> <var>\\mathrm{state}_1</var> <var>\\mathrm{time}_1</var>\n...\n<var>\\mathrm{id}_{N_\\mathrm{order}}</var> <var>w_{N_\\mathrm{order}}</var> <var>z_{N_\\mathrm{order}}</var> <var>\\mathrm{state}_{N_\\mathrm{order}}</var> <var>\\mathrm{time}_{N_\\mathrm{order}}</var>\n</pre>\n\n<ul>\n<li>In the <var>N_\\mathrm{grid}</var> lines, the <var>i</var>-th line indicates the charged capacity of the battery of the nanogrid on the vertex <var>x_i</var> is <var>y_i</var>, and <var>\\mathrm{pw}_{i}^{\\mathrm{actual},t-1}</var>, <var>\\mathrm{pw}_{i}^{\\mathrm{excess},t-1}</var>, and <var>\\mathrm{pw}_{i}^{\\mathrm{buy},t-1}</var> indicate actual energy balance, excess amount of power discarded, and power supplied from the outside at the previous time step <var>t-1</var>, respectively. At <var>t=0</var>, <var>\\mathrm{pw}_{i}^{\\mathrm{actual},t-1}</var>, <var>\\mathrm{pw}_{i}^{\\mathrm{excess},t-1}</var>, and <var>\\mathrm{pw}_{i}^{\\mathrm{buy},t-1}</var> are all displayed as <var>0</var>.<br>\nNote that <var>\\mathrm{pw}_{i}^{\\mathrm{actual},t-1}</var>, <var>\\mathrm{pw}_{i}^{\\mathrm{excess},t-1}</var>, and <var>\\mathrm{pw}_{i}^{\\mathrm{buy},t-1}</var> correspond to <var>\\Delta^{\\mathrm{grid}}_{\\mathrm{gen},t-1}</var>, <var>\\Delta^{\\mathrm{grid}}_{\\mathrm{total},t-1} - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{\\max}-C^{\\mathrm{grid}}_{t-1} \\right\\}</var>, and <var>- \\Delta^{\\mathrm{grid}}_{\\mathrm{total},t-1} - \\min \\left\\{ V_{\\max}^{\\mathrm{grid}}, C^{\\mathrm{grid}}_{t-1} \\right\\}</var>, respectively (see <a href=\"#charge_en\"> Charge/Discharge to the Battery of a Nanogrid </a>).<br>\nIf \"step 2\" and \"step 3\" are not executed at the previous time <var>t−1</var>, <var>\\mathrm{pw}_{i}^{\\mathrm{excess},t-1}</var> and <var>\\mathrm{pw}_{i}^{\\mathrm{buy},t-1}</var> are 0, respectively.</li>\n<li>In the following <var>N_\\mathrm{EV}</var> groups of <var>4</var> lines, the <var>i</var>-th group <var>\\mathrm{carinfo}_i</var> indicated the status of the <var>i</var>-th EV. For the detail, see the information below.</li>\n<li>In the following <var>1</var> line, the number of outstanding orders up to the time <var>t</var> <var>N_\\mathrm{order}</var> is provided.</li>\n<li>In the following <var>N_\\mathrm{order}</var> lines, the <var>i</var>-th line indicates that the starting and destination points of order with ID <var>\\mathrm{id_i}</var> are <var>w_i</var> and <var>z_i</var>, respectively, and the state of the order is <var>\\mathrm{state}_i</var> and the order is generated at the time <var>\\mathrm{time}_1</var>, where <var>\\mathrm{state}_i=0</var> indicates none of the EVs picked it up and <var>\\mathrm{state}_i=1</var> indicates one of the EVs picked it up but it is not yet delivered.</li>\n</ul>\n<p>Here, <var>\\mathrm{carinfo}_i</var> is provided in the following format.</p>\n<pre><var>\\mathrm{charge}_i</var>\n<var>u_i</var> <var>v_i</var> <var>\\mathrm{dist\\_from}\\_u_i</var> <var>\\mathrm{dist\\_to}\\_v_i</var>\n<var>N_{\\mathrm{adj},i}</var> <var>a_{i,1}</var> <var>a_{i,2}</var> <var>\\ldots</var> <var>a_{i,N_\\mathrm{adj}}</var>\n<var>N_{\\mathrm{order},i}</var> <var>o_{i,1}</var> <var>o_{i,2}</var> <var>\\ldots</var> <var>o_{N_{\\mathrm{order}, i}}</var>\n</pre>\n\n<ul>\n<li>The first line indicates that the charged capacity of the <var>i</var>-th EV is <var>\\mathrm{charge}_i</var>.</li>\n<li>The second line indicates the present position of <var>i</var>-th. If <var>u_i \\ne v_i</var> holds, the <var>i</var>-th EV is on the edge connecting <var>u_i</var> and <var>v_i</var>, and the distance to the vertex <var>u_i</var> is <var>\\mathrm{dist\\_from}\\_u_i</var> and that to <var>v_i</var> is <var>\\mathrm{dist\\_to}\\_v_i</var>. If <var>u_i = v_i</var> holds, the <var>i</var>-th EV is on the vertex <var>u_i</var> (in this case, both <var>\\mathrm{dist\\_from}\\_u_i</var> and <var>\\mathrm{dist\\_to}\\_v_i</var> are displayed as <var>0</var>).</li>\n<li>The third line indicates that there are <var>N_{\\mathrm{adj},i}</var> possible vertices to which the <var>i</var> EV moves by the operation <code>move</code> and <var>a_{i,1}</var>, <var>a_{i,2}</var>、<var>\\ldots</var> and <var>a_{i,N_\\mathrm{adj}}</var> are the possible vertices.</li>\n<li>The fourth line indicates there are <var>N_{\\mathrm{order},i}</var> orders put on the <var>i</var>-th EV and the IDs of the orders are <var>o_{i,1}</var>, <var>o_{i,2}</var>, <var>\\ldots</var>,  <var>o_{N_{\\mathrm{order}, i}}</var>.</li>\n</ul>\n<p>In responding to the input, contestants are asked to output the operation of each EV <var>\\mathrm{command}_i</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var> for each time <var>t</var> (<var>0 \\leq t \\lt T_{\\max}</var>). Each operation should be separated by the new line and the output should end with the new line.</p>\n<pre><var>\\mathrm{command}_{1}</var>\n<var>\\mathrm{command}_{2}</var>\n:\n<var>\\mathrm{command}_{N_\\mathrm{EV}}</var>\n</pre>\n\n<p>Here, <var>\\mathrm{command}</var> should be in the following format. There are five possible operations <code>stay</code>, <code>move w</code>, <code>pickup a</code>, <code>charge_from_grid</code>, and <code>charge_to_grid</code> for each EV. Contestants should choose one of them for each EV and output it in one line as follows:</p>\n<ul>\n<li><code>stay</code></li>\n<li><code>move w</code></li>\n<li><code>pickup a</code></li>\n<li><code>charge_from_grid</code> <var>\\Delta^{\\mathrm{grid} \\rightarrow \\mathrm{EV}}_{\\mathrm{charge}}</var></li>\n<li><code>charge_to_grid</code> <var>\\Delta^{\\mathrm{EV} \\rightarrow \\mathrm{grid}}_{\\mathrm{charge}}</var></li>\n</ul>\n<p>There are constraints for each operation (See <a href=\"#ev_en\">EV</a> <strong>Operation for EVs</strong> for the detail). The behavior of the judge when one of these constraints is violated is undefined.<br></p>\n<h2 id=\"io-format3_en\"> Input and Output Format 3 </h2>\n\n<p>After the operation of each EV at <var>t=T_\\mathrm{max}-1</var> is output, <var>\\mathrm{info}_t</var> at <var>t=T_\\mathrm{max}</var> is provided through the standard input from the judge (the format of <var>\\mathrm{info}_t</var> is the same as the format written in Input/Output format 2). On the next line, then, the judge gives the score for transportation <var>S_{\\mathrm{trans}}</var> and the score for electricity management <var>S_{\\mathrm{ele}}</var> to the standard input in the following format.</p>\n<pre><var>S_{\\mathrm{trans}}</var> <var>S_{\\mathrm{ele}}</var>\n</pre>\n\n<h2 id=\"constraints_en\"> Constraints for Input and Output </h2>\n\n<ul>\n<li>Of the following numbers, those described as <b>\"[float]\"</b> are given as floats, and the others are given as integers.</li>\n</ul>\n<h4>Input and output format 1 provided in the beginning of each test case</h4>\n<ul>\n<li><var>N_{\\mathrm{solution}} = 5</var></li>\n<li><var>|V| = 225</var> </li>\n<li><var>1.5 |V| \\leq |E| \\leq  2 |V|</var> </li>\n<li><var>1 \\leq u_{i}, v_{i} \\leq |V|, u_i \\ne v_i</var> <var>(1 \\leq i \\leq |E|)</var></li>\n<li><var>1 \\leq d_i \\leq \\lceil 2\\sqrt{2|V|} \\rceil</var> <var>(1 \\leq i \\leq |E|)</var></li>\n<li>The graph <var>G</var> is guaranteed to be simple and connected.</li>\n<li><var>\\mathrm{DayType} \\in \\left\\{ 0, 1, 2, 3 \\right\\}</var></li>\n<li><var>N_\\mathrm{div} = 20</var></li>\n<li><var>N_\\mathrm{pattern} = 3</var></li>\n<li><var>\\sigma^{2}_{\\mathrm{ele}} = 100</var></li>\n<li><var>p_{\\mathrm{event}} \\in \\left\\{ 0.0, 0.1 \\right\\}</var> <b>\"[float]\"</b> </li>\n<li><var>\\Delta_{\\mathrm{event}} = 1000</var></li>\n<li><var>-1000 \\lt \\mathrm{pw}_{i,j}^{\\mathrm{predict}} \\lt 1000 (1 \\leq i \\leq N_\\mathrm{pattern}, 1 \\leq j \\leq N_\\mathrm{div})</var></li>\n<li><var>N_\\mathrm{grid} = 20</var></li>\n<li><var>C_{\\mathrm{init}}^{\\mathrm{grid}} = 25000</var></li>\n<li><var>C_{\\mathrm{max}}^{\\mathrm{grid}} = 50000</var></li>\n<li><var>V_{\\max}^{\\mathrm{grid}} = 800</var></li>\n<li><var>1 \\leq x_i \\leq |V|</var> (if <var>i \\neq j</var>, <var>x_i \\neq x_j. 1 \\leq i \\leq N_\\mathrm{grid})</var></li>\n<li><var>1 \\leq \\mathrm{pattern}_i \\leq N_\\mathrm{pattern}</var> <var>(1 \\leq i \\leq N_\\mathrm{grid})</var></li>\n<li><var>N_{\\min}^{\\mathrm{EV}} = 15</var></li>\n<li><var>N_{\\max}^{\\mathrm{EV}} = 25</var></li>\n<li><var>N_{\\min}^{\\mathrm{EV}} \\leq N_\\mathrm{EV} \\leq N_{\\max}^{\\mathrm{EV}}</var></li>\n<li><var>C_{\\mathrm{init}}^{\\mathrm{EV}} = 12500</var></li>\n<li><var>C_{\\mathrm{max}}^{\\mathrm{EV}} = 25000</var></li>\n<li><var>V_{\\max}^{\\mathrm{EV}} = 400</var></li>\n<li><var>N_{\\max}^{\\mathrm{trans}} = 4</var></li>\n<li><var>\\Delta_{\\mathrm{move}}^{\\mathrm{EV}} = 50</var></li>\n<li><var>1 \\leq \\mathrm{pos}_i \\leq |V| (1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>p_{\\mathrm{trans}}^{\\mathrm{const}} = 0.7</var>  <b>\"[float]\"</b></li>\n<li><var>T_\\mathrm{last} = 900</var></li>\n<li><var>P^{\\mathrm{trans}} = 3000</var></li>\n<li><var>\\gamma = 2.0</var> <b>\"[float]\"</b></li>\n<li><var>S_{\\mathrm{ele}}^{\\mathrm{ref}} = -1,500,000</var></li>\n<li><var>S_{\\mathrm{trans}}^{\\mathrm{ref}} = -1,900,000</var></li>\n<li><var>T_\\mathrm{max} = 1000</var></li>\n</ul>\n<h4>Input and output format 2 provided for each time step</h4>\n<ul>\n<li><var>1 \\leq x_i \\leq |V|</var> (if <var>i \\neq j</var>, <var>x_i \\neq x_j. 1 \\leq i \\leq N_\\mathrm{grid})</var></li>\n<li><var>0 \\leq y_i \\leq C_{\\mathrm{max}}^{\\mathrm{grid}}</var> <var>(1 \\leq i \\leq N_\\mathrm{grid})</var></li>\n<li><var>-10000 \\lt \\mathrm{pw}_{i}^{\\mathrm{actual},j} \\lt 10000 (1 \\leq i \\leq N_\\mathrm{grid}, -1 \\leq j \\leq T_\\mathrm{max}-2)</var></li>\n<li><var>0 \\leq \\mathrm{pw}_{i}^{\\mathrm{excess},j} \\lt 10000, (1 \\leq i \\leq N_\\mathrm{grid}, -1 \\leq j \\leq T_\\mathrm{max}-2)</var></li>\n<li><var>0 \\leq \\mathrm{pw}_{i}^{\\mathrm{buy},j} \\lt 10000, (1 \\leq i \\leq N_\\mathrm{grid}, -1 \\leq j \\leq T_\\mathrm{max}-2)</var></li>\n<li><var>0 \\leq \\mathrm{charge}_i \\leq C_{\\mathrm{max}}^{\\mathrm{EV}}</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>1 \\leq u_i, v_i \\leq |V|</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>0 \\leq \\mathrm{dist\\_from}\\_u_i \\leq \\lceil 2\\sqrt{2|V|} \\rceil</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>0 \\leq \\mathrm{dist\\_to}\\_v_i \\leq \\lceil 2\\sqrt{2|V|} \\rceil</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>1 \\leq N_{\\mathrm{adj},i} \\leq 5(\\mathrm{MaxDegree})</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>1 \\leq a_{i,j} \\leq |V|</var> <var>(1 \\leq i \\leq N_\\mathrm{EV}, 1 \\leq j \\leq N_{\\mathrm{adj},i})</var></li>\n<li><var>0 \\leq N_{\\mathrm{order},i} \\leq N_{\\max}^{\\mathrm{trans}}</var> <var>(1 \\leq i \\leq N_\\mathrm{EV})</var></li>\n<li><var>1 \\leq o_{i,j} \\leq T_\\mathrm{last}</var> <var>(1 \\leq i \\leq N_\\mathrm{EV}, 1 \\leq j \\leq N_{\\mathrm{order},i})</var></li>\n<li><var>0 \\leq N_\\mathrm{order} \\leq T_\\mathrm{last}</var></li>\n<li><var>1 \\leq \\mathrm{id}_i \\leq T_\\mathrm{last}</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n<li><var>1 \\leq w_i \\leq |V|</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n<li><var>1 \\leq z_i \\leq |V|</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n<li><var>w_i \\ne z_i</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n<li><var>\\mathrm{state}_i \\in \\left\\{ 0, 1 \\right\\}</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n<li><var>0 \\leq \\mathrm{time}_i \\leq T_\\mathrm{last}</var> <var>(1 \\leq i \\leq N_\\mathrm{order})</var></li>\n</ul>\n<h4>Input and output format 3 provided at the end of each test case</h4>\n<ul>\n<li><var>S_{\\mathrm{trans}}</var> <b>\"[float]\"</b></li>\n<li><var>S_{\\mathrm{ele}}</var> <b>\"[float]\"</b></li>\n</ul>\n<h2 id=\"example_en\"> Example of Inputs and Outputs </h2>\n\n<hr>\n<p>Note: This example is to explain how a judge and a contestant interact with each other through inputs and outputs. To simplify the explanation, some of the parameter values like the number of vertices are set to small and they may be outside of the ranges in Constraints of Input and Output. For example, the number of vertices is set to <var>4</var> in this example but is set to <var>225</var> in each test case.</p>\n<style>\n.pre-sample-inout {\n  margin: 0;\n}\n</style>\n\n<table class=\"table table-striped table-bordered\">\n    <tbody><tr>\n        <th>Time Step</th>\n        <th>Judge</th>\n        <th>Contestant</th>\n        <th>Explanation</th>\n    </tr>\n    <tr>\n        <td></td>\n        <td><pre>1\n4 4\n1 2 1\n2 3 2\n3 4 3\n4 1 1\n0\n2 2 1 0 10\n5 -2\n-4 4\n2 10 20 4\n1 1\n4 2\n2 5 10 2 2 1\n2\n4\n0.5 3\n3 0.5 -100 -100\n4\n</pre></td>\n        <td></td>\n        <td>Initial parameter values are provided by Judge in the beginning of each test case<br>\n            Line <var>1</var>: <var>N_{\\mathrm{solution}}</var> is <var>1</var>.<br>\n            Line <var>2</var>: Graph <var>G</var> consists of <var>|V| = 4</var> vertices and <var>|E| = 4</var> edges.<br>\n            The following <var>4</var> lines (Line <var>3</var> - Line <var>6</var>) indicate the edges of the graph.<br>\n            Line <var>3</var>: Edge <var>1</var> connects the vertex <var>1</var> and <var>2</var> and its distance is <var>1</var>.<br>\n            Line <var>4</var>: Edge <var>2</var> connects the vertex <var>2</var> and <var>3</var> and its distance is <var>2</var>.<br>\n            Line <var>5</var>: Edge <var>3</var> connects the vertex <var>3</var> and <var>4</var> and its distance is <var>3</var>.<br>\n            Line <var>6</var>: Edge <var>4</var> connects the vertex <var>4</var> and <var>1</var> and its distance is <var>1</var>.<br>\n            Line <var>7</var>: The weather pattern in this test case is <var>0</var> \"Sunny without downpour\".<br>\n            Line <var>8</var>: <var>N_{\\mathrm{div}}</var> is <var>2</var>, <var>N_\\mathrm{pattern}</var> is <var>2</var>, <var>\\sigma^{2}_{\\mathrm{ele}}</var> is <var>1</var>, <var>p_{\\mathrm{event}}</var> is <var>0</var>, <var>\\Delta_{\\mathrm{event}}</var> is <var>10</var>.<br>\n            The following <var>2</var> lines (Line <var>9</var> - Line <var>10</var>) indicate the predicted energy balance.<br>\n            Line <var>9</var>: The predicted energy balance of nanogrids having the demand pattern <var>1</var> is <var>5</var> for the <var>1</var>-st time interval and <var>-2</var> for the <var>2</var>-nd time interval.<br>\n            Line <var>10</var>: The predicted energy balance of nanogrids having the demand pattern <var>1</var> is <var>-4</var> for the <var>1</var>-st time interval and <var>4</var> for the <var>2</var>-nd time interval.<br>\n            Line <var>11</var>: <var>N_\\mathrm{grid} = 2</var>, <var>C_{\\mathrm{init}}^{\\mathrm{grid}} = 10</var>, <var>C_{\\mathrm{max}}^{\\mathrm{grid}} = 20</var> and <var>V_{\\max}^{\\mathrm{grid}} = 4</var>.<br>\n            Line <var>12</var>: Nanogrid <var>1</var> is on the vertex <var>1</var> and it has the demand pattern <var>1</var>.<br>\n            Line <var>13</var>: Nanogrid <var>2</var> is on the vertex <var>4</var> and it has the demand pattern <var>2</var>.<br>\n            Line <var>14</var>: <var>N_\\mathrm{EV} = 2</var>, <var>C_{\\mathrm{init}}^{\\mathrm{EV}} = 5</var>, <var>C_{\\mathrm{max}}^{\\mathrm{EV}} = 10</var>, <var>V_{\\max}^{\\mathrm{EV}} = 2</var>, <var>N_{\\max}^{\\mathrm{trans}} = 2</var>, and <var>\\Delta_{\\mathrm{move}}^{\\mathrm{EV}} = 1</var>.<br>\n            The following <var>2</var> lines (Line <var>15</var> - Line <var>16</var>) indicate the positions of the EVs at time <var>t=0</var>.<br>\n            Line <var>15</var>: EV <var>1</var> is on the vertex <var>2</var> at time <var>t=0</var>.<br>\n            Line <var>16</var>: EV <var>2</var> is on the vertex <var>4</var> at time <var>t=0</var>.<br>\n            Line <var>17</var>: <var>p_{\\mathrm{trans}}^{\\mathrm{const}} = 0.5</var> and <var>T_\\mathrm{last} = 3</var>.<br>\n            Line <var>18</var>: <var>P^{\\mathrm{trans}} = 3</var>, <var>\\gamma = 0.5</var>, <var>S_{\\mathrm{ele}}^{\\mathrm{ref}} = -100</var> and <var>S_{\\mathrm{trans}}^{\\mathrm{ref}} = -100</var>.<br>\n            Line <var>19</var>: <var>T_{\\max} = 4</var>.\n        </td>\n    </tr>\n    <tr>\n        <td>0</td>\n        <td><pre>1 10 0 0 0\n4 10 0 0 0\n5\n2 2 0 0\n2 1 3\n0\n5\n4 4 0 0\n2 1 3\n0\n1\n1 1 4 0 0\n</pre></td>\n        <td><pre>move 1\ncharge_from_grid 2</pre></td>\n        <td>\n            Input data at time <var>0</var> is provided by Judge.<br>\n            Line 1: The charged capacity of the nanogrid at the vertex <var>1</var> at time <var>0</var> is <var>10</var>. All the other three values are irrelevant at time <var>0</var> and are set to <var>0</var>.<br>\n            Line 2: The charged capacity of the nanogrid at the vertex <var>4</var> at time <var>0</var> is <var>10</var>. All the other three values are irrelevant at time <var>0</var> and are set to <var>0</var>.<br>\n            The following <var>4</var> lines (Line <var>3</var> - Line <var>6</var>) indicate the status of EV <var>1</var>.<br>\n            Line 3: The charged capacity of EV <var>1</var> is <var>5</var> at time <var>0</var>.<br>\n            Line 4: EV <var>1</var> is on the vertex <var>2</var> at time <var>0</var>.<br>\n            Line 5: There are <var>N_{\\mathrm{adj},1} = 2</var> vertices toward which EV <var>1</var> can `move` and the vertices are <var>1</var> and <var>3</var>.<br>\n            Line 6: The number of orders on EV <var>1</var> is <var>N_{\\mathrm{order},i} = 0</var>.<br>\n            The following <var>4</var> lines (Line <var>7</var> - Line <var>10</var>) indicate the status of EV <var>2</var>.<br>\n            Line 7: The charged capacity of EV <var>2</var> is <var>5</var> at time <var>0</var>.<br>\n            Line 8: EV <var>2</var> is on the vertex <var>4</var> at time <var>0</var>.<br>\n            Line 9: There are <var>N_{\\mathrm{adj},1} = 2</var> vertices toward which EV <var>2</var> can `move` and the vertices are <var>1</var> and <var>3</var>.<br>\n            Line 10: The number of orders on EV <var>2</var> is <var>N_{\\mathrm{order},i} = 0</var>.<br>\n            Line 11: There is <var>N_\\mathrm{order} = 1</var> outstanding order.<br>\n            Line 12: The starting and destination vertices of the order <var>1</var> are <var>1</var> and <var>4</var> respectively. The order is not on any EVs and is generated at time <var>0</var>.<br>\n            Output from Contestant<br>\n            Line 1: Operate EV <var>1</var> to move toward the vertex <var>1</var>. If the charged capacity of EV <var>1</var> is less than <var>1</var>, EV <var>1</var> cannot move as operated. In this case, the charged capacity of EV <var>1</var> is <var>5</var> and thus EV <var>1</var> moves toward the vertex <var>1</var> by the distance <var>1</var> by consuming electricity by <var>1</var> in the next time step. Since the road distance of the edge connecting the vertices <var>1</var> and <var>2</var> is <var>1</var>, the location of EV <var>1</var> is the vertex <var>1</var> in the next time step.<br>\n            Line 2: EV <var>2</var> charges from the nanogrid by <var>2</var>. This operation does not violate the constraints because EV <var>2</var> is on the vertex <var>4</var> where the nanogrid is located, the charged amount <var>2</var> does not exceeds the maximum charge speeds of EV and the battery of the nanogrid. Since the resulting charged capacity of EV <var>2</var> is <var>7</var>, which is less than the maximum charged capacity of EV (<var>10</var>), the resulting charged capacity of EV <var>2</var> is <var>7</var> in the next time step.\n        </td>\n    </tr>\n    <tr>\n        <td>1</td>\n        <td><pre>1 14 5 1 0\n4 6 -4 0 2\n4\n1 1 0 0\n2 2 4\n0\n7\n4 4 0 0\n2 1 3\n0\n1\n1 1 4 0 0</pre></td>\n        <td><pre>pickup 1\ncharge_from_grid 2</pre></td>\n        <td>\n            Input data at time <var>1</var> is provided by Judge.<br>\n            Line 1: The charged capacity of the nanogrid on the vertex <var>1</var> at time <var>1</var> is <var>14</var>. The actual energy balance, the amount of electricity overflowed, and the amount of the electricity supplied from the outside at time <var>0</var> are  <var>5, 1, 0</var> , respectively.<br>\n            Line 2: The charged capacity of the nanogrid on the vertex <var>4</var> at time <var>1</var> is <var>6</var>. The actual energy balance, the amount of electricity overflowed, and the amount of the electricity supplied from the outside at time <var>0</var> are  <var>-4, 0, 2</var> , respectively.<br><br>\n            The following <var>4</var> lines (Line <var>3</var> - Line <var>6</var>) indicate the status of EV <var>1</var>.<br>\n            Line 3: The charged capacity of EV <var>1</var> is <var>4</var> at time <var>1</var>.<br>\n            Line 4: EV <var>1</var> is on the vertex <var>1</var> at time <var>1</var>.<br>\n            Line 5: There are <var>N_{\\mathrm{adj},1} = 2</var> vertices toward which EV <var>1</var> can `move` and the vertices are <var>2</var> and <var>4</var>.<br>\n            Line 6: The number of orders on EV <var>1</var> is <var>N_{\\mathrm{order},i} = 0</var>.<br>\n            The following <var>4</var> lines (Line <var>7</var> - Line <var>10</var>) indicate the status of EV <var>2</var>.<br>\n            Line 7: The charged capacity of EV <var>2</var> is <var>7</var> at time <var>1</var>.<br>\n            Line 8: EV <var>2</var> is on the vertex <var>4</var> at time <var>1</var>.<br>\n            Line 9: There are <var>N_{\\mathrm{adj},1} = 2</var> vertices toward which EV <var>2</var> can `move` and the vertices are <var>1</var> and <var>3</var>.<br>\n            Line 10: The number of orders on EV <var>2</var> is <var>N_{\\mathrm{order},i} = 0</var>.<br>\n            Line 11: There is <var>N_\\mathrm{order} = 1</var> outstanding order.<br>\n            Line 12: The starting and destination vertices of the order <var>1</var> are <var>1</var> and <var>4</var> respectively. The order is not on any EVs and is generated at time <var>1</var>.<br>\n            Output from Contestant<br>\n            Line 1: Locate the order <var>1</var> on EV <var>1</var>. EV <var>1</var> does not consume electricity by this operation.<br>\n            Line 2: EV <var>2</var> charges from the nanogrid by <var>2</var>. This operation does not violate the constraints because EV <var>2</var> is on the vertex <var>4</var> where the nanogrid is located, the charged amount <var>2</var> does not exceeds the maximum charge speeds of EV and the battery of the nanogrid. Since the resulting charged capacity of EV <var>2</var> is <var>9</var>, which is less than the maximum charged capacity of EV (<var>10</var>), the resulting charged capacity of EV <var>2</var> is <var>9</var> in the next time step.\n        </td>\n    </tr>\n    <tr>\n        <td>2</td>\n        <td><pre>1 18 5 1 0\n4 2 -4 0 2\n4\n1 1 0 0\n2 2 4\n1 1\n9\n4 4 0 0\n2 1 3\n0\n2\n1 1 4 1 0\n2 4 1 0 2</pre></td>\n        <td><pre>move 4\npickup 2</pre></td>\n        <td>\n            Input data at time <var>2</var> is provided by Judge.<br>\n            Line 1: The charged capacity of the nanogrid on the vertex <var>1</var> at time <var>2</var> is <var>18</var>. The actual energy balance, the amount of electricity overflowed, and the amount of the electricity supplied from the outside at time <var>1</var> are  <var>5, 1, 0</var> , respectively.<br>\n            Line 2: The charged capacity of the nanogrid on the vertex <var>4</var> at time <var>2</var> is <var>2</var>. The actual energy balance, the amount of electricity overflowed, and the amount of the electricity supplied from the outside at time <var>1</var> are  <var>-4, 0, 2</var> , respectively.<br><br>\n            The following <var>4</var> lines (Line <var>3</var> - Line <var>6</var>) indicate the status of EV <var>1</var>.<br>\n            Line 3: The charged capacity of EV <var>1</var> is <var>4</var> at time <var>2</var>.<br>\n            Line 4: EV <var>1</var> is on the vertex <var>1</var> at time <var>2</var>.<br>\n            Line 5: There are <var>N_{\\mathrm{adj},1} = 2</var> vertices toward which EV <var>1</var> can `move` and the vertices are <var>2</var> and <var>4</var>.<br>\n            Line 6: The number of orders on EV <var>1</var> is <var>N_{\\mathrm{order},i} = 1</var> and that the ID of the order is <var>1</var>.<br>\n            The following <var>4</var> lines (Line <var>7</var> - Line <var>10</var>) indicate the status of EV <var>2</var>.<br>\n            Line 7: The charged capacity of EV <var>2</var> is <var>9</var> at time <var>2</var>.<br>\n            Line 8: EV <var>2</var> is on the vertex <var>4</var> at time <var>2</var>.<br>\n            Line 9: There are <var>N_{\\mathrm{adj},1} = 2</var> vertices toward which EV <var>2</var> can `move` and the vertices are <var>1</var> and <var>3</var>.<br>\n            Line 10: The number of orders on EV <var>2</var> is <var>N_{\\mathrm{order},i} = 0</var>.<br>\n            Line 11: There are <var>N_\\mathrm{order} = 2</var> outstanding orders.<br>\n            Line 12: The starting and destination vertices of the order <var>1</var> are <var>1</var> and <var>4</var> respectively. The order is on an EV and is generated at time <var>0</var>.<br>\n            Line 13: The starting and destination vertices of the order <var>2</var> are <var>4</var> and <var>1</var> respectively. The order is not on any EV and is generated at time <var>2</var>.<br>\n            Output from Contestant<br>\n            Line 1: Operate EV <var>1</var> to move toward the vertex <var>4</var>. If the charged capacity of EV <var>1</var> is less than <var>1</var>, EV <var>1</var> cannot move as operated. In this case, the charged capacity of EV <var>1</var> is <var>4</var> and thus EV <var>1</var> moves toward the vertex <var>4</var> by the distance <var>1</var> by consuming electricity by <var>1</var> in the next time step. Since the road distance of the edge connecting the vertices <var>1</var> and <var>4</var> is <var>1</var>, the location of EV <var>1</var> is the vertex <var>4</var> in the next time step.<br>\n            Line 2: Locate the order <var>2</var> on EV <var>2</var>. EV <var>2</var> does not consume electricity by this operation.\n        </td>\n    </tr>\n    <tr>\n        <td>3</td>\n        <td><pre>1 17 -1 0 0\n4 6 4 0 0\n3\n4 4 0 0\n2 1 3\n0\n9\n4 4 0 0\n2 1 3\n1 2\n1\n2 4 1 1 2</pre></td>\n        <td><pre>stay\nmove 1</pre></td>\n        <td>\n            Input data at time <var>3</var> is provided by Judge.<br>\n            Line 1: The charged capacity of the nanogrid on the vertex <var>1</var> at time <var>3</var> is <var>17</var>. The actual energy balance, the amount of electricity overflowed, and the amount of the electricity supplied from the outside at time <var>2</var> are  <var>-1, 0, 0</var> , respectively.<br>\n            Line 2: The charged capacity of the nanogrid on the vertex <var>4</var> at time <var>3</var> is <var>6</var>. The actual energy balance, the amount of electricity overflowed, and the amount of the electricity supplied from the outside at time <var>2</var> are  <var>4, 0, 0</var> , respectively.<br>\n            The following <var>4</var> lines (Line <var>3</var> - Line <var>6</var>) indicate the status of EV <var>1</var>.<br>\n            Line 3: The charged capacity of EV <var>1</var> is <var>3</var> at time <var>3</var>.<br>\n            Line 4: EV <var>1</var> is on the vertex <var>4</var> at time <var>3</var>.<br>\n            Line 5: There are <var>N_{\\mathrm{adj},1} = 2</var> vertices toward which EV <var>1</var> can `move` and the vertices are <var>1</var> and <var>3</var>.<br>\n            Line 6: The number of orders on EV <var>1</var> is <var>N_{\\mathrm{order},i} = 0</var>. Since the destination vertex of the order <var>1</var> is <var>4</var> and EV <var>1</var> is arrived at the vertex, the order <var>1</var> is delivered. <br>\n            The following <var>4</var> lines (Line <var>7</var> - Line <var>10</var>) indicate the status of EV <var>2</var>.<br>\n            Line 7: The charged capacity of EV <var>2</var> is <var>9</var> at time <var>3</var>.<br>\n            Line 8: EV <var>2</var> is on the vertex <var>4</var> at time <var>3</var>.<br>\n            Line 9: There are <var>N_{\\mathrm{adj},1} = 2</var> vertices toward which EV <var>2</var> can `move` and the vertices are <var>1</var> and <var>3</var>.<br>\n            Line 10: The number of orders on EV <var>2</var> is <var>N_{\\mathrm{order},i} = 1</var> and the ID of the order is <var>2</var>.<br>\n            Line 11: There are <var>N_\\mathrm{order} = 1</var> outstanding orders.<br>\n            Line 12: The starting and destination vertices of the order <var>2</var> are <var>4</var> and <var>1</var> respectively. The order is on an EV and is generated at time <var>2</var>.<br>\n            Output from Contestant<br>\n            Line 1: EV <var>1</var> stays on the same vertex.<br>\n            Line 2: Operate EV <var>2</var> to move toward the vertex <var>1</var>. If the charged capacity of EV <var>2</var> is less than <var>1</var>, EV <var>2</var> cannot move as operated. In this case, the charged capacity of EV <var>2</var> is <var>9</var> and thus EV <var>2</var> moves toward the vertex <var>1</var> by the distance <var>1</var> by consuming electricity by <var>1</var> in the next time step. Since the road distance of the edge connecting the vertices <var>4</var> and <var>1</var> is <var>1</var>, the location of EV <var>2</var> is the vertex <var>1</var> in the next time step.\n        </td>\n    </tr>\n    <tr>\n        <td>4</td>\n        <td><pre>1 15 -2 0 0\n4 10 5 1 0\n3\n4 4 0 0\n2 1 3\n0\n8\n1 1 0 0\n2 2 4\n0\n0\n3.0 34.0</pre></td>\n        <td></td>\n        <td>\n            Input data at time <var>4</var> is provided by Judge.<br>\n            Line 1: The charged capacity of the nanogrid on the vertex <var>1</var> at time <var>4</var> is <var>15</var>. The actual energy balance, the amount of electricity overflowed, and the amount of the electricity supplied from the outside at time <var>3</var> are  <var>-2, 0, 0</var> , respectively.<br>\n            Line 2: The charged capacity of the nanogrid on the vertex <var>4</var> at time <var>4</var> is <var>6</var>. The actual energy balance, the amount of electricity overflowed, and the amount of the electricity supplied from the outside at time <var>3</var> are  <var>5, 1, 0</var> , respectively.<br>\n            The following <var>4</var> lines (Line <var>3</var> - Line <var>6</var>) indicate the status of EV <var>1</var>.<br>\n            Line 3: The charged capacity of EV <var>1</var> is <var>3</var> at time <var>4</var>.<br>\n            Line 4: EV <var>1</var> is on the vertex <var>4</var> at time <var>4</var>.<br>\n            Line 5: There are <var>N_{\\mathrm{adj},1} = 2</var> vertices toward which EV <var>1</var> can `move` and the vertices are <var>1</var> and <var>3</var>.<br>\n            Line 6: The number of orders on EV <var>1</var> is <var>N_{\\mathrm{order},i} = 0</var>. <br>\n            The following <var>4</var> lines (Line <var>7</var> - Line <var>10</var>) indicate the status of EV <var>2</var>.<br>\n            Line 7: The charged capacity of EV <var>2</var> is <var>8</var> at time <var>4</var>.<br>\n            Line 8: EV <var>2</var> is on the vertex <var>4</var> at time <var>4</var>.<br>\n            Line 9: There are <var>N_{\\mathrm{adj},1} = 2</var> vertices toward which EV <var>2</var> can `move` and the vertices are <var>2</var> and <var>4</var>.<br>\n            Line 10: The number of orders on EV <var>2</var> is <var>N_{\\mathrm{order},i} = 0</var>. Since the destination vertex of the order <var>2</var> is <var>1</var> and EV <var>2</var> is arrived at the vertex, the order <var>2</var> is delivered.<br>\n            Line 11: There are <var>N_\\mathrm{order} = 0</var> outstanding orders.<br>\n            The following <var>1</var> line (Line <var>12</var>) indicates the score for transportation and for electricity management. <br>\n            Line 12: The score for transportation is <var>3.0</var> and that for electricity management is <var>34.0</var>. <br>\n            How it is scored: The two orders are generated; they are delivered and their waiting times are <var>3</var> and <var>2</var> respectively. Therefore, the score for transportation is calculated by <var>(4-3)+(4-2)-0=3.0</var>. In the last time step, the charged capacities of the two EVs are <var>3</var> and <var>8</var> respectively and the charged capacities of the nanogrids are <var>15</var> and <var>10</var> respectively. Therefore, total amount of charged capacity is <var>36</var>. In addition, the total amount of electricity supplied from the outside is <var>4</var> (Electricity of the amount <var>2</var> is supplied to the nanogrid on the vertex <var>4</var> from the outside at time <var>0</var> and <var>1</var>.) and the amount multiplied by <var>\\gamma</var> is subtracted from the score for electricity management. Therefore, the score for electricity is calculated as <var>36-0.5 \\times 4=34.0</var>.\n        </td>\n    </tr>\n</tbody></table>\n\n<h2 id=\"sample_en\"> Sample Code B </h2>\n\n<p>A software toolkit for generation of input samples (test cases), scoring and testing on a local contestant environment is provided through the following <a href=\"https://img.atcoder.jp/hokudai-hitachi2020/5ab74962545bbb200f633f2a6f1d9fb3.zip\">link</a>. Sample code for beginners is also available.<br>\n<b> The toolkit has been updated because minor bugs were found. (December 18th)</b><br>\n<b> The toolkit that can also be used on windows (Cygwin and WSL) has been released. The English version of the README (short ver.) has also been added. A bug related to constraints has also been fixed. (December 18th)</b><br>\n<b> The English version of the README (full version) has been released. Also, a small error in the Japanese version of the README has been fixed. (December 21st)</b><br>\n<b> The toolkit has been updated according to a fix in the judge system regarding submission of the source code written in Python etc. Also, sample code written in Python has been included. Please see the README for how to use it.(January 6th)</b><br>\n<b> The toolkit has been updated.(A fix regarding DEBUG_LEVEL, etc.) Sample code has also been updated. (January 12th)</b><br></p>\n<ul>\n<li>Input sample (test case) generator</li>\n<li>Tester</li>\n<li>Sample code for beginners</li>\n</ul></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/hokudai-hitachi2020/tasks/hokudai_hitachi2020_b"}