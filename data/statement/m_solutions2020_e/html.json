{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点: <var>500</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3>\n<p>新 AtCoder 市は以下のように、無限に広がる碁盤の目のような構造になっています。  </p>\n<ul>\n<li>新 AtCoder 市の中心には時計台があり、この座標を <var>(0, 0)</var> とする。</li>\n<li>時計台を通る東西方向に一直線の道路があり、これを「東西大通り」とする。これは <var>2</var> 次元座標平面では <var>x</var> 軸に相当する。</li>\n<li>そのほかにも、東西大通りに平行な道路が、距離 <var>1</var> ずつ間隔をあけて無限本存在する。これらは、直線 <var>y = (0 \\ 以外の整数)</var> に相当する。</li>\n<li>時計台を通る南北方向に一直線の道路があり、これを「南北大通り」とする。これは <var>2</var> 次元座標平面では <var>y</var> 軸に相当する。</li>\n<li>そのほかにも、南北大通りに平行な道路が、距離 <var>1</var> ずつ間隔をあけて無限本存在する。これらは、直線 <var>x = (0 \\ 以外の整数)</var> に相当する。</li>\n</ul>\n<p>新 AtCoder 市には <var>N</var> 個の集落があります。<var>i</var> 個目の集落は、座標 <var>(X_i, Y_i)</var> の交差点上にあり、人口は <var>P_i</var> です。各市民は、これらの集落のうちいずれかひとつに住んでいます。  </p>\n<p><strong>現時点で、鉄道路線は東西大通りに沿って無限に延びるものと、南北大通りに沿って無限に延びるものの <var>2</var> 本しかありません。</strong><br>\n市長の M 君は、これでは通勤に不便だと考えたので、新たに <var>K</var> 本の通りを選んで、それぞれに沿って無限に延びる鉄道路線を建設することにしました。  </p>\n<p>ここで、新 AtCoder 市の各市民の「歩行距離」を、住んでいる集落から最も近い鉄道路線までの距離とします。<br>\nこのとき、全ての市民の歩行距離の合計 <var>S</var> が最も小さくなるように鉄道路線を建設したいです。  </p>\n<p>さて、<var>K = 0, 1, 2, \\dots, N</var> のそれぞれについて、鉄道路線建設後の <var>S</var> の最小値はいくつでしょうか？  </p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3>\n<ul>\n<li><var>1 \\leq N \\leq 15</var></li>\n<li><var>-10 \\ 000 \\leq X_i \\leq 10 \\ 000</var></li>\n<li><var>-10 \\ 000 \\leq Y_i \\leq 10 \\ 000</var></li>\n<li><var>1 \\leq P_i \\leq 1 \\ 000 \\ 000</var></li>\n<li><var>N</var> 個の集落の場所 <var>(X_i, Y_i)</var> はすべて異なる</li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3>\n<p>入力は以下の形式で標準入力から与えられます。  </p>\n<pre><var>N</var>\n<var>X_1</var> <var>Y_1</var> <var>P_1</var>\n<var>X_2</var> <var>Y_2</var> <var>P_2</var>\n <var>:</var>  <var>:</var>  <var>:</var>\n<var>X_N</var> <var>Y_N</var> <var>P_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3>\n<p>答えを <var>N+1</var> 行に出力してください。<br>\n<var>i</var> 行目 <var>(i = 1, \\ldots, N+1)</var> には、<var>K = i - 1</var> の場合の鉄道路線建設後の <var>S</var> の最小値を整数として出力してください。  </p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n1 2 300\n3 3 600\n1 4 800\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2900\n900\n0\n0\n</pre>\n\n<p><var>K = 0</var> の場合、集落 <var>1, 2, 3</var> の住民は、鉄道路線にたどり着くためには、それぞれ距離 <var>1, 3, 1</var> 歩く必要があります。<br>\nしたがって、全ての市民の歩行距離の合計 <var>S</var> は <var>1 \\times 300 + 3 \\times 600 + 1 \\times 800 = 2900</var> となります。  </p>\n<p><var>K = 1</var> の場合、東西大通りから距離 <var>4</var> だけ北の道路に鉄道路線を建設すると、集落 <var>1, 2, 3</var> の住民の歩行距離は <var>1, 1, 0</var> になります。<br>\nすると、<var>S = 1 \\times 300 + 1 \\times 600 + 0 \\times 800 = 900</var> となります。<br>\n他にも多くの候補から建設場所を選べますが、そのうちどれも <var>S</var> を <var>900</var> より小さくすることはできません。  </p>\n<p><var>K = 2</var> の場合、南北大通りから距離 <var>1, 3</var> だけ東の道路に鉄道路線を建設すると、新 AtCoder 市のすべての住民が歩行距離 <var>0</var> で鉄道路線にたどり着くことができるので、<var>S = 0</var> となります。また、<var>K = 3</var> の場合も、<var>S = 0</var> とすることができます。  </p>\n<p><var>K = 0, 1, 2</var> の場合の最適な鉄道路線の建設方法を下図に示します。<br>\n青く塗られた道路が鉄道路線を敷設する道路を表します。  </p>\n<p><img src=\"https://img.atcoder.jp/m-solutions2020/fc274bed71a4c37706550fa083496d39.png\" height=\"320\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5\n3 5 400\n5 3 700\n5 5 1000\n5 7 700\n7 5 400\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>13800\n1600\n0\n0\n0\n0\n</pre>\n\n<p><var>K = 1, 2</var> の場合の最適な鉄道路線の建設方法を下図に示します。  </p>\n<p><img src=\"https://img.atcoder.jp/m-solutions2020/7c6b7a31998a1c46fba4c0679b023822.png\" height=\"350\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>6\n2 5 1000\n5 2 1100\n5 5 1700\n-2 -5 900\n-5 -2 600\n-5 -5 2200\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>26700\n13900\n3200\n1200\n0\n0\n0\n</pre>\n\n<p><var>K = 3</var> の場合の最適な鉄道路線の建設方法を下図に示します。  </p>\n<p><img src=\"https://img.atcoder.jp/m-solutions2020/0453fa9c2f02c3bd5d5f9e20d0e8e589.png\" height=\"390\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>8\n2 2 286017\n3 1 262355\n2 -2 213815\n1 -3 224435\n-2 -2 136860\n-3 -1 239338\n-2 2 217647\n-1 3 141903\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>2576709\n1569381\n868031\n605676\n366338\n141903\n0\n0\n0\n</pre>\n\n<p><var>K = 4</var> の場合の最適な鉄道路線の建設方法を下図に示します。  </p>\n<p><img src=\"https://img.atcoder.jp/m-solutions2020/464ce76d1d7d72638eb372342f8386c5.png\" height=\"390\"></p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score: <var>500</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3>\n<p>New AtCoder City has an infinite grid of streets, as follows:</p>\n<ul>\n<li>At the center of the city stands a clock tower. Let <var>(0, 0)</var> be the coordinates of this point.</li>\n<li>A straight street, which we will call <em>East-West Main Street</em>, runs east-west and passes the clock tower. It corresponds to the <var>x</var>-axis in the two-dimensional coordinate plane.</li>\n<li>There are also other infinitely many streets parallel to East-West Main Street, with a distance of <var>1</var> between them. They correspond to the lines <var>\\ldots, y = -2, y = -1, y = 1, y = 2, \\ldots</var> in the two-dimensional coordinate plane.</li>\n<li>A straight street, which we will call <em>North-South Main Street</em>, runs north-south and passes the clock tower. It corresponds to the <var>y</var>-axis in the two-dimensional coordinate plane.</li>\n<li>There are also other infinitely many streets parallel to North-South Main Street, with a distance of <var>1</var> between them. They correspond to the lines <var>\\ldots, x = -2, x = -1, x = 1, x = 2, \\ldots</var> in the two-dimensional coordinate plane.</li>\n</ul>\n<p>There are <var>N</var> residential areas in New AtCoder City. The <var>i</var>-th area is located at the intersection with the coordinates <var>(X_i, Y_i)</var> and has a population of <var>P_i</var>. Each citizen in the city lives in one of these areas.</p>\n<p><strong>The city currently has only two railroads, stretching infinitely, one along East-West Main Street and the other along North-South Main Street.</strong><br>\nM-kun, the mayor, thinks that they are not enough for the commuters, so he decides to choose <var>K</var> streets and build a railroad stretching infinitely along each of those streets.</p>\n<p>Let the <em>walking distance</em> of each citizen be the distance from his/her residential area to the nearest railroad.<br>\nM-kun wants to build railroads so that the sum of the walking distances of all citizens, <var>S</var>, is minimized.</p>\n<p>For each <var>K = 0, 1, 2, \\dots, N</var>, what is the minimum possible value of <var>S</var> after building railroads?</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3>\n<ul>\n<li><var>1 \\leq N \\leq 15</var></li>\n<li><var>-10 \\ 000 \\leq X_i \\leq 10 \\ 000</var></li>\n<li><var>-10 \\ 000 \\leq Y_i \\leq 10 \\ 000</var></li>\n<li><var>1 \\leq P_i \\leq 1 \\ 000 \\ 000</var></li>\n<li>The locations of the <var>N</var> residential areas, <var>(X_i, Y_i)</var>, are all distinct.</li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3>\n<p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>X_1</var> <var>Y_1</var> <var>P_1</var>\n<var>X_2</var> <var>Y_2</var> <var>P_2</var>\n <var>:</var>  <var>:</var>  <var>:</var>\n<var>X_N</var> <var>Y_N</var> <var>P_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3>\n<p>Print the answer in <var>N+1</var> lines.<br>\nThe <var>i</var>-th line <var>(i = 1, \\ldots, N+1)</var> should contain the minimum possible value of <var>S</var> after building railroads for the case <var>K = i-1</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n1 2 300\n3 3 600\n1 4 800\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2900\n900\n0\n0\n</pre>\n\n<p>When <var>K = 0</var>, the residents of Area <var>1</var>, <var>2</var>, and <var>3</var> have to walk the distances of <var>1</var>, <var>3</var>, and <var>1</var>, respectively, to reach a railroad.<br>\nThus, the sum of the walking distances of all citizens, <var>S</var>, is <var>1 \\times 300 + 3 \\times 600 + 1 \\times 800 = 2900</var>.</p>\n<p>When <var>K = 1</var>, if we build a railroad along the street corresponding to the line <var>y = 4</var> in the coordinate plane, the walking distances of the citizens of Area <var>1</var>, <var>2</var>, and <var>3</var> become <var>1</var>, <var>1</var>, and <var>0</var>, respectively.<br>\nThen, <var>S = 1 \\times 300 + 1 \\times 600 + 0 \\times 800 = 900</var>.<br>\nWe have many other options for where we build the railroad, but none of them makes <var>S</var> less than <var>900</var>.</p>\n<p>When <var>K = 2</var>, if we build a railroad along the street corresponding to the lines <var>x = 1</var> and <var>x = 3</var> in the coordinate plane, all citizens can reach a railroad with the walking distance of <var>0</var>, so <var>S = 0</var>. We can also have <var>S = 0</var> when <var>K = 3</var>.</p>\n<p>The figure below shows the optimal way to build railroads for the cases <var>K = 0, 1, 2</var>.<br>\nThe street painted blue represents the roads along which we build railroads.</p>\n<p><img src=\"https://img.atcoder.jp/m-solutions2020/fc274bed71a4c37706550fa083496d39.png\" height=\"320\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5\n3 5 400\n5 3 700\n5 5 1000\n5 7 700\n7 5 400\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>13800\n1600\n0\n0\n0\n0\n</pre>\n\n<p>The figure below shows the optimal way to build railroads for the cases <var>K = 1, 2</var>.</p>\n<p><img src=\"https://img.atcoder.jp/m-solutions2020/7c6b7a31998a1c46fba4c0679b023822.png\" height=\"350\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>6\n2 5 1000\n5 2 1100\n5 5 1700\n-2 -5 900\n-5 -2 600\n-5 -5 2200\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>26700\n13900\n3200\n1200\n0\n0\n0\n</pre>\n\n<p>The figure below shows the optimal way to build railroads for the case <var>K = 3</var>.</p>\n<p><img src=\"https://img.atcoder.jp/m-solutions2020/0453fa9c2f02c3bd5d5f9e20d0e8e589.png\" height=\"390\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>8\n2 2 286017\n3 1 262355\n2 -2 213815\n1 -3 224435\n-2 -2 136860\n-3 -1 239338\n-2 2 217647\n-1 3 141903\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>2576709\n1569381\n868031\n605676\n366338\n141903\n0\n0\n0\n</pre>\n\n<p>The figure below shows the optimal way to build railroads for the case <var>K = 4</var>.</p>\n<p><img src=\"https://img.atcoder.jp/m-solutions2020/464ce76d1d7d72638eb372342f8386c5.png\" height=\"390\"></p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/m-solutions2020/tasks/m_solutions2020_e"}