{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点: <var>1200</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>xy</var> 平面上に <var>2N</var> 個のボールがあります。このうち <var>i</var> 番目のボールの位置は <var>(x_i, y_i)</var> です。\nここで、すべての <var>i</var> について <var>x_i, y_i</var> は <var>1</var> 以上 <var>N</var> 以下の整数であり、<var>2</var> つ以上のボールが同じ位置にあることはありません。</p>\n<p>すぬけ君は、これらのボールを回収するために、タイプ A, B のロボットを <var>N</var> 台ずつ用意し、\n位置 <var>(1, 0), (2, 0), ..., (N, 0)</var> にタイプ A のロボットを、位置 <var>(0, 1), (0, 2), ..., (0, N)</var> にタイプ B のロボットをそれぞれ <var>1</var> 台ずつ設置しました。</p>\n<p>それぞれのタイプのロボットは起動されると以下のように動作します。</p>\n<ul>\n<li>タイプ A のロボットは、位置 <var>(a, 0)</var> で起動されると、直線 <var>x = a</var> 上にあるボールのうち <var>y</var> 座標の値が最小のものを回収して停止する。そのようなボールが存在しない場合は何もせずに停止する。</li>\n<li>タイプ B のロボットは、位置 <var>(0, b)</var> で起動されると、直線 <var>y = b</var> 上にあるボールのうち <var>x</var> 座標の値が最小のものを回収して停止する。そのようなボールが存在しない場合は何もせずに停止する。</li>\n</ul>\n<p>一度停止したロボットをもう一度起動することはできません。また、動作中のロボットがある場合、それが停止するまで新たなロボットを起動することはできません。</p>\n<p>すぬけ君は、ロボットを起動しようとして、起動する順序によってはすべてのボールを回収することができない可能性があることに気づきました。</p>\n<p>ロボットを起動する順序として考えられる <var>(2N)!</var> 通りのうち、すべてのボールを回収できるような順序の個数を <var>1,000,000,007</var> で割った余りを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 ≦ N ≦ 10^5</var></li>\n<li><var>1 ≦ x_i ≦ N</var></li>\n<li><var>1 ≦ y_i ≦ N</var></li>\n<li><var>i ≠ j</var> のとき、<var>x_i ≠ x_j</var> または <var>y_i ≠ y_j</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>x_1</var> <var>y_1</var>\n<var>...</var>\n<var>x_{2N}</var> <var>y_{2N}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>すべてのボールを回収できるようなロボットの起動順序の個数を <var>1,000,000,007</var> で割った余りを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2\n1 1\n1 2\n2 1\n2 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>8\n</pre>\n\n<p>位置 <var>(1,0), (2, 0)</var> に設置されたロボットをそれぞれ A1, A2 と呼び、位置 <var>(0, 1), (0, 2)</var> に設置されたロボットをそれぞれ B1, B2 と呼ぶことにします。\nこのとき、条件を満たす起動順序は以下の <var>8</var> 通りあります。</p>\n<ul>\n<li>A1, B1, A2, B2</li>\n<li>A1, B1, B2, A2</li>\n<li>A1, B2, B1, A2</li>\n<li>A2, B1, A1, B2</li>\n<li>B1, A1, B2, A2</li>\n<li>B1, A1, A2, B2</li>\n<li>B1, A2, A1, B2</li>\n<li>B2, A1, B1, A2</li>\n</ul>\n<p>よって <var>8</var> を出力します。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>4\n3 2\n1 2\n4 1\n4 2\n2 2\n4 4\n2 1\n1 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>7392\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>4\n1 1\n2 2\n3 3\n4 4\n1 2\n2 1\n3 4\n4 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>4480\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>8\n6 2\n5 1\n6 8\n7 8\n6 5\n5 7\n4 3\n1 4\n7 6\n8 3\n2 8\n3 6\n3 2\n8 5\n1 5\n5 8\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>82060779\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 5</h3><pre>3\n1 1\n1 2\n1 3\n2 1\n2 2\n2 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 5</h3><pre>0\n</pre>\n\n<p>条件を満たす順序が存在しない場合、答えは <var>0</var> となります。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1200</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>2N</var> balls in the <var>xy</var>-plane. The coordinates of the <var>i</var>-th of them is <var>(x_i, y_i)</var>.\nHere, <var>x_i</var> and <var>y_i</var> are integers between <var>1</var> and <var>N</var> (inclusive) for all <var>i</var>, and no two balls occupy the same coordinates.</p>\n<p>In order to collect these balls, Snuke prepared <var>2N</var> robots, <var>N</var> of type A and <var>N</var> of type B.\nThen, he placed the type-A robots at coordinates <var>(1, 0), (2, 0), ..., (N, 0)</var>, and the type-B robots at coordinates <var>(0, 1), (0, 2), ..., (0, N)</var>, one at each position.</p>\n<p>When activated, each type of robot will operate as follows.</p>\n<ul>\n<li>\n<p>When a type-A robot is activated at coordinates <var>(a, 0)</var>, it will move to the position of the ball with the lowest <var>y</var>-coordinate among the balls on the line <var>x = a</var>, collect the ball and deactivate itself. If there is no such ball, it will just deactivate itself without doing anything.</p>\n</li>\n<li>\n<p>When a type-B robot is activated at coordinates <var>(0, b)</var>, it will move to the position of the ball with the lowest <var>x</var>-coordinate among the balls on the line <var>y = b</var>, collect the ball and deactivate itself. If there is no such ball, it will just deactivate itself without doing anything.</p>\n</li>\n</ul>\n<p>Once deactivated, a robot cannot be activated again. Also, while a robot is operating, no new robot can be activated until the operating robot is deactivated.</p>\n<p>When Snuke was about to activate a robot, he noticed that he may fail to collect all the balls, depending on the order of activating the robots.</p>\n<p>Among the <var>(2N)!</var> possible orders of activating the robots, find the number of the ones such that all the balls can be collected, modulo <var>1</var> <var>000</var> <var>000</var> <var>007</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 10^5</var></li>\n<li><var>1 \\leq x_i \\leq N</var></li>\n<li><var>1 \\leq y_i \\leq N</var></li>\n<li>If <var>i ≠ j</var>, either <var>x_i ≠ x_j</var> or <var>y_i ≠ y_j</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Inputs</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>x_1</var> <var>y_1</var>\n<var>...</var>\n<var>x_{2N}</var> <var>y_{2N}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Outputs</h3><p>Print the number of the orders of activating the robots such that all the balls can be collected, modulo <var>1</var> <var>000</var> <var>000</var> <var>007</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2\n1 1\n1 2\n2 1\n2 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>8\n</pre>\n\n<p>We will refer to the robots placed at <var>(1, 0)</var> and <var>(2, 0)</var> as A1 and A2, respectively, and the robots placed at <var>(0, 1)</var> and <var>(0, 2)</var> as B1 and B2, respectively.\nThere are eight orders of activation that satisfy the condition, as follows:</p>\n<ul>\n<li>A1, B1, A2, B2</li>\n<li>A1, B1, B2, A2</li>\n<li>A1, B2, B1, A2</li>\n<li>A2, B1, A1, B2</li>\n<li>B1, A1, B2, A2</li>\n<li>B1, A1, A2, B2</li>\n<li>B1, A2, A1, B2</li>\n<li>B2, A1, B1, A2</li>\n</ul>\n<p>Thus, the output should be <var>8</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>4\n3 2\n1 2\n4 1\n4 2\n2 2\n4 4\n2 1\n1 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>7392\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>4\n1 1\n2 2\n3 3\n4 4\n1 2\n2 1\n3 4\n4 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>4480\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>8\n6 2\n5 1\n6 8\n7 8\n6 5\n5 7\n4 3\n1 4\n7 6\n8 3\n2 8\n3 6\n3 2\n8 5\n1 5\n5 8\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>82060779\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 5</h3><pre>3\n1 1\n1 2\n1 3\n2 1\n2 2\n2 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 5</h3><pre>0\n</pre>\n\n<p>When there is no order of activation that satisfies the condition, the output should be <var>0</var>.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc083/tasks/arc083_d"}