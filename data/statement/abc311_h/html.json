{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>675</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>頂点に <var>1</var> から <var>N</var> までの番号がついた <var>N</var> 頂点の根付き木 <var>T</var> があります。根は頂点 <var>1</var> で、頂点 <var>i</var> <var>(2 \\leq i \\leq N)</var> の親は <var>P_i</var> です。<br>\n各頂点には <strong>美しさ</strong>・<strong>重さ</strong> と呼ばれる 2 つの非負整数値がついています。頂点 <var>i</var> の美しさは <var>B_i</var> で重さは <var>W_i</var> です。<br>\nまた、各頂点は赤か青で塗られています。頂点 <var>i</var> の色は整数 <var>C_i</var> で表されて、<var>C_i = 0</var> のとき頂点 <var>i</var> は赤、<var>C_i = 1</var> のとき青で塗られています。</p>\n<p>頂点 <var>v</var> に対して、次の問題の答えを <var>F(v)</var> とおきます。</p>\n<blockquote>\n<p><var>T</var> から <var>v</var> を根とする部分根付き木を取り出して出来る根付き木を <var>U</var> とします。<br>\nあなたは <var>U</var> に対して以下の一連の操作を <var>0</var> 回以上好きなだけ行うことができます。(操作の前後で、削除されない頂点の美しさ・重さ・色はいずれも変化しません。) </p>\n<ul>\n<li>根以外の頂点 <var>c</var> を 1 つ選ぶ。<var>c</var> の親を <var>p</var> とする。</li>\n<li>頂点 <var>c</var> が親側の端点である辺全てに対して、次の操作を行う。<ul>\n<li>辺の <var>c</var> でない端点を <var>u</var> とする。辺を削除して、代わりに <var>p, u</var> 間に <var>p</var> を親側の端点とする新たな辺を結ぶ。</li>\n</ul>\n</li>\n<li>頂点 <var>c</var> 、および <var>p, c</var> 間を結ぶ辺を削除する。</li>\n</ul>\n<p>操作後の <var>U</var> としてあり得る根付き木のうち、以下の条件を全て満たす木を <strong>良い根付き木</strong> と呼びます。</p>\n<ul>\n<li><var>U</var> に含まれるすべての辺について、辺で結ばれた頂点同士の色が異なる。</li>\n<li>頂点の重さの総和が <var>X</var> 以下である。</li>\n</ul>\n<p>良い根付き木に含まれる頂点の美しさの総和として取り得る値の最大値を求めてください。</p>\n</blockquote>\n<p><var>F(1), F(2), \\dots, F(N)</var> を全て列挙してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq N \\leq 200</var></li>\n<li><var>0 \\leq X \\leq 50000</var></li>\n<li><var>1 \\leq P_i \\leq i - 1</var></li>\n<li><var>0 \\leq B_i \\leq 10^{15}</var></li>\n<li><var>0 \\leq W_i \\leq X</var></li>\n<li><var>C_i</var> は <var>0</var> または <var>1</var></li>\n<li>入力される値はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>X</var>\n<var>P_2</var> <var>P_3</var> <var>\\dots</var> <var>P_N</var>\n<var>B_1</var> <var>W_1</var> <var>C_1</var>\n<var>B_2</var> <var>W_2</var> <var>C_2</var>\n<var>\\vdots</var>\n<var>B_N</var> <var>W_N</var> <var>C_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>N</var> 行出力せよ。<var>i</var> 行目には <var>F(i)</var> を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 10\n1 2 2\n2 1 0\n4 2 1\n6 8 0\n7 4 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>9\n10\n6\n7\n</pre>\n\n<p><var>v=1</var> の場合、まず <var>c=2</var> を選び、次に <var>c=3</var> を選ぶと <var>U</var> は図のように変化して、操作後の <var>U</var> は良い根付き木になります。\nこの木に含まれる頂点の美しさの総和は <var>2 + 7 = 9</var> で、良い根付き木の中で最大です。よって <var>F(1) = 9</var> です。</p>\n<p><img alt=\"image\" src=\"https://img.atcoder.jp/ghi/abc311h_e9c1607d075d1352a8dc9ec07fe3ef4991c33a9d56626c4ab3f337e0c9d8a429.jpg\"></p>\n<p><var>v=2</var> の場合、 <var>c=4</var> を選ぶと <var>U</var> は図のように変化して、操作後の <var>U</var> は良い根付き木になります。\nこの木に含まれる頂点の美しさの総和は <var>4 + 6 = 10</var> で、良い根付き木の中で最大です。よって <var>F(2) = 10</var> です。</p>\n<p><img alt=\"image2\" src=\"https://img.atcoder.jp/ghi/abc311h2_fbbe94f219fde3a66d7846819b00d81f125609dd63a1a6fe3028a114991129a3.jpg\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5 5\n1 2 2 3\n1 1 0\n10 1 1\n100 1 0\n1000 1 1\n10000 1 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>11001\n10110\n10100\n1000\n10000\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>20 100\n1 2 1 1 1 6 6 5 1 7 9 4 6 4 15 16 8 2 5\n887945036308847 12 0\n699398807312293 20 1\n501806283312516 17 0\n559755618233839 19 1\n253673279319163 10 1\n745815685342299 11 1\n251710263962529 15 0\n777195295276573 15 0\n408579800634972 17 0\n521840965162492 17 1\n730678137312837 18 1\n370007714721362 14 1\n474595536466754 17 0\n879365432938644 15 0\n291785577961862 20 0\n835878893889428 14 1\n503562238579284 10 0\n567569163005307 18 1\n368949585722534 15 0\n386435396601075 16 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>5329161389647368\n1570154676347343\n501806283312516\n2665577865131167\n1418696191276572\n3952333977838189\n982388401275366\n1344764458281880\n778587515356334\n521840965162492\n730678137312837\n370007714721362\n474595536466754\n879365432938644\n1631226710430574\n1339441132468712\n503562238579284\n567569163005307\n368949585722534\n386435396601075\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>675</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There is a rooted tree <var>T</var> with <var>N</var> vertices numbered <var>1</var> to <var>N</var>. The root is vertex <var>1</var>, and the parent of vertex <var>i</var> <var>(2 \\leq i \\leq N)</var> is <var>P_i</var>.<br>\nEach vertex has two non-negative integer values called <strong>beauty</strong> and <strong>weight</strong>. The beauty and weight of vertex <var>i</var> are <var>B_i</var> and <var>W_i</var>, respectively.<br>\nAdditionally, each vertex is painted red or blue. The color of vertex <var>i</var> is represented by an integer <var>C_i</var>: vertex <var>i</var> is painted red if <var>C_i = 0</var>, and blue if <var>C_i = 1</var>.</p>\n<p>For vertex <var>v</var>, let <var>F(v)</var> be the answer to the following problem.</p>\n<blockquote>\n<p>Let <var>U</var> be the rooted tree that is the subtree of <var>T</var> rooted at <var>v</var>.<br>\nYou can perform the following sequence of operations on <var>U</var> zero or more times. (The operations do not affect the beauties, weights, or colors of the vertices that are not being deleted.)</p>\n<ul>\n<li>Choose a vertex <var>c</var> other than the root. Let <var>p</var> be the parent of <var>c</var>.</li>\n<li>For each edge whose endpoint on the parent side is <var>c</var>, do the following:<ul>\n<li>Let <var>u</var> be the endpoint of the edge other than <var>c</var>. Delete the edge and connect <var>p</var> and <var>u</var> with a new edge, with <var>p</var> on the parent side.</li>\n</ul>\n</li>\n<li>Delete the vertex <var>c</var>, and the edge connecting <var>p</var> and <var>c</var>.</li>\n</ul>\n<p>A rooted tree that can be obtained as <var>U</var> after some operations is called a <strong>good rooted tree</strong> when all of the following conditions are satisfied.</p>\n<ul>\n<li>For every edge in <var>U</var>, the edge's endpoints have different colors.</li>\n<li>The vertices have a total weight of at most <var>X</var>.</li>\n</ul>\n<p>Find the maximum possible total beauty of the vertices in a good rooted tree.</p>\n</blockquote>\n<p>Find all of <var>F(1), F(2), \\dots, F(N)</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 200</var></li>\n<li><var>0 \\leq X \\leq 50000</var></li>\n<li><var>1 \\leq P_i \\leq i - 1</var></li>\n<li><var>0 \\leq B_i \\leq 10^{15}</var></li>\n<li><var>0 \\leq W_i \\leq X</var></li>\n<li><var>C_i</var> is <var>0</var> or <var>1</var>.</li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>X</var>\n<var>P_2</var> <var>P_3</var> <var>\\dots</var> <var>P_N</var>\n<var>B_1</var> <var>W_1</var> <var>C_1</var>\n<var>B_2</var> <var>W_2</var> <var>C_2</var>\n<var>\\vdots</var>\n<var>B_N</var> <var>W_N</var> <var>C_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>N</var> lines. The <var>i</var>-th line should contain <var>F(i)</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 10\n1 2 2\n2 1 0\n4 2 1\n6 8 0\n7 4 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>9\n10\n6\n7\n</pre>\n\n<p>For <var>v=1</var>, choosing <var>c=2</var> and then <var>c=3</var> changes <var>U</var> as shown in the figure, making it a good rooted tree.\nThe total beauty of the vertices in this tree is <var>2 + 7 = 9</var>, which is the maximum among all good rooted trees, so <var>F(1) = 9</var>.</p>\n<p><img alt=\"image\" src=\"https://img.atcoder.jp/ghi/abc311h_e9c1607d075d1352a8dc9ec07fe3ef4991c33a9d56626c4ab3f337e0c9d8a429.jpg\"></p>\n<p>For <var>v=2</var>, choosing <var>c=4</var> changes <var>U</var> as shown in the figure, making it a good rooted tree.\nThe total beauty of the vertices in this tree is <var>4 + 6 = 10</var>, which is the maximum among all good rooted trees, so <var>F(2) = 10</var>.</p>\n<p><img alt=\"image2\" src=\"https://img.atcoder.jp/ghi/abc311h2_fbbe94f219fde3a66d7846819b00d81f125609dd63a1a6fe3028a114991129a3.jpg\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5 5\n1 2 2 3\n1 1 0\n10 1 1\n100 1 0\n1000 1 1\n10000 1 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>11001\n10110\n10100\n1000\n10000\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>20 100\n1 2 1 1 1 6 6 5 1 7 9 4 6 4 15 16 8 2 5\n887945036308847 12 0\n699398807312293 20 1\n501806283312516 17 0\n559755618233839 19 1\n253673279319163 10 1\n745815685342299 11 1\n251710263962529 15 0\n777195295276573 15 0\n408579800634972 17 0\n521840965162492 17 1\n730678137312837 18 1\n370007714721362 14 1\n474595536466754 17 0\n879365432938644 15 0\n291785577961862 20 0\n835878893889428 14 1\n503562238579284 10 0\n567569163005307 18 1\n368949585722534 15 0\n386435396601075 16 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>5329161389647368\n1570154676347343\n501806283312516\n2665577865131167\n1418696191276572\n3952333977838189\n982388401275366\n1344764458281880\n778587515356334\n521840965162492\n730678137312837\n370007714721362\n474595536466754\n879365432938644\n1631226710430574\n1339441132468712\n503562238579284\n567569163005307\n368949585722534\n386435396601075\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc311/tasks/abc311_h"}