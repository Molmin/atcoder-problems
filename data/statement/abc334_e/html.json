{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>450</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><strong>この問題は問題 G と似た設定です。問題文の相違点を赤字で示します。</strong></p>\n<p><var>H</var> 行 <var>W</var> 列のグリッドがあり、グリッドの各マスは赤色あるいは緑色に塗られています。</p>\n<p>グリッドの上から <var>i</var> 行目、左から <var>j</var> 列目のマスをマス <var>(i,j)</var> と表記します。</p>\n<p>マス <var>(i,j)</var> の色は文字 <var>S_{i,j}</var> で表され、<var>S_{i,j} =</var> <code>.</code> のときマス <var>(i,j)</var> は赤色、<var>S_{i,j} =</var> <code>#</code> のときマス <var>(i,j)</var> は緑色に塗られています。</p>\n<p>グリッドにおいて、緑色に塗られたマスを頂点集合、隣り合った <var>2</var> つの緑色のマスを結ぶ辺全体を辺集合としたグラフにおける連結成分の個数を <strong>緑の連結成分数</strong> と呼びます。ただし、<var>2</var> つのマス <var>(x,y)</var> と <var>(x',y')</var> が隣り合っているとは、<var>|x-x'| + |y-y'| = 1</var> であることを指します。</p>\n<p><span style=\"color:red;\"><strong>赤色</strong></span>に塗られたマスを一様ランダムに <var>1</var> つ選び、<span style=\"color:red;\"><strong>緑色</strong></span>に塗り替えたとき、塗り替え後のグリッドの緑の連結成分数の期待値を <var>\\text{mod } 998244353</var> で出力してください。</p>\n<details> \n<summary>「期待値を <var>\\text{mod } 998244353</var> で出力」とは</summary> \n求める期待値は必ず有理数となることが証明できます。\nまたこの問題の制約下では、その値を互いに素な <var>2</var> つの整数 <var>P</var>, <var>Q</var> を用いて <var>\\frac{P}{Q}</var> と表したとき、 <var>R \\times Q \\equiv P\\pmod{998244353}</var> かつ <var>0 \\leq R \\lt 998244353</var> を満たす整数 <var>R</var> がただ <var>1</var> つ存在することが証明できます。この <var>R</var> を出力してください。 \n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq H,W \\leq 1000</var></li>\n<li><var>S_{i,j} =</var> <code>.</code> または <var>S_{i,j} =</var> <code>#</code></li>\n<li><var>S_{i,j} =</var> <code>.</code> なる <var>(i,j)</var> が存在する。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>H</var> <var>W</var>\n<var>S_{1,1}</var><var>S_{1,2}</var><var>\\ldots</var><var>S_{1,W}</var>\n<var>S_{2,1}</var><var>S_{2,2}</var><var>\\ldots</var><var>S_{2,W}</var>\n<var>\\vdots</var>\n<var>S_{H,1}</var><var>S_{H,2}</var><var>\\ldots</var><var>S_{H,W}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 3\n##.\n#.#\n#..\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>499122178\n</pre>\n\n<p>マス <var>(1,3)</var> を緑色に塗り替えたとき、緑の連結成分数は <var>1</var> となります。</p>\n<p>マス <var>(2,2)</var> を緑色に塗り替えたとき、緑の連結成分数は <var>1</var> となります。</p>\n<p>マス <var>(3,2)</var> を緑色に塗り替えたとき、緑の連結成分数は <var>2</var> となります。</p>\n<p>マス <var>(3,3)</var> を緑色に塗り替えたとき、緑の連結成分数は <var>2</var> となります。</p>\n<p>よって、赤色に塗られたマスを一様ランダムに <var>1</var> つ選び、緑色に塗り替えた後の緑の連結成分数の期待値は <var>(1+1+2+2)/4 = 3/2</var> となります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>4 5\n..#..\n.###.\n#####\n..#..\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>598946613\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>3 4\n#...\n.#.#\n..##\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>285212675\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>450</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p><strong>This problem has a similar setting to Problem G. Differences in the problem statement are indicated in red.</strong></p>\n<p>There is a grid with <var>H</var> rows and <var>W</var> columns, where each cell is painted red or green.</p>\n<p>Let <var>(i,j)</var> denote the cell in the <var>i</var>-th row from the top and the <var>j</var>-th column from the left.</p>\n<p>The color of cell <var>(i,j)</var> is represented by the character <var>S_{i,j}</var>, where <var>S_{i,j} =</var> <code>.</code> means cell <var>(i,j)</var> is red, and <var>S_{i,j} =</var> <code>#</code> means cell <var>(i,j)</var> is green.</p>\n<p>The <strong>number of green connected components</strong> in the grid is the number of connected components in the graph with the vertex set being the green cells and the edge set being the edges connecting two adjacent green cells. Here, two cells <var>(x,y)</var> and <var>(x',y')</var> are considered adjacent when <var>|x-x'| + |y-y'| = 1</var>.</p>\n<p>Consider choosing one <span style=\"color:red;\"><strong>red</strong></span> cell uniformly at random and repainting it <span style=\"color:red;\"><strong>green</strong></span>. Print the expected value of the number of green connected components in the grid after repainting, modulo <var>998244353</var>.</p>\n<details> \n<summary>What does \"print the expected value modulo <var>998244353</var>\" mean?</summary> \nIt can be proved that the sought expected value is always rational.\nFurthermore, the constraints of this problem guarantee that if that value is expressed as <var>\\frac{P}{Q}</var> using two coprime integers <var>P</var> and <var>Q</var>, there is exactly one integer <var>R</var> such that <var>R \\times Q \\equiv P \\pmod{998244353}</var> and <var>0 \\leq R &lt; 998244353</var>. Print this <var>R</var>. \n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq H,W \\leq 1000</var></li>\n<li><var>S_{i,j} =</var> <code>.</code> or <var>S_{i,j} =</var> <code>#</code>.</li>\n<li>There is at least one <var>(i,j)</var> such that <var>S_{i,j} =</var> <code>.</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>H</var> <var>W</var>\n<var>S_{1,1}</var><var>S_{1,2}</var><var>\\ldots</var><var>S_{1,W}</var>\n<var>S_{2,1}</var><var>S_{2,2}</var><var>\\ldots</var><var>S_{2,W}</var>\n<var>\\vdots</var>\n<var>S_{H,1}</var><var>S_{H,2}</var><var>\\ldots</var><var>S_{H,W}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 3\n##.\n#.#\n#..\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>499122178\n</pre>\n\n<p>If cell <var>(1,3)</var> is repainted green, the number of green connected components becomes <var>1</var>.</p>\n<p>If cell <var>(2,2)</var> is repainted green, the number of green connected components becomes <var>1</var>.</p>\n<p>If cell <var>(3,2)</var> is repainted green, the number of green connected components becomes <var>2</var>.</p>\n<p>If cell <var>(3,3)</var> is repainted green, the number of green connected components becomes <var>2</var>.</p>\n<p>Therefore, the expected value of the number of green connected components after choosing one red cell uniformly at random and repainting it green is <var>(1+1+2+2)/4 = 3/2</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>4 5\n..#..\n.###.\n#####\n..#..\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>598946613\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>3 4\n#...\n.#.#\n..##\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>285212675\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc334/tasks/abc334_e"}