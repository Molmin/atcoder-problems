{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>900</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>1</var> から <var>N</var> までの番号のついた <var>N</var> 頂点からなる根付き木があります．\n根は頂点 <var>1</var> で，頂点 <var>i</var> (<var>2 \\leq i \\leq N</var>) の親は頂点 <var>P_i</var> (<var>P_i&lt;i</var>) です．</p>\n<p>また，<var>1</var> 以上 <var>N</var> 以下の整数からなる長さ <var>M</var> の整数列 <var>A=(A_1,A_2,\\cdots,A_M),B=(B_1,B_2,\\cdots,B_M)</var> があります．</p>\n<p><var>A</var> が <strong>good</strong> であるとは，各 <var>i</var> に対し，頂点 <var>A_i</var> が頂点 <var>B_i</var> の先祖であるかまたは <var>A_i=B_i</var> を満たすことを意味します．\n最初，<var>A</var> は good です．</p>\n<p><var>A</var> に対する以下の操作を考えます．</p>\n<ul>\n<li>整数 <var>i</var> (<var>1 \\leq i \\leq M-1</var>) を選び，<var>A_i</var> と <var>A_{i+1}</var> の値を入れ替える．\nただし，操作後の <var>A</var> も good である必要がある．</li>\n</ul>\n<p><var>A</var> に <var>0</var> 回以上操作を行った結果としてあり得る数列の個数を <var>998244353</var> で割ったあまりを求めてください．</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq N \\leq 250000</var></li>\n<li><var>2 \\leq M \\leq 250000</var></li>\n<li><var>1 \\leq P_i &lt;i</var></li>\n<li><var>1 \\leq A_i \\leq B_i \\leq N</var></li>\n<li>頂点 <var>A_i</var> は頂点 <var>B_i</var> の先祖であるかまたは <var>A_i=B_i</var></li>\n<li>入力される値はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は標準入力から以下の形式で与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>P_2</var> <var>P_3</var> <var>\\cdots</var> <var>P_N</var>\n<var>A_1</var> <var>A_2</var> <var>\\cdots</var> <var>A_M</var>\n<var>B_1</var> <var>B_2</var> <var>\\cdots</var> <var>B_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力せよ．</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 3\n1 2\n1 2 1\n1 2 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2\n</pre>\n<p><var>i=1</var> を選ぶことを考えます．操作後の <var>A=(2,1,1)</var> は good でないので，この操作は実行不可能です．</p>\n<p><var>i=2</var> を選ぶことを考えます．操作後の <var>A=(1,1,2)</var> は good なので，この操作は実行可能です．</p>\n<p><var>A</var> に <var>0</var> 回以上操作を行った結果としてあり得る数列は <var>A=(1,2,1),(1,1,2)</var> の <var>2</var> つです．</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>4 3\n1 1 1\n2 3 4\n2 3 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>8 13\n1 2 2 3 4 4 3\n5 3 2 5 4 6 2 8 2 6 7 4 7\n5 5 8 5 6 6 5 8 3 6 7 4 7\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>8\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>30 27\n1 2 1 1 5 1 7 1 5 10 1 12 12 13 15 16 12 18 19 18 21 21 23 13 18 18 27 27 13\n1 18 1 5 11 12 1 1 1 12 1 12 1 15 1 1 21 1 12 10 2 8 3 1 1 30 12\n14 27 30 5 11 17 1 18 24 27 29 27 19 15 28 5 21 21 29 11 2 8 3 4 10 30 22\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>60\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>900</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There is a rooted tree with <var>N</var> vertices numbered from <var>1</var> to <var>N</var>.\nThe root is vertex <var>1</var>, and the parent of vertex <var>i</var> (<var>2 \\leq i \\leq N</var>) is vertex <var>P_i</var> (<var>P_i&lt;i</var>).</p>\n<p>There are also integer sequences of length <var>M</var>: <var>A=(A_1,A_2,\\cdots,A_M)</var> and <var>B=(B_1,B_2,\\cdots,B_M)</var>, consisting of integers between <var>1</var> and <var>N</var>, inclusive.</p>\n<p><var>A</var> is said to be <strong>good</strong> if and only if for each <var>i</var>, vertex <var>A_i</var> is an ancestor of vertex <var>B_i</var> or <var>A_i=B_i</var>.\nInitially, <var>A</var> is good.</p>\n<p>Consider the following operation on <var>A</var>.</p>\n<ul>\n<li>Choose an integer <var>i</var> (<var>1 \\leq i \\leq M-1</var>) and swap the values of <var>A_i</var> and <var>A_{i+1}</var>.\nHere, <var>A</var> must remain good after the operation.</li>\n</ul>\n<p>Find the number, modulo <var>998244353</var>, of sequences that can result from performing this operation on <var>A</var> zero or more times.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 250000</var></li>\n<li><var>2 \\leq M \\leq 250000</var></li>\n<li><var>1 \\leq P_i &lt;i</var></li>\n<li><var>1 \\leq A_i \\leq B_i \\leq N</var></li>\n<li>Vertex <var>A_i</var> is an ancestor of vertex <var>B_i</var> or <var>A_i=B_i</var>.</li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>P_2</var> <var>P_3</var> <var>\\cdots</var> <var>P_N</var>\n<var>A_1</var> <var>A_2</var> <var>\\cdots</var> <var>A_M</var>\n<var>B_1</var> <var>B_2</var> <var>\\cdots</var> <var>B_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 3\n1 2\n1 2 1\n1 2 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2\n</pre>\n<p>Consider choosing <var>i=1</var>. The <var>A=(2,1,1)</var> after the operation is not good, so this operation is invalid.</p>\n<p>Consider choosing <var>i=2</var>. The <var>A=(1,1,2)</var> after the operation is good, so this operation is valid.</p>\n<p>There are two sequences that can result from performing zero or more operations on <var>A</var>: <var>A=(1,2,1)</var> and <var>(1,1,2)</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>4 3\n1 1 1\n2 3 4\n2 3 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>1\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>8 13\n1 2 2 3 4 4 3\n5 3 2 5 4 6 2 8 2 6 7 4 7\n5 5 8 5 6 6 5 8 3 6 7 4 7\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>8\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>30 27\n1 2 1 1 5 1 7 1 5 10 1 12 12 13 15 16 12 18 19 18 21 21 23 13 18 18 27 27 13\n1 18 1 5 11 12 1 1 1 12 1 12 1 15 1 1 21 1 12 10 2 8 3 1 1 30 12\n14 27 30 5 11 17 1 18 24 27 29 27 19 15 28 5 21 21 29 11 2 8 3 4 10 30 22\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>60\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc183/tasks/arc183_e"}