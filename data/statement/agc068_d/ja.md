配点 : $1200$ 点

## 問題文

$1$ から $N$ までの番号がついた $N$ 頂点からなる根付き木 $T$ があります．
頂点 $1$ が根で，頂点 $i$ ($2 \leq i \leq N$) の親は $P_i$ ($P_i &lt; i$) です．

$(1,2,\cdots,N)$ の順列 $x=(x_1,x_2,\cdots,x_N)$ が**良い**順列か否かは，以下の手順で判定されます．

- $x$ に対する次の操作を考える．-   - $x$ の隣接する $2$ 要素 $u,v$ であって，$u,v$ が $T$ 上で先祖子孫の関係にあるものを選ぶ．$u,v$ のどちらが先祖でどちらが子孫でも構わない．そして，$u,v$ を swap する．
- 上記の操作を $0$ 回以上行い，初期状態よりも辞書順で真に小さい順列を得ることが可能ならば，$x$ は良い順列**ではない**．どう操作しても初期状態よりも辞書順で真に小さい順列が得られないなら，$x$ は良い順列である．

正整数 $B$ が与えられます．
順列 $x$ に対し，$\operatorname{hash}(x)=\sum_{1 \leq i \leq N} B^{i-1} \times x_i$ と定義します．

良い順列 $x$ すべてに対する $\operatorname{hash}(x)$ の総和を $998244353$ で割ったあまりを求めてください．

 数列の辞書順とは？

数列 $S = (S_1,S_2,\ldots,S_{|S|})$ が数列 $T = (T_1,T_2,\ldots,T_{|T|})$ より**辞書順で小さい**とは，下記の 1. と 2. のどちらかが成り立つことを言います．
ここで，$|S|, |T|$ はそれぞれ $S, T$ の長さを表します．

1. $|S| \lt |T|$ かつ $(S_1,S_2,\ldots,S_{|S|}) = (T_1,T_2,\ldots,T_{|S|})$．
2. ある整数 $1 \leq i \leq \min\lbrace |S|, |T| \rbrace$ が存在して，下記の $2$ つがともに成り立つ．
1.    - $(S_1,S_2,\ldots,S_{i-1}) = (T_1,T_2,\ldots,T_{i-1})$
2.    - $S_i$ が $T_i$ より（数として）小さい．

## 制約

- $2 \leq N \leq 100$
- $1 \leq B &lt; 998244353$
- $1 \leq P_i &lt; i$ ($2 \leq i \leq N$)
- 入力される値はすべて整数

## 入力

入力は以下の形式で標準入力から与えられる．

> $N$ $B$
> 
> $P_2$ $P_3$ $\cdots$ $P_N$

## 出力

答えを出力せよ．

```input1
3 100
1 1
```

```output1
50502
```

例えば，$x=(3,1,2)$ は良い順列ではありません．
これは先祖子孫の関係にある $3,1$ を swap することで $(1,3,2)$ というより小さい順列が得られるからです．

このサンプルでは，良い順列は $x=(1,2,3),(1,3,2)$ の $2$ つです．
よって，$\operatorname{hash}((1,2,3))+\operatorname{hash}((1,3,2))=30201+20301=50502$ が答えになります．

```input2
5 100
1 2 3 4
```

```output2
504030201
```

このサンプルでは，どの $2$ 頂点をとってもそれらは先祖子孫の関係にあります．
よって良い順列は $x=(1,2,3,4,5)$ のみです．

```input3
10 248730679
1 2 1 2 5 6 1 8 1
```

```output3
856673861
```

```input4
20 480124393
1 2 3 2 3 4 3 8 3 4 11 10 4 14 15 12 17 18 19
```

```output4
488941820
```