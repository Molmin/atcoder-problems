{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>現代美術に興味を持ったりんごさんは、CODE FESTIVAL 2017 の会場に作られた <var>N+2</var> 行 <var>M+2</var> 列の盤面と、何人かの人を使って絵を描くことにしました。</p>\n<p>盤面の上から <var>i+1</var> 行目、左から <var>j+1</var> 列目のマスは <var>2</var> つの整数の組 <var>(i,j)</var> であらわされます。すなわち、左上のマスが <var>(0,0)</var> で、右下のマスが <var>(N+1,M+1)</var> です。\n最初、<var>1 \\leq x \\leq N, 1 \\leq y \\leq M</var> を満たすマス <var>(x,y)</var> は白で塗られており、それ以外の (外周の) マスは黒で塗られています。</p>\n<p>りんごさんは、盤面の外周のマスのうちのいくつかに、人を内向きに配置しました。\nより厳密には、配置の情報は <var>4</var> つの文字列 <var>A,B,C,D</var> によってあらわされ、以下のように配置が行われます。</p>\n<ul>\n<li>端以外の各行について、<var>A</var> の <var>i(1 \\leq i \\leq N)</var> 文字目が <code>1</code> のときマス <var>(i,0)</var> に、右を向いた人を <var>1</var> 人配置する。そうでないとき、何もしない。</li>\n<li>端以外の各行について、<var>B</var> の <var>i(1 \\leq i \\leq N)</var> 文字目が <code>1</code> のときマス <var>(i,M+1)</var> に、左を向いた人を <var>1</var> 人配置する。そうでないとき、何もしない。</li>\n<li>端以外の各列について、<var>C</var> の <var>i(1 \\leq i \\leq M)</var> 文字目が <code>1</code> のときマス <var>(0,i)</var> に、下を向いた人を <var>1</var> 人配置する。そうでないとき、何もしない。</li>\n<li>端以外の各列について、<var>D</var> の <var>i(1 \\leq i \\leq M)</var> 文字目が <code>1</code> のときマス <var>(N+1,i)</var> に、上を向いた人を <var>1</var> 人配置する。そうでないとき、何もしない。</li>\n</ul>\n<p>各人はそれぞれ、白でない色のペンキを充分な量持っています。どの相異なる <var>2</var> 人の持っているペンキの色も、互いに異なります。</p>\n<div style=\"text-align: center;\">\n<img src=\"https://atcoder.jp/img/code-festival-2017-quala/46a627606452b904221672922d269290.png\">\n<p>人の配置の例(便宜上、黒く塗られたマスを灰色で表しています)</p>\n</div>\n\n<p>りんごさんは、以下の一連の操作を、全ての人が会場から追い出されていなくなるまで繰り返します。</p>\n<ul>\n<li>まだ追い出されていない人を <var>1</var> 人選ぶ。</li>\n<li>選ばれた人は、目の前のマスが白で塗られている間、自分の向いている向きに <var>1</var> マス分進み、進んだ先のマスを自分の持っているペンキで塗る。目の前のマスが白で塗られていない場合、動作を終了する。</li>\n<li>動作を終了した人を会場から追い出す。</li>\n</ul>\n<div style=\"text-align: center;\">\n<img src=\"https://atcoder.jp/img/code-festival-2017-quala/406bcaf4d52da2ae3b09eedf63ff302e.png\">\n<p>塗られ方の例</p>\n</div>\n\n<p>りんごさんが作ることのできる、最終的な盤面の塗られ方は何通りあるでしょうか。<var>998244353</var> で割ったあまりを求めてください。</p>\n<p>なお、 <var>2</var> つの盤面の塗られ方が異なるとは、あるマスが存在し、そのマスの色が異なることを指します。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N,M \\leq 10^5</var></li>\n<li><var>|A|=|B|=N</var></li>\n<li><var>|C|=|D|=M</var></li>\n<li><var>A,B,C,D</var> は <code>0</code> と <code>1</code> からなる</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>A</var>\n<var>B</var>\n<var>C</var>\n<var>D</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>最終的な盤面の塗られ方の総数を <var>998244353</var> で割ったあまりを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2 2\n10\n01\n10\n01\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>6\n</pre>\n\n<p>以下の <var>6</var> 通りの塗られ方があります。</p>\n<p><img alt=\"\" src=\"https://atcoder.jp/img/code-festival-2017-quala/1dd467cdff8a517c9555abfca0915e2e.png\"></p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>2 2\n11\n11\n11\n11\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>32\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>3 4\n111\n111\n1111\n1111\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1276\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>17 21\n11001010101011101\n11001010011010111\n111010101110101111100\n011010110110101000111\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>548356548\n</pre>\n\n<p><var>998244353</var> で割ったあまりを求めるのを忘れないようにしてください。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 5</h3><pre>3 4\n000\n101\n1111\n0010\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 5</h3><pre>21\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 6</h3><pre>9 13\n111100001\n010101011\n0000000000000\n1010111111101\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 6</h3><pre>177856\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 7</h3><pre>23 30\n01010010101010010001110\n11010100100100101010101\n000101001001010010101010101101\n101001000100101001010010101000\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 7</h3><pre>734524988\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Ringo got interested in modern art. He decided to draw a big picture on the board with <var>N+2</var> rows and <var>M+2</var> columns of squares constructed in the venue of CODE FESTIVAL 2017, using some people.</p>\n<p>The square at the <var>(i+1)</var>-th row and <var>(j+1)</var>-th column in the board is represented by the pair of integers <var>(i,j)</var>. That is, the top-left square is <var>(0,0)</var>, and the bottom-right square is <var>(N+1,M+1)</var>.\nInitially, the squares <var>(x,y)</var> satisfying <var>1 \\leq x \\leq N</var> and <var>1 \\leq y \\leq M</var> are painted white, and the other (outermost) squares are painted black.</p>\n<p>Ringo arranged people at some of the outermost squares, facing inward.\nMore specifically, the arrangement of people is represented by four strings <var>A</var>, <var>B</var>, <var>C</var> and <var>D</var>, as follows:</p>\n<ul>\n<li>For each row except the top and bottom, if the <var>i</var>-th character <var>(1 \\leq i \\leq N)</var> in <var>A</var> is <code>1</code>, place a person facing right at the square <var>(i,0)</var>; otherwise, do nothing.</li>\n<li>For each row except the top and bottom, if the <var>i</var>-th character <var>(1 \\leq i \\leq N)</var> in <var>B</var> is <code>1</code>, place a person facing left at the square <var>(i,M+1)</var>; otherwise, do nothing.</li>\n<li>For each column except the leftmost and rightmost, if the <var>i</var>-th character <var>(1 \\leq i \\leq M)</var> in <var>C</var> is <code>1</code>, place a person facing down at the square <var>(0,i)</var>; otherwise, do nothing.</li>\n<li>For each column except the leftmost and rightmost, if the <var>i</var>-th character <var>(1 \\leq i \\leq M)</var> in <var>D</var> is <code>1</code>, place a person facing up at the square <var>(N+1,i)</var>; otherwise, do nothing.</li>\n</ul>\n<p>Each person has a sufficient amount of non-white paint. No two people have paint of the same color.</p>\n<div style=\"text-align: center;\">\n<img src=\"https://atcoder.jp/img/code-festival-2017-quala/46a627606452b904221672922d269290.png\">\n<p>An example of an arrangement of people (For convenience, black squares are displayed in gray)</p>\n</div>\n\n<p>Ringo repeats the following sequence of operations until all people are dismissed from the venue.</p>\n<ul>\n<li>Select a person who is still in the venue.</li>\n<li>The selected person repeats the following action while the square in front of him/her is white: move one square forward, and paint the square he/she enters with his/her paint. When the square in front of him/her is not white, he/she stops doing the action.</li>\n<li>The person is now dismissed from the venue.</li>\n</ul>\n<div style=\"text-align: center;\">\n<img src=\"https://atcoder.jp/img/code-festival-2017-quala/406bcaf4d52da2ae3b09eedf63ff302e.png\">\n<p>An example of a way the board is painted</p>\n</div>\n\n<p>How many different states of the board can Ringo obtain at the end of the process? Find the count modulo <var>998244353</var>.</p>\n<p>Two states of the board are considered different when there is a square painted in different colors.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N,M \\leq 10^5</var></li>\n<li><var>|A|=|B|=N</var></li>\n<li><var>|C|=|D|=M</var></li>\n<li><var>A</var>, <var>B</var>, <var>C</var> and <var>D</var> consist of <code>0</code> and <code>1</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>A</var>\n<var>B</var>\n<var>C</var>\n<var>D</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the number of the different states of the board Ringo can obtain at the end of the process, modulo <var>998244353</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2 2\n10\n01\n10\n01\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>6\n</pre>\n\n<p>There are six possible states as shown below.</p>\n<p><img alt=\"\" src=\"https://atcoder.jp/img/code-festival-2017-quala/1dd467cdff8a517c9555abfca0915e2e.png\"></p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>2 2\n11\n11\n11\n11\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>32\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>3 4\n111\n111\n1111\n1111\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1276\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>17 21\n11001010101011101\n11001010011010111\n111010101110101111100\n011010110110101000111\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>548356548\n</pre>\n\n<p>Be sure to find the count modulo <var>998244353</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 5</h3><pre>3 4\n000\n101\n1111\n0010\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 5</h3><pre>21\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 6</h3><pre>9 13\n111100001\n010101011\n0000000000000\n1010111111101\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 6</h3><pre>177856\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 7</h3><pre>23 30\n01010010101010010001110\n11010100100100101010101\n000101001001010010101010101101\n101001000100101001010010101000\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 7</h3><pre>734524988\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/code-festival-2017-quala/tasks/code_festival_2017_quala_e"}