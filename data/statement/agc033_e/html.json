{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1500</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>円周が <var>N</var> 個の点によって <var>N</var> 等分され、それぞれが赤か青のいずれかで塗られているような円が、\n<code>R</code> と <code>B</code> からなる長さ <var>M</var> の文字列 <var>S</var> をすべての点から生成するとは、以下の条件を満たすことを指します。</p>\n<ul>\n<li>円周上の <var>N</var> 個の点のうち <var>1</var> つを任意に選び、その点上に駒を置く。</li>\n<li>駒を時計回り、または反時計回りに隣合う点まで動かすことを <var>M</var> 回繰り返す。</li>\n<li>このとき最初にどの点を選んだとしても、うまく動かす向きを定めることで、<var>i</var> 回目に駒が通る円弧の色が <var>S_i</var> であるようにできる。</li>\n</ul>\n<p>ただし、<var>S_i</var> は <code>R</code> のとき赤を、<code>B</code> のとき青を指すものとします。\nまた駒を動かす向きは、最初に選ぶ点ごとに変えられることに注意してください。</p>\n<p>実際に <code>R</code> と <code>B</code> からなる長さ <var>M</var> の文字列 <var>S</var> が与えられます。\n円周が <var>N</var> 等分されている円の各円弧を赤または青のいずれかで塗る <var>2^N</var> 通りの方法のうち、\n<var>S</var> をすべての点から生成するような塗り方の個数を <var>10^9+7</var> で割ったあまりを求めてください。</p>\n<p>ただし、回転して一致するような塗り方も区別して数えます。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 ≦ N ≦ 2 \\times 10^5</var></li>\n<li><var>1 ≦ M ≦ 2 \\times 10^5</var></li>\n<li><var>|S|=M</var></li>\n<li><var>S_i</var> は <code>R</code> または <code>B</code></li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>S</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>条件を満たすような各円弧の塗り方の個数を <var>10^9+7</var> で割ったあまりを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 7\nRBRRBRR\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2\n</pre>\n\n<p>赤と青が交互に塗られているときのみ条件を満たします。\nなので、このケースの答えは <var>2</var> となります。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 3\nBBB\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>4\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>12 10\nRRRRBRRRRB\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>78\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1500</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Consider a circle whose perimeter is divided by <var>N</var> points into <var>N</var> arcs of equal length, and each of the arcs is painted red or blue. Such a circle is said to <em>generate a string <var>S</var> from every point</em> when the following condition is satisfied:</p>\n<ul>\n<li>We will arbitrarily choose one of the <var>N</var> points on the perimeter and place a piece on it.</li>\n<li>Then, we will perform the following move <var>M</var> times: move the piece clockwise or counter-clockwise to an adjacent point.</li>\n<li>Here, whatever point we choose initially, it is always possible to move the piece so that the color of the <var>i</var>-th arc the piece goes along is <var>S_i</var>, by properly deciding the directions of the moves.</li>\n</ul>\n<p>Assume that, if <var>S_i</var> is <code>R</code>, it represents red; if <var>S_i</var> is <code>B</code>, it represents blue.\nNote that the directions of the moves can be decided separately for each choice of the initial point.</p>\n<p>You are given a string <var>S</var> of length <var>M</var> consisting of <code>R</code> and <code>B</code>.\nOut of the <var>2^N</var> ways to paint each of the arcs red or blue in a circle whose perimeter is divided into <var>N</var> arcs of equal length, find the number of ways resulting in a circle that generates <var>S</var> from every point, modulo <var>10^9+7</var>.</p>\n<p>Note that the rotations of the same coloring are also distinguished.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq M \\leq 2 \\times 10^5</var></li>\n<li><var>|S|=M</var></li>\n<li><var>S_i</var> is <code>R</code> or <code>B</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>S</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the number of ways to paint each of the arcs that satisfy the condition, modulo <var>10^9+7</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 7\nRBRRBRR\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2\n</pre>\n\n<p>The condition is satisfied only if the arcs are alternately painted red and blue, so the answer here is <var>2</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 3\nBBB\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>4\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>12 10\nRRRRBRRRRB\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>78\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc033/tasks/agc033_e"}