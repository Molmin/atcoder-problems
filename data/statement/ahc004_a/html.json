{"html":{"ja":"<span class=\"lang-ja\">\n\n<div class=\"part\">\n<section>\n<h3>ストーリー</h3><p>人間の遺伝情報は二重らせん構造のDNAに記録されており、<code>A</code>, <code>G</code>, <code>C</code>, <code>T</code> の4種類の文字からなる非常に長い文字列で表現される。\n最近、隕石の中から宇宙人の細胞が見つかった。\n調査の結果、この宇宙人の遺伝情報は<a href=\"https://ja.wikipedia.org/wiki/%E3%83%88%E3%83%BC%E3%83%A9%E3%82%B9\">トーラス</a>状の物質に記録されており、<code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>, <code>E</code>, <code>F</code>, <code>G</code>, <code>H</code> の8種類の文字からなる<var>N\\times N</var>の行列として表現されることが分かった。\n既存の装置では、この行列を直接読み取ることは出来なかったが、縦方向、もしくは横方向に連続する一次元の部分列を沢山読み取ることに成功した。\nこの部分列の情報を元に行列を推定してほしい。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>一次元の列 <var>b=(b_0, \\ldots, b_{k-1})</var> が行列 <var>a=(a_{i,j})_{0\\leq i,j\\leq N-1}</var> の<strong>部分列</strong>であるとは、ある <var>(i,j)</var>が存在し、以下のどちらか一つ以上を満たすことと定義する。</p>\n<ul>\n<li>全ての <var>p=0,\\ldots,k-1</var> で <var>b_p=a_{i,(j+p)\\bmod N}</var> (横方向に一致)</li>\n<li>全ての <var>p=0,\\ldots,k-1</var> で <var>b_p=a_{(i+p)\\bmod N,j}</var> (縦方向に一致)</li>\n</ul>\n<p>インデックスが <var>N</var> 以上となった場合に<var>N</var>で割った余りを取っていることに注意(つまり、<var>a</var> は左端と右端、上端と下端がつながっている)。</p>\n<p><code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code> からなる <var>M</var> 個の文字列 <var>s_1, \\ldots, s_M</var> が与えられるので、これらのうち出来るだけ多くを部分列として含むような\n<code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code> もしくは <code>.</code> からなる <var>N\\times N</var> の行列を求めよ。\n<code>.</code> は空白を意味する。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>得点</h3><p><var>s_i</var> が出力の部分列であるような <var>i</var> の個数を <var>c</var> (<var>\\leq M</var>)、出力に含まれる <code>.</code> の個数を <var>d</var> (<var>\\leq N^2</var>) としたとき、以下の得点が得られる。</p>\n<ul>\n<li><var>c&lt;M</var> の場合、<var>\\mathrm{round}(10^8\\times \\frac{c}{M})</var></li>\n<li><var>c=M</var> の場合、<var>\\mathrm{round}(10^8\\times \\frac{2 N^2}{2 N^2-d})</var></li>\n</ul>\n<p>不正な出力(<var>N\\times N</var> 行列でない、<code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code>, <code>.</code> 以外の文字を含む)がされた場合、<code>WA</code>と判定される。\nテストケースは全部で100個あり、各テストケースの得点の合計が提出の得点となる。\n1つ以上のテストケースで<code>AC</code>以外の判定がされた場合、提出の得点は0点となる。\nコンテスト時間中に得た最高得点で最終順位が決定され、コンテスト終了後のシステムテストは行われない。 \n同じ得点を複数の参加者が得た場合、その得点を獲得した提出の早い方が上位となる。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>s_1</var>\n<var>\\vdots</var>\n<var>s_M</var>\n</pre>\n\n<ul>\n<li><var>N</var> は全テストケースを通して20で固定</li>\n<li><var>M</var> は400以上800以下の整数値</li>\n<li>各 <var>s_i</var> は <code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code> の8種類の文字からなる長さ2以上12以下の文字列</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code>, <code>.</code> からなる長さ <var>N</var> の文字列を <var>N</var> 行出力せよ。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>入力生成方法</h3><p><var>L</var> 以上 <var>U</var> 以下の整数値を一様ランダムに生成する関数を <var>\\mathrm{rand}(L,U)</var> で表す。</p>\n<p>まずはじめに、<var>N\\times N</var>の行列 <var>a=(a_{i,j})_{0\\leq i,j\\leq N-1}</var> を、各要素毎に独立に一様ランダムに <code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code> から選択することで生成する。\n次に、平均長を決めるパラメータ <var>L=\\mathrm{rand}(4, 10)</var> と文字列の個数 <var>M=\\mathrm{rand}(400, 800)</var> を生成し、以下の処理を独立に <var>M</var> 回繰り返すことで <var>M</var> 個の文字列 <var>s_1,\\ldots,s_M</var> を生成する。</p>\n<p>文字列の始点を表す2つの整数 <var>i=\\mathrm{rand}(0, N-1)</var> と <var>j=\\mathrm{rand}(0, N-1)</var>、向きを表す整数 <var>d=\\mathrm{rand}(0,1)</var>、長さを表す整数 <var>k=\\mathrm{rand}(L-2, L+2)</var> を生成する。</p>\n<ul>\n<li><var>d=0</var> の場合、横方向の部分列 <var>(a_{i,j},a_{i,(j+1)\\bmod N},\\ldots,a_{i,(j+k-1)\\bmod N})</var> を採用する。</li>\n<li><var>d=1</var> の場合、縦方向の部分列 <var>(a_{i,j},a_{(i+1)\\bmod N,j},\\ldots,a_{(i+k-1)\\bmod N,j})</var> を採用する。</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>ツール</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc004/a45fa3f18ab177158bf5961b12872f93.zip\">入力データ</a>: サンプル入力(seed 0)を含む、ローカルテスト用の100個の入力データ(seed 0-99)です。これらの入力は実際のテストケースとは異なります。</li>\n<li><a href=\"https://img.atcoder.jp/ahc004/a42b6f0655821d8b384b31377108e5512.html\">Web版ビジュアライザ</a></li>\n<li><a href=\"https://img.atcoder.jp/ahc004/222362f13a30b1342bf79d0041bd4d39.zip\">入力ジェネレータ・ビジュアライザ</a>: より多くの入力を生成するための入力ジェネレータとローカル実行用のビジュアライザです。使用するには、<a href=\"https://www.rust-lang.org/ja\">Rust言語</a>のコンパイル環境をご用意下さい。</li>\n</ul>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>20 742\nAFHCGEH\nHDBCHG\nEAHC\nABHDG\nDGAHHG\nGAHHGB\nDHBBEB\nGEAD\nGCEBD\nGHGFGA\nBHC\nBAGCCB\nCAF\nHBGGC\nAHEBA\nFBGEB\nGHGFGA\nCFA\nFEHB\nGDCEFBE\nBACEGGG\nCBA\nGEHDC\nCFACHAF\nACGBA\nCEE\nAADDCCH\nGGDHHHC\nEDAEE\nECA\nEBEED\nBGCAH\nAEAH\nGFCGEH\nCGAGHE\nHAGEA\nFEA\nCEDHAG\nEEH\nAGHECFC\nEFGDDA\nDCCHGD\nADDHB\nFCGF\nBAGE\nCFA\nHBCE\nCGFG\nCEFECCB\nBADEBDD\nAGACG\nDCAGGCE\nHEHHDB\nDDHDB\nHCFFAB\nHEBDADD\nDGFCGFG\nAFFFBCG\nFCEAC\nEGGG\nDADDC\nEDH\nBHCAACH\nGCE\nHAHGB\nBFFDAHE\nCFAEAHC\nACCHE\nBFH\nCHDC\nCFHDCB\nDED\nGACG\nHECFCFE\nFEAFEH\nCADFGE\nGCHD\nBEEHEG\nGDH\nFBEHHB\nFHAG\nBGCAHDC\nDCCCE\nGDH\nCCBA\nGEH\nEDEHH\nHHDBCH\nHGB\nEHD\nCFFABFC\nDGG\nDBHEC\nGEAGCFE\nCCGAGHE\nDHAGAC\nCCCGHH\nCBBFFDA\nEFA\nDFGD\nHDCAADD\nHDCFC\nGHECFCF\nCCDDE\nAFC\nCCE\nDAHD\nFAGFCB\nFEC\nDHAGG\nEGEFAG\nCGDD\nAACCHE\nFFC\nHED\nFBCFFHD\nBAGE\nHEBD\nGBBE\nDHBCEFG\nCAAAEAA\nDBFG\nGHCC\nDEGGE\nBCGCHD\nEEA\nBEE\nECG\nDHHHCCA\nCHD\nGCDECG\nFFCCFAE\nHGH\nEGFB\nCFFEGE\nGEADHAG\nGBGDCHD\nEFGC\nBEHHB\nDBECC\nDCFF\nCFE\nDCADDHG\nADHAGGB\nABD\nDAEEGF\nDEG\nCHFFHGH\nCGAGH\nFCCB\nFHGHD\nEBGCAHD\nCFHDC\nFEHB\nFHC\nCHGDHBB\nEDBECCD\nDCF\nGBADEB\nAAHF\nCEFECC\nDCGA\nHAFHFE\nHDCAAD\nGDH\nCEF\nDCBDFDE\nGDHHHCC\nFCCC\nGAGHE\nCHFEE\nGDD\nHEDEHHD\nBDD\nHCAHC\nEEH\nGBG\nHEDEG\nGAFAHB\nBBFHB\nDGF\nBCHGFCC\nGCCFACH\nFAGAE\nDBFGDC\nGHDD\nGGE\nFFFBCG\nEGGGE\nCCCEE\nGABCHED\nEDHA\nEFAGA\nFHDCAD\nGGGD\nDHBGGCC\nDHAGACG\nGECCH\nFABFCD\nGCC\nCCE\nEADHAG\nEEHEG\nFDAD\nDFH\nAFC\nDCCCE\nCGE\nEBDCCC\nGBDGEAB\nCAHCBH\nCGCHD\nFGAEDDB\nFAGAFAH\nHEEFBDC\nHAGGBAH\nDCCEFEC\nADH\nCHEDE\nDAFHCG\nBCFA\nGDCBDF\nHDC\nFFGEH\nEAEFHC\nDDCHCA\nGHGD\nHGGGD\nEGFCF\nCADF\nGGCCGA\nCGDDAA\nDDAACC\nDDHDGG\nGDHEDA\nHEBDAD\nDCGHG\nEFHG\nBHDGAA\nADDCCHG\nFBGEBG\nGFEGHE\nCFAA\nCFDE\nFCBBG\nBDCC\nGBBEAFD\nGDFCA\nGHEDG\nBDGEABH\nADCFGAE\nHHGBCF\nAAHAFHF\nEDA\nCHGDH\nDDDFHEH\nHDCA\nCDCF\nFCFH\nCDGAH\nCHEDEHH\nCCBHEBD\nFBC\nHHDBC\nCEE\nFGCFA\nCEBDCCC\nBEAFDEF\nHHDB\nAEGECE\nHHCCA\nHDDHBCE\nGEH\nHBADFFB\nBECC\nGCAHDCA\nDBAEEHD\nDGAACA\nEEH\nEAFEHDC\nFFHGHDD\nBFEHB\nAHDCAA\nBADFF\nCHCEDH\nCGHAHG\nCCCGHH\nAEEGFED\nDFGDDEF\nGDDAAC\nGEC\nCDAC\nGBDGEAB\nHGCBFEH\nCFA\nCEBE\nBHDGA\nFHEHHD\nBFHB\nAGCDE\nAFCDEDD\nGGAA\nFACAA\nEDA\nCCG\nEHFBCF\nHGBBEA\nAGFCB\nEAADBA\nCFAEAH\nAAHFCEA\nEEG\nDGBGD\nGDHHH\nHHCCAC\nEAGDDHD\nECCHFE\nGDBC\nDCC\nEFHDFEA\nBBFF\nFGBGF\nHDBBEFD\nFCC\nEBGBG\nADDH\nEBDCCCE\nEGG\nEDH\nDEFHGB\nDHCDE\nDCH\nHGBGE\nBAAHFC\nDGGAAF\nDGFC\nAEFHCCF\nEAFDE\nHFBCF\nDEEBEAD\nFDE\nCCD\nFCGFGB\nEGGE\nEDE\nGCDECGD\nEBF\nEGGGEB\nHEDAE\nCEBE\nGDHBB\nDABDEA\nHGCBFE\nHDCADD\nDEGFBAG\nDFBEEH\nGBDGEA\nGCEGGGE\nADHAGG\nGDDADA\nFGBG\nHBCE\nAGFCEEA\nDCF\nBEHHBG\nDFGEA\nDCHDABD\nADCFG\nBEHHB\nDHBGGC\nADFGEAD\nDDH\nBEBGC\nBFEH\nGHH\nFFBCG\nBDDB\nHDCADD\nAHF\nGGD\nFFDAHE\nEGBEEHE\nBBGDEE\nEFCF\nCGFGB\nGCFE\nCEEF\nHFBG\nCCGA\nFFDAHEE\nGBGE\nGBGDCHD\nFGDC\nGCEBDC\nFGBGFCE\nEFBDCG\nAACC\nCBHCAAC\nGDDAD\nAAHA\nGAFF\nCBAAHFC\nGAF\nGAFAHBE\nCCGAG\nDHA\nCEA\nBCEFGCF\nCEDCAGG\nHFB\nAGHGCB\nAADD\nBCGC\nEDCA\nGCF\nBEADECD\nAHDBEA\nFBCG\nGHCCE\nEBDC\nDCAD\nAGCD\nFHFEDB\nFCE\nFEAADDH\nBGC\nGGEBD\nEABGF\nAGE\nCGDBC\nFEAFEHD\nCGH\nDABDEA\nCAHCB\nEDFGDDE\nDAA\nEAGAFF\nDAH\nAFAHBE\nDCBA\nDCB\nBGC\nFFHDC\nFAGFCB\nECFCF\nCFAAFFF\nHGHDDCH\nBGCB\nAHDB\nBACE\nFCCD\nACEDDHD\nCEF\nBFEH\nEGBFEA\nGEHFBC\nGBDGA\nHGCEG\nDBCFHA\nADE\nCGHG\nGDHHHCC\nGFG\nDHEDAE\nECEEA\nBHCHCE\nHAF\nFCEE\nCCBAG\nCEGGGE\nDDCHCAH\nEFHC\nAED\nFGBGFCE\nHEG\nAEE\nBGEBGBG\nADDHBG\nGFGABC\nGDEC\nBGEBGB\nEAEF\nBBG\nGBGDH\nFCGEH\nBEEHEG\nEACBCEG\nGEAB\nGBFE\nHDAB\nEEDAF\nACBCEG\nFEGHEDG\nHCAAC\nHFBGEBG\nHGCBF\nGEBGBG\nBAAHA\nEBEED\nCCEFAGA\nBAD\nFHBGDEG\nAACAAA\nEGF\nAEF\nECEG\nAGGCEBD\nCEBDCCC\nDCCEF\nFGAB\nHGDFCAA\nAACGBD\nAAGFC\nAHC\nFEBCC\nEDE\nBBGDEED\nAACC\nCAAC\nEGDCE\nDCFFGEH\nBCEG\nCEDHAG\nGHE\nAFCD\nBGCBBFH\nDHBCEF\nBGBGD\nDECGDDA\nHDBAGEC\nHGCBFEH\nHHDBCHG\nAGDDHD\nEECGHA\nDDF\nDHB\nEEB\nHEBDA\nDEDDH\nEEFFAG\nHCHCED\nDDAAC\nEEHAGEA\nEFA\nHCC\nCCFDEE\nFCFHDC\nGHED\nDFBE\nEADHAGG\nGGEB\nAGHGC\nHBBEBG\nAHDCAA\nCCGAG\nHGBGEE\nFEEF\nEECGHA\nCCHED\nECGHAHG\nEEDAFH\nFBAGCDE\nHAGACG\nFAGA\nDBH\nHEBDA\nHHCCACE\nBEBGCAH\nHDDH\nFFECHD\nHDAB\nDACAF\nAEEHAGE\nGFCG\nHDDDF\nHHDBA\nHGFGA\nHDF\nCCHGD\nAGGBA\nDBAGE\nGGAAFF\nGDBC\nCHDABD\nFFB\nDHBB\nBDAH\nDDH\nHDF\nGAED\nEADECDC\nDDBA\nAAGFCEE\nEGFBAGC\nDDCCEF\nGFC\nCGF\nHDFE\nBDCCCE\nHGD\nEEFB\nCCACED\nEAFDEF\nHDCFCE\nBBEF\nFAG\nHBEGBE\nEDAEE\nFHE\nCGH\nFGDEC\nAEA\nCAAD\nDCF\nDDBH\nGBGDCH\nAAGFC\nDCB\nDEBAA\nBEFDADC\nECEBE\nGHGD\nEDEGFBA\nDBCFH\nAFA\nFGC\nDABD\nDDCC\nAAHAFH\nFCFEA\nDBHCH\nBBEB\nAGDD\nCCGA\nDGACG\nEBCCED\nFEGHE\nDBA\nGFCEEAG\nFFHDCA\nHDCG\nFBCGC\nFFGEHDC\nCFEA\nFDEBA\nEADCBA\nCCBAGC\nFHCGEH\nADEBFCB\nDCFFGEH\nCEDD\nHECFC\nGGCEBD\nGGG\nEBGCA\nFGEHD\nDDCH\nEGECEDC\nCHD\nFACH\nEGEFA\nGFEDHFB\nFFEG\nECCB\nDBAGEC\nEEFG\nAGE\nCHCAH\nAHEB\nGBD\nAHE\nGAGHEC\nCEACBCE\nDBCFHAG\nFCEA\nDAH\nCACED\nCCHFEE\nACEDD\nCBFEHBA\nCBC\nBFCDG\nEGHCCE\nDDFBE\nEAGCF\nFFE\nAFFECHD\nAHH\nHAF\nHHB\nHFBGEBG\nCDDEG\nCCCEEA\nCCFFE\nABFCDGA\nCGCHDD\nEEAADBA\nACEDDHD\nBACEG\nFEB\nFECHDC\nFCEEF\nFHG\nAEFH\nHFEDB\nAFFE\nGFG\nEGFBA\nBEEHEG\nAACCH\nAEDDB\nEAFD\nDBAC\nGBGDHED\nFHB\nBHDG\nHDCG\nEDGB\nEDDHDBA\nFCB\nCFHAGH\nGFED\nFCCDBF\nABG\nCHFEE\nDBBEFD\nFAEEHAG\nEBFC\nFGDECE\nCDGAH\nDAC\nGEHDC\nBEFDADC\nGBGF\nEECG\nCEEAAD\nEHHBGC\nGAEDFCC\nHAFH\nEAAGF\nCAFC\nEHH\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>FFGAEEABCE.CBAEBH.C.\nEHBFHCGHFGA.G.AE.AAC\n.GBAED.ACHBDG.GDGG.C\nDDFADEGGBDEFFACBB.FA\n.EFBFGEEDGHBCGCEDEEB\nHAAHBDAGBCCE.CCADAFH\nGAFFE.G.CBEG.F.DDCEE\nACE.F.GDAAGH.DHECDBA\nDAFB.HHFBABHEBBBD.CE\nEGFFHDGEHFBAB.DECADA\nDEAHCFGG..CG.BGDBBEC\n.CBAGCAFCDEBGACEHF.D\nGG.CGFA.GHGHG.GG.EHH\nCECG.G.DGBCCAACFCDH.\nFB.DH.F.CEHEH.CGGHFB\nADHCH.HCCBFGBADFBACE\nCE.EHC.AAGADC.FAAEFB\nED.F..HGEACAHACFGAGG\nAADAABC.CA.GF.CADCAF\nCFAHEFGCA.CFGFGECBCH\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n\n<div class=\"part\">\n<section>\n<h3>Story</h3><p>Human genetic information is recorded in DNA with a double helix structure and is represented by a very long string consisting of four characters, <code>A</code>, <code>G</code>, <code>C</code>, and <code>T</code>.\nRecently, alien cells were found in a meteorite.\nAs a result of research, it was found that the genetic information of this alien is recorded in a <a href=\"https://en.wikipedia.org/wiki/Torus\">torus</a>-shaped material and is represented as an <var>N\\times N</var> matrix consisting of eight characters, <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>, <code>E</code>, <code>F</code>, <code>G</code>, and <code>H</code>.\nExisting devices have failed to read this matrix directly, but they have succeeded in reading many one-dimensional subsequences that are contiguous vertically or horizontally.\nPlease estimate the matrix based on this information.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We define that a one-dimensional sequence <var>b=(b_0, \\ldots, b_{k-1})</var> is a <strong>subsequence</strong> of a matrix <var>a=(a_{i,j})_{0\\leq i,j\\leq N-1}</var> if and only if there exists <var>(i, j)</var> satisfying at least one of the following two conditions:</p>\n<ul>\n<li>For all <var>p=0,\\ldots,k-1</var>, <var>b_p=a_{i,(j+p)\\bmod N}</var> holds. (horizontal match)</li>\n<li>For all <var>p=0,\\ldots,k-1</var>, <var>b_p=a_{(i+p)\\bmod N,j}</var> holds. (vertical match)</li>\n</ul>\n<p>Note that if the index is greater than or equal to <var>N</var>, we take the remainder divided by <var>N</var> (in other words, <var>a</var> is connected at the left and right ends, and the top and bottom ends).</p>\n<p>Given <var>M</var> strings <var>s_1, \\ldots, s_M</var> consisting of eight characters, <code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code>, your goal is to find an <var>N\\times N</var> matrix consisting of characters <code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code>, or <code>.</code> which contains as many of the given strings as possible as subsequences.\nHere, <code>.</code> indicates an empty.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Scoring</h3><p>Let <var>c</var> (<var>\\leq M</var>) be the number of <var>i</var>'s such that <var>s_i</var> is a subsequence of the output matrix, and let <var>d</var> (<var>\\leq N^2</var>) be the number of <code>.</code> contained in the output.\nThen, you will obtain the following score.</p>\n<ul>\n<li>If <var>c&lt;M</var>, <var>\\mathrm{round}(10^8\\times \\frac{c}{M})</var>.</li>\n<li>If <var>c=M</var>, <var>\\mathrm{round}(10^8\\times \\frac{2 N^2}{2 N^2-d})</var>.</li>\n</ul>\n<p>If the output is illegal (not an <var>N\\times N</var> matrix, or containing a character other than <code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code>, <code>.</code>), it is judged as <code>WA</code>.\nThere are 100 test cases, and the score of a submission is the total score for each test case.\nIf you get a result other than <code>AC</code> for one or more test cases, the score of the submission will be zero. The highest score obtained during the contest time will determine the final ranking, and there will be no system test after the contest.\nIf more than one participant gets the same score, the ranking will be determined by the submission time of the submission that received that score.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>s_1</var>\n<var>\\vdots</var>\n<var>s_M</var>\n</pre>\n\n<ul>\n<li><var>N</var> is fixed to 20 throughout all the test cases.</li>\n<li><var>M</var> is an integer satisfying <var>400\\leq M\\leq 800</var>.</li>\n<li>Each <var>s_i</var> is a string consisting of characters <code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code>, and its length is at least 2 and at most 12.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Output <var>N</var> lines, each containing a string of length exactly <var>N</var> consisting of characters <code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code>, or <code>.</code>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Input Generation</h3><p>Let <var>\\mathrm{rand}(L,U)</var> be a function that generates a uniformly random integer between <var>L</var> and <var>U</var>, inclusive.</p>\n<p>We first generate an <var>N\\times N</var> matrix <var>a=(a_{i,j})_{0\\leq i,j\\leq N-1}</var> by generating each element uniformly randomly from <code>A</code>, <code>B</code>, <var>\\ldots</var>, <code>H</code>.\nWe then generate a parameter <var>L=\\mathrm{rand}(4, 10)</var>, which decides the average length of the strings, and the number of strings <var>M=\\mathrm{rand}(400, 800)</var>.\nWe generate <var>M</var> strings <var>s_1,\\ldots,s_M</var> by repeating the following process <var>M</var> times.</p>\n<p>We generate two integers <var>i=\\mathrm{rand}(0, N-1)</var> and <var>j=\\mathrm{rand}(0, N-1)</var> representing a starting point, an integer <var>d=\\mathrm{rand}(0,1)</var> representing a direction, and an integer <var>k=\\mathrm{rand}(L-2, L+2)</var> representing the length of the string.</p>\n<ul>\n<li>If <var>d=0</var>, we choose a horizontal subsequence <var>(a_{i,j},a_{i,(j+1)\\bmod N},\\ldots,a_{i,(j+k-1)\\bmod N})</var>.</li>\n<li>If <var>d=1</var>, we choose a vertical subsequence <var>(a_{i,j},a_{(i+1)\\bmod N,j},\\ldots,a_{(i+k-1)\\bmod N,j})</var>.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Tools</h3><ul>\n<li><a href=\"https://img.atcoder.jp/ahc004/a45fa3f18ab177158bf5961b12872f93.zip\">Inputs</a>: A set of 100 inputs (seed 0-99) for local testing, including the sample input (seed 0). These inputs are different from the actual test cases.</li>\n<li><a href=\"https://img.atcoder.jp/ahc004/a42b6f0655821d8b384b31377108e5512.html\">Visualizer on the web</a></li>\n<li><a href=\"https://img.atcoder.jp/ahc004/222362f13a30b1342bf79d0041bd4d39.zip\">Input generator and visualizer</a>: If you want to use more inputs, or if you want to visualize your output locally, you can use this program. You need a compilation environment of <a href=\"https://www.rust-lang.org/ja\">Rust language</a>.</li>\n</ul>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>20 742\nAFHCGEH\nHDBCHG\nEAHC\nABHDG\nDGAHHG\nGAHHGB\nDHBBEB\nGEAD\nGCEBD\nGHGFGA\nBHC\nBAGCCB\nCAF\nHBGGC\nAHEBA\nFBGEB\nGHGFGA\nCFA\nFEHB\nGDCEFBE\nBACEGGG\nCBA\nGEHDC\nCFACHAF\nACGBA\nCEE\nAADDCCH\nGGDHHHC\nEDAEE\nECA\nEBEED\nBGCAH\nAEAH\nGFCGEH\nCGAGHE\nHAGEA\nFEA\nCEDHAG\nEEH\nAGHECFC\nEFGDDA\nDCCHGD\nADDHB\nFCGF\nBAGE\nCFA\nHBCE\nCGFG\nCEFECCB\nBADEBDD\nAGACG\nDCAGGCE\nHEHHDB\nDDHDB\nHCFFAB\nHEBDADD\nDGFCGFG\nAFFFBCG\nFCEAC\nEGGG\nDADDC\nEDH\nBHCAACH\nGCE\nHAHGB\nBFFDAHE\nCFAEAHC\nACCHE\nBFH\nCHDC\nCFHDCB\nDED\nGACG\nHECFCFE\nFEAFEH\nCADFGE\nGCHD\nBEEHEG\nGDH\nFBEHHB\nFHAG\nBGCAHDC\nDCCCE\nGDH\nCCBA\nGEH\nEDEHH\nHHDBCH\nHGB\nEHD\nCFFABFC\nDGG\nDBHEC\nGEAGCFE\nCCGAGHE\nDHAGAC\nCCCGHH\nCBBFFDA\nEFA\nDFGD\nHDCAADD\nHDCFC\nGHECFCF\nCCDDE\nAFC\nCCE\nDAHD\nFAGFCB\nFEC\nDHAGG\nEGEFAG\nCGDD\nAACCHE\nFFC\nHED\nFBCFFHD\nBAGE\nHEBD\nGBBE\nDHBCEFG\nCAAAEAA\nDBFG\nGHCC\nDEGGE\nBCGCHD\nEEA\nBEE\nECG\nDHHHCCA\nCHD\nGCDECG\nFFCCFAE\nHGH\nEGFB\nCFFEGE\nGEADHAG\nGBGDCHD\nEFGC\nBEHHB\nDBECC\nDCFF\nCFE\nDCADDHG\nADHAGGB\nABD\nDAEEGF\nDEG\nCHFFHGH\nCGAGH\nFCCB\nFHGHD\nEBGCAHD\nCFHDC\nFEHB\nFHC\nCHGDHBB\nEDBECCD\nDCF\nGBADEB\nAAHF\nCEFECC\nDCGA\nHAFHFE\nHDCAAD\nGDH\nCEF\nDCBDFDE\nGDHHHCC\nFCCC\nGAGHE\nCHFEE\nGDD\nHEDEHHD\nBDD\nHCAHC\nEEH\nGBG\nHEDEG\nGAFAHB\nBBFHB\nDGF\nBCHGFCC\nGCCFACH\nFAGAE\nDBFGDC\nGHDD\nGGE\nFFFBCG\nEGGGE\nCCCEE\nGABCHED\nEDHA\nEFAGA\nFHDCAD\nGGGD\nDHBGGCC\nDHAGACG\nGECCH\nFABFCD\nGCC\nCCE\nEADHAG\nEEHEG\nFDAD\nDFH\nAFC\nDCCCE\nCGE\nEBDCCC\nGBDGEAB\nCAHCBH\nCGCHD\nFGAEDDB\nFAGAFAH\nHEEFBDC\nHAGGBAH\nDCCEFEC\nADH\nCHEDE\nDAFHCG\nBCFA\nGDCBDF\nHDC\nFFGEH\nEAEFHC\nDDCHCA\nGHGD\nHGGGD\nEGFCF\nCADF\nGGCCGA\nCGDDAA\nDDAACC\nDDHDGG\nGDHEDA\nHEBDAD\nDCGHG\nEFHG\nBHDGAA\nADDCCHG\nFBGEBG\nGFEGHE\nCFAA\nCFDE\nFCBBG\nBDCC\nGBBEAFD\nGDFCA\nGHEDG\nBDGEABH\nADCFGAE\nHHGBCF\nAAHAFHF\nEDA\nCHGDH\nDDDFHEH\nHDCA\nCDCF\nFCFH\nCDGAH\nCHEDEHH\nCCBHEBD\nFBC\nHHDBC\nCEE\nFGCFA\nCEBDCCC\nBEAFDEF\nHHDB\nAEGECE\nHHCCA\nHDDHBCE\nGEH\nHBADFFB\nBECC\nGCAHDCA\nDBAEEHD\nDGAACA\nEEH\nEAFEHDC\nFFHGHDD\nBFEHB\nAHDCAA\nBADFF\nCHCEDH\nCGHAHG\nCCCGHH\nAEEGFED\nDFGDDEF\nGDDAAC\nGEC\nCDAC\nGBDGEAB\nHGCBFEH\nCFA\nCEBE\nBHDGA\nFHEHHD\nBFHB\nAGCDE\nAFCDEDD\nGGAA\nFACAA\nEDA\nCCG\nEHFBCF\nHGBBEA\nAGFCB\nEAADBA\nCFAEAH\nAAHFCEA\nEEG\nDGBGD\nGDHHH\nHHCCAC\nEAGDDHD\nECCHFE\nGDBC\nDCC\nEFHDFEA\nBBFF\nFGBGF\nHDBBEFD\nFCC\nEBGBG\nADDH\nEBDCCCE\nEGG\nEDH\nDEFHGB\nDHCDE\nDCH\nHGBGE\nBAAHFC\nDGGAAF\nDGFC\nAEFHCCF\nEAFDE\nHFBCF\nDEEBEAD\nFDE\nCCD\nFCGFGB\nEGGE\nEDE\nGCDECGD\nEBF\nEGGGEB\nHEDAE\nCEBE\nGDHBB\nDABDEA\nHGCBFE\nHDCADD\nDEGFBAG\nDFBEEH\nGBDGEA\nGCEGGGE\nADHAGG\nGDDADA\nFGBG\nHBCE\nAGFCEEA\nDCF\nBEHHBG\nDFGEA\nDCHDABD\nADCFG\nBEHHB\nDHBGGC\nADFGEAD\nDDH\nBEBGC\nBFEH\nGHH\nFFBCG\nBDDB\nHDCADD\nAHF\nGGD\nFFDAHE\nEGBEEHE\nBBGDEE\nEFCF\nCGFGB\nGCFE\nCEEF\nHFBG\nCCGA\nFFDAHEE\nGBGE\nGBGDCHD\nFGDC\nGCEBDC\nFGBGFCE\nEFBDCG\nAACC\nCBHCAAC\nGDDAD\nAAHA\nGAFF\nCBAAHFC\nGAF\nGAFAHBE\nCCGAG\nDHA\nCEA\nBCEFGCF\nCEDCAGG\nHFB\nAGHGCB\nAADD\nBCGC\nEDCA\nGCF\nBEADECD\nAHDBEA\nFBCG\nGHCCE\nEBDC\nDCAD\nAGCD\nFHFEDB\nFCE\nFEAADDH\nBGC\nGGEBD\nEABGF\nAGE\nCGDBC\nFEAFEHD\nCGH\nDABDEA\nCAHCB\nEDFGDDE\nDAA\nEAGAFF\nDAH\nAFAHBE\nDCBA\nDCB\nBGC\nFFHDC\nFAGFCB\nECFCF\nCFAAFFF\nHGHDDCH\nBGCB\nAHDB\nBACE\nFCCD\nACEDDHD\nCEF\nBFEH\nEGBFEA\nGEHFBC\nGBDGA\nHGCEG\nDBCFHA\nADE\nCGHG\nGDHHHCC\nGFG\nDHEDAE\nECEEA\nBHCHCE\nHAF\nFCEE\nCCBAG\nCEGGGE\nDDCHCAH\nEFHC\nAED\nFGBGFCE\nHEG\nAEE\nBGEBGBG\nADDHBG\nGFGABC\nGDEC\nBGEBGB\nEAEF\nBBG\nGBGDH\nFCGEH\nBEEHEG\nEACBCEG\nGEAB\nGBFE\nHDAB\nEEDAF\nACBCEG\nFEGHEDG\nHCAAC\nHFBGEBG\nHGCBF\nGEBGBG\nBAAHA\nEBEED\nCCEFAGA\nBAD\nFHBGDEG\nAACAAA\nEGF\nAEF\nECEG\nAGGCEBD\nCEBDCCC\nDCCEF\nFGAB\nHGDFCAA\nAACGBD\nAAGFC\nAHC\nFEBCC\nEDE\nBBGDEED\nAACC\nCAAC\nEGDCE\nDCFFGEH\nBCEG\nCEDHAG\nGHE\nAFCD\nBGCBBFH\nDHBCEF\nBGBGD\nDECGDDA\nHDBAGEC\nHGCBFEH\nHHDBCHG\nAGDDHD\nEECGHA\nDDF\nDHB\nEEB\nHEBDA\nDEDDH\nEEFFAG\nHCHCED\nDDAAC\nEEHAGEA\nEFA\nHCC\nCCFDEE\nFCFHDC\nGHED\nDFBE\nEADHAGG\nGGEB\nAGHGC\nHBBEBG\nAHDCAA\nCCGAG\nHGBGEE\nFEEF\nEECGHA\nCCHED\nECGHAHG\nEEDAFH\nFBAGCDE\nHAGACG\nFAGA\nDBH\nHEBDA\nHHCCACE\nBEBGCAH\nHDDH\nFFECHD\nHDAB\nDACAF\nAEEHAGE\nGFCG\nHDDDF\nHHDBA\nHGFGA\nHDF\nCCHGD\nAGGBA\nDBAGE\nGGAAFF\nGDBC\nCHDABD\nFFB\nDHBB\nBDAH\nDDH\nHDF\nGAED\nEADECDC\nDDBA\nAAGFCEE\nEGFBAGC\nDDCCEF\nGFC\nCGF\nHDFE\nBDCCCE\nHGD\nEEFB\nCCACED\nEAFDEF\nHDCFCE\nBBEF\nFAG\nHBEGBE\nEDAEE\nFHE\nCGH\nFGDEC\nAEA\nCAAD\nDCF\nDDBH\nGBGDCH\nAAGFC\nDCB\nDEBAA\nBEFDADC\nECEBE\nGHGD\nEDEGFBA\nDBCFH\nAFA\nFGC\nDABD\nDDCC\nAAHAFH\nFCFEA\nDBHCH\nBBEB\nAGDD\nCCGA\nDGACG\nEBCCED\nFEGHE\nDBA\nGFCEEAG\nFFHDCA\nHDCG\nFBCGC\nFFGEHDC\nCFEA\nFDEBA\nEADCBA\nCCBAGC\nFHCGEH\nADEBFCB\nDCFFGEH\nCEDD\nHECFC\nGGCEBD\nGGG\nEBGCA\nFGEHD\nDDCH\nEGECEDC\nCHD\nFACH\nEGEFA\nGFEDHFB\nFFEG\nECCB\nDBAGEC\nEEFG\nAGE\nCHCAH\nAHEB\nGBD\nAHE\nGAGHEC\nCEACBCE\nDBCFHAG\nFCEA\nDAH\nCACED\nCCHFEE\nACEDD\nCBFEHBA\nCBC\nBFCDG\nEGHCCE\nDDFBE\nEAGCF\nFFE\nAFFECHD\nAHH\nHAF\nHHB\nHFBGEBG\nCDDEG\nCCCEEA\nCCFFE\nABFCDGA\nCGCHDD\nEEAADBA\nACEDDHD\nBACEG\nFEB\nFECHDC\nFCEEF\nFHG\nAEFH\nHFEDB\nAFFE\nGFG\nEGFBA\nBEEHEG\nAACCH\nAEDDB\nEAFD\nDBAC\nGBGDHED\nFHB\nBHDG\nHDCG\nEDGB\nEDDHDBA\nFCB\nCFHAGH\nGFED\nFCCDBF\nABG\nCHFEE\nDBBEFD\nFAEEHAG\nEBFC\nFGDECE\nCDGAH\nDAC\nGEHDC\nBEFDADC\nGBGF\nEECG\nCEEAAD\nEHHBGC\nGAEDFCC\nHAFH\nEAAGF\nCAFC\nEHH\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>FFGAEEABCE.CBAEBH.C.\nEHBFHCGHFGA.G.AE.AAC\n.GBAED.ACHBDG.GDGG.C\nDDFADEGGBDEFFACBB.FA\n.EFBFGEEDGHBCGCEDEEB\nHAAHBDAGBCCE.CCADAFH\nGAFFE.G.CBEG.F.DDCEE\nACE.F.GDAAGH.DHECDBA\nDAFB.HHFBABHEBBBD.CE\nEGFFHDGEHFBAB.DECADA\nDEAHCFGG..CG.BGDBBEC\n.CBAGCAFCDEBGACEHF.D\nGG.CGFA.GHGHG.GG.EHH\nCECG.G.DGBCCAACFCDH.\nFB.DH.F.CEHEH.CGGHFB\nADHCH.HCCBFGBADFBACE\nCE.EHC.AAGADC.FAAEFB\nED.F..HGEACAHACFGAGG\nAADAABC.CA.GF.CADCAF\nCFAHEFGCA.CFGFGECBCH\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/ahc004/tasks/ahc004_a"}