{"html":{"ja":"<span class=\"lang-ja\">\n<script type=\"text/x-mathjax-config\">\nMathJax.Hub.Config({\n  tex2jax: {skipTags:[\"script\",\"noscript\",\"style\",\"textarea\",\"code\"],inlineMath: [['\\\\(','\\\\)']]}\n});\n</script>\n\n<script type=\"text/javascript\" async=\"\" src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML\">\n</script>\n\n<p>配点 : <var>1000</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3>\n<p>ニワンゴくんは \\(N\\) 羽のニワトリを飼っています。それぞれのニワトリは \\(1\\) から \\(N\\) の番号で識別され、\\(i\\) 番目のニワトリの大きさは正の整数 \\(a_i\\) です。</p>\n<p>\\(N\\) 羽のニワトリは手をつなぎ合っていくつかの輪を作ることにしました。\n輪の作り方は \\(1, \\ldots ,N\\) を並び替えた順列 \\(p\\) を用いて表され、ニワトリ \\(i\\) が右手 (ないし右翼) でニワトリ \\(p_i\\) の左手を取ることを表します。ニワトリは自分自身の手を取ることもあります。</p>\n<p>ニワトリ \\(i\\) を含む <strong>輪</strong> を、ニワトリ \\(p_i, p_{p_i}, \\ldots, p_{\\ddots_i} = i\\) からなる集合とします。\nこうして \\(N\\) 羽全てのニワトリが手を取ったとき、\\(N\\) 羽のニワトリたちは何個かの輪に分割できることが証明できます。</p>\n<p>輪の作り方の <strong>美しさ</strong> \\(f(p)\\) はそれぞれの輪に含まれる最も小さいニワトリの大きさの積で定義されます。</p>\n<p>\\(1 \\leq i \\leq N\\) を満たす \\(i\\) について、上の方法で輪が \\(i\\) 個できるような順列 \\(p\\) について \\(f(p)\\) を足し合わせたものを \\(b_i\\) とします。</p>\n<p>\\(b_1, \\ldots, b_N\\) の最大公約数を、modulo \\(998244353\\) で求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3>\n<ul>\n<li>\\(1 \\leq N \\leq 10^5\\)</li>\n<li>\\(1 \\leq a_i \\leq 10^9\\)</li>\n<li>入力で与えられる数値は全て整数である</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3>\n<p>入力は以下の形式で標準入力から与えられる。</p>\n<pre>\\(N\\)\n\\(a_1\\) \\(a_2\\) \\(\\ldots\\) \\(a_N\\)\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3>\n<p>答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例1</h3>\n<pre>2\n4 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例1</h3>\n<pre>3\n</pre>\n\n<p>\\(N = 2, a = [ 4, 3 ]\\) である。</p>\n<p>順列 \\(p = [ 1, 2 ]\\) について、ニワトリ \\(1\\) のみからなる輪とニワトリ \\(2\\) のみからなる輪ができるので、\\(f([1, 2]) = a_1 \\times a_2 = 12\\) である。</p>\n<p>順列 \\(p = [ 2, 1 ]\\) について、ニワトリ \\(1, 2\\) からなる輪ができ、その輪の最も小さいニワトリの大きさは \\(a_2 = 3\\) なので、\\(f([2, 1]) = a_2 = 3\\) である。</p>\n<p>以上から \\(b_1 = f([2, 1]) = 3, b_2 = f([1, 2]) = 12\\) なので、\\(b_1\\) と \\(b_2\\) の最大公約数は \\(3\\) である。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例2</h3>\n<pre>4\n2 5 2 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例2</h3>\n<pre>2\n</pre>\n\n<p>ニワトリは大きさが同じであっても互いに区別できるため、常に \\(N!\\) 通りの順列が存在する。</p>\n<p>以下の図は \\(p = (2, 1, 4, 3), p = (3, 4, 1, 2)\\) の場合の輪の作り方および美しさである。\n</p><div style=\"text-align: center;\">\n<img alt=\"bdd8ce0a7db3b4f920b04551c60aa207.png\" src=\"https://img.atcoder.jp/dwacon5th-prelims/bdd8ce0a7db3b4f920b04551c60aa207.png\">\n</div><p></p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<script type=\"text/x-mathjax-config\">\nMathJax.Hub.Config({\n  tex2jax: {skipTags:[\"script\",\"noscript\",\"style\",\"textarea\",\"code\"],inlineMath: [['\\\\(','\\\\)']]}\n});\n</script>\n\n<script type=\"text/javascript\" async=\"\" src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML\">\n</script>\n\n<p>Score : <var>1000</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3>\n<p>Niwango-kun has \\(N\\) chickens as his pets. The chickens are identified by numbers \\(1\\) to \\(N\\), and the size of the \\(i\\)-th chicken is a positive integer \\(a_i\\).</p>\n<p>\\(N\\) chickens decided to take each other's hand (wing) and form some cycles. The way to make cycles is represented by a permutation \\(p\\) of \\(1, \\ldots , N\\). Chicken \\(i\\) takes chicken \\(p_i\\)'s left hand by its right hand. Chickens may take their own hand.</p>\n<p>Let us define the <em>cycle</em> containing chicken \\(i\\) as the set consisting of chickens \\(p_i, p_{p_i}, \\ldots, p_{\\ddots_i} = i\\). It can be proven that after each chicken takes some chicken's hand, the \\(N\\) chickens can be decomposed into cycles.</p>\n<p>The <em>beauty</em> \\(f(p)\\) of a way of forming cycles is defined as the product of the size of the smallest chicken in each cycle.\nLet \\(b_i \\ (1 \\leq i \\leq N)\\) be the sum of \\(f(p)\\) among all possible permutations \\(p\\) for which \\(i\\) cycles are formed in the procedure above.</p>\n<p>Find the greatest common divisor of \\(b_1, b_2, \\ldots, b_N\\) and print it \\({\\rm mod} \\ 998244353\\).</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3>\n<ul>\n<li>\\(1 \\leq N \\leq 10^5\\)</li>\n<li>\\(1 \\leq a_i \\leq 10^9\\)</li>\n<li>All numbers given in input are integers</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3>\n<p>Input is given from Standard Input in the following format:</p>\n<pre>\\(N\\)\n\\(a_1\\) \\(a_2\\) \\(\\ldots\\) \\(a_N\\)\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3>\n<p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3>\n<pre>2\n4 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3>\n<pre>3\n</pre>\n\n<p>In this case, \\(N = 2, a = [ 4, 3 ]\\).</p>\n<p>For the permutation \\(p = [ 1, 2 ]\\), a cycle of an only chicken \\(1\\) and a cycle of an only chicken \\(2\\) are made, thus \\(f([1, 2]) = a_1 \\times a_2 = 12\\).</p>\n<p>For the permutation \\(p = [ 2, 1 ]\\), a cycle of two chickens \\(1\\) and \\(2\\) is made, and the size of the smallest chicken is \\(a_2 = 3\\), thus \\(f([2, 1]) = a_2 = 3\\).</p>\n<p>Now we know \\(b_1 = f([2, 1]) = 3, b_2 = f([1, 2]) = 12\\), and the greatest common divisor of \\(b_1\\) and \\(b_2\\) is \\(3\\).</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3>\n<pre>4\n2 5 2 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3>\n<pre>2\n</pre>\n\n<p>There are always \\(N!\\) permutations because chickens of the same size can be distinguished from each other.</p>\n<p>The following picture illustrates the cycles formed and their beauties when \\(p = (2, 1, 4, 3)\\) and \\(p = (3, 4, 1, 2)\\), respectively.\n</p><div style=\"text-align: center;\">\n<img alt=\"bdd8ce0a7db3b4f920b04551c60aa207.png\" src=\"https://img.atcoder.jp/dwacon5th-prelims/bdd8ce0a7db3b4f920b04551c60aa207.png\">\n</div><p></p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/dwacon5th-prelims/tasks/dwacon5th_prelims_e"}