{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1000</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>1</var> から <var>2N</var> までの番号がついた <var>2N</var> 個のマスが、マス <var>1</var> を上として上下一列に並んでいます。各マスには <var>1</var> つずつボールが入っており、時刻 <var>t=0</var> において、マス <var>i</var> にあるボールの重さは、 <var>i=1,2, \\ldots ,N</var> では <var>m_i</var>、 <var>i=N+1,N+2, \\ldots ,2N</var> では <var>0</var> です。ただし、<var>(m_1, m_2, \\ldots , m_N)</var> は <var>1</var> から <var>N</var> までの整数を並び替えた数列です。</p>\n<p>以下では、重さ <var>i</var> のボールを「ボール <var>i</var>」、各ボールの入っているマスの番号を「ボールの位置」と呼ぶことにします。</p>\n<p>時刻 <var>t=0</var> 以降、時刻が <var>1</var> 進むごとに、重いボールが下に沈み、代わりに軽いボールが浮かび上がっていきます。</p>\n<p>厳密には、以下の手順によって、時刻 <var>t=t_0</var> における各ボールの位置から時刻 <var>t=t_0+1</var> における各ボールの位置を定めます。</p>\n<blockquote>\n<ul>\n<li>まず、<var>i=N,N-1,\\ldots ,2,1</var> の順に、以下の操作を行う。<ul>\n<li>ボール <var>i</var> の <var>t=t_0+1</var> における位置がすでに定められている場合<ul>\n<li><strong>何もしない。</strong></li>\n</ul>\n</li>\n<li>ボール <var>i</var> の <var>t=t_0+1</var> における位置がまだ定められていない場合<ul>\n<li><var>t=t_0</var> にボール <var>i</var> の <var>1</var> つ下のマスが存在し、このマスに入っているボール（ボール <var>j</var> とする）がボール <var>i</var> より軽いとき、<strong>ボール <var>i</var> と ボール <var>j</var> の <var>t=t_0+1</var> における位置を、<var>t=t_0</var> における両者の位置を交換したものとして定める。</strong></li>\n<li>上記にあてはまらないとき、<strong>ボール <var>i</var> の <var>t=t_0+1</var> における位置を <var>t=t_0</var> における位置と同じに定める。</strong></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>続いて、ボール <var>0</var> のうちこの時点で <var>t=t_0+1</var> における位置が定められていないものについて、<strong>それぞれ <var>t=t_0+1</var> における位置を <var>t=t_0</var> における位置と同じに定める。</strong></li>\n</ul>\n</blockquote>\n<p>このとき、ある時刻にボールが上から軽い順に並び、それ以降全てボールの位置が変化しなくなることが示せます。この状態に達する時刻を求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1\\leq N\\leq 2\\times 10^5</var></li>\n<li><var>1\\leq m_i \\leq N</var></li>\n<li><var>i\\neq j</var> のとき <var>m_i\\neq m_j</var></li>\n<li>入力される値はすべて整数である</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>m_1</var> <var>m_2</var> <var>\\ldots</var> <var>m_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを整数で出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n2 3 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>6\n</pre>\n\n<p>時刻 <var>t=0</var> から <var>t=1</var> にかけての動きは次のように定まります。（必要に応じて、下の図も参考にしてください。）</p>\n<blockquote>\n<ol>\n<li>ボール <var>3</var> について、<var>t=1</var> における位置はまだ定められていない。<var>1</var> つ下のマスにはボール <var>1</var> があり、ボール <var>3</var> の方が重いため、<var>t=1</var> には両者の位置を入れ替える。すなわち、ボール <var>3</var> の位置をマス <var>3</var>、ボール <var>1</var> の位置をマス <var>2</var> に定める。</li>\n<li>ボール <var>2</var> について、<var>t=1</var> における位置はまだ定められていない。<var>1</var> つ下のマスにはボール <var>3</var> があり、これはボール <var>2</var> より重いため、ボール <var>2</var> の <var>t=1</var> における位置を <var>t=0</var> と同じに定める。</li>\n<li>ボール <var>1</var> について、<var>t=1</var> における位置は先のステップで既に定められている。</li>\n<li>ボール <var>0</var> について、全て <var>t=1</var> における位置はまだ定められていない。これらは全て <var>t=1</var> での位置を <var>t=0</var> と同じに定める。</li>\n</ol>\n</blockquote>\n<p>続いて、時刻 <var>t=1</var> から <var>t=2</var> にかけての動きは次のように定まります。</p>\n<blockquote>\n<ol>\n<li>ボール <var>3</var> について、<var>t=2</var> における位置はまだ定められていない。<var>1</var> つ下のマスにはボール <var>0</var> があり、ボール <var>3</var> の方が重いため、<var>t=2</var> には両者の位置を入れ替える。すなわち、ボール <var>3</var> の位置をマス <var>4</var>、（ボール <var>3</var> の <var>1</var> つ下にあった）ボール <var>0</var> の位置をマス <var>3</var> に定める。</li>\n<li>ボール <var>2</var> について、<var>t=2</var> における位置はまだ定められていない。<var>1</var> つ下のマスにはボール <var>1</var> があり、ボール <var>2</var> の方が重いため、<var>t=2</var> には両者の位置を入れ替える。すなわち、ボール <var>2</var> の位置をマス <var>2</var>、ボール <var>1</var> の位置をマス <var>1</var> に定める。</li>\n<li>ボール <var>1</var> について、<var>t=2</var> における位置は先のステップで既に定められている。</li>\n<li>ボール <var>0</var> について、<var>t=1</var> にマス <var>4</var> にあったものの <var>t=2</var> における位置は先のステップで既に定められている。それ以外について、<var>t=2</var> での位置を <var>t=1</var> と同じに定める。</li>\n</ol>\n</blockquote>\n<p>この後も同様にボールの位置を定めていくと、時刻 <var>t=6</var> に上から順にボール <var>0,0,0,1,2,3</var> が並び、以降ボールの位置が変化しないことが分かります。</p>\n<p><img src=\"https://img.atcoder.jp/arc188/4e545d6825157293f80acafb7314f5d1.png\" class=\"img-responsive center-block\" style=\"max-width: 100%\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>5\n4 1 2 3 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>9\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>1\n1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1000</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>2N</var> cells numbered from <var>1</var> to <var>2N</var> arranged vertically in a column with cell <var>1</var> at the top. Each cell contains one ball. The weight of the ball in cell <var>i</var> at time <var>t=0</var> is <var>m_i</var> for <var>i=1,2,\\ldots,N</var>, and <var>0</var> for <var>i=N+1,N+2,\\ldots,2N</var>. Here, <var>(m_1, m_2, \\ldots, m_N)</var> is a permutation of the integers from <var>1</var> to <var>N</var>.</p>\n<p>In the following, we will refer to the ball of weight <var>i</var> as ball <var>i</var>, and the cell number where each ball is located as the position of the ball.</p>\n<p>From time <var>t=0</var> onwards, every time the time advances by <var>1</var>, the heavier balls sink downward, and the lighter balls rise upward.</p>\n<p>Formally, the positions of each ball at time <var>t=t_0+1</var> are determined from their positions at time <var>t=t_0</var> by the following procedure.</p>\n<blockquote>\n<ul>\n<li>First, for <var>i=N,N-1,\\ldots,2,1</var> in this order, perform the following operation.<ul>\n<li>If the position of ball <var>i</var> at <var>t=t_0+1</var> has already been determined:<ul>\n<li><strong>Do nothing.</strong></li>\n</ul>\n</li>\n<li>If the position of ball <var>i</var> at <var>t=t_0+1</var> has not been determined:<ul>\n<li>If there exists a cell immediately below ball <var>i</var> at <var>t=t_0</var>, and the ball in that cell (call it ball <var>j</var>) is lighter than ball <var>i</var>, <strong>set the positions of balls <var>i</var> and <var>j</var> at <var>t=t_0+1</var> to be swapped from their positions at <var>t=t_0</var></strong>.</li>\n<li>Otherwise, <strong>set the position of ball <var>i</var> at <var>t=t_0+1</var> to be the same as at <var>t=t_0</var>.</strong></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Next, for all balls of weight <var>0</var> whose positions at <var>t=t_0+1</var> have not been determined at this point, <strong>set their positions at <var>t=t_0+1</var> to be the same as at <var>t=t_0</var>.</strong></li>\n</ul>\n</blockquote>\n<p>It can be shown that at some time, the balls will be arranged from top to bottom in ascending order of weight, and their positions will no longer change. Find the time when this state is reached.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq m_i \\leq N</var></li>\n<li><var>m_i \\neq m_j</var> for <var>i \\neq j</var>.</li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>m_1</var> <var>m_2</var> <var>\\ldots</var> <var>m_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer as an integer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n2 3 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>6\n</pre>\n\n<p>The movements from time <var>t=0</var> to <var>t=1</var> are determined as follows. (Refer to the diagram below if necessary.)</p>\n<blockquote>\n<ol>\n<li>For ball <var>3</var>, its position at <var>t=1</var> has not yet been determined. The cell immediately below it contains ball <var>1</var>, and ball <var>3</var> is heavier, so swap their positions for <var>t=1</var>. That is, set the position of ball <var>3</var> to cell <var>3</var>, and ball <var>1</var> to cell <var>2</var>.</li>\n<li>For ball <var>2</var>, its position at <var>t=1</var> has not yet been determined. The cell immediately below it contains ball <var>3</var>, which is heavier than ball <var>2</var>, so set the position of ball <var>2</var> at <var>t=1</var> to be the same as at <var>t=0</var>.</li>\n<li>For ball <var>1</var>, its position at <var>t=1</var> has already been determined in the earlier step.</li>\n<li>For balls of weight <var>0</var>, none of their positions at <var>t=1</var> have been determined. Set their positions at <var>t=1</var> to be the same as at <var>t=0</var>.</li>\n</ol>\n</blockquote>\n<p>Next, the movements from time <var>t=1</var> to <var>t=2</var> are determined as follows.</p>\n<blockquote>\n<ol>\n<li>For ball <var>3</var>, its position at <var>t=2</var> has not yet been determined. The cell immediately below it contains ball <var>0</var>, and ball <var>3</var> is heavier, so swap their positions for <var>t=2</var>. That is, set the position of ball <var>3</var> to cell <var>4</var>, and ball <var>0</var> (the one that was below ball <var>3</var>) to cell <var>3</var>.</li>\n<li>For ball <var>2</var>, its position at <var>t=2</var> has not yet been determined. The cell immediately below it contains ball <var>1</var>, and ball <var>2</var> is heavier, so swap their positions for <var>t=2</var>. That is, set the position of ball <var>2</var> to cell <var>2</var>, and ball <var>1</var> to cell <var>1</var>.</li>\n<li>For ball <var>1</var>, its position at <var>t=2</var> has already been determined in the earlier step.</li>\n<li>For balls of weight <var>0</var>, the one that was at cell <var>4</var> at <var>t=1</var> has already had its position at <var>t=2</var> determined in the earlier step. For the others, set their positions at <var>t=2</var> to be the same as at <var>t=1</var>.</li>\n</ol>\n</blockquote>\n<p>Continuing to determine the positions of the balls in this way, at time <var>t=6</var>, the balls will be arranged from top to bottom as balls <var>0,0,0,1,2,3</var>, and their positions will no longer change.</p>\n<p><img src=\"https://img.atcoder.jp/arc188/4e545d6825157293f80acafb7314f5d1.png\" class=\"img-responsive center-block\" style=\"max-width: 100%\"></p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>5\n4 1 2 3 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>9\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>1\n1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc188/tasks/arc188_e"}