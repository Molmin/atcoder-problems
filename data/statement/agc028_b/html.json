{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 個のブロックが一列に並んでおり、左から右へ順に <var>1</var> から <var>N</var> の番号がついています。\nそれぞれのブロックには重さが定まっており、ブロック <var>i</var> の重さは <var>A_i</var> です。\nすぬけ君は、これらのブロックに対して次の操作を <var>N</var> 回行います。</p>\n<ul>\n<li>まだ取り除かれていないブロックを <var>1</var> つ選んで取り除く。\nこの操作のコストは、取り除くブロックと連結なブロック（取り除くブロック自身も含む）の重さの総和となる。\n<var>2</var> つのブロック <var>x</var>, <var>y</var> ( <var>x \\leq y</var> ) が連結であるとは、すべての <var>z</var> ( <var>x \\leq z \\leq y</var> ) について、ブロック <var>z</var> が取り除かれていないことを意味する。</li>\n</ul>\n<p>ブロックを取り除く順番はちょうど <var>N!</var> 通りあります。\n<var>N!</var> 通りのすべての順番について <var>N</var> 回の操作のコストの合計を求め、その総和を求めてください。\nただし、答えは非常に大きくなることがあるので、<var>10^9+7</var> で割った余りを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 10^5</var></li>\n<li><var>1 \\leq A_i \\leq 10^9</var></li>\n<li>入力はすべて整数である。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>A_1</var> <var>A_2</var> <var>...</var> <var>A_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>N!</var> 通りのすべての順番について <var>N</var> 回の操作のコストの合計を求め、その総和を <var>10^9+7</var> で割った余りを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2\n1 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>9\n</pre>\n\n<p>ブロック <var>1</var>, <var>2</var> の順で取り除く場合を考えます。\nまず、最初の操作では、ブロック <var>1</var> と <var>2</var> が連結なので、操作のコストは <var>1+2=3</var> です。\n次の操作では、ブロック <var>2</var> しか残っていないので、操作のコストは <var>2</var> です。\nよって、この順で取り除く場合のコストの合計は <var>3+2=5</var> です。</p>\n<p>ブロック <var>2</var>, <var>1</var> の順で取り除く場合を考えます。\nまず、最初の操作では、ブロック <var>1</var> と <var>2</var> が連結なので、操作のコストは <var>1+2=3</var> です。\n次の操作では、ブロック <var>1</var> しか残っていないので、操作のコストは <var>1</var> です。\nよって、この順で取り除く場合のコストの合計は <var>3+1=4</var> です。</p>\n<p>上記より、答えは <var>5+4=9</var> となります。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>4\n1 1 1 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>212\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>10\n1 2 4 8 16 32 64 128 256 512\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>880971923\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>N</var> blocks arranged in a row, numbered <var>1</var> to <var>N</var> from left to right.\nEach block has a weight, and the weight of Block <var>i</var> is <var>A_i</var>.\nSnuke will perform the following operation on these blocks <var>N</var> times:</p>\n<ul>\n<li>Choose one block that is still not removed, and remove it.\nThe cost of this operation is the sum of the weights of the blocks that are connected to the block being removed (including itself).\nHere, two blocks <var>x</var> and <var>y</var> ( <var>x \\leq y</var> ) are <em>connected</em> when, for all <var>z</var> ( <var>x \\leq z \\leq y</var> ), Block <var>z</var> is still not removed.</li>\n</ul>\n<p>There are <var>N!</var> possible orders in which Snuke removes the blocks.\nFor all of those <var>N!</var> orders, find the total cost of the <var>N</var> operations, and calculate the sum of those <var>N!</var> total costs.\nAs the answer can be extremely large, compute the sum modulo <var>10^9+7</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 10^5</var></li>\n<li><var>1 \\leq A_i \\leq 10^9</var></li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>A_1</var> <var>A_2</var> <var>...</var> <var>A_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>For all of the <var>N!</var> orders, find the total cost of the <var>N</var> operations, and print the sum of those <var>N!</var> total costs, modulo <var>10^9+7</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2\n1 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>9\n</pre>\n\n<p>First, we will consider the order \"Block <var>1</var> -&gt; Block <var>2</var>\".\nIn the first operation, the cost of the operation is <var>1+2=3</var>, as Block <var>1</var> and <var>2</var> are connected.\nIn the second operation, the cost of the operation is <var>2</var>, as only Block <var>2</var> remains.\nThus, the total cost of the two operations for this order is <var>3+2=5</var>.</p>\n<p>Then, we will consider the order \"Block <var>2</var> -&gt; Block <var>1</var>\".\nIn the first operation, the cost of the operation is <var>1+2=3</var>, as Block <var>1</var> and <var>2</var> are connected.\nIn the second operation, the cost of the operation is <var>1</var>, as only Block <var>1</var> remains.\nThus, the total cost of the two operations for this order is <var>3+1=4</var>.</p>\n<p>Therefore, the answer is <var>5+4=9</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>4\n1 1 1 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>212\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>10\n1 2 4 8 16 32 64 128 256 512\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>880971923\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc028/tasks/agc028_b"}