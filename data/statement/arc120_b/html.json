{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>400</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>H</var> 行 <var>W</var> 列のマス目があります。上から <var>i</var> 行目、左から <var>j</var> 列目のマスをマス <var>(i, j)</var> と呼ぶことにします。<br>\nマス目の状態を表す <var>H</var> 個の文字列 <var>S_1, S_2, S_3, \\dots, S_H</var> が与えられます。マス <var>(i, j)</var> の状態は以下の通りです。  </p>\n<ul>\n<li><var>S_i</var> の <var>j</var> 文字目が <code>R</code> ならば赤く塗られている</li>\n<li><var>S_i</var> の <var>j</var> 文字目が <code>B</code> ならば青く塗られている</li>\n<li><var>S_i</var> の <var>j</var> 文字目が <code>.</code> ならば色が塗られていない</li>\n</ul>\n<p>色が塗られていないマスの個数を <var>k</var> とすると、そのようなマスそれぞれを赤と青のどちらかで塗る方法は <var>2^k</var> 通りありますが、このうち以下の条件を満たすものの個数を求めてください。  </p>\n<ul>\n<li>マス <var>(1, 1)</var> からマス <var>(H, W)</var> に、右または下へ <var>1</var> マス移動することを繰り返して辿り着くとき、途中で通過するマス (マス <var>(1, 1), (H, W)</var> を含む) のうち赤に塗られたものの数が、通る経路によらず一定である</li>\n</ul>\n<p>ただし、答えは非常に大きくなることがあるので、<var>998244353</var> で割った余りを出力してください。  </p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\le H \\le 500</var></li>\n<li><var>2 \\le W \\le 500</var></li>\n<li><var>S_i</var> は <code>R</code>, <code>B</code>, <code>.</code> からなる長さ <var>W</var> の文字列</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>H</var> <var>W</var>\n<var>S_1</var>\n<var>S_2</var>\n<var>S_3</var>\n<var>\\hspace{3pt} \\vdots</var>\n<var>S_H</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを <var>998244353</var> で割った余りを出力せよ。  </p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2 2\nB.\n.R\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2\n</pre>\n<p>マス <var>(1, 1)</var> からマス <var>(2, 2)</var> に、右または下へ <var>1</var> マス移動することを繰り返して辿り着く方法は以下の <var>2</var> 通りあります。  </p>\n<ul>\n<li>マス <var>(1, 1) \\rightarrow (1, 2) \\rightarrow (2, 2)</var></li>\n<li>マス <var>(1, 1) \\rightarrow (2, 1) \\rightarrow (2, 2)</var></li>\n</ul>\n<p>マス <var>(1, 2)</var> とマス <var>(2, 1)</var> を異なる色で塗った場合、上記の <var>2</var> 通りの移動方法のどちらを選ぶかによって、通過する赤く塗られたマスの数が変わってしまうため条件を満たしません。<br>\n一方で、マス <var>(1, 2)</var> とマス <var>(2, 1)</var> を同じ色で塗った場合、通過する赤く塗られたマスの数は移動方法によって変わらないため、条件を満たします。<br>\nよって条件を満たす塗り方は <var>2</var> 通りあります。  </p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 3\nR.R\nBBR\n...\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n<p>条件を満たす塗り方が存在しないかもしれません。  </p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>2 2\nBB\nBB\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1\n</pre>\n<p>色が塗られていないマスが存在せず、現在のマス目は条件を満たすため、答えは <var>1</var> となります。  </p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>400</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have a grid with <var>H</var> rows and <var>W</var> columns. Let <var>(i, j)</var> denote the square at the <var>i</var>-th row and <var>j</var>-th column.<br>\nYou are given <var>H</var> strings <var>S_1, S_2, S_3, \\dots, S_H</var> that describe the square, as follows:</p>\n<ul>\n<li>if the <var>j</var>-th character of <var>S_i</var> is <code>R</code>, <var>(i, j)</var> is painted red;</li>\n<li>if the <var>j</var>-th character of <var>S_i</var> is <code>B</code>, <var>(i, j)</var> is painted blue;</li>\n<li>if the <var>j</var>-th character of <var>S_i</var> is <code>.</code>, <var>(i, j)</var> is unpainted.</li>\n</ul>\n<p>Let <var>k</var> be the number of unpainted squares. Among the <var>2^k</var> ways to paint each of those squares red or blue, how many satisfy the following condition?</p>\n<ul>\n<li>The number of red squares visited while getting from <var>(1, 1)</var> to <var>(H, W)</var> by repeatedly moving one square right or down, including <var>(1, 1)</var> and <var>(H, W)</var>, is always the same regardless of the path taken.</li>\n</ul>\n<p>Since the count may be enormous, print it modulo <var>998244353</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\le H \\le 500</var></li>\n<li><var>2 \\le W \\le 500</var></li>\n<li><var>S_i</var> is a string of length <var>W</var> consisting of <code>R</code>, <code>B</code>, and <code>.</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>H</var> <var>W</var>\n<var>S_1</var>\n<var>S_2</var>\n<var>S_3</var>\n<var>\\hspace{3pt} \\vdots</var>\n<var>S_H</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the count modulo <var>998244353</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2 2\nB.\n.R\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2\n</pre>\n<p>There are two ways to get from <var>(1, 1)</var> to <var>(2, 2)</var> by repeatedly moving right or down, as follows:</p>\n<ul>\n<li><var>(1, 1) \\rightarrow (1, 2) \\rightarrow (2, 2)</var></li>\n<li><var>(1, 1) \\rightarrow (2, 1) \\rightarrow (2, 2)</var></li>\n</ul>\n<p>If we paint <var>(1, 2)</var> and <var>(2, 1)</var> in different colors, the above two paths will contain different numbers of red squares, violating the condition.<br>\nOn the other hand, if we paint <var>(1, 2)</var> and <var>(2, 1)</var> in the same color, the two paths will contain the same numbers of red squares, satisfying the condition.<br>\nThus, there are two ways to satisfy the condition.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 3\nR.R\nBBR\n...\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n<p>There may be no way to satisfy the condition.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>2 2\nBB\nBB\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1\n</pre>\n<p>There is no unpainted square, and the current grid satisfies the condition, so the answer is <var>1</var>.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc120/tasks/arc120_b"}