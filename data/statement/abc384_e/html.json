{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>450</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>縦 <var>H</var> 行横 <var>W</var> 列のマス目があります。\n上から <var>i</var> 行目 <var>(1\\leq i\\leq H)</var>、左から <var>j</var> 列目 <var>(1\\leq j\\leq W)</var> のマスをマス <var>(i,j)</var> と呼ぶことにします。</p>\n<p>はじめ、マス <var>(i,j)</var> には強さ <var>S _ {i,j}</var> のスライムがおり、マス <var>(P,Q)</var> にいるスライムが高橋くんです。</p>\n<p>高橋くんが以下の行動を好きな回数（<var>0</var> 回でもよい）行ったあとの、高橋くんの強さとしてありえる最大値を求めてください。</p>\n<ul>\n<li>高橋くんに隣接するスライムのうち、強さが高橋くんの強さの <var>\\dfrac1X</var> 倍<strong>未満</strong>のものを選んで吸収する。\nその結果、吸収されたスライムは消滅し、高橋君の強さは吸収したスライムの強さだけ増加する。</li>\n</ul>\n<p>上記の行動の際、スライムが吸収され消滅したことで生じた隙間は直ちに高橋くんによって埋められ、消滅したスライムに隣接していたスライム（それらが存在すれば）は新たに高橋くんと隣接します（入出力例１の説明も参照してください）。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1\\leq H,W\\leq500</var></li>\n<li><var>1\\leq P\\leq H</var></li>\n<li><var>1\\leq Q\\leq W</var></li>\n<li><var>1\\leq X\\leq10^9</var></li>\n<li><var>1\\leq S _ {i,j}\\leq10^{12}</var></li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>H</var> <var>W</var> <var>X</var> \n<var>P</var> <var>Q</var>\n<var>S _ {1,1}</var> <var>S _ {1,2}</var> <var>\\ldots</var> <var>S _ {1,W}</var>\n<var>S _ {2,1}</var> <var>S _ {2,2}</var> <var>\\ldots</var> <var>S _ {2,W}</var>\n<var>\\vdots</var>\n<var>S _ {H,1}</var> <var>S _ {H,2}</var> <var>\\ldots</var> <var>S _ {H,W}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>高橋くんが行動を行ったあとの高橋くんの強さとしてありえる最大値を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 3 2\n2 2\n14 6 9\n4 9 20\n17 15 7\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>28\n</pre>\n<p>はじめ、それぞれのマスにいるスライムの強さは以下の図のようになっています。</p>\n<p><img src=\"https://img.atcoder.jp/abc384/6b3d3bbde4767c7f5070ad0b1f202043.png\" class=\"img-responsive center-block\" style=\"max-width: 100%\"></p>\n<p>例えば、高橋くんは次のように行動を行うことができます。</p>\n<p><img src=\"https://img.atcoder.jp/abc384/81c0ccdba241277bf0cdd16ae6a7c54d.png\" class=\"img-responsive center-block\" style=\"max-width: 100%\"></p>\n<ul>\n<li>マス <var>(2,1)</var> にいるスライムを吸収する。高橋くんの強さは <var>9+4=13</var> となり、新たにマス <var>(1,1)</var> のスライムとマス <var>(3,1)</var> のスライムが高橋くんと隣接する。</li>\n<li>マス <var>(1,2)</var> にいるスライムを吸収する。高橋くんの強さは <var>13+6=19</var> となり、新たにマス <var>(1,3)</var> のスライムが高橋くんと隣接する。</li>\n<li>マス <var>(1,3)</var> にいるスライムを吸収する。高橋くんの強さは <var>19+9=28</var> となる。</li>\n</ul>\n<p>以上の行動を行ったあと、高橋くんの強さは <var>28</var> となります。</p>\n<p>高橋くんがどのように行動を行っても、高橋くんの強さを <var>28</var> より大きくすることはできないため、<code>28</code> を出力してください。</p>\n<p>高橋くんの強さの <var>\\dfrac12</var> 倍未満のスライムしか吸収できないことに注意してください。\n例えば、上図の右側の状態からマス <var>(1,1)</var> にいるスライムを吸収することはできません。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 4 1\n1 1\n5 10 1 1\n10 1 1 1\n1 1 1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>5\n</pre>\n<p>高橋くんはどのスライムも吸収できません。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>8 10 2\n1 5\n388 130 971 202 487 924 247 286 237 316\n117 166 918 106 336 928 493 391 235 398\n124 280 425 955 212 988 227 222 307 226\n336 302 478 246 950 368 291 236 170 101\n370 200 204 141 287 410 388 314 205 460\n291 104 348 337 404 399 416 263 415 339\n105 420 302 334 231 481 466 366 401 452\n119 432 292 403 371 417 351 231 482 184\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1343\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>450</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There is a grid with <var>H</var> horizontal rows and <var>W</var> vertical columns.\nLet <var>(i, j)</var> denote the cell at the <var>i</var>-th row <var>(1\\leq i\\leq H)</var> from the top and <var>j</var>-th column <var>(1\\leq j\\leq W)</var> from the left.</p>\n<p>Initially, there is a slime with strength <var>S _ {i,j}</var> in cell <var>(i,j)</var>, and Takahashi is the slime in the cell <var>(P,Q)</var>.</p>\n<p>Find the maximum possible strength of Takahashi after performing the following action any number of times (possibly zero):</p>\n<ul>\n<li>Among the slimes adjacent to him, choose one whose strength is <strong>strictly less than</strong> <var>\\dfrac{1}{X}</var> times his strength and absorb it.\n  As a result, the absorbed slime disappears, and Takahashi's strength increases by the strength of the absorbed slime.</li>\n</ul>\n<p>When performing the above action, the gap left by the disappeared slime is immediately filled by Takahashi, and the slimes that were adjacent to the disappeared one (if any) become newly adjacent to Takahashi (refer to the explanation in sample 1).</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1\\leq H,W\\leq500</var></li>\n<li><var>1\\leq P\\leq H</var></li>\n<li><var>1\\leq Q\\leq W</var></li>\n<li><var>1\\leq X\\leq10^9</var></li>\n<li><var>1\\leq S _ {i,j}\\leq10^{12}</var></li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given in the following format from Standard Input:</p>\n<pre><var>H</var> <var>W</var> <var>X</var> \n<var>P</var> <var>Q</var>\n<var>S _ {1,1}</var> <var>S _ {1,2}</var> <var>\\ldots</var> <var>S _ {1,W}</var>\n<var>S _ {2,1}</var> <var>S _ {2,2}</var> <var>\\ldots</var> <var>S _ {2,W}</var>\n<var>\\vdots</var>\n<var>S _ {H,1}</var> <var>S _ {H,2}</var> <var>\\ldots</var> <var>S _ {H,W}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the maximum possible strength of Takahashi after performing the action.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 3 2\n2 2\n14 6 9\n4 9 20\n17 15 7\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>28\n</pre>\n<p>Initially, the strength of the slime in each cell is as follows:</p>\n<p><img src=\"https://img.atcoder.jp/abc384/6b3d3bbde4767c7f5070ad0b1f202043.png\" class=\"img-responsive center-block\" style=\"max-width: 100%\"></p>\n<p>For example, Takahashi can act as follows:</p>\n<p><img src=\"https://img.atcoder.jp/abc384/81c0ccdba241277bf0cdd16ae6a7c54d.png\" class=\"img-responsive center-block\" style=\"max-width: 100%\"></p>\n<ul>\n<li>Absorb the slime in cell <var>(2,1)</var>. His strength becomes <var>9+4=13</var>, and the slimes in cells <var>(1,1)</var> and <var>(3,1)</var> become newly adjacent to him.</li>\n<li>Absorb the slime in cell <var>(1,2)</var>. His strength becomes <var>13+6=19</var>, and the slime in cell <var>(1,3)</var> becomes newly adjacent to him.</li>\n<li>Absorb the slime in cell <var>(1,3)</var>. His strength becomes <var>19+9=28</var>.</li>\n</ul>\n<p>After these actions, his strength is <var>28</var>.</p>\n<p>No matter how he acts, it is impossible to get a strength greater than <var>28</var>, so print <code>28</code>.</p>\n<p>Note that Takahashi can only absorb slimes whose strength is strictly less than half of his strength. For example, in the figure on the right above, he cannot absorb the slime in cell <var>(1,1)</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 4 1\n1 1\n5 10 1 1\n10 1 1 1\n1 1 1 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>5\n</pre>\n<p>He cannot absorb any slimes.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>8 10 2\n1 5\n388 130 971 202 487 924 247 286 237 316\n117 166 918 106 336 928 493 391 235 398\n124 280 425 955 212 988 227 222 307 226\n336 302 478 246 950 368 291 236 170 101\n370 200 204 141 287 410 388 314 205 460\n291 104 348 337 404 399 416 263 415 339\n105 420 302 334 231 481 466 366 401 452\n119 432 292 403 371 417 351 231 482 184\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1343\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc384/tasks/abc384_e"}