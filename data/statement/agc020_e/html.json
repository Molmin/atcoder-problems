{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1400</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>次のような、<code>0</code> と <code>1</code> からなる文字列をエンコードする規則を考えます。</p>\n<ul>\n<li>文字列 <code>0</code>、<code>1</code> はそれぞれ <code>0</code>、<code>1</code> とエンコードできる。</li>\n<li>文字列 <var>A</var>、<var>B</var> をそれぞれ <var>P</var>、<var>Q</var> とエンコードできる場合、文字列 <var>AB</var> を <var>PQ</var> とエンコードできる。</li>\n<li>文字列 <var>A</var> を <var>P</var> とエンコードできる場合、<var>K \\geq 2</var> を正の整数として、文字列 <var>AA...A</var>（<var>A</var> を <var>K</var> 個連結したもの）を <code>(</code><var>P</var><code>x</code><var>K</var><code>)</code> とエンコードできる。</li>\n</ul>\n<p>例えば、文字列 <code>001001001</code> は <code>001001001</code>、<code>00(1(0x2)x2)1</code>、<code>(001x3)</code> などとエンコードすることができ、この他のエンコード方法も存在します。</p>\n<p>また、次の条件が満たされるとき、文字列 <var>A</var> は文字列 <var>B</var> の <em>サブセット</em> であると呼びます。</p>\n<ul>\n<li><var>A</var> と <var>B</var> は長さが等しく、どちらも <code>0</code> と <code>1</code> からなる。</li>\n<li><var>A_i</var> = <code>1</code> であるようなすべての添字 <var>i</var> に対して、<var>B_i</var> = <code>1</code> でもある。</li>\n</ul>\n<p><code>0</code> と <code>1</code> からなる文字列 <var>S</var> が与えられます。<var>S</var> のすべてのサブセットについて、それぞれをエンコードする方法が何通り存在するか求め、それらの個数の総和を <var>998244353</var> で割ったあまりを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq |S| \\leq 100</var></li>\n<li><var>S</var> は <code>0</code> と <code>1</code> からなる。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は標準入力から以下の形式で与えられる。</p>\n<pre><var>S</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>S</var> のすべてのサブセットについてのエンコード方法の個数の総和を <var>998244353</var> で割ったあまりを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>011\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>9\n</pre>\n\n<p><var>S</var> のサブセットは <var>4</var> 個存在し、</p>\n<ul>\n<li><code>011</code> は <code>011</code>、<code>0(1x2)</code> とエンコードできます。</li>\n<li><code>010</code> は <code>010</code> とエンコードできます。</li>\n<li><code>001</code> は <code>001</code>、<code>(0x2)1</code> とエンコードできます。</li>\n<li><code>000</code> は <code>000</code>、<code>0(0x2)</code>、<code>(0x2)0</code>、<code>(0x3)</code> とエンコードできます。</li>\n</ul>\n<p>したがって、<var>S</var> のすべてのサブセットについてのエンコード方法の個数の総和は <var>2 + 1 + 2 + 4 = 9</var> 通りです。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>0000\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>10\n</pre>\n\n<p>今回は <var>S</var> のサブセットは <var>1</var> 個しか存在しませんが、<var>10</var> 通りの方法でエンコードできます。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>101110\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>156\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>001110111010110001100000100111\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>363383189\n</pre>\n\n<p>結果を <var>998244353</var> で割ったあまりを出力することを忘れずに。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1400</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Consider the following set of rules for encoding strings consisting of <code>0</code> and <code>1</code>:</p>\n<ul>\n<li>Strings <code>0</code> and <code>1</code> can be encoded as <code>0</code> and <code>1</code>, respectively. </li>\n<li>If strings <var>A</var> and <var>B</var> can be encoded as <var>P</var> and <var>Q</var>, respectively, then string <var>AB</var> can be encoded as <var>PQ</var>.</li>\n<li>If string <var>A</var> can be encoded as <var>P</var> and <var>K \\geq 2</var> is a positive integer, then string <var>AA...A</var> (<var>A</var> repeated <var>K</var> times) can be encoded as <code>(</code><var>P</var><code>x</code><var>K</var><code>)</code>.</li>\n</ul>\n<p>For example, string <code>001001001</code>, among other possibilities, can be encoded as <code>001001001</code>, <code>00(1(0x2)x2)1</code> and <code>(001x3)</code>.</p>\n<p>Let's call string <var>A</var> a subset of string <var>B</var> if:</p>\n<ul>\n<li><var>A</var> and <var>B</var> are equal in length and consist of <code>0</code> and <code>1</code>;</li>\n<li>for all indices <var>i</var> such that <var>A_i</var> = <code>1</code>, it's also true that <var>B_i</var> = <code>1</code>.</li>\n</ul>\n<p>You are given string <var>S</var> consisting of <code>0</code> and <code>1</code>. Find the total number of distinct encodings of all subsets of <var>S</var>, modulo <var>998244353</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq |S| \\leq 100</var></li>\n<li><var>S</var> consists of <code>0</code> and <code>1</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>S</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the total number of distinct encodings of all subsets of <var>S</var> modulo <var>998244353</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>011\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>9\n</pre>\n\n<p>There are four subsets of <var>S</var>:</p>\n<ul>\n<li><code>011</code> can be encoded as <code>011</code> and <code>0(1x2)</code>;</li>\n<li><code>010</code> can be encoded as <code>010</code>;</li>\n<li><code>001</code> can be encoded as <code>001</code> and <code>(0x2)1</code>;</li>\n<li><code>000</code> can be encoded as <code>000</code>, <code>0(0x2)</code>, <code>(0x2)0</code> and <code>(0x3)</code>.</li>\n</ul>\n<p>Thus, the total number of encodings of all subsets of <var>S</var> is <var>2 + 1 + 2 + 4 = 9</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>0000\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>10\n</pre>\n\n<p>This time <var>S</var> has only one subset, but it can be encoded in <var>10</var> different ways.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>101110\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>156\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>001110111010110001100000100111\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>363383189\n</pre>\n\n<p>Don't forget to take the result modulo <var>998244353</var>.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc020/tasks/agc020_e"}