{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>700</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3>\n<p>AtCoder 街道は、平らな地面の上に伸びる数直線で表される道路です。この道路上に <var>N</var> 個の高さ <var>H</var> の電柱が立っています。電柱には <var>1, 2, \\dots, N</var> の番号が古い順に付けられています。電柱 <var>i \\ (1 \\leq i \\leq N)</var> は座標 <var>X_i</var> に地面と垂直に立っています。<strong>電柱の最下部は地面に固定されています。</strong>ここで、電柱は十分に細いものとして考えます。</p>\n<p>AtCoder 街道ではこれから <var>N</var> 回の地震が発生します。<var>i</var> 回目 <var>(1 \\leq i \\leq N)</var> の地震では、以下のことが起こります。</p>\n<ol>\n<li>電柱 <var>i</var> がまだ倒れていない場合、それが数直線における左または右の方向に、それぞれ <var>\\frac{1}{2}</var> ずつの確率で倒れる。</li>\n<li>倒れようとしている電柱が、まだ倒れていない電柱に衝突した場合（電柱の最下部に衝突した場合を含む）、この電柱も同じ方向に倒れる。場合によってはこれが連鎖的に起こる。</li>\n</ol>\n<p>ここで、1. で電柱がどちら方向に倒れるかは、他の電柱がどちら方向に倒れたかに関係しません。</p>\n<p>以下の図は一回の地震での電柱の倒れ方の一例です。</p>\n<p style=\"text-align: center;\"><img style=\"max-width: 100%;\" alt=\" \" src=\"https://img.atcoder.jp/arc177/099e3b6e0b64fbbb71e3519707cc7908.png\"></p>\n<p>地震対策のため、<var>t = 1, 2, \\dots, N</var> それぞれについて、ちょうど <var>t</var> 回目の地震ですべての電柱が倒れた状態になる確率を <var>2^N</var> 倍した値を <var>998244353</var> で割った余りを求めてください。なお、出力すべき値は整数になることが証明できます。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3>\n<ul>\n<li><var>1 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq H \\leq 10^9</var></li>\n<li><var>0 \\leq X_i \\leq 10^9 \\ (1 \\leq i \\leq N)</var></li>\n<li><var>X_1, X_2, \\dots, X_N</var> はすべて異なる</li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3>\n<p>入力は以下の形式で標準入力から与えられます。  </p>\n<pre><var>N</var> <var>H</var>\n<var>X_1</var> <var>X_2</var> <var>\\cdots</var> <var>X_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3>\n<p><var>t = 1, 2, \\dots, N</var> についての答えをその順番で空白区切りで出力してください。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 2\n0 3 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>4 2 2\n</pre>\n<p>以下の図は、この入力例における電柱の倒れ方の可能性を示しています。図中の分数はその状態になる確率を示しています。</p>\n<p style=\"text-align: center;\"><img style=\"max-width: 100%;\" alt=\" \" src=\"https://img.atcoder.jp/arc177/1b1ec413ff3069cd13b19efd64b9c9d2.png\"></p>\n<p>したがって、ちょうど <var>1, 2, 3</var> 回目の地震ですべての電柱が倒れた状態になる確率は、それぞれ <var>\\frac{1}{2}, \\frac{1}{4}, \\frac{1}{4}</var> です。これを <var>8</var> 倍した <var>4, 2, 2</var> を出力しましょう。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>4 10\n10 55 20 45\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0 4 4 8\n</pre>\n<p>以下の図は、この入力例における電柱の倒れ方の可能性を示しています。図中の分数はその状態になる確率を示しています。</p>\n<p style=\"text-align: center;\"><img style=\"max-width: 100%;\" alt=\" \" src=\"https://img.atcoder.jp/arc177/f2ce4d20221071c814e204d8a2adc60d.png\"></p>\n<p>したがって、ちょうど <var>1, 2, 3, 4</var> 回目の地震ですべての電柱が倒れた状態になる確率は、それぞれ <var>0, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{2}</var> です。これを <var>16</var> 倍した <var>0, 4, 4, 8</var> を出力しましょう。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>8 1\n5 0 6 3 8 1 7 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>0 64 32 48 24 28 28 32\n</pre>\n<p>ちょうど <var>1, 2, 3, 4, 5, 6, 7, 8</var> 回目の地震ですべての電柱が倒れた状態になる確率は、それぞれ <var>0, \\frac{1}{4}, \\frac{1}{8}, \\frac{3}{16}, \\frac{3}{32}, \\frac{7}{64}, \\frac{7}{64}, \\frac{1}{8}</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>40 20\n695 793 11 502 114 861 559 4 212 609 894 435 429 94 91 258 161 45 33 605 673 634 629 163 283 826 409 84 507 548 31 248 588 340 357 168 926 949 322 912\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 41942627 41942627 360709869\n</pre>\n<p><var>37</var> 回目の地震までにすべての電柱が倒れることはありません。ちょうど <var>38, 39, 40</var> 回目の地震ですべての電柱が倒れた状態になる確率は、それぞれ <var>\\frac{3}{8}, \\frac{3}{8}, \\frac{1}{4}</var> です。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score: <var>700</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3>\n<p>AtCoder Street is a road represented by a straight line on flat ground. There are <var>N</var> utility poles of height <var>H</var> standing on this road. The poles are numbered <var>1, 2, \\dots, N</var> in chronological order. Pole <var>i</var> (<var>1 \\leq i \\leq N</var>) is vertically positioned at coordinate <var>X_i</var>. <strong>The base of each pole is fixed to the ground.</strong> Assume that the poles are sufficiently thin.</p>\n<p>The street will experience <var>N</var> earthquakes. During the <var>i</var>-th earthquake <var>(1 \\leq i \\leq N)</var>, the following events occur:</p>\n<ol>\n<li>If pole <var>i</var> has not yet fallen, it falls to the left or the right on the number line, each with a probability of <var>\\frac{1}{2}</var>.</li>\n<li>If a falling pole collides with another pole that has not yet fallen (including collision at the base of the pole), the latter pole will also fall in the same direction. This may trigger a chain reaction.</li>\n</ol>\n<p>The direction in which a pole falls during step 1 is independent of the direction in which other poles have fallen.</p>\n<p>The following figure is an example of how poles might fall during one earthquake:</p>\n<p style=\"text-align: center;\"><img style=\"max-width: 100%;\" alt=\" \" src=\"https://img.atcoder.jp/arc177/099e3b6e0b64fbbb71e3519707cc7908.png\"></p>\n<p>For earthquake preparedness, for each <var>t = 1, 2, \\dots, N</var>, find the probability that all poles have fallen by exactly the <var>t</var>-th earthquake. Multiply it by <var>2^N</var> and print the result modulo <var>998244353</var>. It can be proved that the values to be printed are integers.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3>\n<ul>\n<li><var>1 \\leq N \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq H \\leq 10^9</var></li>\n<li><var>0 \\leq X_i \\leq 10^9 \\ (1 \\leq i \\leq N)</var></li>\n<li><var>X_1, X_2, \\dots, X_N</var> are all distinct.</li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3>\n<p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>H</var>\n<var>X_1</var> <var>X_2</var> <var>\\cdots</var> <var>X_N</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3>\n<p>Print the answers for <var>t = 1, 2, \\dots, N</var> in this order, separated by spaces.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 2\n0 3 1\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>4 2 2\n</pre>\n<p>The following figure shows the possible ways the poles can fall for this sample input. The fractions in the figure indicate the probability of each state occurring.</p>\n<p style=\"text-align: center;\"><img style=\"max-width: 100%;\" alt=\" \" src=\"https://img.atcoder.jp/arc177/0ca8ef9552065d079b964857fd96a584.png\"></p>\n<p>Therefore, the probabilities that all poles have fallen by exactly the <var>1</var>-st, <var>2</var>-nd, <var>3</var>-rd earthquakes are <var>\\frac{1}{2}</var>, <var>\\frac{1}{4}</var>, <var>\\frac{1}{4}</var>, respectively. Multiply these by <var>8</var> to get <var>4, 2, 2</var> for output.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>4 10\n10 55 20 45\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0 4 4 8\n</pre>\n<p>The following figure shows the possible ways the poles can fall for this sample input. The fractions in the figure indicate the probability of each state occurring.</p>\n<p style=\"text-align: center;\"><img style=\"max-width: 100%;\" alt=\" \" src=\"https://img.atcoder.jp/arc177/15420872507930a610017b9ea0f22280.png\"></p>\n<p>Therefore, the probabilities that all poles have fallen by exactly the <var>1</var>-st, <var>2</var>-nd, <var>3</var>-rd, <var>4</var>-th earthquakes are <var>0</var>, <var>\\frac{1}{4}</var>, <var>\\frac{1}{4}</var>, <var>\\frac{1}{2}</var>, respectively. Multiply these by <var>16</var> to get <var>0, 4, 4, 8</var> for output.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>8 1\n5 0 6 3 8 1 7 2\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>0 64 32 48 24 28 28 32\n</pre>\n<p>The probabilities that all poles have fallen by exactly the <var>1</var>-st, <var>2</var>-nd, <var>3</var>-rd, <var>4</var>-th, <var>5</var>-th, <var>6</var>-th, <var>7</var>-th, <var>8</var>-th earthquakes are <var>0</var>, <var>\\frac{1}{4}</var>, <var>\\frac{1}{8}</var>, <var>\\frac{3}{16}</var>, <var>\\frac{3}{32}</var>, <var>\\frac{7}{64}</var>, <var>\\frac{7}{64}</var>, <var>\\frac{1}{8}</var>, respectively.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>40 20\n695 793 11 502 114 861 559 4 212 609 894 435 429 94 91 258 161 45 33 605 673 634 629 163 283 826 409 84 507 548 31 248 588 340 357 168 926 949 322 912\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 41942627 41942627 360709869\n</pre>\n<p>Not all poles will have fallen by the <var>37</var>-th earthquake. The probabilities that all poles have fallen by exactly the <var>38</var>, <var>39</var>, <var>40</var>-th earthquakes are <var>\\frac{3}{8}</var>, <var>\\frac{3}{8}</var>, <var>\\frac{1}{4}</var>, respectively.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc177/tasks/arc177_d"}