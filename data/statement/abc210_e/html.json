{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>500</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 個の頂点と <var>0</var> 本の辺からなる無向グラフがあります。\n<var>N</var> 個の頂点をそれぞれ頂点 <var>0</var>、頂点 <var>1</var>、頂点 <var>2</var>、<var>\\ldots</var>、頂点 <var>N-1</var>と呼びます。</p>\n<p>このグラフに対する <var>M</var> 種類の操作を考えます。<br>\n<var>i = 1, 2, \\ldots, M</var> について、<var>i</var> 番目の操作は「 <var>0 \\leq x \\lt N</var> を満たす整数 <var>x</var> を選び、頂点 <var>x</var> と頂点  <var>(x + A_i) \\bmod N</var> を結ぶ無向辺を追加する」という操作です。ただし、<var>a \\bmod b</var> は <var>a</var> を <var>b</var> で割った余りを表します。\n<var>i</var> 番目の操作を <var>1</var> 回行うと <var>C_i</var> 円の費用がかかります。</p>\n<p>あなたは、<var>M</var> 種類の操作をそれぞれ好きな回数（ <var>0</var> 回でもよい）行うことができます。\n例えば、<var>3</var> 種類の操作がある場合、<var>1</var> 番目の操作を <var>2</var> 回、<var>2</var> 番目の操作を <var>0</var> 回、<var>3</var> 番目の操作を <var>1</var> 回行うという選択が可能です。</p>\n<p>グラフを連結にすることが可能かどうかを判定し、可能な場合はそのためにかかる費用の合計として考えられる最小値を求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq N \\leq 10^9</var></li>\n<li><var>1 \\leq M \\leq 10^5</var></li>\n<li><var>1 \\leq A_i \\leq N-1</var></li>\n<li><var>1 \\leq C_i \\leq 10^9</var></li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>A_1</var> <var>C_1</var>\n<var>A_2</var> <var>C_2</var>\n<var>\\vdots</var>\n<var>A_M</var> <var>C_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>グラフを連結にすることが可能な場合は、そのためにかかる費用の合計として考えられる最小値を出力せよ。<br>\nグラフを連結にすることが不可能な場合は、<var>-1</var> を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4 2\n2 3\n3 5\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>11\n</pre>\n<p>まず <var>1</var> 番目の操作で頂点 <var>0</var> と頂点 <var>2</var> を結び、次に <var>1</var> 番目の操作で頂点 <var>1</var> と頂点 <var>3</var> を結び、最後に <var>2</var> 番目の操作で頂点 <var>1</var> と頂点 <var>0</var> を結ぶと、グラフは連結になります。\nかかった費用の合計は <var>3+3+5 = 11</var> 円で、これが考えられる最小値です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>6 1\n3 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>-1\n</pre>\n<p>どのように操作を行ってもグラフを連結にすることができないので、<var>-1</var> を出力します。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>500</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have an undirected graph with <var>N</var> vertices and <var>0</var> edges.\nLet us call the <var>N</var> vertices Vertex <var>0</var>, Vertex <var>1</var>, Vertex <var>2</var>, <var>\\ldots</var>, Vertex <var>N-1</var>.</p>\n<p>Consider <var>M</var> kinds of operations on this graph.<br>\nFor each <var>i = 1, 2, \\ldots, M</var>, the operation of the <var>i</var>-th kind is to choose an integer <var>x</var> such that <var>0 \\leq x \\lt N</var> and add an undirected edge connecting Vertex <var>x</var> and Vertex <var>(x + A_i) \\bmod N</var>. Here, <var>a \\bmod b</var> denotes the remainder when dividing <var>a</var> by <var>b</var>.\nIt costs <var>C_i</var> yen to do the operation of the <var>i</var>-th kind once.</p>\n<p>You can do these <var>M</var> kinds of operations any number of times (possibly zero) in any order. For example, if three kinds of operations are available, you can choose to do the first operation twice, the second zero times, and the third once.</p>\n<p>Determine whether it is possible to make the graph connected. If it is possible, find the minimum total cost needed to do so.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 10^9</var></li>\n<li><var>1 \\leq M \\leq 10^5</var></li>\n<li><var>1 \\leq A_i \\leq N-1</var></li>\n<li><var>1 \\leq C_i \\leq 10^9</var></li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>A_1</var> <var>C_1</var>\n<var>A_2</var> <var>C_2</var>\n<var>\\vdots</var>\n<var>A_M</var> <var>C_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>If it is possible to make the graph connected, print the minimum total cost needed to do so.<br>\nIf it is impossible to make the graph connected, print <var>-1</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4 2\n2 3\n3 5\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>11\n</pre>\n<p>If we first do the operation of the first kind to connect Vertices <var>0</var> and <var>2</var>, then do it again to connect Vertices <var>1</var> and <var>3</var>, and finally the operation of the second kind to connect Vertices <var>1</var> and <var>0</var>, the graph will be connected.\nThe total cost incurred here is <var>3+3+5 = 11</var> yen, which is the minimum possible.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>6 1\n3 4\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>-1\n</pre>\n<p>There is no way to make the graph connected, so we should print <var>-1</var>.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc210/tasks/abc210_e"}