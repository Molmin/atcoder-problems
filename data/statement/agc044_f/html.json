{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>2400</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 人の (名前の異なる) 人がおり、<var>K</var> 個のクラブがあります。あなたは、各クラブの会員をすべて知っています (形式的に言えば、<var>K</var> 個の無順序リストを持っています)。それぞれの人は複数のクラブの会員である可能性も、どのクラブの会員でもない可能性もあります。複数のクラブの会員の集合が全く同じである可能性もあります。\nここで、<var>K</var> の値は、次の条件を満たす会員構成が少なくとも一通り存在するような最小の値となっています。</p>\n<ul>\n<li><var>N</var> 人全員が (全員の名前が異なるという条件を守りながら) 改名して、<var>K</var> 個のクラブの改名後の会員リストがあなたに与えられた (ただし、どの会員リストがどのクラブのものかは知らされない) とする。このとき、あなたは確実に、改名後の <var>N</var> 個の名前すべてについてその名前の人の元の名前を当てることができる。</li>\n</ul>\n<p>このような <var>K</var> 個のクラブの会員構成が何種類存在するか求めてください。ただし、<var>1000</var> 種類を超える場合はその旨を報告してください。\nここで、<var>2</var> 種類の会員構成は、一方において <var>N</var> 人の人が適切に改名することでもう一方が得られるなら同一とみなします。</p>\n<p><strong>厳密な問題文</strong>:\nクラブとは、<var>\\{1,\\dots, N\\}</var> の部分集合 (空である可能性もある) である。(<var>N</var> 人の人に番号 <var>1, 2, \\ldots, N</var> が付けられているとすると、この集合の要素がクラブの会員に対応する。)\n会員構成とは、<var>K</var> 個のクラブ (異なるとは限らない) からなる多重集合である。\n<var>\\{1,\\dots, N\\}</var> の順列 <var>\\sigma(1), \\dots, \\sigma(N)</var> と会員構成 <var>L=\\{C_1, C_2, \\dots, C_K\\}</var> に対し、<var>\\sigma(L)</var> で会員構成 <var>\\{\\sigma(C_1), \\sigma(C_2), \\dots, \\sigma(C_K)\\}</var> を表す (<var>C</var> がクラブであるとき、<var>\\sigma(C)=\\{\\sigma(x):\\, x\\in C\\}</var> である)。\n会員構成 <var>L</var> は、任意の異なる順列 <var>\\sigma\\not=\\tau</var> に対して <var>\\sigma(L)\\not=\\tau(L)</var> を満たすとき、name-preserving であるという。</p>\n<p>name-preserving であってクラブ数 <var>K</var> が最小であるような会員構成の個数を求めよ。ある順列 <var>\\sigma</var> が存在して <var>L_2=\\sigma(L_1)</var> が成立するような <var>2</var> つの会員構成 <var>L_1, L_2</var> は同一とみなす。このような会員構成の個数が <var>1000</var> を超える場合は <var>-1</var> を出力せよ。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\le N \\le 2\\cdot10^{18}</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は標準入力から以下の形式で与えられる。</p>\n<pre><var>N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>問題文で述べたような会員構成が <var>ans</var> 種類存在するとして、以下の形式で標準出力に出力せよ。</p>\n<pre><var>ans</var>\n</pre>\n\n<p>ただし、このような会員構成の数が <var>1000</var> 種類より多い場合は <var>-1</var> を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>1\n</pre>\n\n<p><var>K</var> の値は <var>1</var> で、name-preserving であるような唯一の会員構成は <var>\\{\\{1\\}\\}</var> です (<var>\\{\\{2\\}\\}</var> はこれと同一とみなされます)。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>1\n</pre>\n\n<p><var>K</var> の値は <var>2</var> で、name-preserving であるような唯一の会員構成は <var>\\{\\{1\\}, \\{1, 2\\}\\}</var> です (置換により一致する会員構成を同一視すると、これのみです)。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>7\n</pre>\n\n<p><var>K</var> の値は <var>3</var> で、name-preserving であるような <var>3</var> クラブの会員構成は以下の通りです。</p>\n<ul>\n<li><var>\\{\\{1\\}, \\{2\\}, \\{1, 3\\}\\}</var></li>\n<li><var>\\{\\{1\\}, \\{1, 2\\}, \\{2, 3\\}\\}</var></li>\n<li><var>\\{\\{1, 2\\}, \\{1, 2\\}, \\{1, 3\\}\\}</var></li>\n<li><var>\\{\\{1\\}, \\{1, 2\\}, \\{1, 2, 3\\}\\}</var></li>\n<li><var>\\{\\{1\\}, \\{2, 3\\}, \\{1, 2, 4\\}\\}</var></li>\n<li><var>\\{\\{1, 2\\}, \\{1, 3\\}, \\{1, 2, 4\\}</var></li>\n<li><var>\\{\\{1, 2\\}, \\{1, 2, 3\\}, \\{2, 3, 4\\}\\}</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>13\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>6\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 5</h3><pre>26\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 5</h3><pre>-1\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 6</h3><pre>123456789123456789\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 6</h3><pre>-1\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>2400</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>N</var> people (with different names) and <var>K</var> clubs. For each club you know the list of members (so you have <var>K</var> unordered lists). Each person can be a member of many clubs (and also <var>0</var> clubs) and two different clubs might have exactly the same members.\nThe value of the number <var>K</var> is the minimum possible such that the following property can be true for at least one configuration of clubs.\nIf every person changes her name (maintaining the property that all names are different) and you know the new <var>K</var> lists of members of the clubs (but you don't know which list corresponds to which club), you are sure that you would be able to match the old names with the new ones.</p>\n<p>Count the number of such configurations of clubs (or say that there are more than <var>1000</var>).\nTwo configurations of clubs that can be obtained one from the other if the <var>N</var> people change their names are considered equal.</p>\n<p><strong>Formal statement</strong>:\nA club is a (possibly empty) subset of <var>\\{1,\\dots, N\\}</var> (the subset identifies the members, assuming that the people are indexed by the numbers <var>1, 2,\\dots, N</var>).\nA configuration of clubs is an unordered collection of <var>K</var> clubs (not necessarily distinct).\nGiven a permutation <var>\\sigma(1), \\dots, \\sigma(N)</var> of <var>\\{1,\\dots, N\\}</var> and a configuration of clubs <var>L=\\{C_1, C_2, \\dots, C_K\\}</var>, we denote with <var>\\sigma(L)</var> the configuration of clubs <var>\\{\\sigma(C_1), \\sigma(C_2), \\dots, \\sigma(C_K)\\}</var> (if <var>C</var> is a club,  <var>\\sigma(C)=\\{\\sigma(x):\\, x\\in C\\}</var>).\nA configuration of clubs <var>L</var> is name-preserving if for any pair of distinct permutations <var>\\sigma\\not=\\tau</var>, it holds <var>\\sigma(L)\\not=\\tau(L)</var>.</p>\n<p>You have to count the number of name-preserving configurations of clubs with the minimum possible number of clubs (so <var>K</var> is minimum). Two configurations <var>L_1, L_2</var> such that <var>L_2=\\sigma(L_1)</var> (for some permutation <var>\\sigma</var>) are considered equal.\nIf there are more than <var>1000</var> such configurations, print <var>-1</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\le N \\le 2\\cdot10^{18}</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the format</p>\n<pre><var>N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>If <var>ans</var> is the number of configurations with the properties described in the statement, you should print on Standard Output</p>\n<pre><var>ans</var>\n</pre>\n\n<p>If there are more than <var>1000</var> such configurations, print <var>-1</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>1\n</pre>\n\n<p>The value of <var>K</var> is <var>1</var> and the unique name-preserving configuration of clubs is <var>\\{\\{1\\}\\}</var> (the configuration <var>\\{\\{2\\}\\}</var> is considered the same).</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>1\n</pre>\n\n<p>The value of <var>K</var> is <var>2</var> and the unique (up to permutation) name-preserving configuration of clubs is <var>\\{\\{1\\}, \\{1, 2\\}\\}</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>7\n</pre>\n\n<p>The value of <var>K</var> is <var>3</var> and the name-preserving configurations of clubs with <var>3</var> clubs are:</p>\n<ul>\n<li><var>\\{\\{1\\}, \\{2\\}, \\{1, 3\\}\\}</var></li>\n<li><var>\\{\\{1\\}, \\{1, 2\\}, \\{2, 3\\}\\}</var></li>\n<li><var>\\{\\{1, 2\\}, \\{1, 2\\}, \\{1, 3\\}\\}</var></li>\n<li><var>\\{\\{1\\}, \\{1, 2\\}, \\{1, 2, 3\\}\\}</var></li>\n<li><var>\\{\\{1\\}, \\{2, 3\\}, \\{1, 2, 4\\}\\}</var></li>\n<li><var>\\{\\{1, 2\\}, \\{1, 3\\}, \\{1, 2, 4\\}</var></li>\n<li><var>\\{\\{1, 2\\}, \\{1, 2, 3\\}, \\{2, 3, 4\\}\\}</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>13\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>6\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 5</h3><pre>26\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 5</h3><pre>-1\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 6</h3><pre>123456789123456789\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 6</h3><pre>-1\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc044/tasks/agc044_f"}