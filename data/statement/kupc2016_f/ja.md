配点 : $150$ 点

    
      
        

## 問題文

        

          京都大学で飼育されているゴリラ達は数学が得意である。
          彼らは今、 2 つの関数 `_`、 `^` を含む式の値を求める問題を解いている。
          これらの関数は 2 入力関数であり、 `_` 関数は入力の小さい方の値を、 `^` 関数は大きい方の値を出力する。
          ゴリラ達は、式の中に現れる整数が $0$ 以上 $99$ 以下であることは知っているが、式の長さは終端を表す記号 `?` を読むまでわからない。
          それぞれの式に含まれる文字数は 1000 文字以下であるが、そのことも知らない。
          優等生ゴリラのアイちゃんは、 式を全て読まなくても式の値がわかることがあることに気づいた。
        

        

          例えば、
        

        ```plain
^(41,3)?
```
        

という式を左から順に読んでいくと、 $6$ 文字目まで読んだ時点、 つまり

        ```plain
^(41,3
```
        

まで読んだ時点で、関数の2番目の入力が$3$ もしくは $30$ 以上 $39$ 以下であることがわかるため、式の値は $41$ であることが確定する。

        

          アイちゃんは他のゴリラより早く問題を解きたいので、先頭から１文字ずつ読んでいき、式の値が分かった時点でその問題を読むのをやめることにした。
          それぞれの式について、式の値とアイちゃんが読む必要のある文字数の最小値を求めよ。
        

      
    

    
      
        

## 制約

        

- $1 \leq Q \leq 200$
- それぞれの式に含まれる文字数は $1000$ 以下である。

      
    

    
    
      
        
          

## 入力

          

入力は複数のテストケースからなり、以下の形式で標準入力から与えられる。

> $Q$
> 
> $statement_1$
> 
> ...
> 
> $statement_Q$
        
      
    
    

各 $statement_i$ $(1 \leq i \leq Q)$ は、以下の BNF の形式で与えられる。

$<statement >$ ::= $<expression >$ `?`
$<expression >$ ::= (`^` | `_`)  `(` $<expression >$ `,` $<expression >$ `)` | $<number >$
$<number >$ :: = `0` | `1` | `2` | ... | `98` | `99`

    
      
        
          

## 出力

          

            出力は $Q$ 行からなる。
            $i$ $(1 \leq i \leq Q)$ 行目には $i$ 番目のテストケースにおける式の値と、読む必要のある文字数の最小値を空白区切りで出力せよ。
          

        
      
    
    

    
      
        

## 入力例1

```plain
4
_(4,51)?
^(99,_(3,67))?
_(0,87)?
3?
```
      
    

    
      
        

## 出力例1

```plain
4 5
99 4
0 3
3 2
```
        

- 1 番目の例では、 $5$ 文字目を読んだ時点、つまり `_(4,5` の時点で式の値が $4$ であるとわかる。
- 2 番目の例では、 $4$ 文字目を読んだ時点、つまり `^(99` の時点で式の値が $99$ であるとわかる。
- 3 番目の例では、 $3$ 文字目を読んだ時点、つまり `_(0` の時点で式の値が $0$ であるとわかる。
- 4 番目の例では、 終端記号を読み込むまで式の値が $3$ であるとわからない。

      
    

    
    
      

## 入力例2

```plain
7
_(23,^(_(22,40),4))?
_(0,99)?
^(99,_(^(19,2),5))?
_(^(43,20),^(30,29))?
^(_(20,3),_(50,41))?
^(_(20,3),_(3,41))?
^(_(20,3),_(4,41))?
```
      
    

    
      
        

## 出力例2

```plain
22 18
0 3
99 4
30 17
41 17
3 14
4 15
```