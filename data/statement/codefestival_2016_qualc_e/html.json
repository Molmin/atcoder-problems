{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1200</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>ある日高橋君は、<var>1</var>~<var>N</var> からなる <var>N!</var> 個の順列全てが載っている辞書を拾いました。辞書は <var>N!</var> ページからなり、 <var>i (1≦i≦N!)</var> ページ目には辞書順 <var>i</var> 番目の順列が載っています。高橋君はこの辞書で長さ <var>N</var> のある順列を調べようとしましたが、順列の一部の数は忘れてしまいました。そのため、可能性のある順列全てをこの辞書で調べようとしています。高橋くんが調べる必要のあるページ番号の総和を <var>10^9+7</var> で割ったあまりを求めてください。</p>\n<p>順列の情報は <var>P_1</var>,<var>P_2</var>,<var>...</var>,<var>P_N</var> で与えられます。<var>P_i=0</var> の時は順列の <var>i</var> 番目の数を忘れてしまったことを、そうでない場合は順列の <var>i</var> 番目の数が <var>P_i</var> であることを意味します。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1≦N≦500000</var></li>\n<li><var>0≦P_i≦N</var></li>\n<li><var>i≠j (1≦i,j≦N)</var> かつ <var>P_i≠0</var> かつ <var>P_j≠0</var> ならば、 <var>P_i≠P_j</var></li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>部分点</h3><ul>\n<li><var>1≦N≦3000</var> を満たすデータセットに正解すると、<var>500</var> 点が与えられる。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>P_1</var> <var>P_2</var> <var>...</var> <var>P_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>高橋くんが調べる必要のあるページ番号の総和を <var>10^9+7</var> で割ったあまりを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4\n0 2 3 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>23\n</pre>\n\n<p>ありうる順列は<var>[1,2,3,4]</var>と<var>[4,2,3,1]</var>です。前者は<var>1</var>ページ目に、後者は<var>22</var>ページ目に載っているため、答えは<var>23</var>です。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3\n0 0 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>21\n</pre>\n\n<p>長さ<var>3</var>の全ての順列がありうるので、答えは<var>1+2+3+4+5+6 = 21</var> になります。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>5\n1 2 3 5 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>2\n</pre>\n\n<p>高橋君は完全に順列を記憶しています。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>1\n0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>1\n</pre>\n\n<p>辞書は<var>1</var>ページからなります。</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 5</h3><pre>10\n0 3 0 0 1 0 4 0 0 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 5</h3><pre>953330050\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1200</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>One day Mr. Takahashi picked up a dictionary containing all of the <var>N</var>! permutations of integers <var>1</var> through <var>N</var>.\nThe dictionary has <var>N</var>! pages, and page <var>i</var> (<var>1 ≤ i ≤ N!</var>) contains the <var>i</var>-th permutation in the lexicographical order.</p>\n<p>Mr. Takahashi wanted to look up a certain permutation of length <var>N</var> in this dictionary, but he forgot some part of it.</p>\n<p>His memory of the permutation is described by a sequence <var>P_1, P_2, ..., P_N</var>.\nIf <var>P_i = 0</var>, it means that he forgot the <var>i</var>-th element of the permutation; otherwise, it means that he remembered the <var>i</var>-th element of the permutation and it is <var>P_i</var>.</p>\n<p>He decided to look up all the possible permutations in the dictionary.\nCompute the sum of the page numbers of the pages he has to check, modulo <var>10^9 + 7</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 ≤ N ≤ 500000</var></li>\n<li><var>0 ≤ P_i ≤ N</var></li>\n<li><var>P_i ≠ P_j</var> if <var>i ≠ j</var> (<var>1 ≤ i, j ≤ N</var>), <var>P_i ≠ 0</var> and <var>P_j ≠ 0</var>.</li>\n</ul>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Partial Score</h3><ul>\n<li>In test cases worth <var>500</var> points, <var>1 ≤ N ≤ 3000</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>P_1</var> <var>P_2</var> <var>...</var> <var>P_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the sum of the page numbers of the pages he has to check, as modulo <var>10^9 + 7</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4\n0 2 3 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>23\n</pre>\n\n<p>The possible permutations are [<var>1</var>, <var>2</var>, <var>3</var>, <var>4</var>] and [<var>4</var>, <var>2</var>, <var>3</var>, <var>1</var>].\nSince the former is on page <var>1</var> and the latter is on page <var>22</var>, the answer is <var>23</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3\n0 0 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>21\n</pre>\n\n<p>Since all permutations of length <var>3</var> are possible, the answer is <var>1 + 2 + 3 + 4 + 5 + 6 = 21</var>.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>5\n1 2 3 5 4\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>2\n</pre>\n\n<p>Mr. Takahashi remembered all the elements of the permutation.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>1\n0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>1\n</pre>\n\n<p>The dictionary consists of one page.</p>\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 5</h3><pre>10\n0 3 0 0 1 0 4 0 0 0\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 5</h3><pre>953330050\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/code-festival-2016-qualc/tasks/codefestival_2016_qualc_e"}