{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>475</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 台のルーレットがあります。\n<var>i</var> 番目 <var>(1\\leq i\\leq N)</var> のルーレットには <var>P _ i</var> 個の整数 <var>S _ {i,1},S _ {i,2},\\ldots,S _ {i,P _ i}</var> が書かれており、<var>C _ i</var> 円支払うことで <var>1</var> 回プレイできます。\n<var>i</var> 番目のルーレットを <var>1</var> 回プレイすると、<var>1</var> 以上 <var>P _ i</var> 以下の整数 <var>j</var> が一様ランダムに選ばれ、<var>S _ {i,j}</var> ポイントを得ることができます。</p>\n<p>ルーレットで得られるポイントは、過去の結果と独立に決まります。</p>\n<p>高橋くんは、ポイントを <var>M</var> ポイント以上獲得したいです。\n高橋くんは、<var>M</var> ポイント以上獲得するまでに支払う金額をなるべく小さくするように行動します。\nただし、高橋くんはルーレットをプレイするたびこれまでのルーレットの結果を見て次にプレイするルーレットを選ぶことができます。</p>\n<p>高橋くんがポイントを <var>M</var> ポイント以上獲得するまでに支払う金額の期待値を求めてください。</p>\n<details><summary>より厳密な定義</summary>\n\n<p>より厳密には、次のようになります。\n高橋くんがルーレットを選ぶ戦略を決めるごとに、その戦略で <var>M</var> ポイント以上獲得するまでに支払う金額の期待値 <var>E</var> が次のように定義されます。</p>\n<ul>\n<li>自然数 <var>X</var> に対して、その戦略に従って高橋くんが <var>M</var> ポイント以上獲得するか、ルーレットを <var>X</var> 回プレイするまでに支払う金額の期待値を <var>f(X)</var> とする。<var>E=\\displaystyle\\lim _ {X\\to+\\infty}f(X)</var> とする。</li>\n</ul>\n\n<p>この問題の条件のもとで、高橋くんがどのような戦略をとっても <var>\\displaystyle\\lim _ {X\\to+\\infty}f(X)</var> が有限の値になることが証明できます。\n高橋くんが <var>E</var> を最小にするような戦略をとったときの <var>E</var> の値を求めてください。</p>\n\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1\\leq N\\leq 100</var></li>\n<li><var>1\\leq M\\leq 100</var></li>\n<li><var>1\\leq C _ i\\leq 10 ^ 4\\ (1\\leq i\\leq N)</var></li>\n<li><var>1\\leq P _ i\\leq 100\\ (1\\leq i\\leq N)</var></li>\n<li><var>0\\leq S _ {i,j}\\leq M\\ (1\\leq i\\leq N,1\\leq j\\leq P _ i)</var></li>\n<li><var>\\displaystyle\\sum _ {j=1}^{P _ i}S _ {i,j}\\gt0\\ (1\\leq i\\leq N)</var></li>\n<li>入力はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var>\n<var>C _ 1</var> <var>P _ 1</var> <var>S _ {1,1}</var> <var>S _ {1,2}</var> <var>\\ldots</var> <var>S _ {1,P _ 1}</var>\n<var>C _ 2</var> <var>P _ 2</var> <var>S _ {2,1}</var> <var>S _ {2,2}</var> <var>\\ldots</var> <var>S _ {2,P _ 2}</var>\n<var>\\vdots</var>\n<var>C _ N</var> <var>P _ N</var> <var>S _ {N,1}</var> <var>S _ {N,2}</var> <var>\\ldots</var> <var>S _ {N,P _ N}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>高橋くんが <var>M</var> ポイント以上獲得するまでに支払う金額の期待値を <var>1</var> 行で出力せよ。\n出力された値と真の値の相対誤差もしくは絶対誤差が <var>10 ^ {-5}</var> 以下のとき、正答と判定される。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 14\n100 2 5 9\n50 4 1 2 4 8\n70 5 2 4 2 8 8\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>215.913355350494384765625\n</pre>\n<p>例えば、高橋くんはルーレットを次のようにプレイすることができます。</p>\n<ul>\n<li><var>50</var> 円を支払ってルーレット <var>2</var> をプレイする。<var>S _ {2,4}=8</var> ポイントを得る。</li>\n<li><var>50</var> 円を支払ってルーレット <var>2</var> をプレイする。<var>S _ {2,1}=1</var> ポイントを得る。</li>\n<li><var>100</var> 円を支払ってルーレット <var>1</var> をプレイする。<var>S _ {1,1}=5</var> ポイントを得る。得たポイントの合計が <var>8+1+5\\geq14</var> ポイントとなったため、終了する。</li>\n</ul>\n<p>この例では、<var>14</var> ポイントを得るまでに <var>200</var> 円を支払っています。</p>\n<p>出力と真の値の相対誤差もしくは絶対誤差が <var>10 ^ {-5}</var> 以下のとき正答と判定されるため、<code>215.9112</code> や <code>215.9155</code> などと出力しても正解になります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>2 100\n1 2 1 2\n10 6 0 0 0 0 0 100\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>60\n</pre>\n<p><var>100</var> ポイントが出るまでルーレット <var>2</var> を回し続けるのが最適です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>20 90\n3252 9 0 4 2 7 3 2 3 2 4\n2147 1 1\n4033 8 0 4 1 7 5 2 5 0\n3795 6 6 6 2 3 2 2\n3941 7 2 4 4 7 2 0 5\n2815 6 2 1 0 5 2 2\n3020 2 3 6\n3858 9 4 2 7 3 0 4 4 6 5\n4533 10 3 6 4 0 6 4 4 2 7 7\n4198 8 6 7 0 6 3 6 5 6\n3739 8 2 7 1 5 1 4 4 7\n2465 4 1 4 0 1\n4418 9 7 6 2 4 6 1 5 0 7\n5450 12 0 4 4 7 7 4 4 5 4 5 3 7\n4196 9 1 6 5 5 7 2 3 6 3\n4776 9 2 2 7 3 6 6 1 6 6\n2286 3 3 5 6\n3152 3 4 1 5\n3509 7 0 6 7 0 1 0 3\n2913 6 0 1 5 0 5 6\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>45037.072314895291126319493887599716\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>475</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>There are <var>N</var> roulette wheels.\nThe <var>i</var>-th <var>(1\\leq i\\leq N)</var> wheel has <var>P _ i</var> integers <var>S _ {i,1},S _ {i,2},\\ldots,S _ {i,P _ i}</var> written on it, and you can play it once by paying <var>C _ i</var> yen.\nWhen you play the <var>i</var>-th wheel once, an integer <var>j</var> between <var>1</var> and <var>P _ i</var>, inclusive, is chosen uniformly at random, and you earn <var>S _ {i,j}</var> points.</p>\n<p>The points you earn from the wheels are determined independently of past results.</p>\n<p>Takahashi wants to earn at least <var>M</var> points.\nTakahashi will act to minimize the amount of money he pays before he earns at least <var>M</var> points.\nAfter each play, he can choose which wheel to play next based on the previous results.</p>\n<p>Find the expected amount of money Takahashi will pay before he earns at least <var>M</var> points.</p>\n<details><summary>More formal definition</summary>\n\n<p>Here is a more formal statement.\nFor a strategy that Takahashi can adopt in choosing which wheel to play, the expected amount of money <var>E</var> that he pays before he earns at least <var>M</var> points with that strategy is defined as follows.</p>\n<ul>\n<li>For a natural number <var>X</var>, let <var>f(X)</var> be the expected amount of money Takahashi pays before he earns at least <var>M</var> points or plays the wheels <var>X</var> times in total according to that strategy. Let <var>E=\\displaystyle\\lim _ {X\\to+\\infty}f(X)</var>.</li>\n</ul>\n\n<p>Under the conditions of this problem, it can be proved that <var>\\displaystyle\\lim _ {X\\to+\\infty}f(X)</var> is finite no matter what strategy Takahashi adopts.\nFind the value of <var>E</var> when he adopts a strategy that minimizes <var>E</var>.</p>\n\n</details>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1\\leq N\\leq 100</var></li>\n<li><var>1\\leq M\\leq 100</var></li>\n<li><var>1\\leq C _ i\\leq 10 ^ 4\\ (1\\leq i\\leq N)</var></li>\n<li><var>1\\leq P _ i\\leq 100\\ (1\\leq i\\leq N)</var></li>\n<li><var>0\\leq S _ {i,j}\\leq M\\ (1\\leq i\\leq N,1\\leq j\\leq P _ i)</var></li>\n<li><var>\\displaystyle\\sum _ {j=1}^{P _ i}S _ {i,j}\\gt0\\ (1\\leq i\\leq N)</var></li>\n<li>All input values are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var>\n<var>C _ 1</var> <var>P _ 1</var> <var>S _ {1,1}</var> <var>S _ {1,2}</var> <var>\\ldots</var> <var>S _ {1,P _ 1}</var>\n<var>C _ 2</var> <var>P _ 2</var> <var>S _ {2,1}</var> <var>S _ {2,2}</var> <var>\\ldots</var> <var>S _ {2,P _ 2}</var>\n<var>\\vdots</var>\n<var>C _ N</var> <var>P _ N</var> <var>S _ {N,1}</var> <var>S _ {N,2}</var> <var>\\ldots</var> <var>S _ {N,P _ N}</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the expected amount of money Takahashi will pay until he earns at least <var>M</var> points in a single line.\nYour output will be considered correct when the relative or absolute error from the true value is at most <var>10 ^ {-5}</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 14\n100 2 5 9\n50 4 1 2 4 8\n70 5 2 4 2 8 8\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>215.913355350494384765625\n</pre>\n<p>For instance, Takahashi can play the wheels as follows.</p>\n<ul>\n<li>Pay <var>50</var> yen to play roulette <var>2</var> and earn <var>S _ {2,4}=8</var> points.</li>\n<li>Pay <var>50</var> yen to play roulette <var>2</var> and earn <var>S _ {2,1}=1</var> point.</li>\n<li>Pay <var>100</var> yen to play roulette <var>1</var> and earn <var>S _ {1,1}=5</var> points. He has earned a total of <var>8+1+5\\geq14</var> points, so he quits playing.</li>\n</ul>\n<p>In this case, he pays <var>200</var> yen before earning <var>14</var> points.</p>\n<p>Your output will be considered correct when the relative or absolute error from the true value is at most <var>10 ^ {-5}</var>, so outputs such as <code>215.9112</code> and <code>215.9155</code> would also be considered correct.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>2 100\n1 2 1 2\n10 6 0 0 0 0 0 100\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>60\n</pre>\n<p>It is optimal to keep spinning roulette <var>2</var> until you get <var>100</var> points.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>20 90\n3252 9 0 4 2 7 3 2 3 2 4\n2147 1 1\n4033 8 0 4 1 7 5 2 5 0\n3795 6 6 6 2 3 2 2\n3941 7 2 4 4 7 2 0 5\n2815 6 2 1 0 5 2 2\n3020 2 3 6\n3858 9 4 2 7 3 0 4 4 6 5\n4533 10 3 6 4 0 6 4 4 2 7 7\n4198 8 6 7 0 6 3 6 5 6\n3739 8 2 7 1 5 1 4 4 7\n2465 4 1 4 0 1\n4418 9 7 6 2 4 6 1 5 0 7\n5450 12 0 4 4 7 7 4 4 5 4 5 3 7\n4196 9 1 6 5 5 7 2 3 6 3\n4776 9 2 2 7 3 6 6 1 6 6\n2286 3 3 5 6\n3152 3 4 1 5\n3509 7 0 6 7 0 1 0 3\n2913 6 0 1 5 0 5 6\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>45037.072314895291126319493887599716\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc314/tasks/abc314_e"}