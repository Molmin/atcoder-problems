{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>高橋くんは <var>H</var> 行 <var>W</var> 列のマスからなるスケートリンクにいます。\n北から <var>r</var> 行目、西から <var>c</var> 列目をマス <var>(r, c)</var> と表すことにします。\n各マスは氷または地面であり、マス <var>(r, c)</var> は <var>S_{r, c}</var> が  <code>#</code> であるときは地面、<code>.</code> であるときは氷です。\nスケートリンクの外側は壁で覆われています。</p>\n<p>高橋くんは、スケートリンク上で静止しているとき、東西南北のいずれかに移動を開始することができます。\n移動開始後、高橋くんは同じ方向に動き続け、壁にぶつかるか、（移動を開始したマス以外の）地面のマスの <em>上</em> にたどりついたときに静止します。</p>\n<p>以下の条件を満たす時、「 マス <var>(r, c)</var> から見て、スケートリンクは無駄がない」と言います:</p>\n<ul>\n<li>高橋くんがマス <var>(r, c)</var> で静止している状態から、うまく移動を繰り返すことによって、全てのマスを <em>通過</em> することができる。（各マスの上で静止できるかどうかは問わない。）</li>\n</ul>\n<p>高橋くんはどのマスから見てもスケートリンクに無駄がないようにするために、いくつかの氷のマスを地面のマスに変更したいです。\n最小でいくつのマスを変更すればよいか求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2\\le H,W \\le 1000</var></li>\n<li><var>S_{r,c}</var> は <code>#</code> または <code>.</code></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>H</var> <var>W</var>\n<var>S_{1,1}\\dots S_{1,W}</var>\n<var>\\vdots</var>\n<var>S_{H,1}\\dots S_{H,W}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>どのマスから見てもスケートリンクに無駄がないようにするために変更する必要のあるマスの数の最小値を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 9\n.........\n.........\n.........\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>1\n</pre>\n\n<p>最初の状態では、マス <var>(1,1)</var> から始めてマス <var>(2,2)</var> を通過することができません。\n例えば以下のように変更すれば条件を満たせます。</p>\n<pre>.........\n........#\n.........\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>10 10\n..........\n#...#.....\n..........\n..........\n..........\n....#.....\n.#......#.\n..........\n..........\n..........\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>6\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Takahashi is on a skating rink consisting of <var>H</var> rows and <var>W</var> columns of squares.\nLet <var>(r, c)</var> denote the square at the <var>r</var>-th row from the north and <var>c</var>-th column from the west.\nEach square is ice or ground; <var>(r, c)</var> is ground if <var>S_{r, c}</var> is <code>#</code> and ice if <var>S_{r, c}</var> is <code>.</code>.\nThere are walls around the rink.</p>\n<p>When Takahashi is standing still on the rink, he can start moving to the east, west, south, or north.\nAfter he starts moving, he will keep moving in the same direction, until he bumps into a wall or he is <em>on</em> a ground square (other than the square where he started moving).</p>\n<p>We say the rink is efficient for <var>(r, c)</var> when the following condition is satisfied:</p>\n<ul>\n<li>There is a sequence of moves that starts at <var>(r, c)</var>, standing still, and <em>passes</em> every square. (It is not required to stop on each square.)</li>\n</ul>\n<p>Takahashi wants to change some number of ice squares to ground squares so that the rink is efficient for every square.\nHow many squares does he need to change, at least?</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2\\le H,W \\le 1000</var></li>\n<li><var>S_{r,c}</var> is <code>#</code> or <code>.</code>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>H</var> <var>W</var>\n<var>S_{1,1}\\dots S_{1,W}</var>\n<var>\\vdots</var>\n<var>S_{H,1}\\dots S_{H,W}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the minimum number of changes needed to make the rink efficient for every square.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 9\n.........\n.........\n.........\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>1\n</pre>\n\n<p>Initially, it is impossible to start at <var>(1, 1)</var> and pass <var>(2, 2)</var>.\nOne way to meet the objective is to change the rink as follows:</p>\n<pre>.........\n........#\n.........\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>10 10\n..........\n#...#.....\n..........\n..........\n..........\n....#.....\n.#......#.\n..........\n..........\n..........\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>6\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc112/tasks/arc112_d"}