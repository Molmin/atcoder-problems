{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>2^N</var> 人の選手でトーナメント戦を行いました。\n各選手には <var>1</var> 〜 <var>2^N</var> の番号がついており、<var>2</var> 人が対戦したときは番号が小さい方の選手が必ず勝ちます。</p>\n<p>行ったトーナメント戦は少し変わっていて、敗者どうしも対戦をすることで全員の順位を決めるものでした。</p>\n<p>ここで、<var>2^n</var> 人で行うこのようなトーナメント戦を「レベル <var>n</var> のフルトーナメント」と呼ぶことにします。\nレベル <var>n</var> のフルトーナメントの順位は以下のように決定されます。</p>\n<ul>\n<li>レベル <var>0</var> のフルトーナメントでは参加者が <var>1</var> 人であり、この人が <var>1</var> 位となる。</li>\n<li>レベル <var>n\\ (1 \\leq n)</var> のフルトーナメントは、<var>2^n</var> 人の選手が横 <var>1</var> 列に並んだ状態から始まり、以下のように順位を決定する。</li>\n<li>まず、端から <var>2</var> 人ずつに区切り、<var>2^{n-1}</var> 組の <var>2</var> 人組を作る。</li>\n<li>それぞれの <var>2</var> 人組で対戦を行い、勝った方が勝ちグループに、負けた方が負けグループに入る。</li>\n<li>勝ちグループに入った選手を元の列での順序を保ったまま並べ、レベル <var>n-1</var> のフルトーナメントを行い、各選手の順位を決定する。</li>\n<li>負けグループについても同様に順位をつけ、その後に負けグループの各選手の順位に <var>2^{n-1}</var> を足す。</li>\n</ul>\n<p>例えば、<var>8</var> 人の選手を <var>3,4,8,6,2,1,7,5</var> の順に並べてレベル <var>3</var> のフルトーナメントを行うと下図のようにトーナメントが行われ、結果の順位順に選手を並べると <var>1,3,5,6,2,4,7,8</var> となります。</p>\n<div style=\"text-align: center;\">\n<img alt=\"e93269f0dfb68bcdff175a3b634ab0d8.png\" src=\"https://img.atcoder.jp/cf17-final/e93269f0dfb68bcdff175a3b634ab0d8.png\">\n</div>\n\n<p>高橋君は、選手の番号をトーナメントの結果の順位順に書いた紙を持っていましたが、いくつかの場所が汚れて読めなくなってしまいました。\nこの紙の情報は長さ <var>N</var> の数列 <var>A</var> として与えられ、<var>A_i</var> が <var>1</var> 以上のときは <var>i</var> 位の選手の番号が <var>A_i</var> であったことを表し、<var>0</var> のときは <var>i</var> 位の選手の番号が分からなくなってしまったことを表します。</p>\n<p>最初の選手の並び順として考えられるものが存在するかどうかを判定し、存在するならば例を <var>1</var> つ答えてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 18</var></li>\n<li><var>0 \\leq A_i \\leq 2^N</var></li>\n<li><var>A_i</var> には <var>0</var> 以外の整数は重複して含まれていない。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>A_1</var> <var>A_2</var> <var>...</var> <var>A_{2^N}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>最初の選手の並び順として考えられるものが存在する場合は <code>YES</code> と出力し、<var>2</var> 行目に選手の番号を順番に空白区切りで出力せよ。\n存在しない場合は代わりに <code>NO</code> と出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\n0 3 0 6 0 0 0 8\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>YES\n3 4 8 6 2 1 7 5\n</pre>\n\n<p>問題文中の例と同じ並び順です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>1\n2 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>NO\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p><var>2^N</var> players competed in a tournament.\nEach player has a unique ID number from <var>1</var> through <var>2^N</var>. When two players play a match, the player with the smaller ID always wins.</p>\n<p>This tournament was a little special, in which losers are not eliminated to fully rank all the players.</p>\n<p>We will call such a tournament that involves <var>2^n</var> players a <em>full tournament of level <var>n</var></em>.\nIn a full tournament of level <var>n</var>, the players are ranked as follows:</p>\n<ul>\n<li>In a full tournament of level <var>0</var>, the only player is ranked first.</li>\n<li>In a full tournament of level <var>n\\ (1 \\leq n)</var>, initially all <var>2^n</var> players are lined up in a row. Then:</li>\n<li>First, starting from the two leftmost players, the players are successively divided into <var>2^{n-1}</var> pairs of two players.</li>\n<li>Each of the pairs plays a match. The winner enters the \"Won\" group, and the loser enters the \"Lost\" group.</li>\n<li>The players in the \"Won\" group are lined up in a row, maintaining the relative order in the previous row. Then, a full tournament of level <var>n-1</var> is held to fully rank these players.</li>\n<li>The players in the \"Lost\" group are also ranked in the same manner, then the rank of each of these players increases by <var>2^{n-1}</var>.</li>\n</ul>\n<p>For example, the figure below shows how a full tournament of level <var>3</var> progresses when eight players are lined up in the order <var>3,4,8,6,2,1,7,5</var>. The list of the players sorted by the final ranking will be <var>1,3,5,6,2,4,7,8</var>.</p>\n<p><img alt=\"\" src=\"https://img.atcoder.jp/cf17-final/e93269f0dfb68bcdff175a3b634ab0d8.png\"></p>\n<p>Takahashi has a sheet of paper with the list of the players sorted by the final ranking in the tournament, but some of it blurred and became unreadable.\nYou are given the information on the sheet as a sequence <var>A</var> of length <var>N</var>. When <var>A_i</var> is <var>1</var> or greater, it means that the <var>i</var>-th ranked player had the ID <var>A_i</var>. If <var>A_i</var> is <var>0</var>, it means that the ID of the <var>i</var>-th ranked player is lost.</p>\n<p>Determine whether there exists a valid order in the first phase of the tournament which is consistent with the sheet. If it exists, provide one such order.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 18</var></li>\n<li><var>0 \\leq A_i \\leq 2^N</var></li>\n<li>No integer, except <var>0</var>, occurs more than once in <var>A_i</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>A_1</var> <var>A_2</var> <var>...</var> <var>A_{2^N}</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>If there exists a valid order in the first phase of the tournament, print <code>YES</code> first, then in the subsequent line, print the IDs of the players sorted by the final ranking, with spaces in between.\nIf there is no such order, print <code>NO</code> instead.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n0 3 0 6 0 0 0 8\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>YES\n3 4 8 6 2 1 7 5\n</pre>\n\n<p>This is the same order as the one in the statement.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>1\n2 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>NO\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/cf17-final/tasks/cf17_final_i"}