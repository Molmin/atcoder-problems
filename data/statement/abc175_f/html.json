{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p>英小文字から成る <var>N</var> 個の文字列 <var>S_1, S_2, \\cdots, S_N</var> があります。</p>\n<p>高橋君はまずこれらの文字列から重複を許して合計 <var>1</var> 個以上選んだ後、選んだ文字列を好きな順番で連結することで、回文であるような文字列を作ろうとしています。</p>\n<p>文字列 <var>S_i</var> を <var>1</var> 個使うにはコストが <var>C_i</var> かかり、同じ文字列であっても使った個数の分だけコストがかかります。</p>\n<p>上述の方法で回文を作ることのできるように文字列を選ぶ方法のうち、コストの和としてありうる値の最小値を求めてください。</p>\n<p>また、どのように選んでも回文を作ることが不可能である場合は <var>-1</var> を出力してください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N \\leq 50</var></li>\n<li><var>1 \\leq |S_i| \\leq 20</var></li>\n<li><var>S_i</var> は英小文字から成る</li>\n<li><var>1 \\leq C_i \\leq 10^9</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>S_1</var> <var>C_1</var>\n<var>S_2</var> <var>C_2</var>\n<var>:</var>\n<var>S_N</var> <var>C_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>回文を作ることのできるように文字列を選ぶ方法のうち、コストの和としてありうる値の最小値を出力せよ。不可能である場合は <var>-1</var> を出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3\nba 3\nabc 4\ncbaa 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>7\n</pre>\n\n<p><code>ba</code>, <code>abc</code>, <code>cbaa</code> があります。</p>\n<p>例えば、<code>ba</code>, <code>abc</code> を <var>1</var> 個ずつ使うとコストは <var>7</var> で、<code>abc</code>, <code>ba</code> の順で連結すると回文になります。\nまた、<code>abc</code>, <code>cbaa</code> を <var>1</var> 個ずつ使うとコストは <var>9</var> で、<code>cbaa</code>, <code>abc</code> の順で連結すると回文になります。</p>\n<p>コスト <var>7</var> 未満で回文を作ることはできないので、<var>7</var> を出力してください。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>2\nabcab 5\ncba 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>11\n</pre>\n\n<p><code>abcab</code> を <var>1</var> 個、<code>cba</code> を <var>2</var> 個選んで、<code>abcab</code>, <code>cba</code>, <code>cba</code> の順で連結すると回文になり、コストは <var>11</var> です。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>4\nab 5\ncba 3\na 12\nab 10\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>8\n</pre>\n\n<p><code>a</code> を <var>1</var> 個だけ選んで回文とすることもできますが、<code>ab</code> と <code>cba</code> を選んで連結する方がコストが小さいです。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>2\nabc 1\nab 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>-1\n</pre>\n\n<p>回文を作ることが不可能であるので、<var>-1</var> を出力してください。</p></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have <var>N</var> strings of lowercase English letters: <var>S_1, S_2, \\cdots, S_N</var>.</p>\n<p>Takahashi wants to make a string that is a palindrome by choosing one or more of these strings - the same string can be chosen more than once - and concatenating them in some order of his choice.</p>\n<p>The cost of using the string <var>S_i</var> once is <var>C_i</var>, and the cost of using it multiple times is <var>C_i</var> multiplied by that number of times.</p>\n<p>Find the minimum total cost needed to choose strings so that Takahashi can make a palindrome.</p>\n<p>If there is no choice of strings in which he can make a palindrome, print <var>-1</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N \\leq 50</var></li>\n<li><var>1 \\leq |S_i| \\leq 20</var></li>\n<li><var>S_i</var> consists of lowercase English letters.</li>\n<li><var>1 \\leq C_i \\leq 10^9</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>S_1</var> <var>C_1</var>\n<var>S_2</var> <var>C_2</var>\n<var>:</var>\n<var>S_N</var> <var>C_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the minimum total cost needed to choose strings so that Takahashi can make a palindrome, or <var>-1</var> if there is no such choice.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\nba 3\nabc 4\ncbaa 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>7\n</pre>\n\n<p>We have <code>ba</code>, <code>abc</code>, and <code>cbaa</code>.</p>\n<p>For example, we can use <code>ba</code> once and <code>abc</code> once for a cost of <var>7</var>, then concatenate them in the order <code>abc</code>, <code>ba</code> to make a palindrome.\nAlso, we can use <code>abc</code> once and <code>cbaa</code> once for a cost of <var>9</var>, then concatenate them in the order <code>cbaa</code>, <code>abc</code> to make a palindrome.</p>\n<p>We cannot make a palindrome for a cost less than <var>7</var>, so we should print <var>7</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>2\nabcab 5\ncba 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>11\n</pre>\n\n<p>We can choose <code>abcab</code> once and <code>cba</code> twice, then concatenate them in the order <code>abcab</code>, <code>cba</code>, <code>cba</code> to make a palindrome for a cost of <var>11</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>4\nab 5\ncba 3\na 12\nab 10\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>8\n</pre>\n\n<p>We can choose <code>a</code> once, which is already a palindrome, but it is cheaper to concatenate <code>ab</code> and <code>cba</code>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>2\nabc 1\nab 2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>-1\n</pre>\n\n<p>We cannot make a palindrome, so we should print <var>-1</var>.</p></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc175/tasks/abc175_f"}