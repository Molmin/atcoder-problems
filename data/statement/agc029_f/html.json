{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>2200</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>\\{1,2,...,N\\}</var> の部分集合が <var>N-1</var> 個与えられます。<var>i</var> 番目の集合を <var>E_i</var> とします。</p>\n<p>各集合 <var>E_i</var> から相異なる <var>2</var> 要素 <var>u_i,v_i</var> を選び、<var>\\{1,2,..,N\\}</var> を頂点集合、\n<var>(u_1,v_1),(u_2,v_2),...,(u_{N-1},v_{N-1})</var> を辺集合とするような、<var>N</var> 頂点 <var>N-1</var> 辺グラフ <var>T</var> を考えます。\nうまく <var>u_i,v_i</var> を定めることにより、<var>T</var> を木にすることができるかどうか判定してください。\nさらに可能な場合は、<var>T</var> が実際に木となるような <var>(u_1,v_1),(u_2,v_2),...,(u_{N-1},v_{N-1})</var> を一つ求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\leq N \\leq 10^5</var></li>\n<li><var>E_i</var> は <var>\\{1,2,..,N\\}</var> の部分集合である。</li>\n<li><var>|E_i| \\geq 2</var></li>\n<li><var>|E_i|</var> の和は <var>2 \\times 10^5</var> 以下である。</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>c_1</var> <var>w_{1,1}</var> <var>w_{1,2}</var> <var>...</var> <var>w_{1,c_1}</var>\n<var>:</var>\n<var>c_{N-1}</var> <var>w_{N-1,1}</var> <var>w_{N-1,2}</var> <var>...</var> <var>w_{N-1,c_{N-1}}</var>\n</pre>\n<p>ただし、<var>c_i</var> は <var>E_i</var> の要素数を指し、<var>w_{i,1},...,w_{i,c_i}</var> は <var>E_i</var> の <var>c_i</var> 個の元である。\nまた、<var>2 \\leq c_i \\leq N</var>, <var>1 \\leq w_{i,j} \\leq N</var>, <var>w_{i,j} \\neq w_{i,k}</var> (<var>1 \\leq j &lt; k \\leq c_i</var>) である。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>T</var> を木とすることができない場合は <code>-1</code> を出力せよ。そうでない場合は以下の形式に従って条件を満たす <var>(u_i,v_i)</var> を出力せよ。</p>\n<pre><var>u_1</var> <var>v_1</var>\n<var>:</var>\n<var>u_{N-1}</var> <var>v_{N-1}</var>\n</pre>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>5\n2 1 2\n3 1 2 3\n3 3 4 5\n2 4 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>1 2\n1 3\n3 4\n4 5\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>6\n3 1 2 3\n3 2 3 4\n3 1 3 4\n3 1 2 4\n3 4 5 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>-1\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>10\n5 1 2 3 4 5\n5 2 3 4 5 6\n5 3 4 5 6 7\n5 4 5 6 7 8\n5 5 6 7 8 9\n5 6 7 8 9 10\n5 7 8 9 10 1\n5 8 9 10 1 2\n5 9 10 1 2 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>2200</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>You are given <var>N-1</var> subsets of <var>\\{1,2,...,N\\}</var>. Let the <var>i</var>-th set be <var>E_i</var>.</p>\n<p>Let us choose two distinct elements <var>u_i</var> and <var>v_i</var> from each set <var>E_i</var>, and consider a graph <var>T</var> with <var>N</var> vertices and <var>N-1</var> edges, whose vertex set is <var>\\{1,2,..,N\\}</var> and whose edge set is <var>(u_1,v_1),(u_2,v_2),...,(u_{N-1},v_{N-1})</var>.\nDetermine if <var>T</var> can be a tree by properly deciding <var>u_i</var> and <var>v_i</var>.\nIf it can, additionally find one instance of <var>(u_1,v_1),(u_2,v_2),...,(u_{N-1},v_{N-1})</var> such that <var>T</var> is actually a tree.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\leq N \\leq 10^5</var></li>\n<li><var>E_i</var> is a subset of <var>\\{1,2,..,N\\}</var>.</li>\n<li><var>|E_i| \\geq 2</var></li>\n<li>The sum of <var>|E_i|</var> is at most <var>2 \\times 10^5</var>.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>c_1</var> <var>w_{1,1}</var> <var>w_{1,2}</var> <var>...</var> <var>w_{1,c_1}</var>\n<var>:</var>\n<var>c_{N-1}</var> <var>w_{N-1,1}</var> <var>w_{N-1,2}</var> <var>...</var> <var>w_{N-1,c_{N-1}}</var>\n</pre>\n<p>Here, <var>c_i</var> stands for the number of elements in <var>E_i</var>, and <var>w_{i,1},...,w_{i,c_i}</var> are the <var>c_i</var> elements in <var>c_i</var>.\nHere, <var>2 \\leq c_i \\leq N</var>, <var>1 \\leq w_{i,j} \\leq N</var>, and <var>w_{i,j} \\neq w_{i,k}</var> (<var>1 \\leq j &lt; k \\leq c_i</var>) hold.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>If <var>T</var> cannot be a tree, print <code>-1</code>; otherwise, print the choices of <var>(u_i,v_i)</var> that satisfy the condition, in the following format:</p>\n<pre><var>u_1</var> <var>v_1</var>\n<var>:</var>\n<var>u_{N-1}</var> <var>v_{N-1}</var>\n</pre>\n</section>\n</div>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>5\n2 1 2\n3 1 2 3\n3 3 4 5\n2 4 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>1 2\n1 3\n3 4\n4 5\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>6\n3 1 2 3\n3 2 3 4\n3 1 3 4\n3 1 2 4\n3 4 5 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>-1\n</pre>\n\n</section>\n</div>\n\n<hr>\n\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>10\n5 1 2 3 4 5\n5 2 3 4 5 6\n5 3 4 5 6 7\n5 4 5 6 7 8\n5 5 6 7 8 9\n5 6 7 8 9 10\n5 7 8 9 10 1\n5 8 9 10 1 2\n5 9 10 1 2 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/agc029/tasks/agc029_f"}