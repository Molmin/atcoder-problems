{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>1000</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><em>ButCoder株式会社</em> は、プログラミングコンテストサイト「<em>ButCoder</em>」の開発や運営を主な事業とするスタートアップ企業です。</p>\n<p>ButCoder社には社長を含めて <var>N</var> 人の社員が在籍し、社長以外の各社員は直属の上司を一人だけ持ちます。各社員には <var>1</var> から <var>N</var> までの重複しない社員番号が割り当てられており、社員番号 <var>i</var> の社員は社員 <var>i</var> と呼ばれます。社長は社員 <var>1</var> であり、社員 <var>i</var> <var>(2 ≤ i ≤ N)</var> の直属の上司は社員 <var>b_i</var> <var>(1 ≤ b_i &lt; i)</var> です。</p>\n<p>ButCoder社員一同の集合写真を撮影するべく、全社員がButCoder本社の大広間に集まりました。この大広間はとても広く、<var>N</var> 人全員が横一列に並ぶことができます。しかし、彼らはどのような順番で並ぶかを決めかねています。どういうわけか、彼らは社長以外みな、自分の直属の上司と隣り合って並ぶことを避けたいようです。</p>\n<p><var>N</var> 人の社員の並び方であって、彼らの希望を満たすものは何通り存在するでしょうか？その個数を <var>10^9+7</var> で割ったあまりを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 ≤ N ≤ 2000</var></li>\n<li><var>1 ≤ b_i &lt; i</var> <var>(2 ≤ i ≤ N)</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var>\n<var>b_2</var>\n<var>b_3</var>\n<var>:</var>\n<var>b_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>N</var> 人の社員の並び方であって、社長を除くどの社員も自分の直属の上司と隣り合わないようなものの個数を <var>10^9+7</var> で割ったあまりを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>4\n1\n2\n3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>2\n</pre>\n\n<p>以下、社員 <var>A</var> が社員 <var>B</var> の直属の上司であることを <var>A → B</var> と表記します。</p>\n<p>このケースでは、社員の主従関係は <var>1 → 2 → 3 → 4</var> となっています。以下の <var>2</var> 通りの並び方が全社員の希望を満たします。</p>\n<ul>\n<li><var>2, 4, 1, 3</var></li>\n<li><var>3, 1, 4, 2</var></li>\n</ul>\n<p>なお、後者は前者を左右に反転したものですが、これらは個別に数えます。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3\n1\n2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n\n<p>社員の主従関係は <var>1 → 2 → 3</var> となっています。<var>3</var> 人の社員がどのように並んでも、社員 <var>2</var>, <var>3</var> の希望のうち少なくとも一方に反するため、答えは <var>0</var> 通りです。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>5\n1\n1\n3\n3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>8\n</pre>\n\n<p>社員の主従関係は次の図のようになっています。</p>\n<p><img alt=\"\" src=\"https://img.atcoder.jp/cf17-exhibition/88bc845e074e0a3fecd96e2db9f3b1a5.png\"></p>\n<p>以下の <var>8</var> 通りの並び方が全社員の希望を満たします。</p>\n<ul>\n<li><var>1, 4, 5, 2, 3</var></li>\n<li><var>1, 5, 4, 2, 3</var></li>\n<li><var>3, 2, 4, 1, 5</var></li>\n<li><var>3, 2, 4, 5, 1</var></li>\n<li><var>3, 2, 5, 1, 4</var></li>\n<li><var>3, 2, 5, 4, 1</var></li>\n<li><var>4, 1, 5, 2, 3</var></li>\n<li><var>5, 1, 4, 2, 3</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 4</h3><pre>15\n1\n2\n3\n1\n4\n2\n7\n1\n8\n2\n8\n1\n8\n2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 4</h3><pre>97193524\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>1000</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p><em>ButCoder Inc.</em> is a startup company whose main business is the development and operation of the programming competition site \"<em>ButCoder</em>\".</p>\n<p>There are <var>N</var> members of the company including the president, and each member except the president has exactly one direct boss. Each member has a unique ID number from <var>1</var> to <var>N</var>, and the member with the ID <var>i</var> is called Member <var>i</var>. The president is Member <var>1</var>, and the direct boss of Member <var>i</var> <var>(2 ≤ i ≤ N)</var> is Member <var>b_i</var> <var>(1 ≤ b_i &lt; i)</var>.</p>\n<p>All the members in ButCoder have gathered in the great hall in the main office to take a group photo. The hall is very large, and all <var>N</var> people can stand in one line. However, they have been unable to decide the order in which they stand. For some reason, all of them except the president want to avoid standing next to their direct bosses.</p>\n<p>How many ways are there for them to stand in a line that satisfy their desires? Find the count modulo <var>10^9+7</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 ≤ N ≤ 2000</var></li>\n<li><var>1 ≤ b_i &lt; i</var> <var>(2 ≤ i ≤ N)</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var>\n<var>b_2</var>\n<var>b_3</var>\n<var>:</var>\n<var>b_N</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the number of ways for the <var>N</var> members to stand in a line, such that no member except the president is next to his/her direct boss, modulo <var>10^9+7</var>.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>4\n1\n2\n3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>2\n</pre>\n\n<p>Below, we will write <var>A → B</var> to denote the fact that Member <var>A</var> is the direct boss of Member <var>B</var>.</p>\n<p>In this case, the hierarchy of the members is <var>1 → 2 → 3 → 4</var>. There are two ways for them to stand in a line that satisfy their desires:</p>\n<ul>\n<li><var>2, 4, 1, 3</var></li>\n<li><var>3, 1, 4, 2</var></li>\n</ul>\n<p>Note that the latter is the reverse of the former, but we count them individually.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3\n1\n2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n\n<p>The hierarchy of the members is <var>1 → 2 → 3</var>. No matter what order they stand in, at least one of the desires of Member <var>2</var> and <var>3</var> is not satisfied, so the answer is <var>0</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>5\n1\n1\n3\n3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>8\n</pre>\n\n<p>The hierarchy of the members is shown below:</p>\n<p><img alt=\"\" src=\"https://img.atcoder.jp/cf17-exhibition/88bc845e074e0a3fecd96e2db9f3b1a5.png\"></p>\n<p>There are eight ways for them to stand in a line that satisfy their desires:</p>\n<ul>\n<li><var>1, 4, 5, 2, 3</var></li>\n<li><var>1, 5, 4, 2, 3</var></li>\n<li><var>3, 2, 4, 1, 5</var></li>\n<li><var>3, 2, 4, 5, 1</var></li>\n<li><var>3, 2, 5, 1, 4</var></li>\n<li><var>3, 2, 5, 4, 1</var></li>\n<li><var>4, 1, 5, 2, 3</var></li>\n<li><var>5, 1, 4, 2, 3</var></li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>15\n1\n2\n3\n1\n4\n2\n7\n1\n8\n2\n8\n1\n8\n2\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>97193524\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/cf17-exhibition-open/tasks/cf17_exhibition_a"}