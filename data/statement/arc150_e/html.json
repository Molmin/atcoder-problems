{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>800</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>NK</var> 人の人が横一列に並んでいます。左から順に人 <var>i\\ (0\\leq i \\leq NK-1)</var> と表記します。</p>\n<p>各人は常に左右どちらかの方向を向いています。時刻 <var>t=0</var> において各人がどちらを向いているかは、<code>L</code>,<code>R</code> のみからなる長さ <var>N</var> の文字列 <var>S=S_0 S_1 \\dots S_{N-1}</var> で表されます。時刻 <var>t=0</var> において人 <var>i</var> は <var>S_{i \\bmod N}</var> が <code>L</code> のとき左を、 <code>R</code> のとき右を向いています。</p>\n<p>これらの人は時刻 <var>t=0.5,\\ 1.5,\\ 2.5 ,\\ \\dots</var> において以下の規則に従って向いている方向を<b>同時に</b>変化させます。</p>\n<ul>\n<li>その時点で左を向いている場合<br>\n自分が向いている方向に人が存在し、その中で過半数の人が右を向いている場合、向いている方向を右に変える。そうでない場合向いている方向を変えない。</li>\n<li>その時点で右を向いている場合<br>\n自分が向いている方向に人が存在し、その中で過半数の人が左を向いている場合、向いている方向を左に変える。そうでない場合向いている方向を変えない。</li>\n</ul>\n<p>時刻 <var>t=0</var> から <var>t=10^{100}</var> までの間に、<var>NK</var> 人それぞれが向いている方向を変える回数の総和を <var>998244353</var> で割った余りを求めてください。</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>1 \\leq N  \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq K \\leq 2 \\times 10^5</var></li>\n<li><var>S</var> は <code>L</code>,<code>R</code> のみからなる長さ <var>N</var> の文字列</li>\n<li>入力される数値はすべて整数</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられます。</p>\n<pre><var>N</var> <var>K</var>\n<var>S</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p>答えを出力してください。</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>7 1\nRRLRLLL\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>9\n</pre>\n<p>各時刻において <var>7</var> 人が向いている方向を文字列で表すと <var>t=1</var> では <code>LLRLRRL</code> 、<var>t=2</var> では <code>LLRLRLL</code> 、 <var>t=3</var> では <code>LLLLLLL</code> となります。</p>\n<p>時刻 <var>t=3</var> 以降では <var>7</var> 人が向いている方向は変化しません。よって答えは <var>1+1+2+1+2+2+0=9</var> になります。</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>4 10\nLLRR\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>0\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>23 200\nRLRRRLLLLLLLLRRRLLRLRRR\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>2207\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>800</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p><var>NK</var> people are standing in a line from left to right. Let us denote them as person <var>i</var> <var>(0\\leq i \\leq NK-1)</var> from left to right.</p>\n<p>Each person is always facing either left or right. The direction of each person at time <var>t=0</var> is represented by a string of length <var>N</var>, <var>S=S_0 S_1 \\dots S_{N-1}</var>, consisting of <code>L</code> and <code>R</code>. At time <var>t=0</var>, person <var>i</var> is facing left if <var>S_{i \\bmod N}</var> is <code>L</code>, and right if it is <code>R</code>.</p>\n<p>At time <var>t=0.5,\\ 1.5,\\ 2.5 ,\\ \\dots</var>, these people <b>simultaneously</b> change their directions according to the following rules.</p>\n<ul>\n<li>When a person is facing left:<br>\nIf there are one or more people in the direction the person is facing, and more than half of those people are facing right, the person changes direction and faces right. Otherwise, the person does not change direction.</li>\n<li>When a person is facing right:<br>\nIf there are one or more people in the direction the person is facing, and more than half of those people are facing left, the person changes direction and faces left. Otherwise, the person does not change direction.</li>\n</ul>\n<p>Find the sum, modulo <var>998244353</var>, of the numbers of times the <var>NK</var> people change direction from time <var>t=0</var> to <var>t=10^{100}</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>1 \\leq N  \\leq 2 \\times 10^5</var></li>\n<li><var>1 \\leq K \\leq 2 \\times 10^5</var></li>\n<li><var>S</var> is a string of length <var>N</var> consisting of <code>L</code> and <code>R</code>.</li>\n<li>All numerical values in the input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>K</var>\n<var>S</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>7 1\nRRLRLLL\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>9\n</pre>\n<p>If we represent the directions of the seven people at each time, we have <code>LLRLRRL</code> at <var>t=1</var>, <code>LLRLRLL</code> at <var>t=2</var>, and <code>LLLLLLL</code> at <var>t=3</var>.</p>\n<p>After <var>t=3</var>, the directions of the seven people do not change. Therefore, the answer is <var>1+1+2+1+2+2+0=9</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>4 10\nLLRR\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>0\n</pre>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>23 200\nRLRRRLLLLLLLLRRRLLRLRRR\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>2207\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/arc150/tasks/arc150_e"}