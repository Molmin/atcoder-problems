{"html":{"ja":"<span class=\"lang-ja\">\n<p>配点 : <var>600</var> 点</p>\n\n<div class=\"part\">\n<section>\n<h3>問題文</h3><p><var>N</var> 頂点 <var>M</var> 辺の単純無向グラフがあります。頂点には <var>1</var> から <var>N</var> までの、辺には <var>1</var> から <var>M</var> までの番号がついています。<br>\n辺 <var>i</var> は頂点 <var>X_i</var> と頂点 <var>Y_i</var> を結んでいます。また、頂点 <var>i</var> には最初整数 <var>A_i</var> が書かれています。<br>\nあなたは <var>K</var> 回にわたって以下の操作を行います。</p>\n<ul>\n<li><var>M</var> 本ある辺の中から、一様ランダムかつ他の選択と独立に <var>1</var> 本選ぶ。その辺が結ぶ <var>2</var> 頂点に書かれている数の平均を <var>x</var> として、その <var>2</var> 頂点に書かれている数を両方 <var>x</var> で置き換える。  </li>\n</ul>\n<p>各頂点 <var>i</var> について、<var>K</var> 回の操作後に頂点 <var>i</var> に書かれている数の期待値を求め、注記の通り <var>\\bmod (10^9 + 7)</var> で出力してください。  </p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>注記</h3><p>有理数を出力する際は、まずその有理数を分数 <var>\\frac{y}{x}</var> として表してください。<br>\nここで、<var>x,y</var> は整数であり、<var>x</var> は <var>10^9+7</var> で割り切れてはなりません (この問題の制約下で、そのような表現は必ず可能です)。<br>\nそして、<var>xz \\equiv y \\pmod {10^9+7}</var> を満たすような <var>0</var> 以上 <var>10^9+6</var> 以下の唯一の整数 <var>z</var> を出力してください。  </p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>制約</h3><ul>\n<li><var>2 \\le N \\le 100</var></li>\n<li><var>1 \\le M \\le \\frac{N(N - 1)}{2}</var></li>\n<li><var>0 \\le K \\le 10^9</var></li>\n<li><var>0 \\le A_i \\le 10^9</var></li>\n<li><var>1 \\le X_i \\le N</var></li>\n<li><var>1 \\le Y_i \\le N</var></li>\n<li>与えられるグラフは単純</li>\n<li>入力に含まれる値は全て整数である</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>\n<pre><var>N</var> <var>M</var> <var>K</var>\n<var>A_1</var> <var>A_2</var> <var>A_3</var> <var>\\dots</var> <var>A_N</var>\n<var>X_1</var> <var>Y_1</var>\n<var>X_2</var> <var>Y_2</var>\n<var>X_3</var> <var>Y_3</var>\n<var>\\hspace{15pt} \\vdots</var>\n<var>X_M</var> <var>Y_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力</h3><p><var>N</var> 行にわたって出力せよ。<br>\n<var>i</var> 行目には、<var>K</var> 回の操作後に頂点 <var>i</var> に書かれている数の期待値を、注記に従って <var>\\bmod (10^9 + 7)</var> で出力せよ。  </p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 1</h3><pre>3 2 1\n3 1 5\n1 2\n1 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 1</h3><pre>3\n500000005\n500000008\n</pre>\n<ul>\n<li>唯一の操作で辺 <var>1</var> が選ばれた場合 : 頂点 <var>1, 2, 3</var> に書かれている数はそれぞれ <var>2, 2, 5</var> となります</li>\n<li>唯一の操作で辺 <var>2</var> が選ばれた場合 : 頂点 <var>1, 2, 3</var> に書かれている数はそれぞれ <var>4, 1, 4</var> となります</li>\n</ul>\n<p>従って、操作後に頂点 <var>1, 2, 3</var> に書かれている数の期待値はそれぞれ <var>3, \\frac{3}{2}, \\frac{9}{2}</var> となります。<br>\nこれらを注記に従って <var>\\bmod (10^9 + 7)</var> の表現に変換すると、それぞれ <var>3, 500000005, 500000008</var> となります。  </p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 2</h3><pre>3 2 2\n12 48 36\n1 2\n1 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 2</h3><pre>750000036\n36\n250000031\n</pre>\n<ul>\n<li><var>1</var> 回目の操作で辺 <var>1</var> が選ばれた場合<br>\n    頂点 <var>1, 2, 3</var> に書かれている数はそれぞれ <var>30, 30, 36</var> となります  <ul>\n<li><var>2</var> 回目の操作で辺 <var>1</var> が選ばれた場合 : 頂点 <var>1, 2, 3</var> に書かれている数はそれぞれ <var>30, 30, 36</var> となります  </li>\n<li><var>2</var> 回目の操作で辺 <var>2</var> が選ばれた場合 : 頂点 <var>1, 2, 3</var> に書かれている数はそれぞれ <var>33, 30, 33</var> となります  </li>\n</ul>\n</li>\n<li><var>1</var> 回目の操作で辺 <var>2</var> が選ばれた場合<br>\n    頂点 <var>1, 2, 3</var> に書かれている数はそれぞれ <var>24, 48, 24</var> となります  <ul>\n<li><var>2</var> 回目の操作で辺 <var>1</var> が選ばれた場合 : 頂点 <var>1, 2, 3</var> に書かれている数はそれぞれ <var>36, 36, 24</var> となります  </li>\n<li><var>2</var> 回目の操作で辺 <var>2</var> が選ばれた場合 : 頂点 <var>1, 2, 3</var> に書かれている数はそれぞれ <var>24, 48, 24</var> となります  </li>\n</ul>\n</li>\n</ul>\n<p>これら <var>4</var> 通りのケースが各 <var>\\frac{1}{4}</var> の確率で起こるので、頂点 <var>1, 2, 3</var> に最終的に書かれている数の期待値はそれぞれ <var>\\frac{123}{4}, \\frac{144}{4} (=36), \\frac{117}{4}</var> となります。  </p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>入力例 3</h3><pre>4 5 1000\n578 173 489 910\n1 2\n2 3\n3 4\n4 1\n1 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>出力例 3</h3><pre>201113830\n45921509\n67803140\n685163678\n</pre></section>\n</div>\n</span>","en":"<span class=\"lang-en\">\n<p>Score : <var>600</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>We have a simple undirected graph with <var>N</var> vertices and <var>M</var> edges. The vertices are numbered <var>1</var> through <var>N</var> and the edges are numbered <var>1</var> through <var>M</var>.<br>\nEdge <var>i</var> connects Vertex <var>X_i</var> and Vertex <var>Y_i</var>. Initially, Vertex <var>i</var> has an integer <var>A_i</var> written on it.<br>\nYou will do the following operation <var>K</var> times:</p>\n<ul>\n<li>Choose one from the <var>M</var> edges uniformly at random and independently from other choices. Let <var>x</var> be the arithmetic mean of the numbers written on the two vertices connected by that edge. Replace each number written on those vertices with <var>x</var>.</li>\n</ul>\n<p>For each vertex <var>i</var>, find the expected value of the number written on that vertex after <var>K</var> operations, and print it modulo <var>(10^9 + 7)</var> as described in Notes.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Notes</h3><p>When printing a rational number, first, represent it as a fraction <var>\\frac{y}{x}</var>, where <var>x</var> and <var>y</var> are integers and <var>x</var> is not divisible by <var>(10^9+7)</var> (under the Constraints of this problem, such a representation is always possible).<br>\nThen, print the only integer <var>z</var> between <var>0</var> and <var>(10^9+6)</var> (inclusive) such that <var>xz \\equiv y \\pmod {10^9+7}</var>.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>2 \\le N \\le 100</var></li>\n<li><var>1 \\le M \\le \\frac{N(N - 1)}{2}</var></li>\n<li><var>0 \\le K \\le 10^9</var></li>\n<li><var>0 \\le A_i \\le 10^9</var></li>\n<li><var>1 \\le X_i \\le N</var></li>\n<li><var>1 \\le Y_i \\le N</var></li>\n<li>The given graph is simple.</li>\n<li>All values in input are integers.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>N</var> <var>M</var> <var>K</var>\n<var>A_1</var> <var>A_2</var> <var>A_3</var> <var>\\dots</var> <var>A_N</var>\n<var>X_1</var> <var>Y_1</var>\n<var>X_2</var> <var>Y_2</var>\n<var>X_3</var> <var>Y_3</var>\n<var>\\hspace{15pt} \\vdots</var>\n<var>X_M</var> <var>Y_M</var>\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print <var>N</var> lines.<br>\nThe <var>i</var>-th line should contain the expected value of the number written on that vertex after <var>K</var> operations, modulo <var>(10^9 + 7)</var>, as described in Notes.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3 2 1\n3 1 5\n1 2\n1 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>3\n500000005\n500000008\n</pre>\n<ul>\n<li>If Edge <var>1</var> is chosen in the only operation: the vertices written on Vertices <var>1, 2, 3</var> will be <var>2, 2, 5</var>, respectively.</li>\n<li>If Edge <var>2</var> is chosen in the only operation: the vertices written on Vertices <var>1, 2, 3</var> will be <var>4, 1, 4</var>, respectively.</li>\n</ul>\n<p>Thus, the expected values of the numbers written on Vertices <var>1, 2, 3</var> are <var>3, \\frac{3}{2}, \\frac{9}{2}</var>, respectively.<br>\nIf we express them modulo <var>(10^9 + 7)</var> as described in Notes, they will be <var>3, 500000005, 500000008</var>, respectively.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>3 2 2\n12 48 36\n1 2\n1 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>750000036\n36\n250000031\n</pre>\n<ul>\n<li>If Edge <var>1</var> is chosen in the <var>1</var>-st operation:\n    The numbers written on Vertices <var>1, 2, 3</var> will be <var>30, 30, 36</var>, respectively.  <ul>\n<li>If Edge <var>1</var> is chosen in the <var>2</var>-nd operation:\nThe numbers written on Vertices <var>1, 2, 3</var> will be <var>30, 30, 36</var>, respectively.</li>\n<li>If Edge <var>2</var> is chosen in the <var>2</var>-nd operation:\nThe numbers written on Vertices <var>1, 2, 3</var> will be <var>33, 30, 33</var>, respectively.</li>\n</ul>\n</li>\n<li>If Edge <var>2</var> is chosen in the <var>1</var>-st operation:\n    The numbers written on Vertices <var>1, 2, 3</var> will be <var>24, 48, 24</var>, respectively.  <ul>\n<li>If Edge <var>1</var> is chosen in the <var>2</var>-nd operation:\nThe numbers written on Vertices <var>1, 2, 3</var> will be <var>36, 36, 24</var>, respectively.</li>\n<li>If Edge <var>2</var> is chosen in the <var>2</var>-nd operation:\nThe numbers written on Vertices <var>1, 2, 3</var> will be <var>24, 48, 24</var>, respectively.</li>\n</ul>\n</li>\n</ul>\n<p>Each of these four scenarios happen with probability <var>\\frac{1}{4}</var>, so the expected values of the numbers written on Vertices <var>1, 2, 3</var> are <var>\\frac{123}{4}, \\frac{144}{4} (=36), \\frac{117}{4}</var>, respectively.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>4 5 1000\n578 173 489 910\n1 2\n2 3\n3 4\n4 1\n1 3\n</pre>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>201113830\n45921509\n67803140\n685163678\n</pre></section>\n</div>\n</span>"},"endpoint":"https://atcoder.jp/contests/abc199/tasks/abc199_f"}